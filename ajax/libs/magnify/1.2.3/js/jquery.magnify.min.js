!function(n){n.fn.magnify=function(e){var a=n.extend({speed:100},e);return this.each(function(){!function(e){var t,i,r=n(e),s=r.parents("a"),f=r.attr("data-magnify-src")||a.src||s.attr("href")||"",d=0,c=0;r.css("display","block"),r.parent(".magnify").length||r.wrap('<div class="magnify"></div>'),t=r.parent(".magnify"),r.prev(".magnify-lens").length?t.children(".magnify-lens").css("background-image","url("+f+")"):r.before('<div class="magnify-lens loading" style="background:url('+f+') no-repeat 0 0;"></div>'),i=t.children(".magnify-lens");var g=new Image;n(g).load(function(){i.removeClass("loading"),d=g.width,c=g.height}),g.src=f,t.mousemove(function(n){var e=t.offset(),s=n.pageX-e.left;if(nY=n.pageY-e.top,s<t.width()&&nY<t.height()&&s>0&&nY>0?i.fadeIn(a.speed):i.fadeOut(a.speed),i.is(":visible")){var f=s-i.width()/2,g=nY-i.height()/2;if(d&&c)var h=-1*Math.round(s/r.width()*d-i.width()/2)+"px "+-1*Math.round(nY/r.height()*c-i.height()/2)+"px";i.css({top:g,left:f,backgroundPosition:h||""})}}),!s.attr("href")||r.attr("data-magnify-src")||a.src||s.click(function(n){n.preventDefault()})}(this)})}}(jQuery);