!function(e){e.fn.magnify=function(n){var i,a,t,o,s=e.extend({debug:!1,speed:100,onload:function(){}},n),r=0,l=0,d=function(n,g){if(n){var c=new Image;e(c).on({load:function(){t.css("display","block"),t.parent(".magnify").length||t.wrap('<div class="magnify"></div>'),a=t.parent(".magnify"),t.prev(".magnify-lens").length?a.children(".magnify-lens").css("background-image","url('"+n+"')"):t.before('<div class="magnify-lens loading" style="background:url(\''+n+"') no-repeat 0 0\"></div>"),(o=a.children(".magnify-lens")).removeClass("loading"),r=c.width,l=c.height,s.debug&&console.log("[MAGNIFY] Got zoom image dimensions OK (width x height): "+r+" x "+l),c=null,s.onload(),a.on("mousemove touchmove",function(e){e.preventDefault();var n=a.offset(),i=(e.pageX||e.originalEvent.touches[0].pageX)-n.left,d=(e.pageY||e.originalEvent.touches[0].pageY)-n.top;if(o.is(":animated")||(i<a.width()&&d<a.height()&&i>0&&d>0?o.is(":hidden")&&o.fadeIn(s.speed):o.is(":visible")&&o.fadeOut(s.speed)),o.is(":visible")){var g=i-o.width()/2,c=d-o.height()/2;if(r&&l)var h=-1*Math.round(i/t.width()*r-o.width()/2)+"px "+-1*Math.round(d/t.height()*l-o.height()/2)+"px";o.css({top:Math.round(c)+"px",left:Math.round(g)+"px",backgroundPosition:h||""})}}),a.mouseleave(function(){o.is(":visible")&&o.fadeOut(s.speed)}),i.length&&(i.css("display","inline-block"),(g||i.attr("href")&&!t.attr("data-magnify-src")&&!s.src)&&i.click(function(e){e.preventDefault()}))},error:function(){c=null,g?s.debug&&console.log("[MAGNIFY] Parent anchor zoom source is invalid also. Disabling zoom..."):(s.debug&&console.log("[MAGNIFY] Invalid data-magnify-src. Looking in parent anchor instead -> "+i.attr("href")),d(i.attr("href"),!0))}}),c.src=n}};return this.each(function(){t=e(this),i=t.parents("a"),d(t.attr("data-magnify-src")||s.src||i.attr("href")||"")})}}(jQuery);