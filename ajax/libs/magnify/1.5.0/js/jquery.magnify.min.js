!function(e){e.fn.magnify=function(n){var i,t,a,o,s=e.extend({debug:!1,speed:100,timeout:-1,onload:function(){}},n),r=0,d=0,l=function(n,u){if(n){var c=new Image;e(c).on({load:function(){a.css("display","block"),a.parent(".magnify").length||a.wrap('<div class="magnify"></div>'),t=a.parent(".magnify"),a.prev(".magnify-lens").length?t.children(".magnify-lens").css("background-image","url('"+n+"')"):a.before('<div class="magnify-lens loading" style="background:url(\''+n+"') no-repeat 0 0\"></div>"),(o=t.children(".magnify-lens")).removeClass("loading"),r=c.width,d=c.height,s.debug&&console.log("[MAGNIFY] Got zoom image dimensions OK (width x height): "+r+" x "+d),c=null,s.onload(),t.on("mousemove touchmove",function(e){e.preventDefault();var n=t.offset(),i=(e.pageX||e.originalEvent.touches[0].pageX)-n.left,l=(e.pageY||e.originalEvent.touches[0].pageY)-n.top;if(o.is(":animated")||(i<t.width()&&l<t.height()&&i>0&&l>0?o.is(":hidden")&&o.fadeIn(s.speed):o.is(":visible")&&o.fadeOut(s.speed)),o.is(":visible")){var u=i-o.width()/2,c=l-o.height()/2;if(r&&d)var g=-1*Math.round(i/a.width()*r-o.width()/2)+"px "+-1*Math.round(l/a.height()*d-o.height()/2)+"px";o.css({top:Math.round(c)+"px",left:Math.round(u)+"px",backgroundPosition:g||""})}}),t.mouseleave(function(){o.is(":visible")&&o.fadeOut(s.speed)}),s.timeout>=0&&t.on("touchend",function(){setTimeout(function(){o.is(":visible")&&o.fadeOut(s.speed)},s.timeout)}),i.length&&(i.css("display","inline-block"),(u||i.attr("href")&&!a.attr("data-magnify-src")&&!s.src)&&i.click(function(e){e.preventDefault()}))},error:function(){c=null,u?s.debug&&console.log("[MAGNIFY] Parent anchor zoom source is invalid also. Disabling zoom..."):(s.debug&&console.log("[MAGNIFY] Invalid data-magnify-src. Looking in parent anchor instead -> "+i.attr("href")),l(i.attr("href"),!0))}}),c.src=n}};return this.each(function(){a=e(this),i=a.parents("a"),l(a.attr("data-magnify-src")||s.src||i.attr("href")||"")})}}(jQuery);