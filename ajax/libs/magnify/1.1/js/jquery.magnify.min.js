!function(n){n.fn.magnify=function(e){var i=n.extend({speed:200},e);return this.each(function(){!function(e){var a,t,s=n(e),r=s.attr("data-magnify-src")||i.src||"",d=0,f=0;s.css("display","block"),s.parent(".magnify").length||s.wrap('<div class="magnify"></div>'),a=s.parent(".magnify"),s.prev(".magnify-lens").length||s.before('<div class="magnify-lens loading" style="background:url('+r+') no-repeat 0 0;"></div>'),t=a.children(".magnify-lens");var o=new Image;n(o).load(function(){t.removeClass("loading"),d=o.width,f=o.height}),o.src=r,a.mousemove(function(n){var e=a.offset(),r=n.pageX-e.left;if(nY=n.pageY-e.top,r<a.width()&&nY<a.height()&&r>0&&nY>0?t.fadeIn(i.speed):t.fadeOut(i.speed),t.is(":visible")){var o=r-t.width()/2,h=nY-t.height()/2;if(d&&f)var g=-1*Math.round(r/s.width()*d-t.width()/2)+"px "+-1*Math.round(nY/s.height()*f-t.height()/2)+"px";t.css({top:h,left:o,backgroundPosition:g||""})}})}(this)})}}(jQuery);