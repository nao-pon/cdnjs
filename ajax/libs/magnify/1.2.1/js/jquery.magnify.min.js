!function(n){n.fn.magnify=function(e){var t=n.extend({speed:200},e);return this.each(function(){!function(e){var a,i,r=n(e),s=r.parents("a"),f=r.attr("data-magnify-src")||t.src||s.attr("href")||"",d=0,h=0;r.css("display","block"),r.parent(".magnify").length||r.wrap('<div class="magnify"></div>'),a=r.parent(".magnify"),r.prev(".magnify-lens").length||r.before('<div class="magnify-lens loading" style="background:url('+f+') no-repeat 0 0;"></div>'),i=a.children(".magnify-lens");var o=new Image;n(o).load(function(){i.removeClass("loading"),d=o.width,h=o.height}),o.src=f,a.mousemove(function(n){var e=a.offset(),s=n.pageX-e.left;if(nY=n.pageY-e.top,s<a.width()&&nY<a.height()&&s>0&&nY>0?i.fadeIn(t.speed):i.fadeOut(t.speed),i.is(":visible")){var f=s-i.width()/2,o=nY-i.height()/2;if(d&&h)var c=-1*Math.round(s/r.width()*d-i.width()/2)+"px "+-1*Math.round(nY/r.height()*h-i.height()/2)+"px";i.css({top:o,left:f,backgroundPosition:c||""})}}),!s.attr("href")||r.attr("data-magnify-src")||t.src||s.click(function(n){n.preventDefault()})}(this)})}}(jQuery);