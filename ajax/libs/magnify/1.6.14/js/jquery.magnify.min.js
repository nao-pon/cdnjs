!function(e){e.fn.magnify=function(t){var n=this,i=e.extend({speed:100,timeout:-1,onload:function(){}},t),a=0,o=function(){clearTimeout(a),a=setTimeout(function(){n.destroy(),n.magnify(i)},100)};return this.destroy=function(){return this.each(function(){var t=e(this),n=t.data("originalStyle");n?t.attr("style",n):t.removeAttr("style"),t.unwrap(".magnify").prevAll(".magnify-lens").remove()}),e(window).off("resize",o),n},e(window).resize(o),this.each(function(){!function(t){var n,a,r,s,l,f,c,g,u,d=e(t),h=d.closest("a"),m=0,p=0,v=d.attr("data-magnify-src")||i.src||h.attr("href")||"",y=function(){a.is(":visible")&&a.fadeOut(i.speed,function(){e("html").removeClass("magnifying").trigger("magnifyend")})};if(v){d.data("originalStyle",d.attr("style"));var w=new Image;e(w).on({load:function(){d.css("display","block"),d.parent(".magnify").length||d.wrap('<div class="magnify"></div>'),n=d.parent(".magnify"),d.prev(".magnify-lens").length?n.children(".magnify-lens").css("background-image","url('"+v+"')"):d.before('<div class="magnify-lens loading" style="background:url(\''+v+"') no-repeat 0 0\"></div>"),(a=n.children(".magnify-lens")).removeClass("loading"),r=n.offset(),s=n.width(),l=n.height(),f=d.innerWidth(),c=d.innerHeight(),g=a.width(),u=a.height(),m=w.width,p=w.height,d.data("zoomSize",{width:m,height:p}),w=null,i.onload(),n.off().on({"mousemove touchmove":function(t){if(t.preventDefault(),l){var n=(t.pageX||t.originalEvent.touches[0].pageX)-r.left,d=(t.pageY||t.originalEvent.touches[0].pageY)-r.top;if(a.is(":animated")||(n<s&&d<l&&n>0&&d>0?a.is(":hidden")&&(e("html").addClass("magnifying").trigger("magnifystart"),a.fadeIn(i.speed)):y()),a.is(":visible")){var h=n-g/2,v=d-u/2;if(m&&p)var w=-1*Math.round(n/f*m-g/2)+"px "+-1*Math.round(d/c*p-u/2)+"px";a.css({top:Math.round(v)+"px",left:Math.round(h)+"px",backgroundPosition:w||""})}}else o()},mouseenter:function(){r=n.offset()},mouseleave:y}),i.timeout>=0&&n.on("touchend",function(){setTimeout(y,i.timeout)}),e("body").not(n).on("touchstart",y);var t=d.attr("usemap");t&&(d.after(e("map[name="+t.slice(1)+"]")),n.click(function(e){(e.pageX||e.pageY)&&(a.hide(),document.elementFromPoint(e.pageX||e.originalEvent.touches[0].pageX,e.pageY||e.originalEvent.touches[0].pageY).click())})),h.length&&(h.css("display","inline-block"),!h.attr("href")||d.attr("data-magnify-src")||i.src||h.click(function(e){e.preventDefault()}))},error:function(){w=null}}),w.src=v}}(this)})}}(jQuery);