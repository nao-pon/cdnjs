!function(e){e.fn.magnify=function(t){var n=this,i=e.extend({speed:100,timeout:-1,onload:function(){}},t),a=0,o=function(){clearTimeout(a),a=setTimeout(function(){n.destroy(),n.magnify(i)},100)};return this.destroy=function(){return this.each(function(){var t=e(this),n=t.data("originalStyle");n?t.attr("style",n):t.removeAttr("style"),t.unwrap(".magnify").prevAll(".magnify-lens").remove()}),e(window).off("resize",o),n},e(window).resize(o),this.each(function(){!function(t){var n,a,o,r,s,l,c,f,g,u=e(t),d=u.closest("a"),h=0,m=0,p=u.attr("data-magnify-src")||i.src||d.attr("href")||"",v=function(){a.is(":visible")&&a.fadeOut(i.speed,function(){e("html").removeClass("magnifying").trigger("magnifyend")})};if(p){u.data("originalStyle",u.attr("style"));var y=new Image;e(y).on({load:function(){u.css("display","block"),u.parent(".magnify").length||u.wrap('<div class="magnify"></div>'),n=u.parent(".magnify"),u.prev(".magnify-lens").length?n.children(".magnify-lens").css("background-image","url('"+p+"')"):u.before('<div class="magnify-lens loading" style="background:url(\''+p+"') no-repeat 0 0\"></div>"),(a=n.children(".magnify-lens")).removeClass("loading"),h=y.width,m=y.height,o=n.offset(),r=n.width(),s=n.height(),l=u.innerWidth(),c=u.innerHeight(),f=a.width(),g=a.height(),u.data("zoomSize",{width:h,height:m}),y=null,i.onload(),n.on("mousemove touchmove",function(t){t.preventDefault();var n=(t.pageX||t.originalEvent.touches[0].pageX)-o.left,u=(t.pageY||t.originalEvent.touches[0].pageY)-o.top;if(a.is(":animated")||(n<r&&u<s&&n>0&&u>0?a.is(":hidden")&&(e("html").addClass("magnifying").trigger("magnifystart"),a.fadeIn(i.speed)):v()),a.is(":visible")){var d=n-f/2,p=u-g/2;if(h&&m)var y=-1*Math.round(n/l*h-f/2)+"px "+-1*Math.round(u/c*m-g/2)+"px";a.css({top:Math.round(p)+"px",left:Math.round(d)+"px",backgroundPosition:y||""})}}),n.mouseleave(v),i.timeout>=0&&n.on("touchend",function(){setTimeout(v,i.timeout)}),e("body").not(n).on("touchstart",v);var t=u.attr("usemap");t&&(u.after(e("map[name="+t.slice(1)+"]")),n.one("click",function(e){a.hide(),document.elementFromPoint(e.pageX||e.originalEvent.touches[0].pageX,e.pageY||e.originalEvent.touches[0].pageY).click()})),d.length&&(d.css("display","inline-block"),!d.attr("href")||u.attr("data-magnify-src")||i.src||d.click(function(e){e.preventDefault()}))},error:function(){y=null}}),y.src=p}}(this)})}}(jQuery);