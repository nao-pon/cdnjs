!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.nipplejs=t()}}(function(){var t=!!("ontouchstart"in window),i={touch:{start:"touchstart",move:"touchmove",end:"touchend"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"}},e={},o=t?i.touch:i.mouse,n={};n.distance=function(t,i){var e=i.x-t.x,o=i.y-t.y;return Math.sqrt(e*e+o*o)},n.angle=function(t,i){var e=i.x-t.x,o=i.y-t.y;return n.degrees(Math.atan2(o,e))},n.findCoord=function(t,i,e){var o={x:0,y:0};return e=n.radians(e),o.x=t.x-i*Math.cos(e),o.y=t.y-i*Math.sin(e),o},n.radians=function(t){return t*(Math.PI/180)},n.degrees=function(t){return t*(180/Math.PI)},n.bindEvt=function(t,i,e){t.addEventListener?t.addEventListener(i,e,!1):t.attachEvent&&t.attachEvent(i,e)},n.unbindEvt=function(t,i,e){t.removeEventListener?t.removeEventListener(i,e):t.detachEvent&&t.detachEvent(i,e)},n.trigger=function(t,i,e){var o=new CustomEvent(i,e);t.dispatchEvent(o)},n.prepareEvent=function(i){return i.preventDefault(),t?i.touches[0]:i},n.getScroll=function(){var t=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,i=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:t,y:i}};var s=function(t){return this.config(t),this.handlers={},this.buildEl().stylize().bindEvt(this.options.zone,"start"),{on:this.on.bind(this),off:this.off.bind(this),el:this.ui.el,options:this.options,ui:this.ui}};return s.prototype.on=function(t,i){var e=this,o=t.split(/[ ,]/g);if(o.length>1){for(var n=0,s=o.length;s>n;n+=1)e.on(o[n],i);return e}return e.handlers[t]=e.handlers[t]||[],e.handlers[t].push(i),e},s.prototype.off=function(t,i){var e=this;return e.handlers[t]&&e.handlers[t].indexOf(i)>=0&&e.handlers[t].splice(e.handlers[t].indexOf(i),1),e},s.prototype.trigger=function(t,i){var e=this;e.handlers[t]&&e.handlers[t].length&&e.handlers[t].forEach(function(o){o.call(e,{type:t},i)})},s.prototype.config=function(t){this.options={},this.options.zone=document.body,this.options.size=100,this.options.threshold=.1,this.options.color="white",this.options.fadeTime=250;for(var i in t)t.hasOwnProperty(i)&&(this.options[i]=t[i]);return this},s.prototype.buildEl=function(t){return this.ui={},this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple",this.ui.back.className="back",this.ui.front.className="front",this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this},s.prototype.stylize=function(){this.styles={},this.styles.el={width:this.options.size+"px",height:this.options.size+"px",position:"absolute",opacity:0,display:"none",transition:"opacity "+this.options.fadeTime+"ms",webkitTransition:"opacity "+this.options.fadeTime+"ms",MozTransition:"opacity "+this.options.fadeTime+"ms",oTransition:"opacity "+this.options.fadeTime+"ms",zIndex:999},this.styles.back={position:"relative",display:"block",width:"100%",height:"100%",background:this.options.color,borderRadius:"50%",webkitBorderRadius:"50%",MozBorderRadius:"50%",opacity:".5"},this.styles.front={width:"50%",height:"50%",position:"absolute",display:"block",background:this.options.color,borderRadius:"50%",webkitBorderRadius:"50%",MozBorderRadius:"50%",opacity:".5"};for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in this.styles[t])this.ui[t].style[i]=this.styles[t][i];return this},s.prototype.addToDom=function(){return this.options.zone.appendChild(this.ui.el),this},s.prototype.removeFromDom=function(){return this.options.zone.removeChild(this.ui.el),this},s.prototype.show=function(){var t=this;return clearTimeout(t.removeTimeout),t.ui.el.style.opacity=0,t.addToDom(),t.ui.el.style.display="block",setTimeout(function(){t.ui.el.style.opacity=1},0),t},s.prototype.hide=function(){var t=this;return t.ui.el.style.opacity=0,clearTimeout(t.removeTimeout),t.removeTimeout=setTimeout(function(){t.ui.el.style.display="none",t.removeFromDom()},t.options.fadeTime),t},s.prototype.applyPosition=function(t,i){return t.style.left=i.x+"px",t.style.top=i.y+"px",this},s.prototype.bindEvt=function(t,i){var s=this;return e[i]=function(){s["on"+i].apply(s,arguments)},n.bindEvt(t,o[i],e[i]),s},s.prototype.unbindEvt=function(t,i){return n.unbindEvt(t,o[i],e[i]),e[i]=void 0,this},s.prototype.computeDirection=function(t,i){var e,o,n,s=i.angle.radian,r=(i.angle.degree,Math.PI/4),a=Math.PI/2;if(e=s>r&&3*r>s?"up":s>-r&&r>=s?"left":s>3*-r&&-r>=s?"down":"right",o=s>-a&&a>s?"left":"right",n=s>0?"up":"down",i.force>this.options.threshold){var h={};for(var d in this.direction)this.direction.hasOwnProperty(d)&&(h[d]=this.direction[d]);var p=!0;this.direction={x:o,y:n,angle:e},i.direction=this.direction;for(var d in h)h[d]!==this.direction[d]&&(p=!1);if(p)return;(h.x!==this.direction.x||h.y!==this.direction.y)&&this.trigger("plain",i),h.x!==this.direction.x&&this.trigger("plain:"+o,i),h.y!==this.direction.y&&this.trigger("plain:"+n,i),h.angle!==this.direction.angle&&(this.trigger("dir",i),this.trigger("dir:"+e,i))}},s.prototype.onstart=function(t){t=n.prepareEvent(t);var i=n.getScroll();return this.box=this.options.zone.getBoundingClientRect(),this.pos={x:t.pageX,y:t.pageY},this.backPos={x:this.pos.x-(i.x+this.box.left+this.options.size/2),y:this.pos.y-(i.y+this.box.top+this.options.size/2)},this.bindEvt(document,"move").bindEvt(document,"end").applyPosition(this.ui.el,this.backPos).applyPosition(this.ui.front,{x:this.options.size/4,y:this.options.size/4}).show(),this.trigger("start",{position:this.pos}),!1},s.prototype.onmove=function(t){t=n.prepareEvent(t);var i=this.options.size/2,e={x:t.pageX,y:t.pageY},o=n.distance(e,this.pos),s=n.angle(e,this.pos),r=n.radians(s),a=o/i;o>i&&(o=i,e=n.findCoord(this.pos,o,s)),this.applyPosition(this.ui.front,{x:e.x-this.pos.x+this.options.size/4,y:e.y-this.pos.y+this.options.size/4});var h={position:e,force:a,distance:o,angle:{radian:r,degree:s}};return this.computeDirection(t,h),this.trigger("move",h),!1},s.prototype.onend=function(t){return t=n.prepareEvent(t),this.unbindEvt(document,"move").unbindEvt(document,"end").hide(),this.trigger("end"),!1},{create:function(t){return new s(t)}}});