!function(e,i){"function"==typeof define&&define.amd?define(["wavesurfer"],i):e.WaveSurfer.Videojs=i(e.WaveSurfer)}(this,function(e){function i(e){this.waveform=new videojs.Waveform(this,{el:t(),options:e}),this.el().appendChild(this.waveform.el())}videojs.Waveform=videojs.Component.extend({init:function(i,t,s){videojs.Component.call(this,i,t,s),this.waveReady=!1,this.waveFinished=!1,this.msDisplayMax=3,this.player().bigPlayButton.hide(),this.player().options().controls&&(this.player().controlBar.progressControl.hide(),this.player().on("userinactive",function(e){this.player().userActive(!0)}),this.player().controlBar.show()),this.player().controlBar.volumeControl.el().style.marginRight="15px",this.surfer=Object.create(e),this.surfer.on("ready",this.onWaveReady.bind(this)),this.surfer.on("error",this.onWaveError.bind(this)),this.surfer.on("finish",this.onWaveFinish.bind(this)),this.surfer.on("audioprocess",this.onWaveProgress.bind(this)),this.surfer.on("seek",this.onWaveSeek.bind(this)),this.player().on("play",this.onPlay.bind(this)),this.player().on("pause",this.onPause.bind(this)),this.player().on("volumechange",this.onVolumeChange.bind(this)),this.player().on("fullscreenchange",this.onScreenChange.bind(this)),this.startPlayers()},startPlayers:function(){var e=this.options().options;this.initialize(e),void 0!=e.src&&this.load(e.src)},initialize:function(e){this.originalHeight=this.player().options().height,e.container=this.el(),e.height=this.player().height()-this.player().controlBar.height(),this.surfer.init(e)},load:function(e){e instanceof Blob||e instanceof File?this.surfer.loadArrayBuffer(e):this.surfer.load(e)},play:function(){this.surfer.play()},pause:function(){this.waveFinished?this.waveFinished=!1:this.surfer.pause(),this.setCurrentTime()},destroy:function(){this.surfer.destroy(),this.player().dispose()},setVolume:function(e){this.surfer.setVolume(e)},setCurrentTime:function(){var e=this.surfer.backend.getDuration(),i=this.surfer.backend.getCurrentTime(),t=Math.min(i,e);this.player().controlBar.currentTimeDisplay.el().firstChild.innerHTML=this.formatTime(t,e)},setDuration:function(){var e=this.surfer.backend.getDuration();this.player().controlBar.durationDisplay.el().firstChild.innerHTML=this.formatTime(e,e)},onWaveReady:function(){this.waveReady=!0,this.waveFinished=!1,this.setDuration(),this.surfer.container.firstChild.style.overflowX="hidden",this.surfer.backend.getDuration()<this.msDisplayMax&&(this.player().controlBar.durationDisplay.el().style.width=this.player().controlBar.currentTimeDisplay.el().style.width="6em"),this.player().removeChild(this.player().loadingSpinner),this.player().options().autoplay&&this.play()},onWaveFinish:function(){this.player().paused()||(this.player().options().loop?(this.surfer.stop(),this.play()):(this.waveFinished=!0,this.player().pause()))},onWaveProgress:function(e){this.setCurrentTime()},onWaveSeek:function(){this.setCurrentTime()},onPlay:function(){this.waveReady&&this.play()},onPause:function(){this.pause()},onVolumeChange:function(){var e=this.player().volume();this.player().muted()&&(e=0),this.setVolume(e)},onScreenChange:function(){var e;e=this.player().isFullscreen()?window.outerHeight:this.originalHeight,this.surfer.drawer.destroy(),this.surfer.params.height=e-this.player().controlBar.height(),this.surfer.createDrawer(),this.surfer.drawBuffer()},onWaveError:function(e){console.warn(e)},formatTime:function(e,i){i=i||e;var t=Math.floor(e%60),s=Math.floor(e/60%60),r=Math.floor(e/3600),n=Math.floor(i/60%60),o=Math.floor(i/3600),a=Math.floor(1e3*(e-t));return(isNaN(e)||e===1/0)&&(r=s=t=a="-"),i>0&&i<this.msDisplayMax?(a<100&&(a=a<10?"00"+a:"0"+a),a=":"+a):a="",r=r>0||o>0?r+":":"",s=((r||n>=10)&&s<10?"0"+s:s)+":",t=t<10?"0"+t:t,r+s+t+a}});var t=function(){return videojs.Component.prototype.createEl(null,{className:"vjs-waveform",tabIndex:0})};return videojs.plugin("wavesurfer",i),i});