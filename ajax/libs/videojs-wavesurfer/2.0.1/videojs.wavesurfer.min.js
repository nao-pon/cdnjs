/**
 * videojs-wavesurfer
 * @version 2.0.1
 * @see https://github.com/collab-project/videojs-wavesurfer
 * @copyright 2014-2017 Collab
 * @license MIT
 */
!function e(r,i,t){function s(n,a){if(!i[n]){if(!r[n]){var l="function"==typeof require&&require;if(!a&&l)return l(n,!0);if(o)return o(n,!0);var u=new Error("Cannot find module '"+n+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[n]={exports:{}};r[n][0].call(h.exports,function(e){var i=r[n][1][e];return s(i||e)},h,h.exports,e,r,i,t)}return i[n].exports}for(var o="function"==typeof require&&require,n=0;n<t.length;n++)s(t[n]);return s}({1:[function(e,r,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var t={debug:!1,msDisplayMax:3};i.default=t},{}],2:[function(e,r,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.default=function(e,r,i){e=e<0?0:e,r=r||e;var t=Math.floor(e%60),s=Math.floor(e/60%60),o=Math.floor(e/3600),n=Math.floor(r/60%60),a=Math.floor(r/3600),l=Math.floor(1e3*(e-t));return(isNaN(e)||e===1/0)&&(o=s=t=l="-"),r>0&&r<i?(l<100&&(l=l<10?"00"+l:"0"+l),l=":"+l):l="",o=o>0||a>0?o+":":"",s=((o||n>=10)&&s<10?"0"+s:s)+":",t=t<10?"0"+t:t,o+s+t+l}},{}],3:[function(e,r,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});i.default=function(e,r,i){!0===i&&("error"===r?videojs.log.error(e):"warn"===r?videojs.log.warn(e):videojs.log(e))}},{}],4:[function(e,r,i){(function(e){var i;i="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},r.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(e,r,i){(function(i){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function s(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function o(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function n(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}var a=function(){function e(e,r){for(var i=0;i<r.length;i++){var t=r[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,i,t){return i&&e(r.prototype,i),t&&e(r,t),r}}(),l=t(e(3)),u=t(e(2)),h=t(e(1)),f=t(e(4)),p=t("undefined"!=typeof window?window.videojs:void 0!==i?i.videojs:null),d=t("undefined"!=typeof window?window.WaveSurfer:void 0!==i?i.WaveSurfer:null),y=p.default.getPlugin("plugin"),c=function(e){function r(e,i){s(this,r);var t=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,i));if(i=p.default.mergeOptions(h.default,i),t.waveReady=!1,t.waveFinished=!1,t.liveMode=!1,t.debug="true"===i.debug.toString(),t.msDisplayMax=parseFloat(i.msDisplayMax),"live"===i.src){if(void 0===d.default.microphone)return t.onWaveError("Could not find wavesurfer.js microphone plugin!"),o(t);t.liveMode=!0,t.waveReady=!0}return t.player.one("ready",t.initialize.bind(t)),t}return n(r,y),a(r,[{key:"initialize",value:function(){this.player.bigPlayButton.hide(),!0===this.player.usingNativeControls_&&void 0!==this.player.tech_.el_&&(this.player.tech_.el_.controls=!1),!0===this.player.options_.controls&&(this.player.controlBar.show(),this.player.controlBar.el_.style.display="flex",this.player.controlBar.progressControl.hide(),[this.player.controlBar.currentTimeDisplay,this.player.controlBar.timeDivider,this.player.controlBar.durationDisplay].forEach(function(e){void 0!==e&&(e.el_.style.display="block",e.show())}),void 0!==this.player.controlBar.remainingTimeDisplay&&this.player.controlBar.remainingTimeDisplay.hide(),this.player.controlBar.playToggle.on(["tap","click"],this.onPlayToggle.bind(this)),this.liveMode||this.player.controlBar.playToggle.hide());var e=this.parseOptions(this.player.options_.plugins.wavesurfer);this.surfer=d.default.create(e),this.surfer.on("error",this.onWaveError.bind(this)),this.surfer.on("finish",this.onWaveFinish.bind(this)),!0===this.liveMode&&this.surfer.microphone.on("deviceError",this.onWaveError.bind(this)),this.surferReady=this.onWaveReady.bind(this),this.surferProgress=this.onWaveProgress.bind(this),this.surferSeek=this.onWaveSeek.bind(this),this.liveMode||this.setupPlaybackEvents(!0),this.player.on("volumechange",this.onVolumeChange.bind(this)),this.player.on("fullscreenchange",this.onScreenChange.bind(this)),!0===this.player.options_.fluid&&(this.surfer.drawer.wrapper.className="vjs-wavedisplay",this.responsiveWave=d.default.util.debounce(this.onResizeChange.bind(this),150),f.default.addEventListener("resize",this.responsiveWave)),this.startPlayers()}},{key:"parseOptions",value:function(e){var r=this.player.el_.getBoundingClientRect();this.originalWidth=this.player.options_.width||r.width,this.originalHeight=this.player.options_.height||r.height;var i=this.player.controlBar.height();if(!0===this.player.options_.controls&&0===i&&(i=30),void 0===e.container&&(e.container=this.player.el_),void 0===e.waveformHeight){var t=r.height;e.height=t-i}else e.height=opts.waveformHeight;return e.splitChannels&&!0===e.splitChannels&&(e.height/=2),!0===this.liveMode&&(e.plugins=[d.default.microphone.create(e)],this.log("wavesurfer.js microphone plugin enabled.")),e}},{key:"startPlayers",value:function(){var e=this.player.options_.plugins.wavesurfer;void 0!==e.src?void 0===this.surfer.microphone?(this.player.loadingSpinner.show(),this.load(e.src)):(this.player.loadingSpinner.hide(),e.wavesurfer=this.surfer):this.player.loadingSpinner.hide()}},{key:"setupPlaybackEvents",value:function(e){!1===e?(this.surfer.un("ready",this.surferReady),this.surfer.un("audioprocess",this.surferProgress),this.surfer.un("seek",this.surferSeek)):!0===e&&(this.surfer.on("ready",this.surferReady),this.surfer.on("audioprocess",this.surferProgress),this.surfer.on("seek",this.surferSeek))}},{key:"load",value:function(e){e instanceof Blob||e instanceof File?(this.log("Loading object: "+JSON.stringify(e)),this.surfer.loadBlob(e)):(this.log("Loading URL: "+e),this.surfer.load(e))}},{key:"play",value:function(){this.player.controlBar.playToggle.handlePlay(),this.liveMode?this.surfer.microphone.active?!this.surfer.microphone.paused?this.pause():(this.log("Resume microphone"),this.surfer.microphone.play()):(this.log("Start microphone"),this.surfer.microphone.start()):(this.log("Start playback"),this.player.play(),this.surfer.play())}},{key:"pause",value:function(){this.player.controlBar.playToggle.handlePause(),this.liveMode?(this.log("Pause microphone"),this.surfer.microphone.pause()):(this.log("Pause playback"),this.waveFinished?this.waveFinished=!1:this.surfer.pause(),this.setCurrentTime())}},{key:"dispose",value:function(){this.liveMode&&this.surfer.microphone&&(this.surfer.microphone.destroy(),this.log("Destroyed microphone plugin")),this.surfer.destroy(),this.log("Destroyed plugin")}},{key:"destroy",value:function(){this.player.dispose()}},{key:"setVolume",value:function(e){void 0!==e&&(this.log("Changing volume to: "+e),this.player.volume(e))}},{key:"exportImage",value:function(e,r){return this.surfer.exportImage(e,r)}},{key:"getCurrentTime",value:function(){var e=this.surfer.getCurrentTime();return e=isNaN(e)?0:e}},{key:"setCurrentTime",value:function(e,r){void 0===e&&(e=this.surfer.getCurrentTime()),void 0===r&&(r=this.surfer.getDuration()),e=isNaN(e)?0:e,r=isNaN(r)?0:r;var i=Math.min(e,r);this.player.controlBar.currentTimeDisplay.formattedTime_=this.player.controlBar.currentTimeDisplay.contentEl().lastChild.textContent=(0,u.default)(i,r,this.msDisplayMax)}},{key:"getDuration",value:function(){var e=this.surfer.getDuration();return e=isNaN(e)?0:e}},{key:"setDuration",value:function(e){void 0===e&&(e=this.surfer.getDuration()),e=isNaN(e)?0:e,this.player.controlBar.durationDisplay.formattedTime_=this.player.controlBar.durationDisplay.contentEl().lastChild.textContent=(0,u.default)(e,e,this.msDisplayMax)}},{key:"onWaveReady",value:function(){this.waveReady=!0,this.waveFinished=!1,this.liveMode=!1,this.log("Waveform is ready"),this.player.trigger("waveReady"),this.setCurrentTime(),this.setDuration(),this.player.controlBar.playToggle.show(),this.player.loadingSpinner.hide(),!0===this.player.options_.autoplay&&this.play()}},{key:"onWaveFinish",value:function(){var e=this;this.log("Finished playback"),this.player.trigger("playbackFinish"),!0===this.player.options_.loop?(this.surfer.stop(),this.play()):(this.waveFinished=!0,this.pause(),this.player.trigger("ended"),this.surfer.once("seek",function(){e.player.controlBar.playToggle.removeClass("vjs-ended"),e.player.trigger("pause")}))}},{key:"onWaveProgress",value:function(e){this.setCurrentTime()}},{key:"onWaveSeek",value:function(){this.setCurrentTime()}},{key:"onWaveError",value:function(e){this.player.trigger("error",e),this.log(e,"error")}},{key:"onPlayToggle",value:function(){this.player.controlBar.playToggle.hasClass("vjs-ended")&&this.player.controlBar.playToggle.removeClass("vjs-ended"),this.surfer.isPlaying()?this.pause():this.play()}},{key:"onVolumeChange",value:function(){var e=this.player.volume();this.player.muted()&&(e=0),this.surfer.setVolume(e)}},{key:"onScreenChange",value:function(){var e=this,r=this.player.setInterval(function(){var i=void 0,t=void 0;if(e.player.isFullscreen()||(i=e.originalWidth,t=e.originalHeight),e.waveReady){if(e.liveMode&&!e.surfer.microphone.active)return;e.redrawWaveform(i,t)}e.player.clearInterval(r)},100)}},{key:"onResizeChange",value:function(){void 0!==this.surfer&&this.redrawWaveform()}},{key:"redrawWaveform",value:function(e,r){var i=this.player.el_.getBoundingClientRect();void 0===e&&(e=i.width),void 0===r&&(r=i.height),this.surfer.drawer.destroy(),this.surfer.params.width=e,this.surfer.params.height=r-this.player.controlBar.height(),this.surfer.createDrawer(),this.surfer.drawer.wrapper.className="vjs-wavedisplay",this.surfer.drawBuffer(),this.surfer.drawer.progress(this.surfer.backend.getPlayedPercents())}},{key:"log",value:function(e,r){(0,l.default)(e,r,this.debug)}}]),r}();c.VERSION="2.0.1",p.default.Wavesurfer=c,p.default.registerPlugin("wavesurfer",c),r.exports={Wavesurfer:c}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[5]);