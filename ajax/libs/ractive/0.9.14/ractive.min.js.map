{"version":3,"file":"ractive.min.js","sources":["../src/view/items/Section.js","../src/view/items/element/specials/Select.js","../src/view/items/element/specials/Textarea.js","../src/view/items/Text.js","../src/config/visibility.js","../src/view/items/element/transitions/prefix.js","../src/view/items/element/transitions/createTransitions.js","../src/view/items/element/transitions/hyphenate.js","../src/view/items/element/Transition.js","../src/view/items/triple/insertHtml.js","../src/view/items/Triple.js","../src/view/items/createItem.js","../src/view/Fragment.js","../src/events/HookQueue.js","../src/Ractive/initialise.js","../src/Ractive/render.js","../src/Ractive/prototype/reset.js","../src/Ractive/prototype/resetPartial.js","../src/Ractive/prototype/reverse.js","../src/Ractive/prototype/shift.js","../src/Ractive/prototype/sort.js","../src/Ractive/prototype/splice.js","../src/Ractive/prototype/unrender.js","../src/Ractive/prototype/unshift.js","../src/Ractive/prototype.js","../src/extend/_extend.js","../src/Ractive.js","../src/view/items/element/binding/CheckboxNameBinding.js","../src/view/items/element/binding/ContentEditableBinding.js","../src/view/items/element/binding/GenericBinding.js","../src/view/items/element/binding/FileBinding.js","../src/view/items/element/binding/MultipleSelectBinding.js","../src/view/items/element/binding/NumericBinding.js","../src/view/items/element/binding/RadioBinding.js","../src/view/items/element/binding/RadioNameBinding.js","../src/view/items/element/binding/SingleSelectBinding.js","../src/view/items/Element.js","../src/view/items/element/specials/Form.js","../src/view/items/element/ElementEvents.js","../src/view/items/component/RactiveEvent.js","../src/view/items/shared/EventDirective.js","../src/view/items/shared/Mustache.js","../src/view/items/Interpolator.js","../src/view/items/element/specials/Input.js","../src/utils/parseJSON.js","../src/view/items/component/Mapping.js","../src/view/items/element/specials/Option.js","../src/view/items/Partial.js","../src/view/RepeatedFragment.js","../src/Ractive/config/runtime-parser.js","../src/shared/getFunction.js","../src/Ractive/config/custom/template.js","../src/Ractive/config/registries.js","../src/Ractive/config/config.js","../src/view/items/shared/Item.js","../src/model/ComputationChild.js","../src/model/Computation.js","../src/view/resolvers/ExpressionProxy.js","../src/view/resolvers/ReferenceExpressionProxy.js","../src/view/items/Alias.js","../src/utils/hyphenateCamel.js","../src/view/helpers/specialAttrs.js","../src/view/items/element/attribute/getUpdateDelegate.js","../src/view/items/element/attribute/propertyNames.js","../src/view/items/element/ConditionalAttribute.js","../src/view/items/element/Attribute.js","../src/view/items/element/BindingFlag.js","../src/view/items/Comment.js","../src/Ractive/prototype/teardown.js","../src/model/specials/RactiveModel.js","../src/model/RootModel.js","../src/Ractive/construct.js","../src/view/items/Component.js","../src/view/items/element/Decorator.js","../src/view/items/Doctype.js","../src/view/items/element/binding/Binding.js","../src/view/items/element/binding/CheckboxBinding.js","../src/view/items/element/binding/getBindingGroup.js","../src/shared/Ticker.js","../src/model/helpers/getPrefixer.js","../src/model/Model.js","../src/model/specials/SharedModel.js","../src/view/resolvers/resolveReference.js","../src/shared/getRactiveContext.js","../src/shared/set.js","../src/Ractive/prototype/shared/add.js","../src/Ractive/prototype/animate.js","../src/events/fireEvent.js","../src/events/Hook.js","../src/Ractive/prototype/attachChild.js","../src/Ractive/prototype/detach.js","../src/Ractive/prototype/detachChild.js","../src/config/types.js","../src/Ractive/prototype/shared/makeArrayMethod.js","../src/Ractive/prototype/update.js","../src/shared/Context.js","../src/Ractive/static/getContext.js","../src/utils/dom.js","../src/config/namespaces.js","../src/Ractive/prototype/insert.js","../src/Ractive/prototype/observe/Observer.js","../src/Ractive/prototype/observe/Pattern.js","../src/Ractive/prototype/observe/Array.js","../src/Ractive/prototype/observeOnce.js","../src/Ractive/prototype/shared/trim.js","../src/Ractive/prototype/shared/notEmptyString.js","../src/Ractive/prototype/pop.js","../src/Ractive/prototype/push.js","../src/global/css.js","../src/Ractive/config/custom/adapt.js","../src/utils/cleanCss.js","../src/Ractive/config/custom/css/transform.js","../src/model/specials/CSSModel.js","../src/Ractive/config/custom/css/css.js","../src/Ractive/config/custom/data.js","../src/config/template.js","../src/parse/utils/createFunction.js","../src/parse/Parser.js","../src/parse/converters/mustache/readDelimiterChange.js","../src/parse/converters/expressions/readTypeof.js","../src/parse/converters/expressions/primary/literal/readRegexpLiteral.js","../src/utils/escapeRegExp.js","../src/parse/converters/utils/getLowestIndex.js","../src/utils/html.js","../src/parse/converters/expressions/shared/errors.js","../src/parse/converters/expressions/primary/literal/readNumberLiteral.js","../src/parse/converters/expressions/primary/literal/stringLiteral/makeQuotedStringMatcher.js","../src/parse/converters/expressions/primary/literal/readStringLiteral.js","../src/parse/converters/expressions/primary/literal/readTemplateStringLiteral.js","../src/parse/converters/expressions/shared/patterns.js","../src/parse/converters/expressions/shared/readKey.js","../src/parse/converters/expressions/primary/literal/readObjectLiteral.js","../src/parse/converters/expressions/primary/literal/readArrayLiteral.js","../src/parse/converters/expressions/primary/readReference.js","../src/parse/converters/expressions/readPrimary.js","../src/parse/converters/expressions/readMemberOrInvocation.js","../src/parse/converters/expressions/readLogicalOr.js","../src/parse/converters/element/readAttribute.js","../src/parse/converters/readMustache.js","../src/parse/converters/mustache/readAliases.js","../src/parse/converters/mustache/section/readElse.js","../src/parse/converters/mustache/section/readElseIf.js","../src/parse/converters/mustache/handlebarsBlockCodes.js","../src/parse/converters/mustache/readSection.js","../src/parse/converters/readHtmlComment.js","../src/parse/utils/stripStandalones.js","../src/parse/utils/trimWhitespace.js","../src/parse/utils/cleanup.js","../src/parse/converters/element/readClosingTag.js","../src/parse/converters/readElement.js","../src/parse/converters/readPartialDefinitionSection.js","../src/Ractive/shared.js","../src/parse/_parse.js","../src/view/items/shared/progressiveText.js","../src/view/items/partial/getPartialTemplate.js","../src/view/items/component/getComponentConstructor.js","../src/view/items/asyncProxy.js","../src/view/helpers/processItems.js","../src/Ractive/prototype/render.js","../src/Ractive/prototype/resetTemplate.js","../src/Ractive/prototype/set.js","../src/Ractive/prototype/subtract.js","../src/Ractive/prototype/toggle.js","../src/Ractive/prototype/toCSS.js","../src/Ractive/prototype/toHTML.js","../src/Ractive/prototype/toText.js","../src/Ractive/prototype/transition.js","../src/Ractive/prototype/unlink.js","../src/Ractive/prototype/updateModel.js","../src/Ractive/static/isInstance.js","../src/Ractive/static/styleGet.js","../src/Ractive/static/sharedSet.js","../src/Ractive/static/sharedGet.js","../src/extend/_macro.js","../src/Ractive/static/keypaths.js","../src/Ractive/static/findPlugin.js","../src/polyfills/Object.assign.js","../src/utils/object.js","../src/utils/is.js","../src/polyfills/performance.now.js","../src/polyfills/array.find.js","../src/polyfills/node.contains.js","../src/polyfills/Promise.js","../src/polyfills/requestAnimationFrame.js","../src/Ractive/config/defaults.js","../src/utils/log.js","../src/Ractive/static/easing.js","../src/config/environment.js","../src/utils/noop.js","../src/config/errors.js","../src/global/capture.js","../src/Ractive/static/interpolators.js","../src/shared/keypaths.js","../src/model/specials/KeyModel.js","../src/model/specials/KeypathModel.js","../src/utils/bind.js","../src/model/ModelBase.js","../src/model/LinkModel.js","../src/global/TransitionManager.js","../src/global/runloop.js","../src/parse/converters/expressions/readConditional.js","../src/parse/converters/readExpression.js","../src/parse/converters/expressions/shared/readExpressionList.js","../src/parse/converters/readExpressionOrReference.js","../src/parse/utils/flattenExpression.js","../src/parse/utils/refineExpression.js","../src/parse/converters/mustache/readTriple.js","../src/parse/converters/mustache/readUnescaped.js","../src/parse/converters/mustache/readPartial.js","../src/parse/converters/mustache/readMustacheComment.js","../src/parse/converters/mustache/readInterpolator.js","../src/parse/converters/mustache/section/readClosing.js","../src/parse/converters/readText.js","../src/parse/converters/readTemplate.js","../src/parse/utils/insertExpressions.js","../src/Ractive/config/wrapPrototypeMethod.js","../src/Ractive/config/deprecate.js","../src/view/resolvers/resolve.js","../src/Ractive/helpers/getComputationSignature.js","../src/Ractive/helpers/subscribe.js","../src/view/items/shared/directiveArgs.js","../src/view/items/element/binding/handleDomEvent.js","../src/utils/getSelectedOptions.js","../src/view/items/element/binding/selectBinding.js","../src/shared/registry.js","../src/shared/interpolate.js","../src/utils/array.js","../src/shared/methodCallers.js","../src/shared/rebind.js","../src/Ractive/prototype/add.js","../src/events/eventStack.js","../src/shared/anchors.js","../src/Ractive/prototype/find.js","../src/Ractive/prototype/findAll.js","../src/Ractive/prototype/findAllComponents.js","../src/Ractive/prototype/findComponent.js","../src/Ractive/prototype/findContainer.js","../src/Ractive/prototype/findParent.js","../src/view/items/shared/findElement.js","../src/shared/getNewIndices.js","../src/Ractive/prototype/fire.js","../src/Ractive/prototype/get.js","../src/Ractive/prototype/getContext.js","../src/Ractive/prototype/link.js","../src/Ractive/prototype/observe.js","../src/Ractive/prototype/off.js","../src/Ractive/prototype/on.js","../src/Ractive/prototype/once.js","../src/Ractive/prototype/readLink.js","../src/utils/id.js","../src/Ractive/static/styleSet.js","../src/parse/converters/expressions/primary/literal/readBooleanLiteral.js","../src/parse/converters/expressions/primary/literal/objectLiteral/keyValuePair.js","../src/parse/converters/expressions/primary/literal/objectLiteral/keyValuePairs.js","../src/parse/converters/expressions/primary/readLiteral.js","../src/parse/converters/expressions/primary/readBracketedExpression.js","../src/parse/converters/expressions/shared/readRefinement.js"],"sourcesContent":["import {\n  SECTION_EACH,\n  SECTION_IF,\n  SECTION_IF_WITH,\n  SECTION_UNLESS,\n  SECTION_WITH\n} from 'config/types';\nimport { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject, isObjectLike } from 'utils/is';\nimport { keep } from 'shared/set';\nimport runloop from 'src/global/runloop';\nimport Fragment from '../Fragment';\nimport RepeatedFragment from '../RepeatedFragment';\nimport { MustacheContainer } from './shared/Mustache';\nimport { keys } from 'utils/object';\n\nfunction isEmpty(value) {\n  return (\n    !value ||\n    (isArray(value) && value.length === 0) ||\n    (isObject(value) && keys(value).length === 0)\n  );\n}\n\nfunction getType(value, hasIndexRef) {\n  if (hasIndexRef || isArray(value)) return SECTION_EACH;\n  if (isObjectLike(value)) return SECTION_IF_WITH;\n  if (value === undefined) return null;\n  return SECTION_IF;\n}\n\nexport default class Section extends MustacheContainer {\n  constructor(options) {\n    super(options);\n\n    this.sectionType = options.template.n || null;\n    this.templateSectionType = this.sectionType;\n    this.subordinate = options.template.l === 1;\n    this.fragment = null;\n  }\n\n  bind() {\n    super.bind();\n\n    if (this.subordinate) {\n      this.sibling = this.up.items[this.up.items.indexOf(this) - 1];\n      this.sibling.nextSibling = this;\n    }\n\n    // if we managed to bind, we need to create children\n    if (this.model) {\n      this.dirty = true;\n      this.update();\n    } else if (\n      this.sectionType &&\n      this.sectionType === SECTION_UNLESS &&\n      (!this.sibling || !this.sibling.isTruthy())\n    ) {\n      this.fragment = new Fragment({\n        owner: this,\n        template: this.template.f\n      }).bind();\n    }\n  }\n\n  detach() {\n    const frag = this.fragment || this.detached;\n    return frag ? frag.detach() : super.detach();\n  }\n\n  isTruthy() {\n    if (this.subordinate && this.sibling.isTruthy()) return true;\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    return !!value && (this.templateSectionType === SECTION_IF_WITH || !isEmpty(value));\n  }\n\n  rebind(next, previous, safe) {\n    if (super.rebind(next, previous, safe)) {\n      if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n        this.fragment.rebind(next);\n      }\n    }\n  }\n\n  render(target, occupants) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target, occupants);\n  }\n\n  shuffle(newIndices) {\n    if (this.fragment && this.sectionType === SECTION_EACH) {\n      this.fragment.shuffle(newIndices);\n    }\n  }\n\n  unbind() {\n    super.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (!this.dirty) return;\n\n    if (this.fragment && this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS) {\n      this.fragment.context = this.model;\n    }\n\n    if (!this.model && this.sectionType !== SECTION_UNLESS) return;\n\n    this.dirty = false;\n\n    const value = !this.model ? undefined : this.model.isRoot ? this.model.value : this.model.get();\n    const siblingFalsey = !this.subordinate || !this.sibling.isTruthy();\n    const lastType = this.sectionType;\n\n    // watch for switching section types\n    if (this.sectionType === null || this.templateSectionType === null)\n      this.sectionType = getType(value, this.template.i);\n    if (lastType && lastType !== this.sectionType && this.fragment) {\n      if (this.rendered) {\n        this.fragment.unbind().unrender(true);\n      }\n\n      this.fragment = null;\n    }\n\n    let newFragment;\n\n    const fragmentShouldExist =\n      this.sectionType === SECTION_EACH || // each always gets a fragment, which may have no iterations\n      this.sectionType === SECTION_WITH || // with (partial context) always gets a fragment\n      (siblingFalsey && (this.sectionType === SECTION_UNLESS ? !this.isTruthy() : this.isTruthy())); // if, unless, and if-with depend on siblings and the condition\n\n    if (fragmentShouldExist) {\n      if (!this.fragment) this.fragment = this.detached;\n\n      if (this.fragment) {\n        // check for detached fragment\n        if (this.detached) {\n          attach(this, this.fragment);\n          this.detached = false;\n          this.rendered = true;\n        }\n\n        if (!this.fragment.bound) this.fragment.bind(this.model);\n        this.fragment.update();\n      } else {\n        if (this.sectionType === SECTION_EACH) {\n          newFragment = new RepeatedFragment({\n            owner: this,\n            template: this.template.f,\n            indexRef: this.template.i\n          }).bind(this.model);\n        } else {\n          // only with and if-with provide context - if and unless do not\n          const context =\n            this.sectionType !== SECTION_IF && this.sectionType !== SECTION_UNLESS\n              ? this.model\n              : null;\n          newFragment = new Fragment({\n            owner: this,\n            template: this.template.f\n          }).bind(context);\n        }\n      }\n    } else {\n      if (this.fragment && this.rendered) {\n        if (keep !== true) {\n          this.fragment.unbind().unrender(true);\n        } else {\n          this.unrender(false);\n          this.detached = this.fragment;\n          runloop.promise().then(() => {\n            if (this.detached) this.detach();\n          });\n        }\n      } else if (this.fragment) {\n        this.fragment.unbind();\n      }\n\n      this.fragment = null;\n    }\n\n    if (newFragment) {\n      if (this.rendered) {\n        attach(this, newFragment);\n      }\n\n      this.fragment = newFragment;\n    }\n\n    if (this.nextSibling) {\n      this.nextSibling.dirty = true;\n      this.nextSibling.update();\n    }\n  }\n}\n\nfunction attach(section, fragment) {\n  const anchor = section.up.findNextNode(section);\n\n  if (anchor) {\n    const docFrag = createDocumentFragment();\n    fragment.render(docFrag);\n\n    anchor.parentNode.insertBefore(docFrag, anchor);\n  } else {\n    fragment.render(section.up.findParentNode());\n  }\n}\n","import { toArray } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Element from '../../Element';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default class Select extends Element {\n  constructor(options) {\n    super(options);\n    this.options = [];\n  }\n\n  foundNode(node) {\n    if (this.binding) {\n      const selectedOptions = getSelectedOptions(node);\n\n      if (selectedOptions.length > 0) {\n        this.selectedOptions = selectedOptions;\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.sync();\n\n    const node = this.node;\n\n    let i = node.options.length;\n    while (i--) {\n      node.options[i].defaultSelected = node.options[i].selected;\n    }\n\n    this.rendered = true;\n  }\n\n  sync() {\n    const selectNode = this.node;\n\n    if (!selectNode) return;\n\n    const options = toArray(selectNode.options);\n\n    if (this.selectedOptions) {\n      options.forEach(o => {\n        if (this.selectedOptions.indexOf(o) >= 0) o.selected = true;\n        else o.selected = false;\n      });\n      this.binding.setFromNode(selectNode);\n      delete this.selectedOptions;\n      return;\n    }\n\n    const selectValue = this.getAttribute('value');\n    const isMultiple = this.getAttribute('multiple');\n    const array = isMultiple && isArray(selectValue);\n\n    // If the <select> has a specified value, that should override\n    // these options\n    if (selectValue !== undefined) {\n      let optionWasSelected;\n\n      options.forEach(o => {\n        const optionValue = o._ractive ? o._ractive.value : o.value;\n        const shouldSelect = isMultiple\n          ? array && this.valueContains(selectValue, optionValue)\n          : this.compare(selectValue, optionValue);\n\n        if (shouldSelect) {\n          optionWasSelected = true;\n        }\n\n        o.selected = shouldSelect;\n      });\n\n      if (!optionWasSelected && !isMultiple) {\n        if (this.binding) {\n          this.binding.forceUpdate();\n        }\n      }\n    } else if (this.binding && this.binding.forceUpdate) {\n      // Otherwise the value should be initialised according to which\n      // <option> element is selected, if twoway binding is in effect\n      this.binding.forceUpdate();\n    }\n  }\n  valueContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.compare(optionValue, selectValue[i])) return true;\n    }\n  }\n  compare(optionValue, selectValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(selectValue, optionValue);\n      }\n      if (selectValue && optionValue) {\n        return selectValue[comparator] == optionValue[comparator];\n      }\n    }\n    return selectValue == optionValue;\n  }\n  update() {\n    const dirty = this.dirty;\n    super.update();\n    if (dirty) {\n      this.sync();\n    }\n  }\n}\n","import { ATTRIBUTE } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport Input from './Input';\nimport { isBindable } from '../binding/selectBinding';\nimport createItem from '../../createItem';\nimport Fragment from '../../../Fragment';\n\nexport default class Textarea extends Input {\n  constructor(options) {\n    const template = options.template;\n\n    options.deferContent = true;\n\n    super(options);\n\n    // check for single interpolator binding\n    if (!this.attributeByName.value) {\n      if (template.f && isBindable({ template })) {\n        (this.attributes || (this.attributes = [])).push(\n          createItem({\n            owner: this,\n            template: { t: ATTRIBUTE, f: template.f, n: 'value' },\n            up: this.up\n          })\n        );\n      } else {\n        this.fragment = new Fragment({\n          owner: this,\n          cssIds: null,\n          template: template.f\n        });\n      }\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.rendered && !this.binding && this.fragment) {\n        runloop.scheduleTask(() => {\n          this.dirty = false;\n          this.node.value = this.fragment.toString();\n        });\n      }\n\n      this.up.bubble(); // default behaviour\n    }\n  }\n}\n","import { TEXT } from 'config/types';\nimport { escapeHtml } from 'utils/html';\nimport { detachNode } from 'utils/dom';\nimport noop from 'utils/noop';\nimport Item from './shared/Item';\nimport progressiveText from './shared/progressiveText';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Text extends Item {\n  constructor(options) {\n    super(options);\n    this.type = TEXT;\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, this.template);\n  }\n\n  toString(escape) {\n    return escape ? escapeHtml(this.template) : this.template;\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  valueOf() {\n    return this.template;\n  }\n}\n\nconst proto = Text.prototype;\nproto.bind = proto.unbind = proto.update = noop;\n","import { win, doc, vendors } from './environment';\n\nexport let visible;\nlet hidden = 'hidden';\n\nif (doc) {\n  let prefix;\n\n  /* istanbul ignore next */\n  if (hidden in doc) {\n    prefix = '';\n  } else {\n    let i = vendors.length;\n    while (i--) {\n      const vendor = vendors[i];\n      hidden = vendor + 'Hidden';\n\n      if (hidden in doc) {\n        prefix = vendor;\n        break;\n      }\n    }\n  }\n\n  /* istanbul ignore else */\n  if (prefix !== undefined) {\n    doc.addEventListener(prefix + 'visibilitychange', onChange);\n    onChange();\n  } else {\n    // gah, we're in an old browser\n    if ('onfocusout' in doc) {\n      doc.addEventListener('focusout', onHide);\n      doc.addEventListener('focusin', onShow);\n    } else {\n      win.addEventListener('pagehide', onHide);\n      win.addEventListener('blur', onHide);\n\n      win.addEventListener('pageshow', onShow);\n      win.addEventListener('focus', onShow);\n    }\n\n    visible = true; // until proven otherwise. Not ideal but hey\n  }\n}\n\nfunction onChange() {\n  visible = !doc[hidden];\n}\n\n/* istanbul ignore next */\nfunction onHide() {\n  visible = false;\n}\n\n/* istanbul ignore next */\nfunction onShow() {\n  visible = true;\n}\n","import { isClient, vendors } from 'config/environment';\nimport { createElement } from 'utils/dom';\nimport hyphenateCamel from 'utils/hyphenateCamel';\n\nlet prefix;\n\n/* istanbul ignore next */\nif (!isClient) {\n  prefix = null;\n} else {\n  const prefixCache = {};\n  const testStyle = createElement('div').style;\n\n  // technically this also normalizes on hyphenated styles as well\n  prefix = function(prop) {\n    if (!prefixCache[prop]) {\n      const name = hyphenateCamel(prop);\n\n      if (testStyle[prop] !== undefined) {\n        prefixCache[prop] = name;\n      } else {\n        /* istanbul ignore next */\n        // test vendors...\n        let i = vendors.length;\n        while (i--) {\n          const vendor = `-${vendors[i]}-${name}`;\n          if (testStyle[vendor] !== undefined) {\n            prefixCache[prop] = vendor;\n            break;\n          }\n        }\n      }\n    }\n\n    return prefixCache[prop];\n  };\n}\n\nexport default prefix;\n","import { missingPlugin } from 'config/errors';\nimport { isClient } from 'config/environment';\nimport { warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { createElement } from 'utils/dom';\nimport interpolate from 'shared/interpolate';\nimport Ticker from 'shared/Ticker';\nimport hyphenate from './hyphenate';\nimport { isFunction, isString } from 'utils/is';\n\nlet createTransitions;\n\nif (!isClient) {\n  createTransitions = null;\n} else {\n  const testStyle = createElement('div').style;\n  const linear = x => x;\n\n  const canUseCssTransitions = {};\n  const cannotUseCssTransitions = {};\n\n  // determine some facts about our environment\n  let TRANSITION;\n  let TRANSITIONEND;\n  let CSS_TRANSITIONS_ENABLED;\n  let TRANSITION_DURATION;\n  let TRANSITION_PROPERTY;\n  let TRANSITION_TIMING_FUNCTION;\n\n  if (testStyle.transition !== undefined) {\n    TRANSITION = 'transition';\n    TRANSITIONEND = 'transitionend';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else if (testStyle.webkitTransition !== undefined) {\n    TRANSITION = 'webkitTransition';\n    TRANSITIONEND = 'webkitTransitionEnd';\n    CSS_TRANSITIONS_ENABLED = true;\n  } else {\n    CSS_TRANSITIONS_ENABLED = false;\n  }\n\n  if (TRANSITION) {\n    TRANSITION_DURATION = TRANSITION + 'Duration';\n    TRANSITION_PROPERTY = TRANSITION + 'Property';\n    TRANSITION_TIMING_FUNCTION = TRANSITION + 'TimingFunction';\n  }\n\n  createTransitions = function(t, to, options, changedProperties, resolve) {\n    // Wait a beat (otherwise the target styles will be applied immediately)\n    // TODO use a fastdom-style mechanism?\n    setTimeout(() => {\n      let jsTransitionsComplete;\n      let cssTransitionsComplete;\n      let cssTimeout; // eslint-disable-line prefer-const\n\n      function transitionDone() {\n        clearTimeout(cssTimeout);\n      }\n\n      function checkComplete() {\n        if (jsTransitionsComplete && cssTransitionsComplete) {\n          t.unregisterCompleteHandler(transitionDone);\n          // will changes to events and fire have an unexpected consequence here?\n          t.ractive.fire(t.name + ':end', t.node, t.isIntro);\n          resolve();\n        }\n      }\n\n      // this is used to keep track of which elements can use CSS to animate\n      // which properties\n      const hashPrefix = (t.node.namespaceURI || '') + t.node.tagName;\n\n      // need to reset transition properties\n      const style = t.node.style;\n      const previous = {\n        property: style[TRANSITION_PROPERTY],\n        timing: style[TRANSITION_TIMING_FUNCTION],\n        duration: style[TRANSITION_DURATION]\n      };\n\n      function transitionEndHandler(event) {\n        const index = changedProperties.indexOf(event.propertyName);\n\n        if (index !== -1) {\n          changedProperties.splice(index, 1);\n        }\n\n        if (changedProperties.length) {\n          // still transitioning...\n          return;\n        }\n\n        clearTimeout(cssTimeout);\n        cssTransitionsDone();\n      }\n\n      function cssTransitionsDone() {\n        style[TRANSITION_PROPERTY] = previous.property;\n        style[TRANSITION_TIMING_FUNCTION] = previous.duration;\n        style[TRANSITION_DURATION] = previous.timing;\n\n        t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n        cssTransitionsComplete = true;\n        checkComplete();\n      }\n\n      t.node.addEventListener(TRANSITIONEND, transitionEndHandler, false);\n\n      // safety net in case transitionend never fires\n      cssTimeout = setTimeout(() => {\n        changedProperties = [];\n        cssTransitionsDone();\n      }, options.duration + (options.delay || 0) + 50);\n      t.registerCompleteHandler(transitionDone);\n\n      style[TRANSITION_PROPERTY] = changedProperties.join(',');\n      const easingName = hyphenate(options.easing || 'linear');\n      style[TRANSITION_TIMING_FUNCTION] = easingName;\n      const cssTiming = style[TRANSITION_TIMING_FUNCTION] === easingName;\n      style[TRANSITION_DURATION] = options.duration / 1000 + 's';\n\n      setTimeout(() => {\n        let i = changedProperties.length;\n        let hash;\n        let originalValue = null;\n        let index;\n        const propertiesToTransitionInJs = [];\n        let prop;\n        let suffix;\n        let interpolator;\n\n        while (i--) {\n          prop = changedProperties[i];\n          hash = hashPrefix + prop;\n\n          if (cssTiming && CSS_TRANSITIONS_ENABLED && !cannotUseCssTransitions[hash]) {\n            const initial = style[prop];\n            style[prop] = to[prop];\n\n            // If we're not sure if CSS transitions are supported for\n            // this tag/property combo, find out now\n            if (!(hash in canUseCssTransitions)) {\n              originalValue = t.getStyle(prop);\n\n              // if this property is transitionable in this browser,\n              // the current style will be different from the target style\n              canUseCssTransitions[hash] = t.getStyle(prop) != to[prop];\n              cannotUseCssTransitions[hash] = !canUseCssTransitions[hash];\n\n              // Reset, if we're going to use timers after all\n              if (cannotUseCssTransitions[hash]) {\n                style[prop] = initial;\n              }\n            }\n          }\n\n          if (!cssTiming || !CSS_TRANSITIONS_ENABLED || cannotUseCssTransitions[hash]) {\n            // we need to fall back to timer-based stuff\n            if (originalValue === null) originalValue = t.getStyle(prop);\n\n            // need to remove this from changedProperties, otherwise transitionEndHandler\n            // will get confused\n            index = changedProperties.indexOf(prop);\n            if (index === -1) {\n              warnIfDebug(\n                'Something very strange happened with transitions. Please raise an issue at https://github.com/ractivejs/ractive/issues - thanks!',\n                { node: t.node }\n              );\n            } else {\n              changedProperties.splice(index, 1);\n            }\n\n            // TODO Determine whether this property is animatable at all\n\n            suffix = /[^\\d]*$/.exec(originalValue)[0];\n            interpolator = interpolate(parseFloat(originalValue), parseFloat(to[prop]));\n\n            // ...then kick off a timer-based transition\n            if (interpolator) {\n              propertiesToTransitionInJs.push({\n                name: prop,\n                interpolator,\n                suffix\n              });\n            } else {\n              style[prop] = to[prop];\n            }\n\n            originalValue = null;\n          }\n        }\n\n        // javascript transitions\n        if (propertiesToTransitionInJs.length) {\n          let easing;\n\n          if (isString(options.easing)) {\n            easing = t.ractive.easing[options.easing];\n\n            if (!easing) {\n              warnOnceIfDebug(missingPlugin(options.easing, 'easing'));\n              easing = linear;\n            }\n          } else if (isFunction(options.easing)) {\n            easing = options.easing;\n          } else {\n            easing = linear;\n          }\n\n          new Ticker({\n            duration: options.duration,\n            easing,\n            step(pos) {\n              let i = propertiesToTransitionInJs.length;\n              while (i--) {\n                const prop = propertiesToTransitionInJs[i];\n                style[prop.name] = prop.interpolator(pos) + prop.suffix;\n              }\n            },\n            complete() {\n              jsTransitionsComplete = true;\n              checkComplete();\n            }\n          });\n        } else {\n          jsTransitionsComplete = true;\n        }\n\n        if (changedProperties.length) {\n          style[TRANSITION_PROPERTY] = changedProperties.join(',');\n        } else {\n          style[TRANSITION_PROPERTY] = 'none';\n\n          // We need to cancel the transitionEndHandler, and deal with\n          // the fact that it will never fire\n          t.node.removeEventListener(TRANSITIONEND, transitionEndHandler, false);\n          cssTransitionsComplete = true;\n          checkComplete();\n        }\n      }, 0);\n    }, options.delay || 0);\n  };\n}\n\nexport default createTransitions;\n","import { vendors } from 'config/environment';\n\nconst vendorPattern = new RegExp('^(?:' + vendors.join('|') + ')([A-Z])');\n\nexport default function(str) {\n  /* istanbul ignore next */\n  if (!str) return ''; // edge case\n\n  /* istanbul ignore next */\n  if (vendorPattern.test(str)) str = '-' + str;\n\n  return str.replace(/[A-Z]/g, match => '-' + match.toLowerCase());\n}\n","import { win } from 'config/environment';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction, isNumber, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { findInViewHierarchy } from 'shared/registry';\nimport { visible } from 'config/visibility';\nimport findElement from '../shared/findElement';\nimport prefix from './transitions/prefix';\nimport createTransitions from './transitions/createTransitions';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport { assign, hasOwn, keys } from 'utils/object';\n\nconst getComputedStyle = win && win.getComputedStyle;\nconst resolved = Promise.resolve();\n\nconst names = {\n  t0: 'intro-outro',\n  t1: 'intro',\n  t2: 'outro'\n};\n\nexport default class Transition {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.ractive = this.owner.ractive;\n    this.template = options.template;\n    this.up = options.up;\n    this.options = options;\n    this.onComplete = [];\n  }\n\n  animateStyle(style, value, options) {\n    if (arguments.length === 4) {\n      throw new Error(\n        't.animateStyle() returns a promise - use .then() instead of passing a callback'\n      );\n    }\n\n    // Special case - page isn't visible. Don't animate anything, because\n    // that way you'll never get CSS transitionend events\n    if (!visible) {\n      this.setStyle(style, value);\n      return resolved;\n    }\n\n    let to;\n\n    if (isString(style)) {\n      to = {};\n      to[style] = value;\n    } else {\n      to = style;\n\n      // shuffle arguments\n      options = value;\n    }\n\n    return new Promise(fulfil => {\n      // Edge case - if duration is zero, set style synchronously and complete\n      if (!options.duration) {\n        this.setStyle(to);\n        fulfil();\n        return;\n      }\n\n      // Get a list of the properties we're animating\n      const propertyNames = keys(to);\n      const changedProperties = [];\n\n      // Store the current styles\n      const computedStyle = getComputedStyle(this.node);\n\n      let i = propertyNames.length;\n      while (i--) {\n        const prop = propertyNames[i];\n        const name = prefix(prop);\n\n        const current = computedStyle[prefix(prop)];\n\n        // record the starting points\n        const init = this.node.style[name];\n        if (!(name in this.originals)) this.originals[name] = this.node.style[name];\n        this.node.style[name] = to[prop];\n        this.targets[name] = this.node.style[name];\n        this.node.style[name] = init;\n\n        // we need to know if we're actually changing anything\n        if (current != to[prop]) {\n          // use != instead of !==, so we can compare strings with numbers\n          changedProperties.push(name);\n\n          // if we happened to prefix, make sure there is a properly prefixed value\n          to[name] = to[prop];\n\n          // make the computed style explicit, so we can animate where\n          // e.g. height='auto'\n          this.node.style[name] = current;\n        }\n      }\n\n      // If we're not actually changing anything, the transitionend event\n      // will never fire! So we complete early\n      if (!changedProperties.length) {\n        fulfil();\n        return;\n      }\n\n      createTransitions(this, to, options, changedProperties, fulfil);\n    });\n  }\n\n  bind() {\n    const options = this.options;\n    const type = options.template && options.template.v;\n    if (type) {\n      if (type === 't0' || type === 't1') this.element.intro = this;\n      if (type === 't0' || type === 't2') this.element.outro = this;\n      this.eventName = names[type];\n    }\n\n    const ractive = this.owner.ractive;\n\n    this.name = options.name || options.template.n;\n\n    if (options.params) {\n      this.params = options.params;\n    }\n\n    if (isFunction(this.name)) {\n      this._fn = this.name;\n      this.name = this._fn.name;\n    } else {\n      this._fn = findInViewHierarchy('transitions', ractive, this.name);\n    }\n\n    if (!this._fn) {\n      warnOnceIfDebug(missingPlugin(this.name, 'transition'), { ractive });\n    }\n\n    setupArgsFn(this, options.template);\n  }\n\n  getParams() {\n    if (this.params) return this.params;\n\n    // get expression args if supplied\n    if (this.fn) {\n      const values = resolveArgs(this, this.template, this.up).map(model => {\n        if (!model) return undefined;\n\n        return model.get();\n      });\n      return this.fn.apply(this.ractive, values);\n    }\n  }\n\n  getStyle(props) {\n    const computedStyle = getComputedStyle(this.node);\n\n    if (isString(props)) {\n      return computedStyle[prefix(props)];\n    }\n\n    if (!isArray(props)) {\n      throw new Error(\n        'Transition$getStyle must be passed a string, or an array of strings representing CSS properties'\n      );\n    }\n\n    const styles = {};\n\n    let i = props.length;\n    while (i--) {\n      const prop = props[i];\n      let value = computedStyle[prefix(prop)];\n\n      if (value === '0px') value = 0;\n      styles[prop] = value;\n    }\n\n    return styles;\n  }\n\n  processParams(params, defaults) {\n    if (isNumber(params)) {\n      params = { duration: params };\n    } else if (isString(params)) {\n      if (params === 'slow') {\n        params = { duration: 600 };\n      } else if (params === 'fast') {\n        params = { duration: 200 };\n      } else {\n        params = { duration: 400 };\n      }\n    } else if (!params) {\n      params = {};\n    }\n\n    return assign({}, defaults, params);\n  }\n\n  registerCompleteHandler(fn) {\n    addToArray(this.onComplete, fn);\n  }\n\n  setStyle(style, value) {\n    if (isString(style)) {\n      const name = prefix(style);\n      if (!hasOwn(this.originals, name)) this.originals[name] = this.node.style[name];\n      this.node.style[name] = value;\n      this.targets[name] = this.node.style[name];\n    } else {\n      let prop;\n      for (prop in style) {\n        if (hasOwn(style, prop)) {\n          this.setStyle(prop, style[prop]);\n        }\n      }\n    }\n\n    return this;\n  }\n\n  shouldFire(type) {\n    if (!this.ractive.transitionsEnabled) return false;\n\n    // check for noIntro and noOutro cases, which only apply when the owner ractive is rendering and unrendering, respectively\n    if (type === 'intro' && this.ractive.rendering && nearestProp('noIntro', this.ractive, true))\n      return false;\n    if (type === 'outro' && this.ractive.unrendering && nearestProp('noOutro', this.ractive, false))\n      return false;\n\n    const params = this.getParams(); // this is an array, the params object should be the first member\n    // if there's not a parent element, this can't be nested, so roll on\n    if (!this.element.parent) return true;\n\n    // if there is a local param, it takes precedent\n    if (params && params[0] && isObject(params[0]) && 'nested' in params[0]) {\n      if (params[0].nested !== false) return true;\n    } else {\n      // use the nearest instance setting\n      // find the nearest instance that actually has a nested setting\n      if (nearestProp('nestedTransitions', this.ractive) !== false) return true;\n    }\n\n    // check to see if this is actually a nested transition\n    let el = this.element.parent;\n    while (el) {\n      if (el[type] && el[type].starting) return false;\n      el = el.parent;\n    }\n\n    return true;\n  }\n\n  start() {\n    const node = (this.node = this.element.node);\n    const originals = (this.originals = {}); //= node.getAttribute( 'style' );\n    const targets = (this.targets = {});\n\n    let completed;\n    const args = this.getParams();\n\n    // create t.complete() - we don't want this on the prototype,\n    // because we don't want `this` silliness when passing it as\n    // an argument\n    this.complete = noReset => {\n      this.starting = false;\n      if (completed) {\n        return;\n      }\n\n      this.onComplete.forEach(fn => fn());\n      if (!noReset && this.isIntro) {\n        for (const k in targets) {\n          if (node.style[k] === targets[k]) node.style[k] = originals[k];\n        }\n      }\n\n      this._manager.remove(this);\n\n      completed = true;\n    };\n\n    // If the transition function doesn't exist, abort\n    if (!this._fn) {\n      this.complete();\n      return;\n    }\n\n    const promise = this._fn.apply(this.ractive, [this].concat(args));\n    if (promise) promise.then(this.complete);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (!this.element.attributes.unbinding) {\n      const type = this.options && this.options.template && this.options.template.v;\n      if (type === 't0' || type === 't1') this.element.intro = null;\n      if (type === 't0' || type === 't2') this.element.outro = null;\n    }\n  }\n\n  unregisterCompleteHandler(fn) {\n    removeFromArray(this.onComplete, fn);\n  }\n}\n\nconst proto = Transition.prototype;\nproto.destroyed = proto.render = proto.unrender = proto.update = noop;\n\nfunction nearestProp(prop, ractive, rendering) {\n  let instance = ractive;\n  while (instance) {\n    if (\n      hasOwn(instance, prop) &&\n      (rendering === undefined || rendering ? instance.rendering : instance.unrendering)\n    )\n      return instance[prop];\n    instance = instance.component && instance.component.ractive;\n  }\n\n  return ractive[prop];\n}\n","import { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\n\nconst elementCache = {};\n\nlet ieBug;\nlet ieBlacklist;\n\ntry {\n  createElement('table').innerHTML = 'foo';\n} catch (/* istanbul ignore next */ err) {\n  ieBug = true;\n\n  ieBlacklist = {\n    TABLE: ['<table class=\"x\">', '</table>'],\n    THEAD: ['<table><thead class=\"x\">', '</thead></table>'],\n    TBODY: ['<table><tbody class=\"x\">', '</tbody></table>'],\n    TR: ['<table><tr class=\"x\">', '</tr></table>'],\n    SELECT: ['<select class=\"x\">', '</select>']\n  };\n}\n\nexport default function(html, node) {\n  const nodes = [];\n\n  // render 0 and false\n  if (html == null || html === '') return nodes;\n\n  let container;\n  let wrapper;\n  let selectedOption;\n\n  /* istanbul ignore if */\n  if (ieBug && (wrapper = ieBlacklist[node.tagName])) {\n    container = element('DIV');\n    container.innerHTML = wrapper[0] + html + wrapper[1];\n    container = container.querySelector('.x');\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  } else if (node.namespaceURI === svg) {\n    container = element('DIV');\n    container.innerHTML = '<svg class=\"x\">' + html + '</svg>';\n    container = container.querySelector('.x');\n  } else if (node.tagName === 'TEXTAREA') {\n    container = createElement('div');\n\n    if (typeof container.textContent !== 'undefined') {\n      container.textContent = html;\n    } else {\n      container.innerHTML = html;\n    }\n  } else {\n    container = element(node.tagName);\n    container.innerHTML = html;\n\n    if (container.tagName === 'SELECT') {\n      selectedOption = container.options[container.selectedIndex];\n    }\n  }\n\n  let child;\n  while ((child = container.firstChild)) {\n    nodes.push(child);\n    container.removeChild(child);\n  }\n\n  // This is really annoying. Extracting <option> nodes from the\n  // temporary container <select> causes the remaining ones to\n  // become selected. So now we have to deselect them. IE8, you\n  // amaze me. You really do\n  // ...and now Chrome too\n  let i;\n  if (node.tagName === 'SELECT') {\n    i = nodes.length;\n    while (i--) {\n      if (nodes[i] !== selectedOption) {\n        nodes[i].selected = false;\n      }\n    }\n  }\n\n  return nodes;\n}\n\nfunction element(tagName) {\n  return elementCache[tagName] || (elementCache[tagName] = createElement(tagName));\n}\n","import { createDocumentFragment, matches } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport { decodeCharacterReferences } from 'utils/html';\nimport runloop from 'src/global/runloop';\nimport Mustache from './shared/Mustache';\nimport insertHtml from './triple/insertHtml';\nimport { inAttribute } from './element/Attribute';\n\nexport default class Triple extends Mustache {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    if (this.nodes) this.nodes.forEach(node => docFrag.appendChild(node));\n    return docFrag;\n  }\n\n  find(selector) {\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) return node;\n\n      const queryResult = node.querySelector(selector);\n      if (queryResult) return queryResult;\n    }\n\n    return null;\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n    const len = this.nodes.length;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const node = this.nodes[i];\n\n      if (node.nodeType !== 1) continue;\n\n      if (matches(node, selector)) result.push(node);\n\n      const queryAllResult = node.querySelectorAll(selector);\n      if (queryAllResult) {\n        result.push.apply(result, queryAllResult);\n      }\n    }\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  firstNode() {\n    return this.rendered && this.nodes[0];\n  }\n\n  render(target, occupants, anchor) {\n    if (!this.nodes) {\n      const html = this.model ? this.model.get() : '';\n      this.nodes = insertHtml(html, target);\n    }\n\n    let nodes = this.nodes;\n\n    // progressive enhancement\n    if (occupants) {\n      let i = -1;\n      let next;\n\n      // start with the first node that should be rendered\n      while (occupants.length && (next = this.nodes[i + 1])) {\n        let n;\n        // look through the occupants until a matching node is found\n        while ((n = occupants.shift())) {\n          const t = n.nodeType;\n\n          if (\n            t === next.nodeType &&\n            ((t === 1 && n.outerHTML === next.outerHTML) ||\n              ((t === 3 || t === 8) && n.nodeValue === next.nodeValue))\n          ) {\n            this.nodes.splice(++i, 1, n); // replace the generated node with the existing one\n            break;\n          } else {\n            target.removeChild(n); // remove the non-matching existing node\n          }\n        }\n      }\n\n      if (i >= 0) {\n        // update the list of remaining nodes to attach, excluding any that were replaced by existing nodes\n        nodes = this.nodes.slice(i);\n      }\n\n      // update the anchor to be the next occupant\n      if (occupants.length) anchor = occupants[0];\n    }\n\n    // attach any remainging nodes to the parent\n    if (nodes.length) {\n      const frag = createDocumentFragment();\n      nodes.forEach(n => frag.appendChild(n));\n\n      if (anchor) {\n        target.insertBefore(frag, anchor);\n      } else {\n        target.appendChild(frag);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    let value = this.model && this.model.get();\n    value = value != null ? '' + value : '';\n\n    return inAttribute() ? decodeCharacterReferences(value) : value;\n  }\n\n  unrender() {\n    if (this.nodes)\n      this.nodes.forEach(node => {\n        // defer detachment until all relevant outros are done\n        runloop.detachWhenReady({\n          node,\n          detach() {\n            detachNode(node);\n          }\n        });\n      });\n    this.rendered = false;\n    this.nodes = null;\n  }\n\n  update() {\n    if (this.rendered && this.dirty) {\n      this.dirty = false;\n\n      this.unrender();\n      this.render(this.up.findParentNode(), null, this.up.findNextNode(this));\n    } else {\n      // make sure to reset the dirty flag even if not rendered\n      this.dirty = false;\n    }\n  }\n}\n","import {\n  ALIAS,\n  ANCHOR,\n  COMMENT,\n  COMPONENT,\n  DOCTYPE,\n  ELEMENT,\n  INTERPOLATOR,\n  PARTIAL,\n  SECTION,\n  TRIPLE,\n  YIELDER\n} from 'config/types';\nimport { ATTRIBUTE, BINDING_FLAG, DECORATOR, EVENT, TRANSITION } from 'config/types';\nimport Alias from './Alias';\nimport Attribute from './element/Attribute';\nimport BindingFlag from './element/BindingFlag';\nimport Comment from './Comment';\nimport Component from './Component';\nimport Decorator from './element/Decorator';\nimport Doctype from './Doctype';\nimport Form from './element/specials/Form';\nimport Element from './Element';\nimport EventDirective from './shared/EventDirective';\nimport Interpolator from './Interpolator';\nimport Input from './element/specials/Input';\nimport Mapping from './component/Mapping';\nimport Option from './element/specials/Option';\nimport Partial from './Partial';\nimport Section from './Section';\nimport Select from './element/specials/Select';\nimport Textarea from './element/specials/Textarea';\nimport Text from './Text';\nimport Transition from './element/Transition';\nimport Triple from './Triple';\nimport getComponentConstructor from './component/getComponentConstructor';\nimport findElement from './shared/findElement';\nimport { findInstance } from 'shared/registry';\nimport asyncProxy from './asyncProxy';\nimport { isString, isFunction } from 'utils/is';\n\nconst constructors = {};\nconstructors[ALIAS] = Alias;\nconstructors[ANCHOR] = Component;\nconstructors[DOCTYPE] = Doctype;\nconstructors[INTERPOLATOR] = Interpolator;\nconstructors[PARTIAL] = Partial;\nconstructors[SECTION] = Section;\nconstructors[TRIPLE] = Triple;\nconstructors[YIELDER] = Partial;\n\nconstructors[ATTRIBUTE] = Attribute;\nconstructors[BINDING_FLAG] = BindingFlag;\nconstructors[DECORATOR] = Decorator;\nconstructors[EVENT] = EventDirective;\nconstructors[TRANSITION] = Transition;\nconstructors[COMMENT] = Comment;\n\nconst specialElements = {\n  doctype: Doctype,\n  form: Form,\n  input: Input,\n  option: Option,\n  select: Select,\n  textarea: Textarea\n};\n\nexport default function createItem(options) {\n  if (isString(options.template)) {\n    return new Text(options);\n  }\n\n  let ctor;\n  let name;\n  const type = options.template.t;\n\n  if (type === ELEMENT) {\n    name = options.template.e;\n\n    // could be a macro partial\n    ctor = findInstance('partials', options.up.ractive, name);\n    if (ctor) {\n      ctor = ctor.partials[name];\n      if (ctor.styleSet) {\n        options.macro = ctor;\n        return new Partial(options);\n      }\n    }\n\n    // could be component or element\n    ctor = getComponentConstructor(options.up.ractive, name);\n    if (ctor) {\n      if (isFunction(ctor.then)) {\n        return asyncProxy(ctor, options);\n      } else {\n        return new Component(options, ctor);\n      }\n    }\n\n    ctor = specialElements[name.toLowerCase()] || Element;\n    return new ctor(options);\n  }\n\n  let Item;\n\n  // component mappings are a special case of attribute\n  if (type === ATTRIBUTE) {\n    let el = options.owner;\n    if (!el || (el.type !== ANCHOR && el.type !== COMPONENT && el.type !== ELEMENT)) {\n      el = findElement(options.up);\n    }\n    options.element = el;\n\n    Item = el.type === COMPONENT || el.type === ANCHOR ? Mapping : Attribute;\n  } else {\n    Item = constructors[type];\n  }\n\n  if (!Item) throw new Error(`Unrecognised item type ${type}`);\n\n  return new Item(options);\n}\n","import { ELEMENT, YIELDER } from 'config/types';\nimport runloop from 'src/global/runloop';\nimport { findMap } from 'utils/array';\nimport { getContext, findParentWithContext } from 'shared/getRactiveContext';\nimport {\n  bind,\n  destroyed,\n  shuffled,\n  toEscapedString,\n  toString,\n  unbind,\n  unrender,\n  update\n} from 'shared/methodCallers';\nimport createItem from './items/createItem';\nimport processItems from './helpers/processItems';\nimport parseJSON from 'utils/parseJSON';\nimport { createDocumentFragment } from 'utils/dom';\n\nfunction unrenderAndDestroy(item) {\n  item.unrender(true);\n}\n\nexport default class Fragment {\n  constructor(options) {\n    this.owner = options.owner; // The item that owns this fragment - an element, section, partial, or attribute\n\n    this.isRoot = !options.owner.up;\n    this.parent = this.isRoot ? null : this.owner.up;\n    this.ractive = options.ractive || (this.isRoot ? options.owner : this.parent.ractive);\n\n    this.componentParent = this.isRoot && this.ractive.component ? this.ractive.component.up : null;\n    this.delegate =\n      (this.parent\n        ? this.parent.delegate\n        : this.componentParent && this.componentParent.delegate) ||\n      (this.owner.containerFragment && this.owner.containerFragment.delegate);\n\n    this.context = null;\n    this.rendered = false;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    if ('cssIds' in options) {\n      this.cssIds = options.cssIds && options.cssIds.length && options.cssIds;\n    } else {\n      this.cssIds = this.parent ? this.parent.cssIds : null;\n    }\n\n    this.dirty = false;\n    this.dirtyValue = true; // used for attribute values\n\n    this.template = options.template || [];\n    this.createItems();\n  }\n\n  bind(context) {\n    this.context = context;\n    this.items.forEach(bind);\n    this.bound = true;\n\n    // in rare cases, a forced resolution (or similar) will cause the\n    // fragment to be dirty before it's even finished binding. In those\n    // cases we update immediately\n    if (this.dirty) this.update();\n\n    return this;\n  }\n\n  bubble() {\n    this.dirtyValue = true;\n\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.isRoot) {\n        // TODO encapsulate 'is component root, but not overall root' check?\n        if (this.ractive.component) {\n          this.ractive.component.bubble();\n        } else if (this.bound) {\n          runloop.addFragment(this);\n        }\n      } else {\n        this.owner.bubble(this.index);\n      }\n    }\n  }\n\n  createItems() {\n    // this is a hot code path\n    const max = this.template.length;\n    this.items = [];\n    for (let i = 0; i < max; i++) {\n      this.items[i] = createItem({\n        up: this,\n        template: this.template[i],\n        index: i\n      });\n    }\n  }\n\n  destroyed() {\n    this.items.forEach(destroyed);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      docFrag.appendChild(xs[i].detach());\n    }\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.items, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAll && i.findAll(selector, options));\n    }\n  }\n\n  findComponent(name, options) {\n    return findMap(this.items, i => i.findComponent(name, options));\n  }\n\n  findAllComponents(name, options) {\n    if (this.items) {\n      this.items.forEach(i => i.findAllComponents && i.findAllComponents(name, options));\n    }\n  }\n\n  findContext() {\n    const base = findParentWithContext(this);\n    if (!base || !base.context) return this.ractive.viewmodel;\n    else return base.context;\n  }\n\n  findNextNode(item) {\n    // search for the next node going forward\n    if (item) {\n      let it;\n      for (let i = item.index + 1; i < this.items.length; i++) {\n        it = this.items[i];\n        if (!it || !it.firstNode) continue;\n\n        const node = it.firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    // if this is the root fragment, and there are no more items,\n    // it means we're at the end...\n    if (this.isRoot) {\n      if (this.ractive.component) {\n        return this.ractive.component.up.findNextNode(this.ractive.component);\n      }\n\n      // TODO possible edge case with other content\n      // appended to this.ractive.el?\n      return null;\n    }\n\n    if (this.parent) return this.owner.findNextNode(this); // the argument is in case the parent is a RepeatedFragment\n  }\n\n  findParentNode() {\n    let fragment = this;\n\n    do {\n      if (fragment.owner.type === ELEMENT) {\n        return fragment.owner.node;\n      }\n\n      if (fragment.isRoot && !fragment.ractive.component) {\n        // TODO encapsulate check\n        return fragment.ractive.el;\n      }\n\n      if (fragment.owner.type === YIELDER) {\n        fragment = fragment.owner.containerFragment;\n      } else {\n        fragment = fragment.componentParent || fragment.parent; // TODO ugh\n      }\n    } while (fragment);\n\n    throw new Error('Could not find parent node'); // TODO link to issue tracker\n  }\n\n  findRepeatingFragment() {\n    let fragment = this;\n    // TODO better check than fragment.parent.iterations\n    while ((fragment.parent || fragment.componentParent) && !fragment.isIteration) {\n      fragment = fragment.parent || fragment.componentParent;\n    }\n\n    return fragment;\n  }\n\n  firstNode(skipParent) {\n    const node = findMap(this.items, i => i.firstNode(true));\n    if (node) return node;\n    if (skipParent) return null;\n\n    return this.parent.findNextNode(this.owner);\n  }\n\n  rebind(next) {\n    this.context = next;\n  }\n\n  render(target, occupants) {\n    if (this.rendered) throw new Error('Fragment is already rendered!');\n    this.rendered = true;\n\n    const xs = this.items;\n    const len = xs.length;\n    for (let i = 0; i < len; i++) {\n      xs[i].render(target, occupants);\n    }\n  }\n\n  resetTemplate(template) {\n    const wasBound = this.bound;\n    const wasRendered = this.rendered;\n\n    // TODO ensure transitions are disabled globally during reset\n\n    if (wasBound) {\n      if (wasRendered) this.unrender(true);\n      this.unbind();\n    }\n\n    this.template = template;\n    this.createItems();\n\n    if (wasBound) {\n      this.bind(this.context);\n\n      if (wasRendered) {\n        const parentNode = this.findParentNode();\n        const anchor = this.findNextNode();\n\n        if (anchor) {\n          const docFrag = createDocumentFragment();\n          this.render(docFrag);\n          parentNode.insertBefore(docFrag, anchor);\n        } else {\n          this.render(parentNode);\n        }\n      }\n    }\n  }\n\n  shuffled() {\n    this.items.forEach(shuffled);\n  }\n\n  toString(escape) {\n    return this.items.map(escape ? toEscapedString : toString).join('');\n  }\n\n  unbind() {\n    this.context = null;\n    this.items.forEach(unbind);\n    this.bound = false;\n\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    this.items.forEach(shouldDestroy ? unrenderAndDestroy : unrender);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      if (!this.updating) {\n        this.dirty = false;\n        this.updating = true;\n        this.items.forEach(update);\n        this.updating = false;\n      } else if (this.isRoot) {\n        runloop.addFragmentToRoot(this);\n      }\n    }\n  }\n\n  valueOf() {\n    if (this.items.length === 1) {\n      return this.items[0].valueOf();\n    }\n\n    if (this.dirtyValue) {\n      const values = {};\n      const source = processItems(this.items, values, this.ractive._guid);\n      const parsed = parseJSON(source, values);\n\n      this.value = parsed ? parsed.value : this.toString();\n\n      this.dirtyValue = false;\n    }\n\n    return this.value;\n  }\n}\nFragment.prototype.getContext = getContext;\n","import Hook from './Hook';\n\nfunction getChildQueue(queue, ractive) {\n  return queue[ractive._guid] || (queue[ractive._guid] = []);\n}\n\nfunction fire(hookQueue, ractive) {\n  const childQueue = getChildQueue(hookQueue.queue, ractive);\n\n  hookQueue.hook.fire(ractive);\n\n  // queue is \"live\" because components can end up being\n  // added while hooks fire on parents that modify data values.\n  while (childQueue.length) {\n    fire(hookQueue, childQueue.shift());\n  }\n\n  delete hookQueue.queue[ractive._guid];\n}\n\nexport default class HookQueue {\n  constructor(event) {\n    this.hook = new Hook(event);\n    this.inProcess = {};\n    this.queue = {};\n  }\n\n  begin(ractive) {\n    this.inProcess[ractive._guid] = true;\n  }\n\n  end(ractive) {\n    const parent = ractive.parent;\n\n    // If this is *isn't* a child of a component that's in process,\n    // it should call methods or fire at this point\n    if (!parent || !this.inProcess[parent._guid]) {\n      fire(this, ractive);\n    } else {\n      // elsewise, handoff to parent to fire when ready\n      getChildQueue(this.queue, parent).push(ractive);\n    }\n\n    delete this.inProcess[ractive._guid];\n  }\n}\n","import { logIfDebug, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport config from './config/config';\nimport Fragment from 'src/view/Fragment';\nimport Hook from 'src/events/Hook';\nimport HookQueue from 'src/events/HookQueue';\nimport Ractive from '../Ractive';\nimport subscribe from './helpers/subscribe';\nimport { hasOwn, keys } from 'utils/object';\n\nconst configHook = new Hook('config');\nconst initHook = new HookQueue('init');\n\nexport default function initialise(ractive, userOptions, options) {\n  keys(ractive.viewmodel.computations).forEach(key => {\n    const computation = ractive.viewmodel.computations[key];\n\n    if (hasOwn(ractive.viewmodel.value, key)) {\n      computation.set(ractive.viewmodel.value[key]);\n    }\n  });\n\n  // init config from Parent and options\n  config.init(ractive.constructor, ractive, userOptions);\n\n  configHook.fire(ractive);\n\n  initHook.begin(ractive);\n\n  const fragment = (ractive.fragment = createFragment(ractive, options));\n  if (fragment) fragment.bind(ractive.viewmodel);\n\n  initHook.end(ractive);\n\n  // general config done, set up observers\n  subscribe(ractive, userOptions, 'observe');\n\n  if (fragment) {\n    // render automatically ( if `el` is specified )\n    const el = getElement(ractive.el || ractive.target);\n    if (el) {\n      const promise = ractive.render(el, ractive.append);\n\n      if (Ractive.DEBUG_PROMISES) {\n        promise.catch(err => {\n          warnOnceIfDebug(\n            'Promise debugging is enabled, to help solve errors that happen asynchronously. Some browsers will log unhandled promise rejections, in which case you can safely disable promise debugging:\\n  Ractive.DEBUG_PROMISES = false;'\n          );\n          warnIfDebug('An error happened during rendering', { ractive });\n          logIfDebug(err);\n\n          throw err;\n        });\n      }\n    }\n  }\n}\n\nexport function createFragment(ractive, options = {}) {\n  if (ractive.template) {\n    const cssIds = [].concat(ractive.constructor._cssIds || [], options.cssIds || []);\n\n    return new Fragment({\n      owner: ractive,\n      template: ractive.template,\n      cssIds\n    });\n  }\n}\n","import { doc } from 'config/environment';\nimport { applyCSS } from 'src/global/css';\nimport Hook from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport { createFragment } from './initialise';\n\nconst renderHook = new Hook('render');\nconst completeHook = new Hook('complete');\n\nexport default function render(ractive, target, anchor, occupants) {\n  // set a flag to let any transitions know that this instance is currently rendering\n  ractive.rendering = true;\n\n  const promise = runloop.start();\n  runloop.scheduleTask(() => renderHook.fire(ractive), true);\n\n  if (ractive.fragment.rendered) {\n    throw new Error(\n      'You cannot call ractive.render() on an already rendered instance! Call ractive.unrender() first'\n    );\n  }\n\n  if (ractive.destroyed) {\n    ractive.destroyed = false;\n    ractive.fragment = createFragment(ractive).bind(ractive.viewmodel);\n  }\n\n  anchor = getElement(anchor) || ractive.anchor;\n\n  ractive.el = ractive.target = target;\n  ractive.anchor = anchor;\n\n  // ensure encapsulated CSS is up-to-date\n  if (ractive.cssId) applyCSS();\n\n  if (target) {\n    (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(ractive);\n\n    if (anchor) {\n      const docFrag = doc.createDocumentFragment();\n      ractive.fragment.render(docFrag);\n      target.insertBefore(docFrag, anchor);\n    } else {\n      ractive.fragment.render(target, occupants);\n    }\n  }\n\n  runloop.end();\n  ractive.rendering = false;\n\n  return promise.then(() => {\n    if (ractive.torndown) return;\n\n    completeHook.fire(ractive);\n  });\n}\n","import runloop from 'src/global/runloop';\nimport config from '../config/config';\nimport Hook from '../../events/Hook';\nimport dataConfigurator from '../config/custom/data';\nimport { isObjectType } from 'utils/is';\n\nconst shouldRerender = ['template', 'partials', 'components', 'decorators', 'events'];\n\nconst completeHook = new Hook('complete');\nconst resetHook = new Hook('reset');\nconst renderHook = new Hook('render');\nconst unrenderHook = new Hook('unrender');\n\nexport default function Ractive$reset(data) {\n  data = data || {};\n\n  if (!isObjectType(data)) {\n    throw new Error('The reset method takes either no arguments, or an object containing new data');\n  }\n\n  // TEMP need to tidy this up\n  data = dataConfigurator.init(this.constructor, this, { data });\n\n  const promise = runloop.start();\n\n  // If the root object is wrapped, try and use the wrapper's reset value\n  const wrapper = this.viewmodel.wrapper;\n  if (wrapper && wrapper.reset) {\n    if (wrapper.reset(data) === false) {\n      // reset was rejected, we need to replace the object\n      this.viewmodel.set(data);\n    }\n  } else {\n    this.viewmodel.set(data);\n  }\n\n  // reset config items and track if need to rerender\n  const changes = config.reset(this);\n  let rerender;\n\n  let i = changes.length;\n  while (i--) {\n    if (shouldRerender.indexOf(changes[i]) > -1) {\n      rerender = true;\n      break;\n    }\n  }\n\n  if (rerender) {\n    unrenderHook.fire(this);\n    this.fragment.resetTemplate(this.template);\n    renderHook.fire(this);\n    completeHook.fire(this);\n  }\n\n  runloop.end();\n\n  resetHook.fire(this, data);\n\n  return promise;\n}\n","import runloop from 'src/global/runloop';\nimport { PARTIAL, COMPONENT, ELEMENT } from 'config/types';\nimport { isArray } from 'utils/is';\nimport { handleChange } from 'shared/methodCallers';\n\nfunction collect(source, name, attr, dest) {\n  source.forEach(item => {\n    // queue to rerender if the item is a partial and the current name matches\n    if (item.type === PARTIAL && (item.refName === name || item.name === name)) {\n      item.inAttribute = attr;\n      dest.push(item);\n      return; // go no further\n    }\n\n    // if it has a fragment, process its items\n    if (item.fragment) {\n      collect(item.fragment.iterations || item.fragment.items, name, attr, dest);\n    } else if (isArray(item.items)) {\n      // or if it is itself a fragment, process its items\n      collect(item.items, name, attr, dest);\n    } else if (item.type === COMPONENT && item.instance) {\n      // or if it is a component, step in and process its items\n      // ...unless the partial is shadowed\n      if (item.instance.partials[name]) return;\n      collect(item.instance.fragment.items, name, attr, dest);\n    }\n\n    // if the item is an element, process its attributes too\n    if (item.type === ELEMENT) {\n      if (isArray(item.attributes)) {\n        collect(item.attributes, name, true, dest);\n      }\n    }\n  });\n}\n\nexport default function(name, partial) {\n  const collection = [];\n  collect(this.fragment.items, name, false, collection);\n\n  const promise = runloop.start();\n\n  this.partials[name] = partial;\n  collection.forEach(handleChange);\n\n  runloop.end();\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('reverse').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('shift').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('sort').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('splice').path;\n","import Hook from 'src/events/Hook';\nimport { warnIfDebug } from 'utils/log';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\n\nconst unrenderHook = new Hook('unrender');\n\nexport default function Ractive$unrender() {\n  if (!this.fragment.rendered) {\n    warnIfDebug('ractive.unrender() was called on a Ractive instance that was not rendered');\n    return Promise.resolve();\n  }\n\n  this.unrendering = true;\n  const promise = runloop.start();\n\n  // If this is a component, and the component isn't marked for destruction,\n  // don't detach nodes from the DOM unnecessarily\n  const shouldDestroy =\n    !this.component ||\n    (this.component.anchor || {}).shouldDestroy ||\n    this.component.shouldDestroy ||\n    this.shouldDestroy;\n  this.fragment.unrender(shouldDestroy);\n  if (shouldDestroy) this.destroyed = true;\n\n  removeFromArray(this.el.__ractive_instances__, this);\n\n  unrenderHook.fire(this);\n\n  runloop.end();\n  this.unrendering = false;\n\n  return promise;\n}\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('unshift').path;\n","import add from './prototype/add';\nimport animate from './prototype/animate';\nimport attachChild from './prototype/attachChild';\nimport detach from './prototype/detach';\nimport detachChild from './prototype/detachChild';\nimport find from './prototype/find';\nimport findAll from './prototype/findAll';\nimport findAllComponents from './prototype/findAllComponents';\nimport findComponent from './prototype/findComponent';\nimport findContainer from './prototype/findContainer';\nimport findParent from './prototype/findParent';\nimport fire from './prototype/fire';\nimport get from './prototype/get';\nimport getContext, { getNodeInfo } from './prototype/getContext';\nimport insert from './prototype/insert';\nimport link from './prototype/link';\nimport observe from './prototype/observe';\nimport observeOnce from './prototype/observeOnce';\nimport off from './prototype/off';\nimport on from './prototype/on';\nimport once from './prototype/once';\nimport pop from './prototype/pop';\nimport push from './prototype/push';\nimport readLink from './prototype/readLink';\nimport render from './prototype/render';\nimport reset from './prototype/reset';\nimport resetPartial from './prototype/resetPartial';\nimport resetTemplate from './prototype/resetTemplate';\nimport reverse from './prototype/reverse';\nimport set from './prototype/set';\nimport shift from './prototype/shift';\nimport sort from './prototype/sort';\nimport splice from './prototype/splice';\nimport subtract from './prototype/subtract';\nimport teardown from './prototype/teardown';\nimport toggle from './prototype/toggle';\nimport toCSS from './prototype/toCSS';\nimport toHTML from './prototype/toHTML';\nimport toText from './prototype/toText';\nimport transition from './prototype/transition';\nimport unlink from './prototype/unlink';\nimport unrender from './prototype/unrender';\nimport unshift from './prototype/unshift';\nimport update from './prototype/update';\nimport updateModel from './prototype/updateModel';\n\nimport { defineProperty } from 'utils/object';\n\nconst proto = {\n  add,\n  animate,\n  attachChild,\n  detach,\n  detachChild,\n  find,\n  findAll,\n  findAllComponents,\n  findComponent,\n  findContainer,\n  findParent,\n  fire,\n  get,\n  getContext,\n  getNodeInfo,\n  insert,\n  link,\n  observe,\n  observeOnce,\n  off,\n  on,\n  once,\n  pop,\n  push,\n  readLink,\n  render,\n  reset,\n  resetPartial,\n  resetTemplate,\n  reverse,\n  set,\n  shift,\n  sort,\n  splice,\n  subtract,\n  teardown,\n  toggle,\n  toCSS,\n  toCss: toCSS,\n  toHTML,\n  toHtml: toHTML,\n  toText,\n  transition,\n  unlink,\n  unrender,\n  unshift,\n  update,\n  updateModel\n};\n\ndefineProperty(proto, 'target', {\n  get() {\n    return this.el;\n  }\n});\n\nexport default proto;\n","import config from '../Ractive/config/config';\nimport dataConfigurator from '../Ractive/config/custom/data';\nimport construct from '../Ractive/construct';\nimport initialise from '../Ractive/initialise';\nimport Ractive from '../Ractive';\nimport isInstance from '../Ractive/static/isInstance';\nimport styleSet from '../Ractive/static/styleSet';\nimport styleGet from '../Ractive/static/styleGet';\nimport sharedSet from '../Ractive/static/sharedSet';\nimport sharedGet from '../Ractive/static/sharedGet';\nimport { assign, create, defineProperties, toPairs } from 'utils/object';\nimport { isArray, isFunction } from 'utils/is';\n\nconst callsSuper = /super\\s*\\(|\\.call\\s*\\(\\s*this/;\n\nexport function extend(...options) {\n  if (!options.length) {\n    return extendOne(this);\n  } else {\n    return options.reduce(extendOne, this);\n  }\n}\n\nexport function extendWith(Class, options = {}) {\n  return extendOne(this, options, Class);\n}\n\nfunction extendOne(Parent, options = {}, Target) {\n  let proto;\n  let Child = isFunction(Target) && Target;\n\n  if (options.prototype instanceof Ractive) {\n    throw new Error(`Ractive no longer supports multiple inheritance.`);\n  }\n\n  if (Child) {\n    if (!(Child.prototype instanceof Parent)) {\n      throw new Error(\n        `Only classes that inherit the appropriate prototype may be used with extend`\n      );\n    }\n    if (!callsSuper.test(Child.toString())) {\n      throw new Error(`Only classes that call super in their constructor may be used with extend`);\n    }\n\n    proto = Child.prototype;\n  } else {\n    Child = function(options) {\n      if (!(this instanceof Child)) return new Child(options);\n\n      construct(this, options || {});\n      initialise(this, options || {}, {});\n    };\n\n    proto = create(Parent.prototype);\n    proto.constructor = Child;\n\n    Child.prototype = proto;\n  }\n\n  // Static properties\n  defineProperties(Child, {\n    // alias prototype as defaults\n    defaults: { value: proto },\n\n    extend: { value: extend, writable: true, configurable: true },\n    extendWith: { value: extendWith, writable: true, configurable: true },\n    extensions: { value: [] },\n\n    isInstance: { value: isInstance },\n\n    Parent: { value: Parent },\n    Ractive: { value: Ractive },\n\n    styleGet: { value: styleGet.bind(Child), configurable: true },\n    styleSet: { value: styleSet.bind(Child), configurable: true }\n  });\n\n  // extend configuration\n  config.extend(Parent, proto, options, Child);\n\n  // store event and observer registries on the constructor when extending\n  Child._on = (Parent._on || []).concat(toPairs(options.on));\n  Child._observe = (Parent._observe || []).concat(toPairs(options.observe));\n\n  Parent.extensions.push(Child);\n\n  // attribute defs are not inherited, but they need to be stored\n  if (options.attributes) {\n    let attrs;\n\n    // allow an array of optional props or an object with arrays for optional and required props\n    if (isArray(options.attributes)) {\n      attrs = { optional: options.attributes, required: [] };\n    } else {\n      attrs = options.attributes;\n    }\n\n    // make sure the requisite keys actually store arrays\n    if (!isArray(attrs.required)) attrs.required = [];\n    if (!isArray(attrs.optional)) attrs.optional = [];\n\n    Child.attributes = attrs;\n  }\n\n  dataConfigurator.extend(Parent, proto, options, Child);\n\n  if (options.computed) {\n    proto.computed = assign(create(Parent.prototype.computed), options.computed);\n  }\n\n  return Child;\n}\n\ndefineProperties(Ractive, {\n  sharedGet: { value: sharedGet },\n  sharedSet: { value: sharedSet },\n  styleGet: { configurable: true, value: styleGet.bind(Ractive) },\n  styleSet: { configurable: true, value: styleSet.bind(Ractive) }\n});\n","import './polyfills/Object.assign';\nimport './polyfills/array.find';\nimport './polyfills/node.contains';\nimport './polyfills/performance.now';\nimport './polyfills/Promise';\nimport './polyfills/requestAnimationFrame';\n\nimport defaults from './Ractive/config/defaults';\nimport easing from './Ractive/static/easing';\nimport interpolators from './Ractive/static/interpolators';\nimport { svg, win } from './config/environment';\nimport proto from './Ractive/prototype';\nimport { extend, extendWith } from './extend/_extend';\nimport macro from './extend/_macro';\nimport parse from './parse/_parse';\nimport getContext, { getNodeInfo } from './Ractive/static/getContext';\nimport isInstance from './Ractive/static/isInstance';\nimport construct from './Ractive/construct';\nimport initialise from './Ractive/initialise';\nimport { getCSS } from './global/css';\nimport { escapeKey, unescapeKey, normalise } from './shared/keypaths';\nimport { joinKeys, splitKeypath } from './Ractive/static/keypaths';\nimport shared from './Ractive/shared';\nimport { findPlugin } from './Ractive/static/findPlugin';\nimport parseJSON from './utils/parseJSON';\nimport CSSModel from './model/specials/CSSModel';\nimport { data as sharedData } from './model/specials/SharedModel';\nimport { extern } from './shared/getRactiveContext';\nimport { warn } from 'utils/log';\n\nimport { assign, defineProperty, defineProperties } from 'utils/object';\n\nexport default function Ractive(options) {\n  if (!(this instanceof Ractive)) return new Ractive(options);\n\n  construct(this, options || {});\n  initialise(this, options || {}, {});\n}\n\n// check to see if we're being asked to force Ractive as a global for some weird environments\nif (win && !win.Ractive) {\n  let opts = '';\n  const script =\n    document.currentScript ||\n    /* istanbul ignore next */ document.querySelector('script[data-ractive-options]');\n\n  if (script) opts = script.getAttribute('data-ractive-options') || '';\n\n  /* istanbul ignore next */\n  if (~opts.indexOf('ForceGlobal')) win.Ractive = Ractive;\n} else if (win) {\n  warn(`Ractive already appears to be loaded while loading BUILD_PLACEHOLDER_VERSION.`);\n}\n\nassign(Ractive.prototype, proto, defaults);\nRactive.prototype.constructor = Ractive;\n\n// alias prototype as `defaults`\nRactive.defaults = Ractive.prototype;\n\n// share defaults with the parser\nshared.defaults = Ractive.defaults;\nshared.Ractive = Ractive;\n\n// static properties\ndefineProperties(Ractive, {\n  // debug flag\n  DEBUG: { writable: true, value: true },\n  DEBUG_PROMISES: { writable: true, value: true },\n\n  // static methods:\n  extend: { value: extend },\n  extendWith: { value: extendWith },\n  escapeKey: { value: escapeKey },\n  evalObjectString: { value: parseJSON },\n  findPlugin: { value: findPlugin },\n  getContext: { value: getContext },\n  getCSS: { value: getCSS },\n  getNodeInfo: { value: getNodeInfo },\n  isInstance: { value: isInstance },\n  joinKeys: { value: joinKeys },\n  macro: { value: macro },\n  normaliseKeypath: { value: normalise },\n  parse: { value: parse },\n  splitKeypath: { value: splitKeypath },\n  // sharedSet and styleSet are in _extend because circular refs\n  unescapeKey: { value: unescapeKey },\n\n  // support\n  enhance: { writable: true, value: false },\n  svg: { value: svg },\n\n  // version\n  VERSION: { value: 'BUILD_PLACEHOLDER_VERSION' },\n\n  // plugins\n  adaptors: { writable: true, value: {} },\n  components: { writable: true, value: {} },\n  decorators: { writable: true, value: {} },\n  easing: { writable: true, value: easing },\n  events: { writable: true, value: {} },\n  extensions: { value: [] },\n  interpolators: { writable: true, value: interpolators },\n  partials: { writable: true, value: {} },\n  transitions: { writable: true, value: {} },\n\n  // CSS variables\n  cssData: { configurable: true, value: {} },\n\n  // access to @shared without an instance\n  sharedData: { value: sharedData },\n\n  // for getting the source Ractive lib from a constructor\n  Ractive: { value: Ractive },\n\n  // to allow extending contexts\n  Context: { value: extern.Context.prototype }\n});\n\ndefineProperty(Ractive, '_cssModel', {\n  configurable: true,\n  value: new CSSModel(Ractive)\n});\n","import Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\nimport { isArray } from 'utils/is';\n\nconst push = [].push;\n\nfunction getValue() {\n  const all = this.bindings\n    .filter(b => b.node && b.node.checked)\n    .map(b => b.element.getAttribute('value'));\n  const res = [];\n  all.forEach(v => {\n    if (!this.bindings[0].arrayContains(res, v)) res.push(v);\n  });\n  return res;\n}\n\nexport default class CheckboxNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.checkboxName = true; // so that ractive.updateModel() knows what to do with this\n\n    // Each input has a reference to an array containing it and its\n    // group, as two-way binding depends on being able to ascertain\n    // the status of all inputs within the group\n    this.group = getBindingGroup('checkboxes', this.model, getValue);\n    this.group.add(this);\n\n    if (this.noInitialValue) {\n      this.group.noInitialValue = true;\n    }\n\n    // If no initial value was set, and this input is checked, we\n    // update the model\n    if (this.group.noInitialValue && this.element.getAttribute('checked')) {\n      const existingValue = this.model.get();\n      const bindingValue = this.element.getAttribute('value');\n\n      if (!this.arrayContains(existingValue, bindingValue)) {\n        push.call(existingValue, bindingValue); // to avoid triggering runloop with array adaptor\n      }\n    }\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n  }\n\n  getInitialValue() {\n    // This only gets called once per group (of inputs that\n    // share a name), because it only gets called if there\n    // isn't an initial value. By the same token, we can make\n    // a note of that fact that there was no initial value,\n    // and populate it using any `checked` attributes that\n    // exist (which users should avoid, but which we should\n    // support anyway to avoid breaking expectations)\n    this.noInitialValue = true; // TODO are noInitialValue and wasUndefined the same thing?\n    return [];\n  }\n\n  getValue() {\n    return this.group.value;\n  }\n\n  handleChange() {\n    this.isChecked = this.element.node.checked;\n    this.group.value = this.model.get();\n    const value = this.element.getAttribute('value');\n    if (this.isChecked && !this.arrayContains(this.group.value, value)) {\n      this.group.value.push(value);\n    } else if (!this.isChecked && this.arrayContains(this.group.value, value)) {\n      this.removeFromArray(this.group.value, value);\n    }\n    // make sure super knows there's a change\n    this.lastValue = null;\n    super.handleChange();\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    const existingValue = this.model.get();\n    const bindingValue = this.element.getAttribute('value');\n\n    if (isArray(existingValue)) {\n      this.isChecked = this.arrayContains(existingValue, bindingValue);\n    } else {\n      this.isChecked = this.element.compare(existingValue, bindingValue);\n    }\n    node.name = '{{' + this.model.getKeypath() + '}}';\n    node.checked = this.isChecked;\n\n    this.element.on('change', handleDomEvent);\n\n    // in case of IE emergency, bind to click event as well\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.group.bindings.forEach(binding => (binding.wasUndefined = true));\n\n    if (node.checked) {\n      const valueSoFar = this.group.getValue();\n      valueSoFar.push(this.element.getAttribute('value'));\n\n      this.group.model.set(valueSoFar);\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n\n  arrayContains(selectValue, optionValue) {\n    let i = selectValue.length;\n    while (i--) {\n      if (this.element.compare(optionValue, selectValue[i])) return true;\n    }\n    return false;\n  }\n\n  removeFromArray(array, item) {\n    if (!array) return;\n    let i = array.length;\n    while (i--) {\n      if (this.element.compare(item, array[i])) {\n        array.splice(i, 1);\n      }\n    }\n  }\n}\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class ContentEditableBinding extends Binding {\n  getInitialValue() {\n    return this.element.fragment ? this.element.fragment.toString() : '';\n  }\n\n  getValue() {\n    return this.element.node.innerHTML;\n  }\n\n  render() {\n    super.render();\n\n    const el = this.element;\n\n    el.on('change', handleDomEvent);\n    el.on('blur', handleDomEvent);\n\n    if (!this.ractive.lazy) {\n      el.on('input', handleDomEvent);\n\n      if (this.node.attachEvent) {\n        el.on('keyup', handleDomEvent);\n      }\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.innerHTML);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('blur', handleDomEvent);\n    el.off('change', handleDomEvent);\n    el.off('input', handleDomEvent);\n    el.off('keyup', handleDomEvent);\n  }\n}\n","import { isNumeric } from 'utils/is';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nfunction handleBlur() {\n  handleDomEvent.call(this);\n\n  const value = this._ractive.binding.model.get();\n  this.value = value == undefined ? '' : value;\n}\n\nfunction handleDelay(delay) {\n  let timeout;\n\n  return function() {\n    if (timeout) clearTimeout(timeout);\n\n    timeout = setTimeout(() => {\n      const binding = this._ractive.binding;\n      if (binding.rendered) handleDomEvent.call(this);\n      timeout = null;\n    }, delay);\n  };\n}\n\nexport default class GenericBinding extends Binding {\n  getInitialValue() {\n    return '';\n  }\n\n  getValue() {\n    return this.node.value;\n  }\n\n  render() {\n    super.render();\n\n    // any lazy setting for this element overrides the root\n    // if the value is a number, it's a timeout\n    let lazy = this.ractive.lazy;\n    let timeout = false;\n    const el = this.element;\n\n    if ('lazy' in this.element) {\n      lazy = this.element.lazy;\n    }\n\n    if (isNumeric(lazy)) {\n      timeout = +lazy;\n      lazy = false;\n    }\n\n    this.handler = timeout ? handleDelay(timeout) : handleDomEvent;\n\n    const node = this.node;\n\n    el.on('change', handleDomEvent);\n\n    if (node.type !== 'file') {\n      if (!lazy) {\n        el.on('input', this.handler);\n\n        // IE is a special snowflake\n        if (node.attachEvent) {\n          el.on('keyup', this.handler);\n        }\n      }\n\n      el.on('blur', handleBlur);\n    }\n  }\n\n  unrender() {\n    const el = this.element;\n    this.rendered = false;\n\n    el.off('change', handleDomEvent);\n    el.off('input', this.handler);\n    el.off('keyup', this.handler);\n    el.off('blur', handleBlur);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class FileBinding extends GenericBinding {\n  getInitialValue() {\n    /* istanbul ignore next */\n    return undefined;\n  }\n\n  getValue() {\n    /* istanbul ignore next */\n    return this.node.files;\n  }\n\n  render() {\n    /* istanbul ignore next */\n    this.element.lazy = false;\n    /* istanbul ignore next */\n    super.render();\n  }\n\n  setFromNode(node) {\n    /* istanbul ignore next */\n    this.model.set(node.files);\n  }\n}\n","import { arrayContentsMatch } from 'utils/array';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class MultipleSelectBinding extends Binding {\n  getInitialValue() {\n    return this.element.options\n      .filter(option => option.getAttribute('selected'))\n      .map(option => option.getAttribute('value'));\n  }\n\n  getValue() {\n    const options = this.element.node.options;\n    const len = options.length;\n\n    const selectedValues = [];\n\n    for (let i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (option.selected) {\n        const optionValue = option._ractive ? option._ractive.value : option.value;\n        selectedValues.push(optionValue);\n      }\n    }\n\n    return selectedValues;\n  }\n\n  handleChange() {\n    const attribute = this.attribute;\n    const previousValue = attribute.getValue();\n\n    const value = this.getValue();\n\n    if (previousValue === undefined || !arrayContentsMatch(value, previousValue)) {\n      super.handleChange();\n    }\n\n    return this;\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.model.get() === undefined) {\n      // get value from DOM, if possible\n      this.handleChange();\n    }\n  }\n\n  setFromNode(node) {\n    const selectedOptions = getSelectedOptions(node);\n    let i = selectedOptions.length;\n    const result = new Array(i);\n\n    while (i--) {\n      const option = selectedOptions[i];\n      result[i] = option._ractive ? option._ractive.value : option.value;\n    }\n\n    this.model.set(result);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import GenericBinding from './GenericBinding';\n\nexport default class NumericBinding extends GenericBinding {\n  getInitialValue() {\n    return undefined;\n  }\n\n  getValue() {\n    const value = parseFloat(this.node.value);\n    return isNaN(value) ? undefined : value;\n  }\n\n  setFromNode(node) {\n    const value = parseFloat(node.value);\n    if (!isNaN(value)) this.model.set(value);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nconst siblings = {};\n\nfunction getSiblings(hash) {\n  return siblings[hash] || (siblings[hash] = []);\n}\n\nexport default class RadioBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n\n    this.siblings = getSiblings(this.ractive._guid + this.element.getAttribute('name'));\n    this.siblings.push(this);\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  handleChange() {\n    runloop.start();\n\n    this.siblings.forEach(binding => {\n      binding.model.set(binding.getValue());\n    });\n\n    runloop.end();\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n\n  unbind() {\n    removeFromArray(this.siblings, this);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n}\n","import noop from 'utils/noop';\nimport Binding from './Binding';\nimport getBindingGroup from './getBindingGroup';\nimport handleDomEvent from './handleDomEvent';\n\nfunction getValue() {\n  const checked = this.bindings.filter(b => b.node.checked);\n  if (checked.length > 0) {\n    return checked[0].element.getAttribute('value');\n  }\n}\n\nexport default class RadioNameBinding extends Binding {\n  constructor(element) {\n    super(element, 'name');\n\n    this.group = getBindingGroup('radioname', this.model, getValue);\n    this.group.add(this);\n\n    if (element.checked) {\n      this.group.value = this.getValue();\n    }\n  }\n\n  bind() {\n    if (!this.group.bound) {\n      this.group.bind();\n    }\n\n    // update name keypath when necessary\n    this.nameAttributeBinding = {\n      handleChange: () => (this.node.name = `{{${this.model.getKeypath()}}}`),\n      rebind: noop\n    };\n\n    this.model.getKeypathModel().register(this.nameAttributeBinding);\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('checked')) {\n      return this.element.getAttribute('value');\n    }\n  }\n\n  getValue() {\n    return this.element.getAttribute('value');\n  }\n\n  handleChange() {\n    // If this <input> is the one that's checked, then the value of its\n    // `name` model gets set to its value\n    if (this.node.checked) {\n      this.group.value = this.getValue();\n      super.handleChange();\n    }\n  }\n\n  lastVal(setting, value) {\n    if (!this.group) return;\n    if (setting) this.group.lastValue = value;\n    else return this.group.lastValue;\n  }\n\n  render() {\n    super.render();\n\n    const node = this.node;\n\n    node.name = `{{${this.model.getKeypath()}}}`;\n    node.checked = this.element.compare(this.model.get(), this.element.getAttribute('value'));\n\n    this.element.on('change', handleDomEvent);\n\n    if (node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  setFromNode(node) {\n    if (node.checked) {\n      this.group.model.set(this.element.getAttribute('value'));\n    }\n  }\n\n  unbind() {\n    this.group.remove(this);\n\n    this.model.getKeypathModel().unregister(this.nameAttributeBinding);\n  }\n\n  unrender() {\n    const el = this.element;\n\n    el.off('change', handleDomEvent);\n    el.off('click', handleDomEvent);\n  }\n}\n","import runloop from 'src/global/runloop';\nimport getSelectedOptions from 'utils/getSelectedOptions';\nimport Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class SingleSelectBinding extends Binding {\n  forceUpdate() {\n    const value = this.getValue();\n\n    if (value !== undefined) {\n      this.attribute.locked = true;\n      runloop.scheduleTask(() => (this.attribute.locked = false));\n      this.model.set(value);\n    }\n  }\n\n  getInitialValue() {\n    if (this.element.getAttribute('value') !== undefined) {\n      return;\n    }\n\n    const options = this.element.options;\n    const len = options.length;\n\n    if (!len) return;\n\n    let value;\n    let optionWasSelected;\n    let i = len;\n\n    // take the final selected option...\n    while (i--) {\n      const option = options[i];\n\n      if (option.getAttribute('selected')) {\n        if (!option.getAttribute('disabled')) {\n          value = option.getAttribute('value');\n        }\n\n        optionWasSelected = true;\n        break;\n      }\n    }\n\n    // or the first non-disabled option, if none are selected\n    if (!optionWasSelected) {\n      while (++i < len) {\n        if (!options[i].getAttribute('disabled')) {\n          value = options[i].getAttribute('value');\n          break;\n        }\n      }\n    }\n\n    // This is an optimisation (aka hack) that allows us to forgo some\n    // other more expensive work\n    // TODO does it still work? seems at odds with new architecture\n    if (value !== undefined) {\n      this.element.attributeByName.value.value = value;\n    }\n\n    return value;\n  }\n\n  getValue() {\n    const options = this.node.options;\n    const len = options.length;\n\n    let i;\n    for (i = 0; i < len; i += 1) {\n      const option = options[i];\n\n      if (options[i].selected && !options[i].disabled) {\n        return option._ractive ? option._ractive.value : option.value;\n      }\n    }\n  }\n\n  render() {\n    super.render();\n    this.element.on('change', handleDomEvent);\n  }\n\n  setFromNode(node) {\n    const option = getSelectedOptions(node)[0];\n    this.model.set(option._ractive ? option._ractive.value : option.value);\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n  }\n}\n","import { ATTRIBUTE, BINDING_FLAG, DECORATOR, DELEGATE_FLAG, EVENT, TRANSITION } from 'config/types';\nimport { win } from 'config/environment';\nimport { html, svg } from 'config/namespaces';\nimport { toArray, addToArray, removeFromArray } from 'utils/array';\nimport { escapeHtml, voidElementNames } from 'utils/html';\nimport { createElement, detachNode, matches, safeAttributeString } from 'utils/dom';\nimport runloop from 'src/global/runloop';\nimport Context from 'shared/Context';\nimport { bind, destroyed, render, unbind, update } from 'shared/methodCallers';\nimport { ContainerItem } from './shared/Item';\nimport Fragment from '../Fragment';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport findElement from './shared/findElement';\nimport selectBinding from './element/binding/selectBinding';\nimport { assign, create, defineProperty } from 'utils/object';\n\nconst endsWithSemi = /;\\s*$/;\n\nexport default class Element extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.e.toLowerCase();\n\n    // find parent element\n    this.parent = findElement(this.up, false);\n\n    if (this.parent && this.parent.name === 'option') {\n      throw new Error(\n        `An <option> element cannot contain other elements (encountered <${this.name}>)`\n      );\n    }\n\n    this.decorators = [];\n\n    // create attributes\n    this.attributeByName = {};\n\n    let attrs;\n    let n, attr, val, cls, name, template, leftovers;\n\n    const m = this.template.m;\n    const len = (m && m.length) || 0;\n\n    for (let i = 0; i < len; i++) {\n      template = m[i];\n      switch (template.t) {\n        case ATTRIBUTE:\n        case BINDING_FLAG:\n        case DECORATOR:\n        case EVENT:\n        case TRANSITION:\n          attr = createItem({\n            owner: this,\n            up: this.up,\n            template\n          });\n\n          n = template.n;\n\n          attrs = attrs || (attrs = this.attributes = []);\n\n          if (n === 'value') val = attr;\n          else if (n === 'name') name = attr;\n          else if (n === 'class') cls = attr;\n          else attrs.push(attr);\n\n          break;\n\n        case DELEGATE_FLAG:\n          this.delegate = false;\n          break;\n\n        default:\n          (leftovers || (leftovers = [])).push(template);\n          break;\n      }\n    }\n\n    if (val) attrs.push(val);\n    if (name) attrs.push(name);\n    if (cls) attrs.unshift(cls);\n\n    if (leftovers) {\n      (attrs || (this.attributes = [])).push(\n        new ConditionalAttribute({\n          owner: this,\n          up: this.up,\n          template: leftovers\n        })\n      );\n\n      // empty leftovers array\n      leftovers = [];\n    }\n\n    // create children\n    if (options.template.f && !options.deferContent) {\n      this.fragment = new Fragment({\n        template: options.template.f,\n        owner: this,\n        cssIds: null\n      });\n    }\n\n    this.binding = null; // filled in later\n  }\n\n  bind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.binding = true;\n      attrs.forEach(bind);\n      attrs.binding = false;\n    }\n\n    if (this.fragment) this.fragment.bind();\n\n    // create two-way binding if necessary\n    if (!this.binding) this.recreateTwowayBinding();\n    else this.binding.bind();\n  }\n\n  createTwowayBinding() {\n    if ('twoway' in this ? this.twoway : this.ractive.twoway) {\n      const Binding = selectBinding(this);\n      if (Binding) {\n        const binding = new Binding(this);\n        if (binding && binding.model) return binding;\n      }\n    }\n  }\n\n  destroyed() {\n    if (this.attributes) this.attributes.forEach(destroyed);\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.removeEventListener(k, handler);\n      }\n    }\n\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  detach() {\n    // if this element is no longer rendered, the transitions are complete and the attributes can be torn down\n    if (!this.rendered) this.destroyed();\n\n    return detachNode(this.node);\n  }\n\n  find(selector, options) {\n    if (this.node && matches(this.node, selector)) return this.node;\n    if (this.fragment) {\n      return this.fragment.find(selector, options);\n    }\n  }\n\n  findAll(selector, options) {\n    const { result } = options;\n\n    if (matches(this.node, selector)) {\n      result.push(this.node);\n    }\n\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findNextNode() {\n    return null;\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute ? attribute.getValue() : undefined;\n  }\n\n  getContext(...assigns) {\n    if (this.fragment) return this.fragment.getContext(...assigns);\n\n    if (!this.ctx) this.ctx = new Context(this.up, this);\n    assigns.unshift(create(this.ctx));\n    return assign.apply(null, assigns);\n  }\n\n  off(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = this.listeners && this.listeners[event];\n\n    if (!ref) return;\n    removeFromArray(ref, callback);\n\n    if (delegate) {\n      const listeners =\n        (delegate.listeners || (delegate.listeners = [])) &&\n        (delegate.listeners[event] || (delegate.listeners[event] = []));\n      if (listeners.refs && !--listeners.refs) delegate.off(event, delegateHandler, true);\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        rem.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, true);\n        add.call(n, event, handler, false);\n      }\n    }\n  }\n\n  on(event, callback, capture = false) {\n    const delegate = this.up.delegate;\n    const ref = (this.listeners || (this.listeners = {}))[event] || (this.listeners[event] = []);\n\n    if (delegate) {\n      const listeners =\n        ((delegate.listeners || (delegate.listeners = [])) && delegate.listeners[event]) ||\n        (delegate.listeners[event] = []);\n      if (!listeners.refs) {\n        listeners.refs = 0;\n        delegate.on(event, delegateHandler, true);\n        listeners.refs++;\n      } else {\n        listeners.refs++;\n      }\n    } else if (this.rendered) {\n      const n = this.node;\n      const add = n.addEventListener;\n      const rem = n.removeEventListener;\n\n      if (!ref.length) {\n        add.call(n, event, handler, capture);\n      } else if (ref.length && !ref.refs && capture) {\n        rem.call(n, event, handler, false);\n        add.call(n, event, handler, true);\n      }\n    }\n\n    addToArray(this.listeners[event], callback);\n  }\n\n  recreateTwowayBinding() {\n    if (this.binding) {\n      this.binding.unbind();\n      this.binding.unrender();\n    }\n\n    if ((this.binding = this.createTwowayBinding())) {\n      this.binding.bind();\n      if (this.rendered) this.binding.render();\n    }\n  }\n\n  render(target, occupants) {\n    // TODO determine correct namespace\n    this.namespace = getNamespace(this);\n\n    let node;\n    let existing = false;\n\n    if (occupants) {\n      let n;\n      while ((n = occupants.shift())) {\n        if (\n          n.nodeName.toUpperCase() === this.template.e.toUpperCase() &&\n          n.namespaceURI === this.namespace\n        ) {\n          this.node = node = n;\n          existing = true;\n          break;\n        } else {\n          detachNode(n);\n        }\n      }\n    }\n\n    if (!existing && this.node) {\n      node = this.node;\n      target.appendChild(node);\n      existing = true;\n    }\n\n    if (!node) {\n      const name = this.template.e;\n      node = createElement(\n        this.namespace === html ? name.toLowerCase() : name,\n        this.namespace,\n        this.getAttribute('is')\n      );\n      this.node = node;\n    }\n\n    // tie the node to this vdom element\n    defineProperty(node, '_ractive', {\n      value: {\n        proxy: this\n      },\n      configurable: true\n    });\n\n    if (existing && this.foundNode) this.foundNode(node);\n\n    // register intro before rendering content so children can find the intro\n    const intro = this.intro;\n    if (intro && intro.shouldFire('intro')) {\n      intro.isIntro = true;\n      intro.isOutro = false;\n      runloop.registerTransition(intro);\n    }\n\n    if (this.fragment) {\n      const children = existing ? toArray(node.childNodes) : undefined;\n\n      this.fragment.render(node, children);\n\n      // clean up leftover children\n      if (children) {\n        children.forEach(detachNode);\n      }\n    }\n\n    if (existing) {\n      // store initial values for two-way binding\n      if (this.binding && this.binding.wasUndefined) this.binding.setFromNode(node);\n      // remove unused attributes\n      let i = node.attributes.length;\n      while (i--) {\n        const name = node.attributes[i].name;\n        if (!(name in this.attributeByName)) node.removeAttribute(name);\n      }\n    }\n\n    // Is this a top-level node of a component? If so, we may need to add\n    // a data-ractive-css attribute, for CSS encapsulation\n    if (this.up.cssIds) {\n      node.setAttribute('data-ractive-css', this.up.cssIds.map(x => `{${x}}`).join(' '));\n    }\n\n    if (this.attributes) this.attributes.forEach(render);\n    if (this.binding) this.binding.render();\n\n    if (!this.up.delegate && this.listeners) {\n      const ls = this.listeners;\n      for (const k in ls) {\n        if (ls[k] && ls[k].length) this.node.addEventListener(k, handler, !!ls[k].refs);\n      }\n    }\n\n    if (!existing) {\n      target.appendChild(node);\n    }\n\n    this.rendered = true;\n  }\n\n  toString() {\n    const tagName = this.template.e;\n\n    let attrs = (this.attributes && this.attributes.map(stringifyAttribute).join('')) || '';\n\n    // Special case - selected options\n    if (this.name === 'option' && this.isSelected()) {\n      attrs += ' selected';\n    }\n\n    // Special case - two-way radio name bindings\n    if (this.name === 'input' && inputIsCheckedRadio(this)) {\n      attrs += ' checked';\n    }\n\n    // Special case style and class attributes and directives\n    let style, cls;\n    this.attributes &&\n      this.attributes.forEach(attr => {\n        if (attr.name === 'class') {\n          cls = (cls || '') + (cls ? ' ' : '') + safeAttributeString(attr.getString());\n        } else if (attr.name === 'style') {\n          style = (style || '') + (style ? ' ' : '') + safeAttributeString(attr.getString());\n          if (style && !endsWithSemi.test(style)) style += ';';\n        } else if (attr.style) {\n          style =\n            (style || '') +\n            (style ? ' ' : '') +\n            `${attr.style}: ${safeAttributeString(attr.getString())};`;\n        } else if (attr.inlineClass && attr.getValue()) {\n          cls = (cls || '') + (cls ? ' ' : '') + attr.inlineClass;\n        }\n      });\n    // put classes first, then inline style\n    if (style !== undefined) attrs = ' style' + (style ? `=\"${style}\"` : '') + attrs;\n    if (cls !== undefined) attrs = ' class' + (cls ? `=\"${cls}\"` : '') + attrs;\n\n    if (this.up.cssIds) {\n      attrs += ` data-ractive-css=\"${this.up.cssIds.map(x => `{${x}}`).join(' ')}\"`;\n    }\n\n    let str = `<${tagName}${attrs}>`;\n\n    if (voidElementNames.test(this.name)) return str;\n\n    // Special case - textarea\n    if (this.name === 'textarea' && this.getAttribute('value') !== undefined) {\n      str += escapeHtml(this.getAttribute('value'));\n    } else if (this.getAttribute('contenteditable') !== undefined) {\n      // Special case - contenteditable\n      str += this.getAttribute('value') || '';\n    }\n\n    if (this.fragment) {\n      str += this.fragment.toString(!/^(?:script|style)$/i.test(this.template.e)); // escape text unless script/style\n    }\n\n    str += `</${tagName}>`;\n    return str;\n  }\n\n  unbind() {\n    const attrs = this.attributes;\n    if (attrs) {\n      attrs.unbinding = true;\n      attrs.forEach(unbind);\n      attrs.unbinding = false;\n    }\n\n    if (this.binding) this.binding.unbind();\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (!this.rendered) return;\n    this.rendered = false;\n\n    // unrendering before intro completed? complete it now\n    // TODO should be an API for aborting transitions\n    const transition = this.intro;\n    if (transition && transition.complete) transition.complete();\n\n    // Detach as soon as we can\n    if (this.name === 'option') {\n      // <option> elements detach immediately, so that\n      // their parent <select> element syncs correctly, and\n      // since option elements can't have transitions anyway\n      this.detach();\n    } else if (shouldDestroy) {\n      runloop.detachWhenReady(this);\n    }\n\n    // outro transition\n    const outro = this.outro;\n    if (outro && outro.shouldFire('outro')) {\n      outro.isIntro = false;\n      outro.isOutro = true;\n      runloop.registerTransition(outro);\n    }\n\n    if (this.fragment) this.fragment.unrender();\n\n    if (this.binding) this.binding.unrender();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n\n      this.attributes && this.attributes.forEach(update);\n\n      if (this.fragment) this.fragment.update();\n    }\n  }\n}\n\nfunction inputIsCheckedRadio(element) {\n  const nameAttr = element.attributeByName.name;\n  return (\n    element.getAttribute('type') === 'radio' &&\n    (nameAttr || {}).interpolator &&\n    element.getAttribute('value') === nameAttr.interpolator.model.get()\n  );\n}\n\nfunction stringifyAttribute(attribute) {\n  const str = attribute.toString();\n  return str ? ' ' + str : '';\n}\n\nfunction getNamespace(element) {\n  // Use specified namespace...\n  const xmlns = element.getAttribute('xmlns');\n  if (xmlns) return xmlns;\n\n  // ...or SVG namespace, if this is an <svg> element\n  if (element.name === 'svg') return svg;\n\n  const parent = element.parent;\n\n  if (parent) {\n    // ...or HTML, if the parent is a <foreignObject>\n    if (parent.name === 'foreignobject') return html;\n\n    // ...or inherit from the parent node\n    return parent.node.namespaceURI;\n  }\n\n  return element.ractive.el.namespaceURI;\n}\n\nfunction delegateHandler(ev) {\n  const name = ev.type;\n  const end = ev.currentTarget;\n  const endEl = end._ractive && end._ractive.proxy;\n  let node = ev.target;\n  let bubble = true;\n  let listeners;\n\n  // starting with the origin node, walk up the DOM looking for ractive nodes with a matching event listener\n  while (bubble && node && node !== end) {\n    const proxy = node._ractive && node._ractive.proxy;\n    if (proxy && proxy.up.delegate === endEl && shouldFire(ev, node, end)) {\n      listeners = proxy.listeners && proxy.listeners[name];\n\n      if (listeners) {\n        listeners.forEach(l => {\n          bubble = l.call(node, ev) !== false && bubble;\n        });\n      }\n    }\n\n    node = node.parentNode || node.correspondingUseElement; // SVG with a <use> element in certain environments\n  }\n\n  return bubble;\n}\n\nconst UIEvent = win !== null ? win.UIEvent : null;\nfunction shouldFire(event, start, end) {\n  if (UIEvent && event instanceof UIEvent) {\n    let node = start;\n    while (node && node !== end) {\n      if (node.disabled) return false;\n      node = node.parentNode || node.correspondingUseElement;\n    }\n  }\n\n  return true;\n}\n\nfunction handler(ev) {\n  const el = this._ractive.proxy;\n  if (!el.listeners || !el.listeners[ev.type]) return;\n  el.listeners[ev.type].forEach(l => l.call(this, ev));\n}\n","import runloop from 'src/global/runloop';\nimport Element from '../../Element';\n\nexport default class Form extends Element {\n  constructor(options) {\n    super(options);\n    this.formBindings = [];\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.on('reset', handleReset);\n  }\n\n  unrender(shouldDestroy) {\n    this.off('reset', handleReset);\n    super.unrender(shouldDestroy);\n  }\n}\n\nfunction handleReset() {\n  const element = this._ractive.proxy;\n\n  runloop.start();\n  element.formBindings.forEach(updateModel);\n  runloop.end();\n}\n\nfunction updateModel(binding) {\n  binding.model.set(binding.resetValue);\n}\n","import { fatal } from 'utils/log';\nimport runloop from 'src/global/runloop';\nimport { win } from 'config/environment';\n\n// because IE\nconst whitelist = {\n  animationend: 1,\n  animationiteration: 1,\n  animationstart: 1,\n  transitioncancel: 1,\n  transitionend: 1,\n  transitionstart: 1,\n  transitionrun: 1\n};\n\nclass DOMEvent {\n  constructor(name, owner) {\n    if (name.indexOf('*') !== -1) {\n      fatal(\n        `Only component proxy-events may contain \"*\" wildcards, <${\n          owner.name\n        } on-${name}=\"...\"/> is not valid`\n      );\n    }\n\n    this.name = name;\n    this.owner = owner;\n    this.handler = null;\n  }\n\n  bind() {}\n\n  render(directive) {\n    // schedule events so that they take place after twoway binding\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n      const name = this.name;\n      const on = `on${name}`;\n\n      // this is probably a custom event fired from a decorator or manually\n      if (!(on in node) && !(on in win) && !whitelist[name]) return;\n\n      this.owner.on(\n        name,\n        (this.handler = event => {\n          return directive.fire({\n            node,\n            original: event,\n            event,\n            name\n          });\n        })\n      );\n    }, true);\n  }\n\n  unbind() {}\n\n  unrender() {\n    if (this.handler) this.owner.off(this.name, this.handler);\n  }\n}\n\nclass CustomEvent {\n  constructor(eventPlugin, owner, name) {\n    this.eventPlugin = eventPlugin;\n    this.owner = owner;\n    this.name = name;\n    this.handler = null;\n  }\n\n  bind() {}\n\n  render(directive) {\n    runloop.scheduleTask(() => {\n      const node = this.owner.node;\n\n      this.handler = this.eventPlugin(node, (event = {}) => {\n        if (event.original) event.event = event.original;\n        else event.original = event.event;\n\n        event.name = this.name;\n        event.node = event.node || node;\n        return directive.fire(event);\n      });\n    });\n  }\n\n  unbind() {}\n\n  unrender() {\n    this.handler.teardown();\n  }\n}\n\nexport { DOMEvent, CustomEvent };\n","import Context from '../../../shared/Context';\n\nexport default class RactiveEvent {\n  constructor(component, name) {\n    this.component = component;\n    this.name = name;\n    this.handler = null;\n  }\n\n  bind(directive) {\n    const ractive = this.component.instance;\n\n    this.handler = ractive.on(this.name, (...args) => {\n      // watch for reproxy\n      if (args[0] instanceof Context) {\n        const ctx = args.shift();\n        ctx.component = ractive;\n        directive.fire(ctx, args);\n      } else {\n        directive.fire({}, args);\n      }\n\n      // cancel bubbling\n      return false;\n    });\n  }\n\n  render() {}\n\n  unbind() {\n    this.handler.cancel();\n  }\n\n  unrender() {}\n}\n","import { ANCHOR, COMPONENT } from 'config/types';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport fireEvent from 'src/events/fireEvent';\nimport { splitKeypath } from 'shared/keypaths';\nimport { findInViewHierarchy } from 'shared/registry';\nimport findElement from './findElement';\nimport { DOMEvent, CustomEvent } from '../element/ElementEvents';\nimport RactiveEvent from '../component/RactiveEvent';\nimport { resolveArgs, setupArgsFn } from '../shared/directiveArgs';\nimport Context from 'src/shared/Context';\nimport { isArray, isString } from 'utils/is';\n\nconst specialPattern = /^(event|arguments|@node|@event|@context)(\\..+)?$/;\nconst dollarArgsPattern = /^\\$(\\d+)(\\..+)?$/;\n\nexport default class EventDirective {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up, true);\n    this.template = options.template;\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n    //const delegate = this.delegate = this.ractive.delegate && options.up.delegate;\n    this.events = [];\n\n    if (this.element.type === COMPONENT || this.element.type === ANCHOR) {\n      this.template.n.forEach(n => {\n        this.events.push(new RactiveEvent(this.element, n));\n      });\n    } else {\n      // make sure the delegate element has a storag object\n      //if ( delegate && !delegate.delegates ) delegate.delegates = {};\n\n      this.template.n.forEach(n => {\n        const fn = findInViewHierarchy('events', this.ractive, n);\n        if (fn) {\n          this.events.push(new CustomEvent(fn, this.element, n));\n        } else {\n          this.events.push(new DOMEvent(n, this.element));\n        }\n      });\n    }\n\n    // method calls\n    this.models = null;\n  }\n\n  bind() {\n    addToArray(this.element.events || (this.element.events = []), this);\n\n    setupArgsFn(this, this.template);\n    if (!this.fn) this.action = this.template.f;\n\n    this.events.forEach(e => e.bind(this));\n  }\n\n  destroyed() {\n    this.events.forEach(e => e.unrender());\n  }\n\n  fire(event, args = []) {\n    const context =\n      event instanceof Context && event.refire ? event : this.element.getContext(event);\n\n    if (this.fn) {\n      const values = [];\n\n      const models = resolveArgs(this, this.template, this.up, {\n        specialRef(ref) {\n          const specialMatch = specialPattern.exec(ref);\n          if (specialMatch) {\n            // on-click=\"foo(event.node)\"\n            return {\n              special: specialMatch[1],\n              keys: specialMatch[2] ? splitKeypath(specialMatch[2].substr(1)) : []\n            };\n          }\n\n          const dollarMatch = dollarArgsPattern.exec(ref);\n          if (dollarMatch) {\n            // on-click=\"foo($1)\"\n            return {\n              special: 'arguments',\n              keys: [dollarMatch[1] - 1].concat(\n                dollarMatch[2] ? splitKeypath(dollarMatch[2].substr(1)) : []\n              )\n            };\n          }\n        }\n      });\n\n      if (models) {\n        models.forEach(model => {\n          if (!model) return values.push(undefined);\n\n          if (model.special) {\n            const which = model.special;\n            let obj;\n\n            if (which === '@node') {\n              obj = this.element.node;\n            } else if (which === '@event') {\n              obj = event && event.event;\n            } else if (which === 'event') {\n              warnOnceIfDebug(\n                `The event reference available to event directives is deprecated and should be replaced with @context and @event`\n              );\n              obj = context;\n            } else if (which === '@context') {\n              obj = context;\n            } else {\n              obj = args;\n            }\n\n            const keys = model.keys.slice();\n\n            while (obj && keys.length) obj = obj[keys.shift()];\n            return values.push(obj);\n          }\n\n          if (model.wrapper) {\n            return values.push(model.wrapperValue);\n          }\n\n          values.push(model.get());\n        });\n      }\n\n      // make event available as `this.event`\n      const ractive = this.ractive;\n      const oldEvent = ractive.event;\n\n      ractive.event = context;\n      const returned = this.fn.apply(ractive, values);\n      let result = returned.pop();\n\n      // Auto prevent and stop if return is explicitly false\n      if (result === false) {\n        const original = event ? event.original : undefined;\n        if (original) {\n          original.preventDefault && original.preventDefault();\n          original.stopPropagation && original.stopPropagation();\n        } else {\n          warnOnceIfDebug(\n            `handler '${this.template.n.join(\n              ' '\n            )}' returned false, but there is no event available to cancel`\n          );\n        }\n      } else if (!returned.length && isArray(result) && isString(result[0])) {\n        // watch for proxy events\n        result = fireEvent(this.ractive, result.shift(), context, result);\n      }\n\n      ractive.event = oldEvent;\n\n      return result;\n    } else {\n      return fireEvent(this.ractive, this.action, context, args);\n    }\n  }\n\n  handleChange() {}\n\n  render() {\n    this.events.forEach(e => e.render(this));\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    removeFromArray(this.element.events, this);\n    this.events.forEach(e => e.unbind());\n  }\n\n  unrender() {\n    this.events.forEach(e => e.unrender());\n  }\n}\n\nEventDirective.prototype.update = noop;\n","import { rebindMatch } from 'shared/rebind';\nimport Item, { ContainerItem } from './Item';\nimport resolve from '../../resolvers/resolve';\nimport { assign } from 'utils/object';\n\nexport default class Mustache extends Item {\n  constructor(options) {\n    super(options);\n\n    if (options.owner) this.parent = options.owner;\n\n    this.isStatic = !!options.template.s;\n\n    this.model = null;\n    this.dirty = false;\n  }\n\n  bind() {\n    // yield mustaches should resolve in container context\n    const start = this.containerFragment || this.up;\n    // try to find a model for this view\n    const model = resolve(start, this.template);\n\n    if (model) {\n      const value = model.get();\n\n      if (this.isStatic) {\n        this.model = { get: () => value };\n        model.unreference();\n        return;\n      }\n\n      model.register(this);\n      this.model = model;\n    }\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    next = rebindMatch(this.template, next, previous, this.up);\n    if (next === this.model) return false;\n\n    if (this.model) {\n      this.model.unregister(this);\n    }\n    if (next) next.addShuffleRegister(this, 'mark');\n    this.model = next;\n    if (!safe) this.handleChange();\n    return true;\n  }\n\n  unbind() {\n    if (!this.isStatic) {\n      this.model && this.model.unregister(this);\n      this.model = undefined;\n    }\n  }\n}\n\nexport function MustacheContainer(options) {\n  Mustache.call(this, options);\n}\n\nconst proto = (MustacheContainer.prototype = Object.create(ContainerItem.prototype));\n\nassign(proto, Mustache.prototype, { constructor: MustacheContainer });\n","import progressiveText from './shared/progressiveText';\nimport { escapeHtml } from 'utils/html';\nimport { safeToStringValue } from 'utils/dom';\nimport { detachNode } from 'utils/dom';\nimport Mustache from './shared/Mustache';\nimport { inAttributes } from './element/ConditionalAttribute';\n\nexport default class Interpolator extends Mustache {\n  bubble() {\n    if (this.owner) this.owner.bubble();\n    super.bubble();\n  }\n\n  detach() {\n    return detachNode(this.node);\n  }\n\n  firstNode() {\n    return this.node;\n  }\n\n  getString() {\n    return this.model ? safeToStringValue(this.model.get()) : '';\n  }\n\n  render(target, occupants) {\n    if (inAttributes()) return;\n    const value = this.getString();\n\n    this.rendered = true;\n\n    progressiveText(this, target, occupants, value);\n  }\n\n  toString(escape) {\n    const string = this.getString();\n    return escape ? escapeHtml(string) : string;\n  }\n\n  unrender(shouldDestroy) {\n    if (shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.rendered) {\n        this.node.data = this.getString();\n      }\n    }\n  }\n\n  valueOf() {\n    return this.model ? this.model.get() : undefined;\n  }\n}\n","import Element from '../../Element';\nimport { isFunction } from 'utils/is';\n\nexport default class Input extends Element {\n  render(target, occupants) {\n    super.render(target, occupants);\n    this.node.defaultValue = this.node.value;\n  }\n  compare(value, attrValue) {\n    const comparator = this.getAttribute('value-comparator');\n    if (comparator) {\n      if (isFunction(comparator)) {\n        return comparator(value, attrValue);\n      }\n      if (value && attrValue) {\n        return value[comparator] == attrValue[comparator];\n      }\n    }\n    return value == attrValue;\n  }\n}\n","import Parser from 'parse/Parser';\nimport readStringLiteral from 'parse/converters/expressions/primary/literal/readStringLiteral';\nimport readKey from 'parse/converters/expressions/shared/readKey';\nimport { hasOwn, keys } from 'utils/object';\n\n// simple JSON parser, without the restrictions of JSON parse\n// (i.e. having to double-quote keys).\n//\n// If passed a hash of values as the second argument, ${placeholders}\n// will be replaced with those values\n\nconst specials = {\n  true: true,\n  false: false,\n  null: null,\n  undefined\n};\n\nconst specialsPattern = new RegExp('^(?:' + keys(specials).join('|') + ')');\nconst numberPattern = /^(?:[+-]?)(?:(?:(?:0|[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\nconst placeholderPattern = /\\$\\{([^\\}]+)\\}/g;\nconst placeholderAtStartPattern = /^\\$\\{([^\\}]+)\\}/;\nconst onlyWhitespace = /^\\s*$/;\n\nconst JsonParser = Parser.extend({\n  init(str, options) {\n    this.values = options.values;\n    this.sp();\n  },\n\n  postProcess(result) {\n    if (result.length !== 1 || !onlyWhitespace.test(this.leftover)) {\n      return null;\n    }\n\n    return { value: result[0].v };\n  },\n\n  converters: [\n    function getPlaceholder(parser) {\n      if (!parser.values) return null;\n\n      const placeholder = parser.matchPattern(placeholderAtStartPattern);\n\n      if (placeholder && hasOwn(parser.values, placeholder)) {\n        return { v: parser.values[placeholder] };\n      }\n    },\n\n    function getSpecial(parser) {\n      const special = parser.matchPattern(specialsPattern);\n      if (special) return { v: specials[special] };\n    },\n\n    function getNumber(parser) {\n      const number = parser.matchPattern(numberPattern);\n      if (number) return { v: +number };\n    },\n\n    function getString(parser) {\n      const stringLiteral = readStringLiteral(parser);\n      const values = parser.values;\n\n      if (stringLiteral && values) {\n        return {\n          v: stringLiteral.v.replace(\n            placeholderPattern,\n            (match, $1) => ($1 in values ? values[$1] : $1)\n          )\n        };\n      }\n\n      return stringLiteral;\n    },\n\n    function getObject(parser) {\n      if (!parser.matchString('{')) return null;\n\n      const result = {};\n\n      parser.sp();\n\n      if (parser.matchString('}')) {\n        return { v: result };\n      }\n\n      let pair;\n      while ((pair = getKeyValuePair(parser))) {\n        result[pair.key] = pair.value;\n\n        parser.sp();\n\n        if (parser.matchString('}')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n      }\n\n      return null;\n    },\n\n    function getArray(parser) {\n      if (!parser.matchString('[')) return null;\n\n      const result = [];\n\n      parser.sp();\n\n      if (parser.matchString(']')) {\n        return { v: result };\n      }\n\n      let valueToken;\n      while ((valueToken = parser.read())) {\n        result.push(valueToken.v);\n\n        parser.sp();\n\n        if (parser.matchString(']')) {\n          return { v: result };\n        }\n\n        if (!parser.matchString(',')) {\n          return null;\n        }\n\n        parser.sp();\n      }\n\n      return null;\n    }\n  ]\n});\n\nfunction getKeyValuePair(parser) {\n  parser.sp();\n\n  const key = readKey(parser);\n\n  if (!key) return null;\n\n  const pair = { key };\n\n  parser.sp();\n  if (!parser.matchString(':')) {\n    return null;\n  }\n  parser.sp();\n\n  const valueToken = parser.read();\n\n  if (!valueToken) return null;\n\n  pair.value = valueToken.v;\n  return pair;\n}\n\nexport default function(str, values) {\n  const parser = new JsonParser(str, { values });\n  return parser.result;\n}\n","import { INTERPOLATOR } from '../../../config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport parseJSON from '../../../utils/parseJSON';\nimport resolve from '../../resolvers/resolve';\nimport runloop from '../../../global/runloop';\nimport { warnIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isArray, isObjectType, isString } from 'utils/is';\n\nexport default class Mapping extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = this.element.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.element.attributeByName[this.name] = this;\n\n    this.value = options.template.f;\n  }\n\n  bind() {\n    const template = this.template.f;\n    const viewmodel = this.element.instance.viewmodel;\n\n    if (template === 0) {\n      // empty attributes are `true`\n      viewmodel.joinKey(this.name).set(true);\n    } else if (isString(template)) {\n      const parsed = parseJSON(template);\n      viewmodel.joinKey(this.name).set(parsed ? parsed.value : template);\n    } else if (isArray(template)) {\n      createMapping(this, true);\n    }\n  }\n\n  render() {}\n\n  unbind() {\n    if (this.model) this.model.unregister(this);\n    if (this.boundFragment) this.boundFragment.unbind();\n\n    if (this.element.bound) {\n      if (this.link.target === this.model) this.link.owner.unlink();\n    }\n  }\n\n  unrender() {}\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.boundFragment) this.boundFragment.update();\n    }\n  }\n}\n\nfunction createMapping(item) {\n  const template = item.template.f;\n  const viewmodel = item.element.instance.viewmodel;\n  const childData = viewmodel.value;\n\n  if (template.length === 1 && template[0].t === INTERPOLATOR) {\n    const model = resolve(item.up, template[0]);\n    const val = model.get(false);\n\n    // if the interpolator is not static\n    if (!template[0].s) {\n      item.model = model;\n      item.link = viewmodel.createLink(item.name, model, template[0].r, {\n        mapping: true\n      });\n\n      // initialize parent side of the mapping from child data\n      if (val === undefined && !model.isReadonly && item.name in childData) {\n        model.set(childData[item.name]);\n      }\n    } else if (!isObjectType(val) || template[0].x) {\n      // copy non-object, non-computed vals through\n      viewmodel.joinKey(splitKeypath(item.name)).set(val);\n    } else {\n      // warn about trying to copy an object\n      warnIfDebug(`Cannot copy non-computed object value from static mapping '${item.name}'`);\n    }\n\n    // if the item isn't going to manage the model, give it a chance to tear down if it's computed\n    if (model !== item.model) model.unregister();\n  } else {\n    item.boundFragment = new Fragment({\n      owner: item,\n      template\n    }).bind();\n\n    item.model = viewmodel.joinKey(splitKeypath(item.name));\n    item.model.set(item.boundFragment.valueOf());\n\n    // item is a *bit* of a hack\n    item.boundFragment.bubble = () => {\n      Fragment.prototype.bubble.call(item.boundFragment);\n      // defer this to avoid mucking around model deps if there happens to be an expression involved\n      runloop.scheduleTask(() => {\n        item.boundFragment.update();\n        item.model.set(item.boundFragment.valueOf());\n      });\n    };\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Element from '../../Element';\nimport findElement from '../../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class Option extends Element {\n  constructor(options) {\n    const template = options.template;\n    if (!template.a) template.a = {};\n\n    // If the value attribute is missing, use the element's content,\n    // as long as it isn't disabled\n    if (template.a.value === undefined && !('disabled' in template.a)) {\n      template.a.value = template.f || '';\n    }\n\n    super(options);\n\n    this.select = findElement(this.parent || this.up, false, 'select');\n  }\n\n  bind() {\n    if (!this.select) {\n      super.bind();\n      return;\n    }\n\n    // If the select has a value, it overrides the `selected` attribute on\n    // this option - so we delete the attribute\n    const selectedAttribute = this.attributeByName.selected;\n    if (selectedAttribute && this.select.getAttribute('value') !== undefined) {\n      const index = this.attributes.indexOf(selectedAttribute);\n      this.attributes.splice(index, 1);\n      delete this.attributeByName.selected;\n    }\n\n    super.bind();\n    this.select.options.push(this);\n  }\n\n  bubble() {\n    // if we're using content as value, may need to update here\n    const value = this.getAttribute('value');\n    if (this.node && this.node.value !== value) {\n      this.node._ractive.value = value;\n    }\n    super.bubble();\n  }\n\n  getAttribute(name) {\n    const attribute = this.attributeByName[name];\n    return attribute\n      ? attribute.getValue()\n      : name === 'value' && this.fragment\n        ? this.fragment.valueOf()\n        : undefined;\n  }\n\n  isSelected() {\n    const optionValue = this.getAttribute('value');\n\n    if (optionValue === undefined || !this.select) {\n      return false;\n    }\n\n    const selectValue = this.select.getAttribute('value');\n\n    if (this.select.compare(selectValue, optionValue)) {\n      return true;\n    }\n\n    if (this.select.getAttribute('multiple') && isArray(selectValue)) {\n      let i = selectValue.length;\n      while (i--) {\n        if (this.select.compare(selectValue[i], optionValue)) {\n          return true;\n        }\n      }\n    }\n  }\n\n  render(target, occupants) {\n    super.render(target, occupants);\n\n    if (!this.attributeByName.value) {\n      this.node._ractive.value = this.getAttribute('value');\n    }\n  }\n\n  unbind() {\n    super.unbind();\n\n    if (this.select) {\n      removeFromArray(this.select.options, this);\n    }\n  }\n}\n","import { ELEMENT, PARTIAL, SECTION, SECTION_WITH, YIELDER } from 'config/types';\nimport { assign, create, hasOwn, keys } from 'utils/object';\nimport { isArray, isFunction, isObjectType, isString } from 'utils/is';\nimport noop from 'utils/noop';\nimport { MustacheContainer } from './shared/Mustache';\nimport Fragment from '../Fragment';\nimport getPartialTemplate from './partial/getPartialTemplate';\nimport { resolveAliases } from './Alias';\nimport { warnOnceIfDebug, warnIfDebug } from 'utils/log';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport runloop from 'src/global/runloop';\nimport { applyCSS } from 'src/global/css';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function Partial(options) {\n  MustacheContainer.call(this, options);\n\n  const tpl = options.template;\n\n  // yielder is a special form of partial that will later require special handling\n  if (tpl.t === YIELDER) {\n    this.yielder = 1;\n  } else if (tpl.t === ELEMENT) {\n    // this is a macro partial, complete with macro constructor\n    // leaving this as an element will confuse up-template searches\n    this.type = PARTIAL;\n    this.macro = options.macro;\n  }\n}\n\nconst proto = (Partial.prototype = create(MustacheContainer.prototype));\n\nassign(proto, {\n  constructor: Partial,\n\n  bind() {\n    const template = this.template;\n\n    if (this.yielder) {\n      // the container is the instance that owns this node\n      this.container = this.up.ractive;\n      this.component = this.container.component;\n      this.containerFragment = this.up;\n\n      // normal component\n      if (this.component) {\n        // yields skip the owning instance and go straight to the surrounding context\n        this.up = this.component.up;\n\n        // {{yield}} is equivalent to {{yield content}}\n        if (!template.r && !template.x && !template.tx) this.refName = 'content';\n      } else {\n        // plain-ish instance that may be attached to a parent later\n        this.fragment = new Fragment({\n          owner: this,\n          template: []\n        });\n        this.fragment.bind();\n        return;\n      }\n    }\n\n    // this is a macro/super partial\n    if (this.macro) {\n      this.fn = this.macro;\n    } else {\n      // this is a plain partial or yielder\n      if (!this.refName) this.refName = template.r;\n\n      // if the refName exists as a partial, this is a plain old partial reference where no model binding will happen\n      if (this.refName) {\n        partialFromValue(this, this.refName);\n      }\n\n      // this is a dynamic/inline partial\n      if (!this.partial && !this.fn) {\n        MustacheContainer.prototype.bind.call(this);\n        if (this.model) partialFromValue(this, this.model.get());\n      }\n    }\n\n    if (!this.partial && !this.fn) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    createFragment(this, this.partial || []);\n\n    // macro/super partial\n    if (this.fn) initMacro(this);\n\n    this.fragment.bind();\n  },\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n\n      if (this.yielder) {\n        this.containerFragment.bubble();\n      } else {\n        this.up.bubble();\n      }\n    }\n  },\n\n  findNextNode() {\n    return (this.containerFragment || this.up).findNextNode(this);\n  },\n\n  handleChange() {\n    this.dirtyTemplate = true;\n    this.externalChange = true;\n    this.bubble();\n  },\n\n  refreshAttrs() {\n    keys(this._attrs).forEach(k => {\n      this.handle.attributes[k] = this._attrs[k].valueOf();\n    });\n  },\n\n  resetTemplate() {\n    if (this.fn && this.proxy) {\n      if (this.externalChange) {\n        if (isFunction(this.proxy.teardown)) this.proxy.teardown();\n        this.fn = this.proxy = null;\n      } else {\n        this.partial = this.fnTemplate;\n        return true;\n      }\n    }\n\n    const partial = this.partial;\n    this.partial = null;\n\n    if (this.refName) {\n      this.partial = getPartialTemplate(this.ractive, this.refName, this.up);\n    }\n\n    if (!this.partial && this.model) {\n      partialFromValue(this, this.model.get());\n    }\n\n    if (!this.fn && partial === this.partial) return false;\n\n    this.unbindAttrs();\n\n    if (this.fn) {\n      initMacro(this);\n      if (isFunction(this.proxy.render)) runloop.scheduleTask(() => this.proxy.render());\n    } else if (!this.partial) {\n      warnOnceIfDebug(`Could not find template for partial '${this.name}'`);\n    }\n\n    return true;\n  },\n\n  render(target, occupants) {\n    if (this.fn && this.fn._cssDef && !this.fn._cssDef.applied) applyCSS();\n\n    this.fragment.render(target, occupants);\n\n    if (this.proxy && isFunction(this.proxy.render)) this.proxy.render();\n  },\n\n  unbind() {\n    this.fragment.unbind();\n\n    this.fragment.aliases = null;\n\n    this.unbindAttrs();\n\n    MustacheContainer.prototype.unbind.call(this);\n  },\n\n  unbindAttrs() {\n    if (this._attrs) {\n      keys(this._attrs).forEach(k => {\n        this._attrs[k].unbind();\n      });\n    }\n  },\n\n  unrender(shouldDestroy) {\n    if (this.proxy && isFunction(this.proxy.teardown)) this.proxy.teardown();\n\n    this.fragment.unrender(shouldDestroy);\n  },\n\n  update() {\n    const proxy = this.proxy;\n    this.updating = 1;\n\n    if (this.dirtyAttrs) {\n      this.dirtyAttrs = false;\n      this.refreshAttrs();\n      if (isFunction(proxy.update)) proxy.update(this.handle.attributes);\n    }\n\n    if (this.dirtyTemplate) {\n      this.dirtyTemplate = false;\n      this.resetTemplate() && this.fragment.resetTemplate(this.partial || []);\n    }\n\n    if (this.dirty) {\n      this.dirty = false;\n      if (proxy && isFunction(proxy.invalidate)) proxy.invalidate();\n      this.fragment.update();\n    }\n\n    this.externalChange = false;\n    this.updating = 0;\n  }\n});\n\nfunction createFragment(self, partial) {\n  self.partial = partial;\n  contextifyTemplate(self);\n\n  const options = {\n    owner: self,\n    template: self.partial\n  };\n\n  if (self.yielder) options.ractive = self.container.parent;\n\n  if (self.fn) options.cssIds = self.fn._cssIds;\n\n  const fragment = (self.fragment = new Fragment(options));\n\n  // partials may have aliases that need to be in place before binding\n  if (self.template.z) {\n    fragment.aliases = resolveAliases(self.template.z, self.containerFragment || self.up);\n  }\n}\n\nfunction contextifyTemplate(self) {\n  if (self.template.c) {\n    self.partial = [{ t: SECTION, n: SECTION_WITH, f: self.partial }];\n    assign(self.partial[0], self.template.c);\n  }\n}\n\nfunction partialFromValue(self, value, okToParse) {\n  let tpl = value;\n\n  if (isArray(tpl)) {\n    self.partial = tpl;\n  } else if (tpl && isObjectType(tpl)) {\n    if (isArray(tpl.t)) self.partial = tpl.t;\n    else if (isString(tpl.template))\n      self.partial = parsePartial(tpl.template, tpl.template, self.ractive).t;\n  } else if (isFunction(tpl) && tpl.styleSet) {\n    self.fn = tpl;\n    if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n  } else if (tpl != null) {\n    tpl = getPartialTemplate(self.ractive, '' + tpl, self.containerFragment || self.up);\n    if (tpl) {\n      self.name = value;\n      if (tpl.styleSet) {\n        self.fn = tpl;\n        if (self.fragment) self.fragment.cssIds = tpl._cssIds;\n      } else self.partial = tpl;\n    } else if (okToParse) {\n      self.partial = parsePartial('' + value, '' + value, self.ractive).t;\n    } else {\n      self.name = value;\n    }\n  }\n\n  return self.partial;\n}\n\nfunction setTemplate(template) {\n  partialFromValue(this, template, true);\n\n  if (!this.initing) {\n    this.dirtyTemplate = true;\n    this.fnTemplate = this.partial;\n\n    if (this.updating) {\n      this.bubble();\n      runloop.promise();\n    } else {\n      const promise = runloop.start();\n\n      this.bubble();\n      runloop.end();\n\n      return promise;\n    }\n  }\n}\n\nfunction aliasLocal(ref, name) {\n  const aliases = this.fragment.aliases || (this.fragment.aliases = {});\n  if (!name) {\n    aliases[ref] = this._data;\n  } else {\n    aliases[name] = this._data.joinAll(splitKeypath(ref));\n  }\n}\n\nconst extras = 'extra-attributes';\n\nfunction initMacro(self) {\n  const fn = self.fn;\n  const fragment = self.fragment;\n\n  // defensively copy the template in case it changes\n  const template = (self.template = assign({}, self.template));\n  const handle = (self.handle = fragment.getContext({\n    proxy: self,\n    aliasLocal,\n    name: self.template.e || self.name,\n    attributes: {},\n    setTemplate: setTemplate.bind(self),\n    template\n  }));\n\n  if (!template.p) template.p = {};\n  template.p = handle.partials = assign({}, template.p);\n  if (!hasOwn(template.p, 'content')) template.p.content = template.f || [];\n\n  if (isArray(fn.attributes)) {\n    self._attrs = {};\n\n    const invalidate = function() {\n      this.dirty = true;\n      self.dirtyAttrs = true;\n      self.bubble();\n    };\n\n    if (isArray(template.m)) {\n      const attrs = template.m;\n      template.p[extras] = template.m = attrs.filter(a => !~fn.attributes.indexOf(a.n));\n      attrs.filter(a => ~fn.attributes.indexOf(a.n)).forEach(a => {\n        const fragment = new Fragment({\n          template: a.f,\n          owner: self\n        });\n        fragment.bubble = invalidate;\n        fragment.findFirstNode = noop;\n        self._attrs[a.n] = fragment;\n      });\n    } else {\n      template.p[extras] = [];\n    }\n  } else {\n    template.p[extras] = template.m;\n  }\n\n  if (self._attrs) {\n    keys(self._attrs).forEach(k => {\n      self._attrs[k].bind();\n    });\n    self.refreshAttrs();\n  }\n\n  self.initing = 1;\n  self.proxy = fn(handle, handle.attributes) || {};\n  if (!self.partial) self.partial = [];\n  self.fnTemplate = self.partial;\n  self.initing = 0;\n\n  contextifyTemplate(self);\n  fragment.resetTemplate(self.partial);\n}\n\nfunction parsePartial(name, partial, ractive) {\n  let parsed;\n\n  try {\n    parsed = parser.parse(partial, parser.getParseOptions(ractive));\n  } catch (e) {\n    warnIfDebug(`Could not parse partial from expression '${name}'\\n${e.message}`);\n  }\n\n  return parsed || { t: [] };\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport { isArray, isObject } from 'utils/is';\nimport { findMap } from 'utils/array';\nimport {\n  toEscapedString,\n  toString,\n  destroyed,\n  shuffled,\n  unbind,\n  unrender,\n  unrenderAndDestroy,\n  update\n} from 'shared/methodCallers';\nimport Fragment from './Fragment';\nimport findElement from './items/shared/findElement';\nimport { getContext } from 'shared/getRactiveContext';\nimport { keys } from 'utils/object';\n\nexport default class RepeatedFragment {\n  constructor(options) {\n    this.parent = options.owner.up;\n\n    // bit of a hack, so reference resolution works without another\n    // layer of indirection\n    this.up = this;\n    this.owner = options.owner;\n    this.ractive = this.parent.ractive;\n    this.delegate =\n      this.ractive.delegate !== false &&\n      (this.parent.delegate || findDelegate(findElement(options.owner)));\n    // delegation disabled by directive\n    if (this.delegate && this.delegate.delegate === false) this.delegate = false;\n    // let the element know it's a delegate handler\n    if (this.delegate) this.delegate.delegate = this.delegate;\n\n    // encapsulated styles should be inherited until they get applied by an element\n    this.cssIds = 'cssIds' in options ? options.cssIds : this.parent ? this.parent.cssIds : null;\n\n    this.context = null;\n    this.rendered = false;\n    this.iterations = [];\n\n    this.template = options.template;\n\n    this.indexRef = options.indexRef;\n    this.keyRef = options.keyRef;\n\n    this.pendingNewIndices = null;\n    this.previousIterations = null;\n\n    // track array versus object so updates of type rest\n    this.isArray = false;\n  }\n\n  bind(context) {\n    this.context = context;\n    this.bound = true;\n    const value = context.get();\n\n    // {{#each array}}...\n    if ((this.isArray = isArray(value))) {\n      // we can't use map, because of sparse arrays\n      this.iterations = [];\n      const max = value.length;\n      for (let i = 0; i < max; i += 1) {\n        this.iterations[i] = this.createIteration(i, i);\n      }\n    } else if (isObject(value)) {\n      // {{#each object}}...\n      this.isArray = false;\n\n      // TODO this is a dreadful hack. There must be a neater way\n      if (this.indexRef) {\n        const refs = this.indexRef.split(',');\n        this.keyRef = refs[0];\n        this.indexRef = refs[1];\n      }\n\n      this.iterations = keys(value).map((key, index) => {\n        return this.createIteration(key, index);\n      });\n    }\n\n    return this;\n  }\n\n  bubble(index) {\n    if (!this.bubbled) this.bubbled = [];\n    this.bubbled.push(index);\n\n    this.owner.bubble();\n  }\n\n  createIteration(key, index) {\n    const fragment = new Fragment({\n      owner: this,\n      template: this.template\n    });\n\n    fragment.key = key;\n    fragment.index = index;\n    fragment.isIteration = true;\n    fragment.delegate = this.delegate;\n\n    const model = this.context.joinKey(key);\n\n    // set up an iteration alias if there is one\n    if (this.owner.template.z) {\n      fragment.aliases = {};\n      fragment.aliases[this.owner.template.z[0].n] = model;\n    }\n\n    return fragment.bind(model);\n  }\n\n  destroyed() {\n    this.iterations.forEach(destroyed);\n  }\n\n  detach() {\n    const docFrag = createDocumentFragment();\n    this.iterations.forEach(fragment => docFrag.appendChild(fragment.detach()));\n    return docFrag;\n  }\n\n  find(selector, options) {\n    return findMap(this.iterations, i => i.find(selector, options));\n  }\n\n  findAll(selector, options) {\n    return this.iterations.forEach(i => i.findAll(selector, options));\n  }\n\n  findAllComponents(name, options) {\n    return this.iterations.forEach(i => i.findAllComponents(name, options));\n  }\n\n  findComponent(name, options) {\n    return findMap(this.iterations, i => i.findComponent(name, options));\n  }\n\n  findContext() {\n    return this.context;\n  }\n\n  findNextNode(iteration) {\n    if (iteration.index < this.iterations.length - 1) {\n      for (let i = iteration.index + 1; i < this.iterations.length; i++) {\n        const node = this.iterations[i].firstNode(true);\n        if (node) return node;\n      }\n    }\n\n    return this.owner.findNextNode();\n  }\n\n  firstNode(skipParent) {\n    return this.iterations[0] ? this.iterations[0].firstNode(skipParent) : null;\n  }\n\n  rebind(next) {\n    this.context = next;\n    this.iterations.forEach(fragment => {\n      const model = next ? next.joinKey(fragment.key) : undefined;\n      fragment.context = model;\n      if (this.owner.template.z) {\n        fragment.aliases = {};\n        fragment.aliases[this.owner.template.z[0].n] = model;\n      }\n    });\n  }\n\n  render(target, occupants) {\n    // TODO use docFrag.cloneNode...\n\n    const xs = this.iterations;\n    if (xs) {\n      const len = xs.length;\n      for (let i = 0; i < len; i++) {\n        xs[i].render(target, occupants);\n      }\n    }\n\n    this.rendered = true;\n  }\n\n  shuffle(newIndices) {\n    if (!this.pendingNewIndices) this.previousIterations = this.iterations.slice();\n\n    if (!this.pendingNewIndices) this.pendingNewIndices = [];\n\n    this.pendingNewIndices.push(newIndices);\n\n    const iterations = [];\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      if (newIndex === -1) return;\n\n      const fragment = this.iterations[oldIndex];\n      iterations[newIndex] = fragment;\n\n      if (newIndex !== oldIndex && fragment) fragment.dirty = true;\n    });\n\n    this.iterations = iterations;\n\n    this.bubble();\n  }\n\n  shuffled() {\n    this.iterations.forEach(shuffled);\n  }\n\n  toString(escape) {\n    return this.iterations ? this.iterations.map(escape ? toEscapedString : toString).join('') : '';\n  }\n\n  unbind() {\n    this.bound = false;\n    this.iterations.forEach(unbind);\n    return this;\n  }\n\n  unrender(shouldDestroy) {\n    this.iterations.forEach(shouldDestroy ? unrenderAndDestroy : unrender);\n    if (this.pendingNewIndices && this.previousIterations) {\n      this.previousIterations.forEach(fragment => {\n        if (fragment.rendered) shouldDestroy ? unrenderAndDestroy(fragment) : unrender(fragment);\n      });\n    }\n    this.rendered = false;\n  }\n\n  // TODO smart update\n  update() {\n    // skip dirty check, since this is basically just a facade\n\n    if (this.pendingNewIndices) {\n      this.bubbled.length = 0;\n      this.updatePostShuffle();\n      return;\n    }\n\n    if (this.updating) return;\n    this.updating = true;\n\n    const value = this.context.get();\n    const wasArray = this.isArray;\n\n    let toRemove;\n    let oldKeys;\n    let reset = true;\n    let i;\n\n    if ((this.isArray = isArray(value))) {\n      if (wasArray) {\n        reset = false;\n        if (this.iterations.length > value.length) {\n          toRemove = this.iterations.splice(value.length);\n        }\n      }\n    } else if (isObject(value) && !wasArray) {\n      reset = false;\n      toRemove = [];\n      oldKeys = {};\n      i = this.iterations.length;\n\n      while (i--) {\n        const fragment = this.iterations[i];\n        if (fragment.key in value) {\n          oldKeys[fragment.key] = true;\n        } else {\n          this.iterations.splice(i, 1);\n          toRemove.push(fragment);\n        }\n      }\n    }\n\n    if (reset) {\n      toRemove = this.iterations;\n      this.iterations = [];\n    }\n\n    if (toRemove) {\n      toRemove.forEach(fragment => {\n        fragment.unbind();\n        fragment.unrender(true);\n      });\n    }\n\n    // update the remaining ones\n    if (!reset && this.isArray && this.bubbled && this.bubbled.length) {\n      const bubbled = this.bubbled;\n      this.bubbled = [];\n      bubbled.forEach(i => this.iterations[i] && this.iterations[i].update());\n    } else {\n      this.iterations.forEach(update);\n    }\n\n    // add new iterations\n    const newLength = isArray(value) ? value.length : isObject(value) ? keys(value).length : 0;\n\n    let docFrag;\n    let fragment;\n\n    if (newLength > this.iterations.length) {\n      docFrag = this.rendered ? createDocumentFragment() : null;\n      i = this.iterations.length;\n\n      if (isArray(value)) {\n        while (i < value.length) {\n          fragment = this.createIteration(i, i);\n\n          this.iterations.push(fragment);\n          if (this.rendered) fragment.render(docFrag);\n\n          i += 1;\n        }\n      } else if (isObject(value)) {\n        // TODO this is a dreadful hack. There must be a neater way\n        if (this.indexRef && !this.keyRef) {\n          const refs = this.indexRef.split(',');\n          this.keyRef = refs[0];\n          this.indexRef = refs[1];\n        }\n\n        keys(value).forEach(key => {\n          if (!oldKeys || !(key in oldKeys)) {\n            fragment = this.createIteration(key, i);\n\n            this.iterations.push(fragment);\n            if (this.rendered) fragment.render(docFrag);\n\n            i += 1;\n          }\n        });\n      }\n\n      if (this.rendered) {\n        const parentNode = this.parent.findParentNode();\n        const anchor = this.parent.findNextNode(this.owner);\n\n        parentNode.insertBefore(docFrag, anchor);\n      }\n    }\n\n    this.updating = false;\n  }\n\n  updatePostShuffle() {\n    const newIndices = this.pendingNewIndices[0];\n\n    // map first shuffle through\n    this.pendingNewIndices.slice(1).forEach(indices => {\n      newIndices.forEach((newIndex, oldIndex) => {\n        newIndices[oldIndex] = indices[newIndex];\n      });\n    });\n\n    // This algorithm (for detaching incorrectly-ordered fragments from the DOM and\n    // storing them in a document fragment for later reinsertion) seems a bit hokey,\n    // but it seems to work for now\n    const len = this.context.get().length;\n    const oldLen = this.previousIterations.length;\n    const removed = {};\n    let i;\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      const fragment = this.previousIterations[oldIndex];\n      this.previousIterations[oldIndex] = null;\n\n      if (newIndex === -1) {\n        removed[oldIndex] = fragment;\n      } else if (fragment.index !== newIndex) {\n        const model = this.context.joinKey(newIndex);\n        fragment.index = fragment.key = newIndex;\n        fragment.context = model;\n        if (this.owner.template.z) {\n          fragment.aliases = {};\n          fragment.aliases[this.owner.template.z[0].n] = model;\n        }\n      }\n    });\n\n    // if the array was spliced outside of ractive, sometimes there are leftover fragments not in the newIndices\n    this.previousIterations.forEach((frag, i) => {\n      if (frag) removed[i] = frag;\n    });\n\n    // create new/move existing iterations\n    const docFrag = this.rendered ? createDocumentFragment() : null;\n    const parentNode = this.rendered ? this.parent.findParentNode() : null;\n\n    const contiguous = 'startIndex' in newIndices;\n    i = contiguous ? newIndices.startIndex : 0;\n\n    for (i; i < len; i++) {\n      const frag = this.iterations[i];\n\n      if (frag && contiguous) {\n        // attach any built-up iterations\n        if (this.rendered) {\n          if (removed[i]) docFrag.appendChild(removed[i].detach());\n          if (docFrag.childNodes.length) parentNode.insertBefore(docFrag, frag.firstNode());\n        }\n        continue;\n      }\n\n      if (!frag) this.iterations[i] = this.createIteration(i, i);\n\n      if (this.rendered) {\n        if (removed[i]) docFrag.appendChild(removed[i].detach());\n\n        if (frag) docFrag.appendChild(frag.detach());\n        else {\n          this.iterations[i].render(docFrag);\n        }\n      }\n    }\n\n    // append any leftovers\n    if (this.rendered) {\n      for (i = len; i < oldLen; i++) {\n        if (removed[i]) docFrag.appendChild(removed[i].detach());\n      }\n\n      if (docFrag.childNodes.length) {\n        parentNode.insertBefore(docFrag, this.owner.findNextNode());\n      }\n    }\n\n    // trigger removal on old nodes\n    keys(removed).forEach(k => removed[k].unbind().unrender(true));\n\n    this.iterations.forEach(update);\n\n    this.pendingNewIndices = null;\n\n    this.shuffled();\n  }\n}\n\nRepeatedFragment.prototype.getContext = getContext;\n\n// find the topmost delegate\nfunction findDelegate(start) {\n  let el = start;\n  let delegate = start;\n\n  while (el) {\n    if (el.delegate) delegate = el;\n    el = el.parent;\n  }\n\n  return delegate;\n}\n","import { fromExpression, fromComputationString } from 'parse/utils/createFunction';\nimport { doc } from 'config/environment';\nimport { fatal } from 'utils/log';\nimport { addFunctions } from 'shared/getFunction';\nimport parse from 'parse/_parse';\nimport { isString } from 'utils/is';\n\nconst parseOptions = [\n  'delimiters',\n  'tripleDelimiters',\n  'staticDelimiters',\n  'staticTripleDelimiters',\n  'csp',\n  'interpolate',\n  'preserveWhitespace',\n  'sanitize',\n  'stripComments',\n  'contextLines',\n  'attributes'\n];\n\nconst TEMPLATE_INSTRUCTIONS = `Either preparse or use a ractive runtime source that includes the parser. `;\n\nconst COMPUTATION_INSTRUCTIONS = `Either include a version of Ractive that can parse or convert your computation strings to functions.`;\n\nfunction throwNoParse(method, error, instructions) {\n  if (!method) {\n    fatal(`Missing Ractive.parse - cannot parse ${error}. ${instructions}`);\n  }\n}\n\nexport function createFunction(body, length) {\n  throwNoParse(fromExpression, 'new expression function', TEMPLATE_INSTRUCTIONS);\n  return fromExpression(body, length);\n}\n\nexport function createFunctionFromString(str, bindTo) {\n  throwNoParse(fromComputationString, 'compution string \"${str}\"', COMPUTATION_INSTRUCTIONS);\n  return fromComputationString(str, bindTo);\n}\n\nconst parser = {\n  fromId(id, options) {\n    if (!doc) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Cannot retrieve template #${id} as Ractive is not running in a browser.`);\n    }\n\n    if (id) id = id.replace(/^#/, '');\n\n    let template;\n\n    if (!(template = doc.getElementById(id))) {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Could not find template element with id #${id}`);\n    }\n\n    if (template.tagName.toUpperCase() !== 'SCRIPT') {\n      if (options && options.noThrow) {\n        return;\n      }\n      throw new Error(`Template element with id #${id}, must be a <script> element`);\n    }\n\n    return 'textContent' in template ? template.textContent : template.innerHTML;\n  },\n\n  isParsed(template) {\n    return !isString(template);\n  },\n\n  getParseOptions(ractive) {\n    // Could be Ractive or a Component\n    if (ractive.defaults) {\n      ractive = ractive.defaults;\n    }\n\n    return parseOptions.reduce((val, key) => {\n      val[key] = ractive[key];\n      return val;\n    }, {});\n  },\n\n  parse(template, options) {\n    throwNoParse(parse, 'template', TEMPLATE_INSTRUCTIONS);\n    const parsed = parse(template, options);\n    addFunctions(parsed);\n    return parsed;\n  },\n\n  parseFor(template, ractive) {\n    return this.parse(template, this.getParseOptions(ractive));\n  }\n};\n\nexport default parser;\n","import { createFunction } from '../Ractive/config/runtime-parser';\nimport { create, keys } from 'utils/object';\n\nconst functions = create(null);\n\nexport default function getFunction(str, i) {\n  if (functions[str]) return functions[str];\n  return (functions[str] = createFunction(str, i));\n}\n\nexport function addFunctions(template) {\n  if (!template) return;\n\n  const exp = template.e;\n\n  if (!exp) return;\n\n  keys(exp).forEach(str => {\n    if (functions[str]) return;\n    functions[str] = exp[str];\n  });\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { addFunctions } from 'shared/getFunction';\nimport parser from '../runtime-parser';\nimport { hasOwn } from 'utils/object';\nimport { isFunction, isNumber, isString } from 'utils/is';\n\nexport default {\n  name: 'template',\n\n  extend(Parent, proto, options) {\n    // only assign if exists\n    if ('template' in options) {\n      const template = options.template;\n\n      if (isFunction(template)) {\n        proto.template = template;\n      } else {\n        proto.template = parseTemplate(template, proto);\n      }\n    }\n  },\n\n  init(Parent, ractive, options) {\n    // TODO because of prototypal inheritance, we might just be able to use\n    // ractive.template, and not bother passing through the Parent object.\n    // At present that breaks the test mocks' expectations\n    let template = 'template' in options ? options.template : Parent.prototype.template;\n    template = template || { v: TEMPLATE_VERSION, t: [] };\n\n    if (isFunction(template)) {\n      const fn = template;\n      template = getDynamicTemplate(ractive, fn);\n\n      ractive._config.template = {\n        fn,\n        result: template\n      };\n    }\n\n    template = parseTemplate(template, ractive);\n\n    // TODO the naming of this is confusing - ractive.template refers to [...],\n    // but Component.prototype.template refers to {v:1,t:[],p:[]}...\n    // it's unnecessary, because the developer never needs to access\n    // ractive.template\n    ractive.template = template.t;\n\n    if (template.p) {\n      extendPartials(ractive.partials, template.p);\n    }\n  },\n\n  reset(ractive) {\n    const result = resetValue(ractive);\n\n    if (result) {\n      const parsed = parseTemplate(result, ractive);\n\n      ractive.template = parsed.t;\n      extendPartials(ractive.partials, parsed.p, true);\n\n      return true;\n    }\n  }\n};\n\nfunction resetValue(ractive) {\n  const initial = ractive._config.template;\n\n  // If this isn't a dynamic template, there's nothing to do\n  if (!initial || !initial.fn) {\n    return;\n  }\n\n  const result = getDynamicTemplate(ractive, initial.fn);\n\n  // TODO deep equality check to prevent unnecessary re-rendering\n  // in the case of already-parsed templates\n  if (result !== initial.result) {\n    initial.result = result;\n    return result;\n  }\n}\n\nfunction getDynamicTemplate(ractive, fn) {\n  return fn.call(ractive, {\n    fromId: parser.fromId,\n    isParsed: parser.isParsed,\n    parse(template, options = parser.getParseOptions(ractive)) {\n      return parser.parse(template, options);\n    }\n  });\n}\n\nfunction parseTemplate(template, ractive) {\n  if (isString(template)) {\n    // parse will validate and add expression functions\n    template = parseAsString(template, ractive);\n  } else {\n    // need to validate and add exp for already parsed template\n    validate(template);\n    addFunctions(template);\n  }\n\n  return template;\n}\n\nfunction parseAsString(template, ractive) {\n  // ID of an element containing the template?\n  if (template[0] === '#') {\n    template = parser.fromId(template);\n  }\n\n  return parser.parseFor(template, ractive);\n}\n\nfunction validate(template) {\n  // Check that the template even exists\n  if (template == undefined) {\n    throw new Error(`The template cannot be ${template}.`);\n  } else if (!isNumber(template.v)) {\n    // Check the parsed template has a version at all\n    throw new Error(\n      \"The template parser was passed a non-string template, but the template doesn't have a version.  Make sure you're passing in the template you think you are.\"\n    );\n  } else if (template.v !== TEMPLATE_VERSION) {\n    // Check we're using the correct version\n    throw new Error(\n      `Mismatched template version (expected ${TEMPLATE_VERSION}, got ${\n        template.v\n      }) Please ensure you are using the latest version of Ractive.js in your build process as well as in your app`\n    );\n  }\n}\n\nfunction extendPartials(existingPartials, newPartials, overwrite) {\n  if (!newPartials) return;\n\n  // TODO there's an ambiguity here - we need to overwrite in the `reset()`\n  // case, but not initially...\n\n  for (const key in newPartials) {\n    if (overwrite || !hasOwn(existingPartials, key)) {\n      existingPartials[key] = newPartials[key];\n    }\n  }\n}\n","import { create, keys } from 'utils/object';\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'computed',\n  'decorators',\n  'easing',\n  'events',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nconst registriesOnDefaults = ['computed'];\n\nclass Registry {\n  constructor(name, useDefaults) {\n    this.name = name;\n    this.useDefaults = useDefaults;\n  }\n\n  extend(Parent, proto, options) {\n    const parent = this.useDefaults ? Parent.defaults : Parent;\n    const target = this.useDefaults ? proto : proto.constructor;\n    this.configure(parent, target, options);\n  }\n\n  init() {\n    // noop\n  }\n\n  configure(Parent, target, options) {\n    const name = this.name;\n    const option = options[name];\n\n    const registry = create(Parent[name]);\n\n    for (const key in option) {\n      registry[key] = option[key];\n    }\n\n    target[name] = registry;\n  }\n\n  reset(ractive) {\n    const registry = ractive[this.name];\n    let changed = false;\n\n    keys(registry).forEach(key => {\n      const item = registry[key];\n\n      if (item._fn) {\n        if (item._fn.isOwner) {\n          registry[key] = item._fn;\n        } else {\n          delete registry[key];\n        }\n        changed = true;\n      }\n    });\n\n    return changed;\n  }\n}\n\nconst registries = registryNames.map(name => {\n  const putInDefaults = registriesOnDefaults.indexOf(name) > -1;\n  return new Registry(name, putInDefaults);\n});\n\nexport default registries;\n","import { warnIfDebug } from 'utils/log';\nimport adaptConfigurator from './custom/adapt';\nimport cssConfigurator from './custom/css/css';\nimport dataConfigurator from './custom/data';\nimport templateConfigurator from './custom/template';\nimport defaults from './defaults';\nimport registries from './registries';\nimport wrapPrototype from './wrapPrototypeMethod';\nimport deprecate from './deprecate';\nimport RactiveProto from '../prototype';\nimport { hasOwn, keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nconst custom = {\n  adapt: adaptConfigurator,\n  css: cssConfigurator,\n  data: dataConfigurator,\n  template: templateConfigurator\n};\n\nconst defaultKeys = keys(defaults);\n\nconst isStandardKey = makeObj(defaultKeys.filter(key => !custom[key]));\n\n// blacklisted keys that we don't double extend\nconst isBlacklisted = makeObj(\n  defaultKeys.concat(registries.map(r => r.name), ['on', 'observe', 'attributes', 'cssData'])\n);\n\nconst order = [].concat(\n  defaultKeys.filter(key => !registries[key] && !custom[key]),\n  registries,\n  //custom.data,\n  custom.template,\n  custom.css\n);\n\nconst config = {\n  extend: (Parent, proto, options, Child) => configure('extend', Parent, proto, options, Child),\n  init: (Parent, ractive, options) => configure('init', Parent, ractive, options),\n  reset: ractive => order.filter(c => c.reset && c.reset(ractive)).map(c => c.name)\n};\n\nfunction configure(method, Parent, target, options, Child) {\n  deprecate(options);\n\n  for (const key in options) {\n    if (hasOwn(isStandardKey, key)) {\n      const value = options[key];\n\n      // warn the developer if they passed a function and ignore its value\n\n      // NOTE: we allow some functions on \"el\" because we duck type element lists\n      // and some libraries or ef'ed-up virtual browsers (phantomJS) return a\n      // function object as the result of querySelector methods\n      if (key !== 'el' && isFunction(value)) {\n        warnIfDebug(\n          `${key} is a Ractive option that does not expect a function and will be ignored`,\n          method === 'init' ? target : null\n        );\n      } else {\n        target[key] = value;\n      }\n    }\n  }\n\n  // disallow combination of `append` and `enhance`\n  if (options.append && options.enhance) {\n    throw new Error('Cannot use append and enhance at the same time');\n  }\n\n  registries.forEach(registry => {\n    registry[method](Parent, target, options, Child);\n  });\n\n  adaptConfigurator[method](Parent, target, options, Child);\n  templateConfigurator[method](Parent, target, options, Child);\n  cssConfigurator[method](Parent, target, options, Child);\n\n  extendOtherMethods(Parent.prototype, target, options);\n}\n\nconst _super = /\\b_super\\b/;\nfunction extendOtherMethods(parent, target, options) {\n  for (const key in options) {\n    if (!isBlacklisted[key] && hasOwn(options, key)) {\n      let member = options[key];\n\n      // if this is a method that overwrites a method, wrap it:\n      if (isFunction(member)) {\n        if (key in RactiveProto && !_super.test(member.toString())) {\n          warnIfDebug(\n            `Overriding Ractive prototype function '${key}' without calling the '${_super}' method can be very dangerous.`\n          );\n        }\n        member = wrapPrototype(parent, key, member);\n      }\n\n      target[key] = member;\n    }\n  }\n}\n\nfunction makeObj(array) {\n  const obj = {};\n  array.forEach(x => (obj[x] = true));\n  return obj;\n}\n\nexport default config;\n","import { createDocumentFragment } from 'utils/dom';\nimport noop from 'utils/noop';\n\nexport default class Item {\n  constructor(options) {\n    this.up = options.up;\n    this.ractive = options.up.ractive;\n\n    this.template = options.template;\n    this.index = options.index;\n    this.type = options.template.t;\n\n    this.dirty = false;\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.fragment) this.fragment.destroyed();\n  }\n\n  find() {\n    return null;\n  }\n\n  findComponent() {\n    return null;\n  }\n\n  findNextNode() {\n    return this.up.findNextNode(this);\n  }\n\n  shuffled() {\n    if (this.fragment) this.fragment.shuffled();\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n}\n\nItem.prototype.findAll = noop;\nItem.prototype.findAllComponents = noop;\n\nexport class ContainerItem extends Item {\n  constructor(options) {\n    super(options);\n  }\n\n  detach() {\n    return this.fragment ? this.fragment.detach() : createDocumentFragment();\n  }\n\n  find(selector) {\n    if (this.fragment) {\n      return this.fragment.find(selector);\n    }\n  }\n\n  findAll(selector, options) {\n    if (this.fragment) {\n      this.fragment.findAll(selector, options);\n    }\n  }\n\n  findComponent(name) {\n    if (this.fragment) {\n      return this.fragment.findComponent(name);\n    }\n  }\n\n  findAllComponents(name, options) {\n    if (this.fragment) {\n      this.fragment.findAllComponents(name, options);\n    }\n  }\n\n  firstNode(skipParent) {\n    return this.fragment && this.fragment.firstNode(skipParent);\n  }\n\n  toString(escape) {\n    return this.fragment ? this.fragment.toString(escape) : '';\n  }\n}\n","import { capture } from 'src/global/capture';\nimport Model from './Model';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { hasOwn } from 'utils/object';\n\nexport default class ComputationChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n\n    this.isReadonly = !this.root.ractive.syncComputedChildren;\n    this.dirty = true;\n  }\n\n  get setRoot() {\n    return this.parent.setRoot;\n  }\n\n  applyValue(value) {\n    super.applyValue(value);\n\n    if (!this.isReadonly) {\n      let source = this.parent;\n      // computed models don't have a shuffle method\n      while (source && source.shuffle) {\n        source = source.parent;\n      }\n\n      if (source) {\n        source.dependencies.forEach(mark);\n      }\n    }\n\n    if (this.setRoot) {\n      this.setRoot.set(this.setRoot.value);\n    }\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const parentValue = this.parent.get();\n      this.value = parentValue ? parentValue[this.key] : undefined;\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    return (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n      ? this.wrapperValue\n      : this.value;\n  }\n\n  handleChange() {\n    this.dirty = true;\n\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n    this.deps.forEach(handleChange);\n    this.children.forEach(handleChange);\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ComputationChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n}\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { capture, startCapturing, stopCapturing } from 'src/global/capture';\nimport { warnIfDebug } from 'utils/log';\nimport Model from './Model';\nimport { maybeBind } from './ModelBase';\nimport ComputationChild from './ComputationChild';\nimport { hasConsole } from 'config/environment';\nimport { isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nexport default class Computation extends Model {\n  constructor(viewmodel, signature, key) {\n    super(null, null);\n\n    this.root = this.parent = viewmodel;\n    this.signature = signature;\n\n    this.key = key; // not actually used, but helps with debugging\n    this.isExpression = key && key[0] === '@';\n\n    this.isReadonly = !this.signature.setter;\n\n    this.context = viewmodel.computationContext;\n\n    this.dependencies = [];\n\n    this.children = [];\n    this.childByKey = {};\n\n    this.deps = [];\n\n    this.dirty = true;\n\n    // TODO: is there a less hackish way to do this?\n    this.shuffle = undefined;\n  }\n\n  get setRoot() {\n    if (this.signature.setter) return this;\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n\n    if (this.dirty) {\n      this.dirty = false;\n      const old = this.value;\n      this.value = this.getValue();\n      // this may cause a view somewhere to update, so it must be in a runloop\n      if (!runloop.active()) {\n        runloop.start();\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n        runloop.end();\n      } else {\n        if (!isEqual(old, this.value)) this.notifyUpstream();\n      }\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    }\n\n    // if capturing, this value needs to be unwrapped because it's for external use\n    return maybeBind(\n      this,\n      // if unwrap is supplied, it overrides capture\n      this.wrapper && (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture)\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      result = this.signature.getter.call(this.context);\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n\n      // TODO this is all well and good in Chrome, but...\n      // ...also, should encapsulate this stuff better, and only\n      // show it if Ractive.DEBUG\n      if (hasConsole) {\n        if (console.groupCollapsed)\n          console.groupCollapsed(\n            '%cshow details',\n            'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n          );\n        const sig = this.signature;\n        console.error(\n          `${err.name}: ${err.message}\\n\\n${sig.getterString}${\n            sig.getterUseStack ? '\\n\\n' + err.stack : ''\n          }`\n        );\n        if (console.groupCollapsed) console.groupEnd();\n      }\n    }\n\n    const dependencies = stopCapturing();\n    this.setDependencies(dependencies);\n\n    return result;\n  }\n\n  mark() {\n    this.handleChange();\n  }\n\n  rebind(next, previous) {\n    // computations will grab all of their deps again automagically\n    if (next !== previous) this.handleChange();\n  }\n\n  set(value) {\n    if (this.isReadonly) {\n      throw new Error(`Cannot set read-only computed value '${this.key}'`);\n    }\n\n    this.signature.setter(value);\n    this.mark();\n  }\n\n  setDependencies(dependencies) {\n    // unregister any soft dependencies we no longer have\n    let i = this.dependencies.length;\n    while (i--) {\n      const model = this.dependencies[i];\n      if (!~dependencies.indexOf(model)) model.unregister(this);\n    }\n\n    // and add any new ones\n    i = dependencies.length;\n    while (i--) {\n      const model = dependencies[i];\n      if (!~this.dependencies.indexOf(model)) model.register(this);\n    }\n\n    this.dependencies = dependencies;\n  }\n\n  teardown() {\n    let i = this.dependencies.length;\n    while (i--) {\n      if (this.dependencies[i]) this.dependencies[i].unregister(this);\n    }\n    if (this.root.computations[this.key] === this) delete this.root.computations[this.key];\n    super.teardown();\n  }\n}\n\nconst prototype = Computation.prototype;\nconst child = ComputationChild.prototype;\nprototype.handleChange = child.handleChange;\nprototype.joinKey = child.joinKey;\n","import { removeFromArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport { warnIfDebug } from 'utils/log';\nimport Model from 'src/model/Model';\nimport Computation from 'src/model/Computation';\nimport { startCapturing, stopCapturing } from 'src/global/capture';\nimport getFunction from 'shared/getFunction';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from './resolveReference';\n\nexport default class ExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(fragment.ractive.viewmodel, null);\n\n    this.fragment = fragment;\n    this.template = template;\n\n    this.isReadonly = true;\n    this.dirty = true;\n\n    this.fn = getFunction(template.s, template.r.length);\n\n    this.models = this.template.r.map(ref => {\n      return resolveReference(this.fragment, ref);\n    });\n    this.dependencies = [];\n\n    this.shuffle = undefined;\n\n    this.bubble();\n  }\n\n  bubble(actuallyChanged = true) {\n    // refresh the keypath\n    this.keypath = undefined;\n\n    if (actuallyChanged) {\n      this.handleChange();\n    }\n  }\n\n  getKeypath() {\n    if (!this.template) return '@undefined';\n    if (!this.keypath) {\n      this.keypath =\n        '@' +\n        this.template.s.replace(/_(\\d+)/g, (match, i) => {\n          if (i >= this.models.length) return match;\n\n          const model = this.models[i];\n          return model ? model.getKeypath() : '@undefined';\n        });\n    }\n\n    return this.keypath;\n  }\n\n  getValue() {\n    startCapturing();\n    let result;\n\n    try {\n      const params = this.models.map(m => (m ? m.get(true) : undefined));\n      result = this.fn.apply(this.fragment.ractive, params);\n    } catch (err) {\n      warnIfDebug(`Failed to compute ${this.getKeypath()}: ${err.message || err}`);\n    }\n\n    const dependencies = stopCapturing();\n    // remove missing deps\n    this.dependencies.filter(d => !~dependencies.indexOf(d)).forEach(d => {\n      d.unregister(this);\n      removeFromArray(this.dependencies, d);\n    });\n    // register new deps\n    dependencies.filter(d => !~this.dependencies.indexOf(d)).forEach(d => {\n      d.register(this);\n      this.dependencies.push(d);\n    });\n\n    return result;\n  }\n\n  notifyUpstream() {}\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n\n    if (~idx) {\n      next = rebindMatch(this.template.r[idx], next, previous);\n      if (next !== previous) {\n        previous.unregister(this);\n        this.models.splice(idx, 1, next);\n        if (next) next.addShuffleRegister(this, 'mark');\n      }\n    }\n    this.bubble(!safe);\n  }\n\n  retrieve() {\n    return this.get();\n  }\n\n  teardown() {\n    this.fragment = undefined;\n    if (this.dependencies) this.dependencies.forEach(d => d.unregister(this));\n    super.teardown();\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n\nconst prototype = ExpressionProxy.prototype;\nconst computation = Computation.prototype;\nprototype.get = computation.get;\nprototype.handleChange = computation.handleChange;\nprototype.joinKey = computation.joinKey;\nprototype.mark = computation.mark;\nprototype.unbind = noop;\n","import Model from 'src/model/Model';\nimport { findBoundValue } from 'src/model/ModelBase';\nimport { REFERENCE } from 'config/types';\nimport { rebindMatch } from 'shared/rebind';\nimport { handleChange, mark, marked } from 'shared/methodCallers';\nimport { isEqual, isString } from 'utils/is';\nimport { escapeKey } from 'shared/keypaths';\nimport ExpressionProxy from './ExpressionProxy';\nimport resolveReference from './resolveReference';\nimport resolve from './resolve';\nimport { hasOwn } from 'utils/object';\nimport { capture } from 'src/global/capture';\n\nclass ReferenceExpressionChild extends Model {\n  constructor(parent, key) {\n    super(parent, key);\n    this.dirty = true;\n  }\n\n  applyValue(value) {\n    if (isEqual(value, this.value)) return;\n\n    let parent = this.parent;\n    const keys = [this.key];\n    while (parent) {\n      if (parent.base) {\n        const target = parent.model.joinAll(keys);\n        target.applyValue(value);\n        break;\n      }\n\n      keys.unshift(parent.key);\n\n      parent = parent.parent;\n    }\n  }\n\n  get(shouldCapture, opts) {\n    this.retrieve();\n    return super.get(shouldCapture, opts);\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ReferenceExpressionChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark() {\n    this.dirty = true;\n    super.mark();\n  }\n\n  retrieve() {\n    if (this.dirty) {\n      this.dirty = false;\n      const parent = this.parent.get();\n      this.value = parent && parent[this.key];\n    }\n\n    return this.value;\n  }\n}\n\nconst missing = { get() {} };\n\nexport default class ReferenceExpressionProxy extends Model {\n  constructor(fragment, template) {\n    super(null, null);\n    this.dirty = true;\n    this.root = fragment.ractive.viewmodel;\n    this.template = template;\n\n    this.base = resolve(fragment, template);\n\n    const intermediary = (this.intermediary = {\n      handleChange: () => this.handleChange(),\n      rebind: (next, previous) => {\n        if (previous === this.base) {\n          next = rebindMatch(template, next, previous);\n          if (next !== this.base) {\n            this.base.unregister(intermediary);\n            this.base = next;\n          }\n        } else {\n          const idx = this.members.indexOf(previous);\n          if (~idx) {\n            // only direct references will rebind... expressions handle themselves\n            next = rebindMatch(template.m[idx].n, next, previous);\n            if (next !== this.members[idx]) {\n              this.members.splice(idx, 1, next || missing);\n            }\n          }\n        }\n\n        if (next !== previous) previous.unregister(intermediary);\n        if (next) next.addShuffleTask(() => next.register(intermediary));\n\n        this.bubble();\n      }\n    });\n\n    this.members = template.m.map(template => {\n      if (isString(template)) {\n        return { get: () => template };\n      }\n\n      let model;\n\n      if (template.t === REFERENCE) {\n        model = resolveReference(fragment, template.n);\n        model.register(intermediary);\n\n        return model;\n      }\n\n      model = new ExpressionProxy(fragment, template);\n      model.register(intermediary);\n      return model;\n    });\n\n    this.base.register(intermediary);\n\n    this.bubble();\n  }\n\n  bubble() {\n    if (!this.base) return;\n    if (!this.dirty) this.handleChange();\n  }\n\n  get(shouldCapture, opts) {\n    if (shouldCapture) capture(this);\n    if (this.dirty) {\n      this.bubble();\n\n      const keys = this.members.map(m => escapeKey(String(m.get())));\n      const model = this.base.joinAll(keys);\n\n      if (model !== this.model) {\n        if (this.model) {\n          this.model.unregister(this);\n          this.model.unregisterTwowayBinding(this);\n        }\n\n        this.model = model;\n        this.parent = model.parent;\n        this.model.register(this);\n        this.model.registerTwowayBinding(this);\n\n        if (this.keypathModel) this.keypathModel.handleChange();\n      }\n\n      this.value = this.model.get(shouldCapture, opts);\n      this.dirty = false;\n      this.mark();\n      return this.value;\n    } else {\n      return this.model ? this.model.get(shouldCapture, opts) : undefined;\n    }\n  }\n\n  // indirect two-way bindings\n  getValue() {\n    this.value = this.model ? this.model.get() : undefined;\n\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) return value;\n    }\n\n    // check one-way bindings\n    const oneway = findBoundValue(this.deps);\n    if (oneway) return oneway.value;\n\n    return this.value;\n  }\n\n  getKeypath() {\n    return this.model ? this.model.getKeypath() : '@undefined';\n  }\n\n  handleChange() {\n    this.dirty = true;\n    this.mark();\n  }\n\n  joinKey(key) {\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new ReferenceExpressionChild(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark() {\n    if (this.dirty) {\n      this.deps.forEach(handleChange);\n    }\n\n    this.links.forEach(marked);\n    this.children.forEach(mark);\n  }\n\n  rebind() {\n    this.handleChange();\n  }\n\n  retrieve() {\n    return this.value;\n  }\n\n  set(value) {\n    this.model.set(value);\n  }\n\n  shuffle(newIndices, unsafe) {\n    if (this.model && !this.model.shuffling) this.model.shuffle(newIndices, unsafe);\n    else super.shuffle(newIndices, unsafe);\n  }\n\n  teardown() {\n    if (this.base) {\n      this.base.unregister(this.intermediary);\n    }\n    if (this.model) {\n      this.model.unregister(this);\n      this.model.unregisterTwowayBinding(this);\n    }\n    if (this.members) {\n      this.members.forEach(m => m && m.unregister && m.unregister(this.intermediary));\n    }\n  }\n\n  unreference() {\n    super.unreference();\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n\n  unregister(dep) {\n    super.unregister(dep);\n    if (!this.deps.length && !this.refs) this.teardown();\n  }\n}\n","import Fragment from '../Fragment';\nimport { ContainerItem } from './shared/Item';\nimport resolve from '../resolvers/resolve';\n\nexport function resolveAliases(aliases, fragment) {\n  const resolved = {};\n\n  for (let i = 0; i < aliases.length; i++) {\n    resolved[aliases[i].n] = resolve(fragment, aliases[i].x);\n  }\n\n  for (const k in resolved) {\n    resolved[k].reference();\n  }\n\n  return resolved;\n}\n\nexport default class Alias extends ContainerItem {\n  constructor(options) {\n    super(options);\n\n    this.fragment = null;\n  }\n\n  bind() {\n    this.fragment = new Fragment({\n      owner: this,\n      template: this.template.f\n    });\n\n    this.fragment.aliases = resolveAliases(this.template.z, this.up);\n    this.fragment.bind();\n  }\n\n  render(target) {\n    this.rendered = true;\n    if (this.fragment) this.fragment.render(target);\n  }\n\n  unbind() {\n    for (const k in this.fragment.aliases) {\n      this.fragment.aliases[k].unreference();\n    }\n\n    this.fragment.aliases = {};\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender(shouldDestroy) {\n    if (this.rendered && this.fragment) this.fragment.unrender(shouldDestroy);\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      this.fragment.update();\n    }\n  }\n}\n","export default function(camelCaseStr) {\n  return camelCaseStr.replace(/([A-Z])/g, (match, $1) => {\n    return '-' + $1.toLowerCase();\n  });\n}\n","import cleanCss from 'utils/cleanCss';\nimport { isString } from 'utils/is';\n\nconst space = /\\s+/;\n\nexport function readStyle(css) {\n  if (!isString(css)) return {};\n\n  return cleanCss(css, (css, reconstruct) => {\n    return css\n      .split(';')\n      .filter(rule => !!rule.trim())\n      .map(reconstruct)\n      .reduce((rules, rule) => {\n        const i = rule.indexOf(':');\n        const name = rule.substr(0, i).trim();\n        rules[name] = rule.substr(i + 1).trim();\n        return rules;\n      }, {});\n  });\n}\n\nexport function readClass(str) {\n  const list = str.split(space);\n\n  // remove any empty entries\n  let i = list.length;\n  while (i--) {\n    if (!list[i]) list.splice(i, 1);\n  }\n\n  return list;\n}\n","import { html } from 'config/namespaces';\nimport { safeToStringValue } from 'utils/dom';\nimport { arrayContains } from 'utils/array';\nimport noop from 'utils/noop';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport { readStyle, readClass } from 'src/view/helpers/specialAttrs';\nimport { keys as objectKeys } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nconst textTypes = [\n  undefined,\n  'text',\n  'search',\n  'url',\n  'email',\n  'hidden',\n  'password',\n  'search',\n  'reset',\n  'submit'\n];\n\nexport default function getUpdateDelegate(attribute) {\n  const { element, name } = attribute;\n\n  if (name === 'value') {\n    if (attribute.interpolator) attribute.interpolator.bound = true;\n\n    // special case - selects\n    if (element.name === 'select' && name === 'value') {\n      return element.getAttribute('multiple') ? updateMultipleSelectValue : updateSelectValue;\n    }\n\n    if (element.name === 'textarea') return updateStringValue;\n\n    // special case - contenteditable\n    if (element.getAttribute('contenteditable') != null) return updateContentEditableValue;\n\n    // special case - <input>\n    if (element.name === 'input') {\n      const type = element.getAttribute('type');\n\n      // type='file' value='{{fileList}}'>\n      if (type === 'file') return noop; // read-only\n\n      // type='radio' name='{{twoway}}'\n      if (type === 'radio' && element.binding && element.binding.attribute.name === 'name')\n        return updateRadioValue;\n\n      if (~textTypes.indexOf(type)) return updateStringValue;\n    }\n\n    return updateValue;\n  }\n\n  const node = element.node;\n\n  // special case - <input type='radio' name='{{twoway}}' value='foo'>\n  if (attribute.isTwoway && name === 'name') {\n    if (node.type === 'radio') return updateRadioName;\n    if (node.type === 'checkbox') return updateCheckboxName;\n  }\n\n  if (name === 'style') return updateStyleAttribute;\n\n  if (name.indexOf('style-') === 0) return updateInlineStyle;\n\n  // special case - class names. IE fucks things up, again\n  if (name === 'class' && (!node.namespaceURI || node.namespaceURI === html))\n    return updateClassName;\n\n  if (name.indexOf('class-') === 0) return updateInlineClass;\n\n  if (attribute.isBoolean) {\n    const type = element.getAttribute('type');\n    if (attribute.interpolator && name === 'checked' && (type === 'checkbox' || type === 'radio'))\n      attribute.interpolator.bound = true;\n    return updateBoolean;\n  }\n\n  if (attribute.namespace && attribute.namespace !== attribute.node.namespaceURI)\n    return updateNamespacedAttribute;\n\n  return updateAttribute;\n}\n\nfunction updateMultipleSelectValue(reset) {\n  let value = this.getValue();\n\n  if (!isArray(value)) value = [value];\n\n  const options = this.node.options;\n  let i = options.length;\n\n  if (reset) {\n    while (i--) options[i].selected = false;\n  } else {\n    while (i--) {\n      const option = options[i];\n      const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n\n      option.selected = arrayContains(value, optionValue);\n    }\n  }\n}\n\nfunction updateSelectValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    // TODO is locked still a thing?\n    this.node._ractive.value = value;\n\n    const options = this.node.options;\n    let i = options.length;\n    let wasSelected = false;\n\n    if (reset) {\n      while (i--) options[i].selected = false;\n    } else {\n      while (i--) {\n        const option = options[i];\n        const optionValue = option._ractive ? option._ractive.value : option.value; // options inserted via a triple don't have _ractive\n        if (option.disabled && option.selected) wasSelected = true;\n\n        if (optionValue == value) {\n          // double equals as we may be comparing numbers with strings\n          option.selected = true;\n          return;\n        }\n      }\n    }\n\n    if (!wasSelected) this.node.selectedIndex = -1;\n  }\n}\n\nfunction updateContentEditableValue(reset) {\n  const value = this.getValue();\n\n  if (!this.locked) {\n    if (reset) this.node.innerHTML = '';\n    else this.node.innerHTML = value === undefined ? '' : value;\n  }\n}\n\nfunction updateRadioValue(reset) {\n  const node = this.node;\n  const wasChecked = node.checked;\n\n  const value = this.getValue();\n\n  if (reset) return (node.checked = false);\n\n  //node.value = this.element.getAttribute( 'value' );\n  node.value = this.node._ractive.value = value;\n  node.checked = this.element.compare(value, this.element.getAttribute('name'));\n\n  // This is a special case - if the input was checked, and the value\n  // changed so that it's no longer checked, the twoway binding is\n  // most likely out of date. To fix it we have to jump through some\n  // hoops... this is a little kludgy but it works\n  if (wasChecked && !node.checked && this.element.binding && this.element.binding.rendered) {\n    this.element.binding.group.model.set(this.element.binding.group.getValue());\n  }\n}\n\nfunction updateValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node.removeAttribute('value');\n      this.node.value = this.node._ractive.value = null;\n    } else {\n      const value = this.getValue();\n\n      this.node.value = this.node._ractive.value = value;\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateStringValue(reset) {\n  if (!this.locked) {\n    if (reset) {\n      this.node._ractive.value = '';\n      this.node.removeAttribute('value');\n    } else {\n      const value = this.getValue();\n\n      this.node._ractive.value = value;\n\n      this.node.value = safeToStringValue(value);\n      this.node.setAttribute('value', safeToStringValue(value));\n    }\n  }\n}\n\nfunction updateRadioName(reset) {\n  if (reset) this.node.checked = false;\n  else this.node.checked = this.element.compare(this.getValue(), this.element.binding.getValue());\n}\n\nfunction updateCheckboxName(reset) {\n  const { element, node } = this;\n  const binding = element.binding;\n\n  const value = this.getValue();\n  const valueAttribute = element.getAttribute('value');\n\n  if (reset) {\n    // TODO: WAT?\n  }\n\n  if (!isArray(value)) {\n    binding.isChecked = node.checked = element.compare(value, valueAttribute);\n  } else {\n    let i = value.length;\n    while (i--) {\n      if (element.compare(valueAttribute, value[i])) {\n        binding.isChecked = node.checked = true;\n        return;\n      }\n    }\n    binding.isChecked = node.checked = false;\n  }\n}\n\nfunction updateStyleAttribute(reset) {\n  const props = reset ? {} : readStyle(this.getValue() || '');\n  const style = this.node.style;\n  const keys = objectKeys(props);\n  const prev = this.previous || [];\n\n  let i = 0;\n  while (i < keys.length) {\n    if (keys[i] in style) {\n      const safe = props[keys[i]].replace('!important', '');\n      style.setProperty(keys[i], safe, safe.length !== props[keys[i]].length ? 'important' : '');\n    }\n    i++;\n  }\n\n  // remove now-missing attrs\n  i = prev.length;\n  while (i--) {\n    if (!~keys.indexOf(prev[i]) && prev[i] in style) style.setProperty(prev[i], '', '');\n  }\n\n  this.previous = keys;\n}\n\nfunction updateInlineStyle(reset) {\n  if (!this.style) {\n    this.style = hyphenateCamel(this.name.substr(6));\n  }\n\n  if (reset && this.node.style.getPropertyValue(this.style) !== this.last) return;\n\n  const value = reset ? '' : safeToStringValue(this.getValue());\n  const safe = value.replace('!important', '');\n  this.node.style.setProperty(this.style, safe, safe.length !== value.length ? 'important' : '');\n  this.last = safe;\n}\n\nfunction updateClassName(reset) {\n  const value = reset ? [] : readClass(safeToStringValue(this.getValue()));\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const prev = this.previous || attr.slice(0);\n\n  const className = value.concat(attr.filter(c => !~prev.indexOf(c))).join(' ');\n\n  if (className !== cls) {\n    if (!isString(this.node.className)) {\n      this.node.className.baseVal = className;\n    } else {\n      this.node.className = className;\n    }\n  }\n\n  this.previous = value;\n}\n\nfunction updateInlineClass(reset) {\n  const name = this.name.substr(6);\n\n  // watch out for werdo svg elements\n  let cls = this.node.className;\n  cls = cls.baseVal !== undefined ? cls.baseVal : cls;\n\n  const attr = readClass(cls);\n  const value = reset ? false : this.getValue();\n\n  if (!this.inlineClass) this.inlineClass = name;\n\n  if (value && !~attr.indexOf(name)) attr.push(name);\n  else if (!value && ~attr.indexOf(name)) attr.splice(attr.indexOf(name), 1);\n\n  if (!isString(this.node.className)) {\n    this.node.className.baseVal = attr.join(' ');\n  } else {\n    this.node.className = attr.join(' ');\n  }\n}\n\nfunction updateBoolean(reset) {\n  // with two-way binding, only update if the change wasn't initiated by the user\n  // otherwise the cursor will often be sent to the wrong place\n  if (!this.locked) {\n    if (reset) {\n      if (this.useProperty) this.node[this.propertyName] = false;\n      this.node.removeAttribute(this.propertyName);\n    } else {\n      if (this.useProperty) {\n        this.node[this.propertyName] = this.getValue();\n      } else {\n        const val = this.getValue();\n        if (val) {\n          this.node.setAttribute(this.propertyName, isString(val) ? val : '');\n        } else {\n          this.node.removeAttribute(this.propertyName);\n        }\n      }\n    }\n  }\n}\n\nfunction updateAttribute(reset) {\n  if (reset) {\n    if (this.node.getAttribute(this.name) === this.value) {\n      this.node.removeAttribute(this.name);\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttribute(this.name, this.value);\n  }\n}\n\nfunction updateNamespacedAttribute(reset) {\n  if (reset) {\n    if (\n      this.value ===\n      this.node.getAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1))\n    ) {\n      this.node.removeAttributeNS(this.namespace, this.name.slice(this.name.indexOf(':') + 1));\n    }\n  } else {\n    this.value = safeToStringValue(this.getString());\n    this.node.setAttributeNS(\n      this.namespace,\n      this.name.slice(this.name.indexOf(':') + 1),\n      this.value\n    );\n  }\n}\n","export default {\n  'accept-charset': 'acceptCharset',\n  accesskey: 'accessKey',\n  bgcolor: 'bgColor',\n  class: 'className',\n  codebase: 'codeBase',\n  colspan: 'colSpan',\n  contenteditable: 'contentEditable',\n  datetime: 'dateTime',\n  dirname: 'dirName',\n  for: 'htmlFor',\n  'http-equiv': 'httpEquiv',\n  ismap: 'isMap',\n  maxlength: 'maxLength',\n  novalidate: 'noValidate',\n  pubdate: 'pubDate',\n  readonly: 'readOnly',\n  rowspan: 'rowSpan',\n  tabindex: 'tabIndex',\n  usemap: 'useMap'\n};\n","import { doc } from 'config/environment';\nimport { svg } from 'config/namespaces';\nimport { createElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport noop from 'utils/noop';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\n\nconst div = doc ? createElement('div') : null;\n\nlet attributes = false;\nexport function inAttributes() {\n  return attributes;\n}\n\nexport default class ConditionalAttribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.attributes = [];\n\n    this.owner = options.owner;\n\n    this.fragment = new Fragment({\n      ractive: this.ractive,\n      owner: this,\n      template: this.template\n    });\n\n    // this fragment can't participate in node-y things\n    this.fragment.findNextNode = noop;\n\n    this.dirty = false;\n  }\n\n  bind() {\n    this.fragment.bind();\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.owner.bubble();\n    }\n  }\n\n  destroyed() {\n    this.unrender();\n  }\n\n  render() {\n    this.node = this.owner.node;\n    if (this.node) {\n      this.isSvg = this.node.namespaceURI === svg;\n    }\n\n    attributes = true;\n    if (!this.rendered) this.fragment.render();\n\n    this.rendered = true;\n    this.dirty = true; // TODO this seems hacky, but necessary for tests to pass in browser AND node.js\n    this.update();\n    attributes = false;\n  }\n\n  toString() {\n    return this.fragment.toString();\n  }\n\n  unbind() {\n    this.fragment.unbind();\n  }\n\n  unrender() {\n    this.rendered = false;\n    this.fragment.unrender();\n  }\n\n  update() {\n    let str;\n    let attrs;\n\n    if (this.dirty) {\n      this.dirty = false;\n\n      const current = attributes;\n      attributes = true;\n      this.fragment.update();\n\n      if (this.rendered && this.node) {\n        str = this.fragment.toString();\n\n        attrs = parseAttributes(str, this.isSvg);\n\n        // any attributes that previously existed but no longer do\n        // must be removed\n        this.attributes.filter(a => notIn(attrs, a)).forEach(a => {\n          this.node.removeAttribute(a.name);\n        });\n\n        attrs.forEach(a => {\n          this.node.setAttribute(a.name, a.value);\n        });\n\n        this.attributes = attrs;\n      }\n\n      attributes = current || false;\n    }\n  }\n}\n\nconst onlyWhitespace = /^\\s*$/;\nfunction parseAttributes(str, isSvg) {\n  if (onlyWhitespace.test(str)) return [];\n  const tagName = isSvg ? 'svg' : 'div';\n  return str\n    ? (div.innerHTML = `<${tagName} ${str}></${tagName}>`) && toArray(div.childNodes[0].attributes)\n    : [];\n}\n\nfunction notIn(haystack, needle) {\n  let i = haystack.length;\n\n  while (i--) {\n    if (haystack[i].name === needle.name) {\n      return false;\n    }\n  }\n\n  return true;\n}\n","import { INTERPOLATOR } from 'config/types';\nimport namespaces from 'config/namespaces';\nimport { safeAttributeString } from 'utils/dom';\nimport { booleanAttributes } from 'utils/html';\nimport hyphenateCamel from 'utils/hyphenateCamel';\nimport Fragment from '../../Fragment';\nimport Item from '../shared/Item';\nimport findElement from '../shared/findElement';\nimport getUpdateDelegate from './attribute/getUpdateDelegate';\nimport propertyNames from './attribute/propertyNames';\nimport { inAttributes } from './ConditionalAttribute';\nimport { isArray, isString } from 'utils/is';\n\nfunction lookupNamespace(node, prefix) {\n  const qualified = `xmlns:${prefix}`;\n\n  while (node) {\n    if (node.hasAttribute && node.hasAttribute(qualified)) return node.getAttribute(qualified);\n    node = node.parentNode;\n  }\n\n  return namespaces[prefix];\n}\n\nlet attribute = false;\nexport function inAttribute() {\n  return attribute;\n}\n\nexport default class Attribute extends Item {\n  constructor(options) {\n    super(options);\n\n    this.name = options.template.n;\n    this.namespace = null;\n\n    this.owner = options.owner || options.up.owner || options.element || findElement(options.up);\n    this.element =\n      options.element || (this.owner.attributeByName ? this.owner : findElement(options.up));\n    this.up = options.up; // shared\n    this.ractive = this.up.ractive;\n\n    this.rendered = false;\n    this.updateDelegate = null;\n    this.fragment = null;\n\n    this.element.attributeByName[this.name] = this;\n\n    if (!isArray(options.template.f)) {\n      this.value = options.template.f;\n      if (this.value === 0) {\n        this.value = '';\n      } else if (this.value === undefined) {\n        this.value = true;\n      }\n    } else {\n      this.fragment = new Fragment({\n        owner: this,\n        template: options.template.f\n      });\n    }\n\n    this.interpolator =\n      this.fragment &&\n      this.fragment.items.length === 1 &&\n      this.fragment.items[0].type === INTERPOLATOR &&\n      this.fragment.items[0];\n\n    if (this.interpolator) this.interpolator.owner = this;\n  }\n\n  bind() {\n    if (this.fragment) {\n      this.fragment.bind();\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.up.bubble();\n      this.element.bubble();\n      this.dirty = true;\n    }\n  }\n\n  firstNode() {}\n\n  getString() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.toString()\n      : this.value != null\n        ? '' + this.value\n        : '';\n    attribute = false;\n    return value;\n  }\n\n  // TODO could getValue ever be called for a static attribute,\n  // or can we assume that this.fragment exists?\n  getValue() {\n    attribute = true;\n    const value = this.fragment\n      ? this.fragment.valueOf()\n      : booleanAttributes.test(this.name)\n        ? true\n        : this.value;\n    attribute = false;\n    return value;\n  }\n\n  render() {\n    const node = this.element.node;\n    this.node = node;\n\n    // should we use direct property access, or setAttribute?\n    if (!node.namespaceURI || node.namespaceURI === namespaces.html) {\n      this.propertyName = propertyNames[this.name] || this.name;\n\n      if (node[this.propertyName] !== undefined) {\n        this.useProperty = true;\n      }\n\n      // is attribute a boolean attribute or 'value'? If so we're better off doing e.g.\n      // node.selected = true rather than node.setAttribute( 'selected', '' )\n      if (booleanAttributes.test(this.name) || this.isTwoway) {\n        this.isBoolean = true;\n      }\n\n      if (this.propertyName === 'value') {\n        node._ractive.value = this.value;\n      }\n    }\n\n    if (node.namespaceURI) {\n      const index = this.name.indexOf(':');\n      if (index !== -1) {\n        this.namespace = lookupNamespace(node, this.name.slice(0, index));\n      } else {\n        this.namespace = node.namespaceURI;\n      }\n    }\n\n    this.rendered = true;\n    this.updateDelegate = getUpdateDelegate(this);\n    this.updateDelegate();\n  }\n\n  toString() {\n    if (inAttributes()) return '';\n    attribute = true;\n\n    const value = this.getValue();\n\n    // Special case - select and textarea values (should not be stringified)\n    if (\n      this.name === 'value' &&\n      (this.element.getAttribute('contenteditable') !== undefined ||\n        (this.element.name === 'select' || this.element.name === 'textarea'))\n    ) {\n      return;\n    }\n\n    // Special case – bound radio `name` attributes\n    if (\n      this.name === 'name' &&\n      this.element.name === 'input' &&\n      this.interpolator &&\n      this.element.getAttribute('type') === 'radio'\n    ) {\n      return `name=\"{{${this.interpolator.model.getKeypath()}}}\"`;\n    }\n\n    // Special case - style and class attributes and directives\n    if (\n      this.owner === this.element &&\n      (this.name === 'style' || this.name === 'class' || this.style || this.inlineClass)\n    ) {\n      return;\n    }\n\n    if (\n      !this.rendered &&\n      this.owner === this.element &&\n      (!this.name.indexOf('style-') || !this.name.indexOf('class-'))\n    ) {\n      if (!this.name.indexOf('style-')) {\n        this.style = hyphenateCamel(this.name.substr(6));\n      } else {\n        this.inlineClass = this.name.substr(6);\n      }\n\n      return;\n    }\n\n    if (booleanAttributes.test(this.name))\n      return value\n        ? isString(value)\n          ? `${this.name}=\"${safeAttributeString(value)}\"`\n          : this.name\n        : '';\n    if (value == null) return '';\n\n    const str = safeAttributeString(this.getString());\n    attribute = false;\n\n    return str ? `${this.name}=\"${str}\"` : this.name;\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n  }\n\n  unrender() {\n    this.updateDelegate(true);\n\n    this.rendered = false;\n  }\n\n  update() {\n    if (this.dirty) {\n      let binding;\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      if (this.rendered) this.updateDelegate();\n      if (this.isTwoway && !this.locked) {\n        this.interpolator.twowayBinding.lastVal(true, this.interpolator.model.get());\n      } else if (this.name === 'value' && (binding = this.element.binding)) {\n        // special case: name bound element with dynamic value\n        const attr = binding.attribute;\n        if (attr && !attr.dirty && attr.rendered) {\n          this.element.binding.attribute.updateDelegate();\n        }\n      }\n    }\n  }\n}\n","import { INTERPOLATOR, ELEMENT } from 'config/types';\nimport Item from '../shared/Item';\nimport Fragment from '../../Fragment';\nimport findElement from '../shared/findElement';\nimport { isArray } from 'utils/is';\n\nexport default class BindingFlag extends Item {\n  constructor(options) {\n    super(options);\n\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.flag = options.template.v === 'l' ? 'lazy' : 'twoway';\n    this.bubbler = this.owner === this.element ? this.element : this.up;\n\n    if (this.element.type === ELEMENT) {\n      if (isArray(options.template.f)) {\n        this.fragment = new Fragment({\n          owner: this,\n          template: options.template.f\n        });\n      }\n\n      this.interpolator =\n        this.fragment &&\n        this.fragment.items.length === 1 &&\n        this.fragment.items[0].type === INTERPOLATOR &&\n        this.fragment.items[0];\n    }\n  }\n\n  bind() {\n    if (this.fragment) this.fragment.bind();\n    set(this, this.getValue(), true);\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.bubbler.bubble();\n      this.dirty = true;\n    }\n  }\n\n  getValue() {\n    if (this.fragment) return this.fragment.valueOf();\n    else if ('value' in this) return this.value;\n    else if ('f' in this.template) return this.template.f;\n    else return true;\n  }\n\n  render() {\n    set(this, this.getValue(), true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    if (this.fragment) this.fragment.unbind();\n\n    delete this.element[this.flag];\n  }\n\n  unrender() {\n    if (this.element.rendered) this.element.recreateTwowayBinding();\n  }\n\n  update() {\n    if (this.dirty) {\n      this.dirty = false;\n      if (this.fragment) this.fragment.update();\n      set(this, this.getValue(), true);\n    }\n  }\n}\n\nfunction set(flag, value, update) {\n  if (value === 0) {\n    flag.value = true;\n  } else if (value === 'true') {\n    flag.value = true;\n  } else if (value === 'false' || value === '0') {\n    flag.value = false;\n  } else {\n    flag.value = value;\n  }\n\n  const current = flag.element[flag.flag];\n  flag.element[flag.flag] = flag.value;\n  if (update && !flag.element.attributes.binding && current !== flag.value) {\n    flag.element.recreateTwowayBinding();\n  }\n\n  return flag.value;\n}\n","import Item from './shared/Item';\nimport noop from 'utils/noop';\nimport { detachNode } from 'utils/dom';\nimport { doc } from 'config/environment';\nimport { assign, create } from 'utils/object';\n\nexport default function Comment(options) {\n  Item.call(this, options);\n}\n\nconst proto = create(Item.prototype);\n\nassign(proto, {\n  bind: noop,\n  unbind: noop,\n  update: noop,\n\n  detach() {\n    return detachNode(this.node);\n  },\n\n  firstNode() {\n    return this.node;\n  },\n\n  render(target) {\n    this.rendered = true;\n\n    this.node = doc.createComment(this.template.c);\n    target.appendChild(this.node);\n  },\n\n  toString() {\n    return `<!-- ${this.template.c} -->`;\n  },\n\n  unrender(shouldDestroy) {\n    if (this.rendered && shouldDestroy) this.detach();\n    this.rendered = false;\n  }\n});\n\nComment.prototype = proto;\n","import Hook from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\nimport { cancel } from 'shared/methodCallers';\nimport { warnIfDebug } from 'utils/log';\n\nconst teardownHook = new Hook('teardown');\nconst destructHook = new Hook('destruct');\n\n// Teardown. This goes through the root fragment and all its children, removing observers\n// and generally cleaning up after itself\n\nexport default function Ractive$teardown() {\n  if (this.torndown) {\n    warnIfDebug('ractive.teardown() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  this.shouldDestroy = true;\n  return teardown(this, () => (this.fragment.rendered ? this.unrender() : Promise.resolve()));\n}\n\nexport function teardown(instance, getPromise) {\n  instance.torndown = true;\n  instance.fragment.unbind();\n  instance._observers.slice().forEach(cancel);\n\n  if (instance.el && instance.el.__ractive_instances__) {\n    removeFromArray(instance.el.__ractive_instances__, instance);\n  }\n\n  const promise = getPromise();\n\n  teardownHook.fire(instance);\n\n  promise.then(() => {\n    destructHook.fire(instance);\n    instance.viewmodel.teardown();\n  });\n\n  return promise;\n}\n","import { SharedModel } from './SharedModel';\nimport { Missing } from '../LinkModel';\nimport { create } from 'utils/object';\n\nexport default class RactiveModel extends SharedModel {\n  constructor(ractive) {\n    super(ractive, '@this');\n    this.ractive = ractive;\n  }\n\n  joinKey(key) {\n    const model = super.joinKey(key);\n\n    if ((key === 'root' || key === 'parent') && !model.isLink) return initLink(model, key);\n    else if (key === 'data') return this.ractive.viewmodel;\n    else if (key === 'cssData') return this.ractive.constructor._cssModel;\n\n    return model;\n  }\n}\n\nfunction initLink(model, key) {\n  model.applyValue = function(value) {\n    this.parent.value[key] = value;\n    if (value && value.viewmodel) {\n      this.link(value.viewmodel.getRactiveModel(), key);\n      this._link.markedAll();\n    } else {\n      this.link(create(Missing), key);\n      this._link.markedAll();\n    }\n  };\n\n  model.applyValue(model.parent.ractive[key], key);\n  model._link.set = v => model.applyValue(v);\n  model._link.applyValue = v => model.applyValue(v);\n  return model._link;\n}\n","import { capture } from 'src/global/capture';\nimport Computation from './Computation';\nimport Model from './Model';\nimport { handleChange, mark } from 'shared/methodCallers';\nimport RactiveModel from './specials/RactiveModel';\nimport SharedModel, { GlobalModel } from './specials/SharedModel';\nimport { splitKeypath, escapeKey, unescapeKey } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\nimport { hasOwn, keys as objectKeys } from 'utils/object';\n\nexport default class RootModel extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.ractive = options.ractive; // TODO sever this link\n\n    this.value = options.data;\n    this.adaptors = options.adapt;\n    this.adapt();\n\n    this.computationContext = options.ractive;\n    this.computations = {};\n  }\n\n  attached(fragment) {\n    attachImplicits(this, fragment);\n  }\n\n  compute(key, signature) {\n    const computation = new Computation(this, signature, key);\n    this.computations[escapeKey(key)] = computation;\n\n    return computation;\n  }\n\n  createLink(keypath, target, targetPath, options) {\n    const keys = splitKeypath(keypath);\n\n    let model = this;\n    while (keys.length) {\n      const key = keys.shift();\n      model = model.childByKey[key] || model.joinKey(key);\n    }\n\n    return model.link(target, targetPath, options);\n  }\n\n  detached() {\n    detachImplicits(this);\n  }\n\n  get(shouldCapture, options) {\n    if (shouldCapture) capture(this);\n\n    if (!options || options.virtual !== false) {\n      const result = this.getVirtual();\n      const keys = objectKeys(this.computations);\n      let i = keys.length;\n      while (i--) {\n        result[keys[i]] = this.computations[keys[i]].get();\n      }\n\n      return result;\n    } else {\n      return this.value;\n    }\n  }\n\n  getKeypath() {\n    return '';\n  }\n\n  getRactiveModel() {\n    return this.ractiveModel || (this.ractiveModel = new RactiveModel(this.ractive));\n  }\n\n  getValueChildren() {\n    const children = super.getValueChildren(this.value);\n\n    this.children.forEach(child => {\n      if (child._link) {\n        const idx = children.indexOf(child);\n        if (~idx) children.splice(idx, 1, child._link);\n        else children.push(child._link);\n      }\n    });\n\n    for (const k in this.computations) {\n      children.push(this.computations[k]);\n    }\n\n    return children;\n  }\n\n  has(key) {\n    const value = this.value;\n    let unescapedKey = unescapeKey(key);\n\n    if (\n      unescapedKey === '@this' ||\n      unescapedKey === '@global' ||\n      unescapedKey === '@shared' ||\n      unescapedKey === '@style'\n    )\n      return true;\n    if (unescapedKey[0] === '~' && unescapedKey[1] === '/') unescapedKey = unescapedKey.slice(2);\n    if (key === '' || hasOwn(value, unescapedKey)) return true;\n\n    // mappings/links and computations\n    if (\n      key in this.computations ||\n      (this.childByKey[unescapedKey] && this.childByKey[unescapedKey]._link)\n    )\n      return true;\n\n    // We climb up the constructor chain to find if one of them contains the unescapedKey\n    let constructor = value.constructor;\n    while (constructor !== Function && constructor !== Array && constructor !== Object) {\n      if (hasOwn(constructor.prototype, unescapedKey)) return true;\n      constructor = constructor.constructor;\n    }\n\n    return false;\n  }\n\n  joinKey(key, opts) {\n    if (key[0] === '@') {\n      if (key === '@this' || key === '@') return this.getRactiveModel();\n      if (key === '@global') return GlobalModel;\n      if (key === '@shared') return SharedModel;\n      if (key === '@style') return this.getRactiveModel().joinKey('cssData');\n      return;\n    }\n\n    if (key[0] === '~' && key[1] === '/') key = key.slice(2);\n\n    return hasOwn(this.computations, key) ? this.computations[key] : super.joinKey(key, opts);\n  }\n\n  set(value) {\n    // TODO wrapping root node is a baaaad idea. We should prevent this\n    const wrapper = this.wrapper;\n    if (wrapper) {\n      const shouldTeardown = !wrapper.reset || wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        wrapper.teardown();\n        this.wrapper = null;\n        this.value = value;\n        this.adapt();\n      }\n    } else {\n      this.value = value;\n      this.adapt();\n    }\n\n    this.deps.forEach(handleChange);\n    this.children.forEach(mark);\n  }\n\n  retrieve() {\n    return this.wrapper ? this.wrapper.get() : this.value;\n  }\n\n  teardown() {\n    super.teardown();\n    for (const k in this.computations) {\n      this.computations[k].teardown();\n    }\n    this.ractiveModel && this.ractiveModel.teardown();\n  }\n}\nRootModel.prototype.update = noop;\n\nfunction attachImplicits(model, fragment) {\n  if (model._link && model._link.implicit && model._link.isDetached()) {\n    model.attach(fragment);\n  }\n\n  // look for virtual children to relink and cascade\n  for (const k in model.childByKey) {\n    if (k in model.value) {\n      attachImplicits(model.childByKey[k], fragment);\n    } else if (!model.childByKey[k]._link || model.childByKey[k]._link.isDetached()) {\n      const mdl = resolveReference(fragment, k);\n      if (mdl) {\n        model.childByKey[k].link(mdl, k, { implicit: true });\n      }\n    }\n  }\n}\n\nfunction detachImplicits(model) {\n  if (model._link && model._link.implicit) {\n    model.unlink();\n  }\n\n  for (const k in model.childByKey) {\n    detachImplicits(model.childByKey[k]);\n  }\n}\n","import { fatal, warnIfDebug, welcome } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport { ensureArray, combine } from 'utils/array';\nimport { findInViewHierarchy } from 'shared/registry';\nimport dataConfigurator from './config/custom/data';\nimport RootModel from 'src/model/RootModel';\nimport Hook from 'src/events/Hook';\nimport getComputationSignature from './helpers/getComputationSignature';\nimport subscribe from './helpers/subscribe';\nimport Ractive from '../Ractive';\nimport { ATTRIBUTE, INTERPOLATOR } from 'config/types';\nimport { assign, create, hasOwn } from 'utils/object';\nimport { isString } from 'utils/is';\n\nconst constructHook = new Hook('construct');\n\nconst registryNames = [\n  'adaptors',\n  'components',\n  'decorators',\n  'easing',\n  'events',\n  'interpolators',\n  'partials',\n  'transitions'\n];\n\nlet uid = 0;\n\nexport default function construct(ractive, options) {\n  if (Ractive.DEBUG) welcome();\n\n  initialiseProperties(ractive);\n  handleAttributes(ractive);\n\n  // set up event subscribers\n  subscribe(ractive, options, 'on');\n\n  // if there's not a delegation setting, inherit from parent if it's not default\n  if (\n    !hasOwn(options, 'delegate') &&\n    ractive.parent &&\n    ractive.parent.delegate !== ractive.delegate\n  ) {\n    ractive.delegate = false;\n  }\n\n  // TODO don't allow `onconstruct` with `new Ractive()`, there's no need for it\n  constructHook.fire(ractive, options);\n\n  // Add registries\n  let i = registryNames.length;\n  while (i--) {\n    const name = registryNames[i];\n    ractive[name] = assign(create(ractive.constructor[name] || null), options[name]);\n  }\n\n  if (ractive._attributePartial) {\n    ractive.partials['extra-attributes'] = ractive._attributePartial;\n    delete ractive._attributePartial;\n  }\n\n  // Create a viewmodel\n  const viewmodel = new RootModel({\n    adapt: getAdaptors(ractive, ractive.adapt, options),\n    data: dataConfigurator.init(ractive.constructor, ractive, options),\n    ractive\n  });\n\n  // once resolved, share the adaptors array between the root model and instance\n  ractive.adapt = viewmodel.adaptors;\n\n  ractive.viewmodel = viewmodel;\n\n  // Add computed properties\n  const computed = assign(create(ractive.constructor.prototype.computed), options.computed);\n\n  for (const key in computed) {\n    if (key === '__proto__') continue;\n    const signature = getComputationSignature(ractive, key, computed[key]);\n    viewmodel.compute(key, signature);\n  }\n}\n\nfunction getAdaptors(ractive, protoAdapt, options) {\n  protoAdapt = protoAdapt.map(lookup);\n  const adapt = ensureArray(options.adapt).map(lookup);\n\n  const srcs = [protoAdapt, adapt];\n  if (ractive.parent && !ractive.isolated) {\n    srcs.push(ractive.parent.viewmodel.adaptors);\n  }\n\n  return combine.apply(null, srcs);\n\n  function lookup(adaptor) {\n    if (isString(adaptor)) {\n      adaptor = findInViewHierarchy('adaptors', ractive, adaptor);\n\n      if (!adaptor) {\n        fatal(missingPlugin(adaptor, 'adaptor'));\n      }\n    }\n\n    return adaptor;\n  }\n}\n\nfunction initialiseProperties(ractive) {\n  // Generate a unique identifier, for places where you'd use a weak map if it\n  // existed\n  ractive._guid = 'r-' + uid++;\n\n  // events\n  ractive._subs = create(null);\n  ractive._nsSubs = 0;\n\n  // storage for item configuration from instantiation to reset,\n  // like dynamic functions or original values\n  ractive._config = {};\n\n  // events\n  ractive.event = null;\n  ractive._eventQueue = [];\n\n  // observers\n  ractive._observers = [];\n\n  // external children\n  ractive._children = [];\n  ractive._children.byName = {};\n  ractive.children = ractive._children;\n\n  if (!ractive.component) {\n    ractive.root = ractive;\n    ractive.parent = ractive.container = null; // TODO container still applicable?\n  }\n}\n\nfunction handleAttributes(ractive) {\n  const component = ractive.component;\n  const attributes = ractive.constructor.attributes;\n\n  if (attributes && component) {\n    const tpl = component.template;\n    const attrs = tpl.m ? tpl.m.slice() : [];\n\n    // grab all of the passed attribute names\n    const props = attrs.filter(a => a.t === ATTRIBUTE).map(a => a.n);\n\n    // warn about missing requireds\n    attributes.required.forEach(p => {\n      if (!~props.indexOf(p)) {\n        warnIfDebug(`Component '${component.name}' requires attribute '${p}' to be provided`);\n      }\n    });\n\n    // set up a partial containing non-property attributes\n    const all = attributes.optional.concat(attributes.required);\n    const partial = [];\n    let i = attrs.length;\n    while (i--) {\n      const a = attrs[i];\n      if (a.t === ATTRIBUTE && !~all.indexOf(a.n)) {\n        if (attributes.mapAll) {\n          // map the attribute if requested and make the extra attribute in the partial refer to the mapping\n          partial.unshift({\n            t: ATTRIBUTE,\n            n: a.n,\n            f: [{ t: INTERPOLATOR, r: `~/${a.n}` }]\n          });\n        } else {\n          // transfer the attribute to the extra attributes partal\n          partial.unshift(attrs.splice(i, 1)[0]);\n        }\n      }\n    }\n\n    if (partial.length) component.template = { t: tpl.t, e: tpl.e, f: tpl.f, m: attrs, p: tpl.p };\n    ractive._attributePartial = partial;\n  }\n}\n","import runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\nimport { bind, render as callRender, unbind, unrender, update } from 'shared/methodCallers';\nimport { teardown } from 'src/Ractive/prototype/teardown';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnIfDebug } from 'utils/log';\nimport { createDocumentFragment } from 'utils/dom';\nimport {\n  ANCHOR,\n  ATTRIBUTE,\n  BINDING_FLAG,\n  COMPONENT,\n  DECORATOR,\n  EVENT,\n  TRANSITION,\n  YIELDER\n} from 'config/types';\nimport construct from 'src/Ractive/construct';\nimport initialise from 'src/Ractive/initialise';\nimport render from 'src/Ractive/render';\nimport Item from './shared/Item';\nimport ConditionalAttribute from './element/ConditionalAttribute';\nimport createItem from './createItem';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { assign, create } from 'utils/object';\nimport { isArray, isString } from 'utils/is';\n\nexport default class Component extends Item {\n  constructor(options, ComponentConstructor) {\n    super(options);\n    let template = options.template;\n    this.isAnchor = template.t === ANCHOR;\n    this.type = this.isAnchor ? ANCHOR : COMPONENT; // override ELEMENT from super\n    let attrs = template.m;\n\n    const partials = template.p || {};\n    if (!('content' in partials)) partials.content = template.f || [];\n    this._partials = partials; // TEMP\n\n    if (this.isAnchor) {\n      this.name = template.n;\n\n      this.addChild = addChild;\n      this.removeChild = removeChild;\n    } else {\n      const instance = create(ComponentConstructor.prototype);\n\n      this.instance = instance;\n      this.name = template.e;\n\n      if (instance.el) {\n        warnIfDebug(\n          `The <${this.name}> component has a default 'el' property; it has been disregarded`\n        );\n      }\n\n      // find container\n      let fragment = options.up;\n      let container;\n      while (fragment) {\n        if (fragment.owner.type === YIELDER) {\n          container = fragment.owner.container;\n          break;\n        }\n\n        fragment = fragment.parent;\n      }\n\n      // add component-instance-specific properties\n      instance.parent = this.up.ractive;\n      instance.container = container || null;\n      instance.root = instance.parent.root;\n      instance.component = this;\n\n      construct(this.instance, { partials });\n\n      // these can be modified during construction\n      template = this.template;\n      attrs = template.m;\n\n      // allow components that are so inclined to add programmatic mappings\n      if (isArray(this.mappings)) {\n        attrs = (attrs || []).concat(this.mappings);\n      } else if (isString(this.mappings)) {\n        attrs = (attrs || []).concat(parser.parse(this.mappings, { attributes: true }).t);\n      }\n\n      // for hackability, this could be an open option\n      // for any ractive instance, but for now, just\n      // for components and just for ractive...\n      instance._inlinePartials = partials;\n    }\n\n    this.attributeByName = {};\n    this.attributes = [];\n\n    if (attrs) {\n      const leftovers = [];\n      attrs.forEach(template => {\n        switch (template.t) {\n          case ATTRIBUTE:\n          case EVENT:\n            this.attributes.push(\n              createItem({\n                owner: this,\n                up: this.up,\n                template\n              })\n            );\n            break;\n\n          case TRANSITION:\n          case BINDING_FLAG:\n          case DECORATOR:\n            break;\n\n          default:\n            leftovers.push(template);\n            break;\n        }\n      });\n\n      if (leftovers.length) {\n        this.attributes.push(\n          new ConditionalAttribute({\n            owner: this,\n            up: this.up,\n            template: leftovers\n          })\n        );\n      }\n    }\n\n    this.eventHandlers = [];\n  }\n\n  bind() {\n    if (!this.isAnchor) {\n      this.attributes.forEach(bind);\n      this.eventHandlers.forEach(bind);\n\n      initialise(\n        this.instance,\n        {\n          partials: this._partials\n        },\n        {\n          cssIds: this.up.cssIds\n        }\n      );\n\n      this.bound = true;\n    }\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (!this.isAnchor && this.instance.fragment) this.instance.fragment.destroyed();\n  }\n\n  detach() {\n    if (this.isAnchor) {\n      if (this.instance) return this.instance.fragment.detach();\n      return createDocumentFragment();\n    }\n\n    return this.instance.fragment.detach();\n  }\n\n  find(selector, options) {\n    if (this.instance) return this.instance.fragment.find(selector, options);\n  }\n\n  findAll(selector, options) {\n    if (this.instance) this.instance.fragment.findAll(selector, options);\n  }\n\n  findComponent(name, options) {\n    if (!name || this.name === name) return this.instance;\n\n    if (this.instance.fragment) {\n      return this.instance.fragment.findComponent(name, options);\n    }\n  }\n\n  findAllComponents(name, options) {\n    const { result } = options;\n\n    if (this.instance && (!name || this.name === name)) {\n      result.push(this.instance);\n    }\n\n    if (this.instance) this.instance.findAllComponents(name, options);\n  }\n\n  firstNode(skipParent) {\n    if (this.instance) return this.instance.fragment.firstNode(skipParent);\n  }\n\n  getContext(...assigns) {\n    assigns.unshift(this.instance);\n    return getRactiveContext.apply(null, assigns);\n  }\n\n  render(target, occupants) {\n    if (this.isAnchor) {\n      this.rendered = true;\n      this.target = target;\n\n      if (!checking.length) {\n        checking.push(this.ractive);\n        if (occupants) {\n          this.occupants = occupants;\n          checkAnchors();\n          this.occupants = null;\n        } else {\n          runloop.scheduleTask(checkAnchors, true);\n        }\n      }\n    } else {\n      this.attributes.forEach(callRender);\n      this.eventHandlers.forEach(callRender);\n\n      render(this.instance, target, null, occupants);\n\n      this.rendered = true;\n    }\n  }\n\n  toString() {\n    if (this.instance) return this.instance.toHTML();\n  }\n\n  unbind() {\n    if (!this.isAnchor) {\n      this.bound = false;\n\n      this.attributes.forEach(unbind);\n\n      teardown(this.instance, () => runloop.promise());\n    }\n  }\n\n  unrender(shouldDestroy) {\n    this.shouldDestroy = shouldDestroy;\n\n    if (this.isAnchor) {\n      if (this.item) unrenderItem(this, this.item);\n      this.target = null;\n      if (!checking.length) {\n        checking.push(this.ractive);\n        runloop.scheduleTask(checkAnchors, true);\n      }\n    } else {\n      this.instance.unrender();\n      this.instance.el = this.instance.target = null;\n      this.attributes.forEach(unrender);\n      this.eventHandlers.forEach(unrender);\n    }\n\n    this.rendered = false;\n  }\n\n  update() {\n    this.dirty = false;\n    if (this.instance) {\n      this.instance.fragment.update();\n      this.attributes.forEach(update);\n      this.eventHandlers.forEach(update);\n    }\n  }\n}\n\nfunction addChild(meta) {\n  if (this.item) this.removeChild(this.item);\n\n  const child = meta.instance;\n  meta.anchor = this;\n\n  meta.up = this.up;\n  meta.name = meta.nameOption || this.name;\n  this.name = meta.name;\n\n  if (!child.isolated) child.viewmodel.attached(this.up);\n\n  // render as necessary\n  if (this.rendered) {\n    renderItem(this, meta);\n  }\n}\n\nfunction removeChild(meta) {\n  // unrender as necessary\n  if (this.item === meta) {\n    unrenderItem(this, meta);\n    this.name = this.template.n;\n  }\n}\n\nfunction renderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = false;\n  meta.up = anchor.up;\n\n  anchor.item = meta;\n  anchor.instance = meta.instance;\n  const nextNode = anchor.up.findNextNode(anchor);\n\n  if (meta.instance.fragment.rendered) {\n    meta.instance.unrender();\n  }\n\n  meta.partials = meta.instance.partials;\n  meta.instance.partials = assign(create(meta.partials), meta.partials, anchor._partials);\n\n  meta.instance.fragment.unbind();\n  meta.instance.fragment.componentParent = anchor.up;\n  meta.instance.fragment.bind(meta.instance.viewmodel);\n\n  anchor.attributes.forEach(bind);\n  anchor.eventHandlers.forEach(bind);\n  anchor.attributes.forEach(callRender);\n  anchor.eventHandlers.forEach(callRender);\n\n  const target = anchor.up.findParentNode();\n  render(meta.instance, target, target.contains(nextNode) ? nextNode : null, anchor.occupants);\n\n  if (meta.lastBound !== anchor) {\n    meta.lastBound = anchor;\n  }\n}\n\nfunction unrenderItem(anchor, meta) {\n  if (!anchor.rendered) return;\n\n  meta.shouldDestroy = true;\n  meta.instance.unrender();\n\n  anchor.eventHandlers.forEach(unrender);\n  anchor.attributes.forEach(unrender);\n  anchor.eventHandlers.forEach(unbind);\n  anchor.attributes.forEach(unbind);\n\n  meta.instance.el = meta.instance.anchor = null;\n  meta.instance.fragment.componentParent = null;\n  meta.up = null;\n  meta.anchor = null;\n  anchor.item = null;\n  anchor.instance = null;\n}\n\nlet checking = [];\nexport function checkAnchors() {\n  const list = checking;\n  checking = [];\n\n  list.forEach(updateAnchors);\n}\n","import { findInViewHierarchy } from 'shared/registry';\nimport { warnOnce } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport noop from 'utils/noop';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'src/shared/rebind';\nimport findElement from '../shared/findElement';\nimport { setupArgsFn, teardownArgsFn } from '../shared/directiveArgs';\n\nconst missingDecorator = {\n  update: noop,\n  teardown: noop\n};\n\nexport default class Decorator {\n  constructor(options) {\n    this.owner = options.owner || options.up.owner || findElement(options.up);\n    this.element = this.owner.attributeByName ? this.owner : findElement(options.up);\n    this.up = options.up || this.owner.up;\n    this.ractive = this.owner.ractive;\n    const template = (this.template = options.template);\n\n    this.name = template.n;\n\n    this.node = null;\n    this.handle = null;\n\n    this.element.decorators.push(this);\n  }\n\n  bind() {\n    setupArgsFn(this, this.template, this.up, { register: true });\n  }\n\n  bubble() {\n    if (!this.dirty) {\n      this.dirty = true;\n      // decorators may be owned directly by an element or by a fragment if conditional\n      this.owner.bubble();\n      this.up.bubble();\n    }\n  }\n\n  destroyed() {\n    if (this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n    this.shouldDestroy = true;\n  }\n\n  handleChange() {\n    this.bubble();\n  }\n\n  rebind(next, previous, safe) {\n    const idx = this.models.indexOf(previous);\n    if (!~idx) return;\n\n    next = rebindMatch(this.template.f.r[idx], next, previous);\n    if (next === previous) return;\n\n    previous.unregister(this);\n    this.models.splice(idx, 1, next);\n    if (next) next.addShuffleRegister(this, 'mark');\n\n    if (!safe) this.bubble();\n  }\n\n  render() {\n    this.shouldDestroy = false;\n    if (this.handle) this.unrender();\n    runloop.scheduleTask(() => {\n      const fn = findInViewHierarchy('decorators', this.ractive, this.name);\n\n      if (!fn) {\n        warnOnce(missingPlugin(this.name, 'decorator'));\n        this.handle = missingDecorator;\n        return;\n      }\n\n      this.node = this.element.node;\n\n      let args;\n      if (this.fn) {\n        args = this.models.map(model => {\n          if (!model) return undefined;\n\n          return model.get();\n        });\n        args = this.fn.apply(this.ractive, args);\n      }\n\n      this.handle = fn.apply(this.ractive, [this.node].concat(args));\n\n      if (!this.handle || !this.handle.teardown) {\n        throw new Error(\n          `The '${this.name}' decorator must return an object with a teardown method`\n        );\n      }\n\n      // watch out for decorators that cause their host element to be unrendered\n      if (this.shouldDestroy) this.destroyed();\n    }, true);\n  }\n\n  toString() {\n    return '';\n  }\n\n  unbind() {\n    teardownArgsFn(this, this.template);\n  }\n\n  unrender(shouldDestroy) {\n    if ((!shouldDestroy || this.element.rendered) && this.handle) {\n      this.handle.teardown();\n      this.handle = null;\n    }\n  }\n\n  update() {\n    const instance = this.handle;\n\n    if (!this.dirty) {\n      if (instance && instance.invalidate) {\n        runloop.scheduleTask(() => instance.invalidate(), true);\n      }\n      return;\n    }\n\n    this.dirty = false;\n\n    if (instance) {\n      if (!instance.update) {\n        this.unrender();\n        this.render();\n      } else {\n        const args = this.models.map(model => model && model.get());\n        instance.update.apply(this.ractive, this.fn.apply(this.ractive, args));\n      }\n    }\n  }\n}\n","import noop from 'utils/noop';\nimport Item from './shared/Item';\n\nexport default class Doctype extends Item {\n  toString() {\n    return '<!DOCTYPE' + this.template.a + '>';\n  }\n}\n\nconst proto = Doctype.prototype;\nproto.bind = proto.render = proto.teardown = proto.unbind = proto.unrender = proto.update = noop;\n","import runloop from 'src/global/runloop';\nimport { warnOnceIfDebug } from 'utils/log';\nimport noop from 'utils/noop';\nimport findElement from '../../shared/findElement';\n\nexport default class Binding {\n  constructor(element, name = 'value') {\n    this.element = element;\n    this.ractive = element.ractive;\n    this.attribute = element.attributeByName[name];\n\n    const interpolator = this.attribute.interpolator;\n    interpolator.twowayBinding = this;\n\n    const model = interpolator.model;\n\n    if (model.isReadonly && !model.setRoot) {\n      const keypath = model.getKeypath().replace(/^@/, '');\n      warnOnceIfDebug(\n        `Cannot use two-way binding on <${\n          element.name\n        }> element: ${keypath} is read-only. To suppress this warning use <${\n          element.name\n        } twoway='false'...>`,\n        { ractive: this.ractive }\n      );\n      return false;\n    }\n\n    this.attribute.isTwoway = true;\n    this.model = model;\n\n    // initialise value, if it's undefined\n    let value = model.get();\n    this.wasUndefined = value === undefined;\n\n    if (value === undefined && this.getInitialValue) {\n      value = this.getInitialValue();\n      model.set(value);\n    }\n    this.lastVal(true, value);\n\n    const parentForm = findElement(this.element, false, 'form');\n    if (parentForm) {\n      this.resetValue = value;\n      parentForm.formBindings.push(this);\n    }\n  }\n\n  bind() {\n    this.model.registerTwowayBinding(this);\n  }\n\n  handleChange() {\n    const value = this.getValue();\n    if (this.lastVal() === value) return;\n\n    runloop.start();\n    this.attribute.locked = true;\n    this.model.set(value);\n    this.lastVal(true, value);\n\n    // if the value changes before observers fire, unlock to be updatable cause something weird and potentially freezy is up\n    if (this.model.get() !== value) this.attribute.locked = false;\n    else runloop.scheduleTask(() => (this.attribute.locked = false));\n\n    runloop.end();\n  }\n\n  lastVal(setting, value) {\n    if (setting) this.lastValue = value;\n    else return this.lastValue;\n  }\n\n  rebind(next, previous) {\n    if (this.model && this.model === previous) previous.unregisterTwowayBinding(this);\n    if (next) {\n      this.model = next;\n      runloop.scheduleTask(() => next.registerTwowayBinding(this));\n    }\n  }\n\n  render() {\n    this.node = this.element.node;\n    this.node._ractive.binding = this;\n    this.rendered = true; // TODO is this used anywhere?\n  }\n\n  setFromNode(node) {\n    this.model.set(node.value);\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n  }\n}\n\nBinding.prototype.unrender = noop;\n","import Binding from './Binding';\nimport handleDomEvent from './handleDomEvent';\n\nexport default class CheckboxBinding extends Binding {\n  constructor(element) {\n    super(element, 'checked');\n  }\n\n  render() {\n    super.render();\n\n    this.element.on('change', handleDomEvent);\n\n    if (this.node.attachEvent) {\n      this.element.on('click', handleDomEvent);\n    }\n  }\n\n  unrender() {\n    this.element.off('change', handleDomEvent);\n    this.element.off('click', handleDomEvent);\n  }\n\n  getInitialValue() {\n    return !!this.element.getAttribute('checked');\n  }\n\n  getValue() {\n    return this.node.checked;\n  }\n\n  setFromNode(node) {\n    this.model.set(node.checked);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport Binding from './Binding';\n\nexport default function getBindingGroup(group, model, getValue) {\n  const hash = `${group}-bindingGroup`;\n  return model[hash] || (model[hash] = new BindingGroup(hash, model, getValue));\n}\n\nclass BindingGroup {\n  constructor(hash, model, getValue) {\n    this.model = model;\n    this.hash = hash;\n    this.getValue = () => {\n      this.value = getValue.call(this);\n      return this.value;\n    };\n\n    this.bindings = [];\n  }\n\n  add(binding) {\n    this.bindings.push(binding);\n  }\n\n  bind() {\n    this.value = this.model.get();\n    this.model.registerTwowayBinding(this);\n    this.bound = true;\n  }\n\n  remove(binding) {\n    removeFromArray(this.bindings, binding);\n    if (!this.bindings.length) {\n      this.unbind();\n    }\n  }\n\n  unbind() {\n    this.model.unregisterTwowayBinding(this);\n    this.bound = false;\n    delete this.model[this.hash];\n  }\n}\n\nBindingGroup.prototype.rebind = Binding.prototype.rebind;\n","import runloop from 'src/global/runloop';\n\n// TODO what happens if a transition is aborted?\n\nconst tickers = [];\nlet running = false;\n\nfunction tick() {\n  runloop.start();\n\n  const now = performance.now();\n\n  let i;\n  let ticker;\n\n  for (i = 0; i < tickers.length; i += 1) {\n    ticker = tickers[i];\n\n    if (!ticker.tick(now)) {\n      // ticker is complete, remove it from the stack, and decrement i so we don't miss one\n      tickers.splice(i--, 1);\n    }\n  }\n\n  runloop.end();\n\n  if (tickers.length) {\n    requestAnimationFrame(tick);\n  } else {\n    running = false;\n  }\n}\n\nexport default class Ticker {\n  constructor(options) {\n    this.duration = options.duration;\n    this.step = options.step;\n    this.complete = options.complete;\n    this.easing = options.easing;\n\n    this.start = performance.now();\n    this.end = this.start + this.duration;\n\n    this.running = true;\n\n    tickers.push(this);\n    if (!running) requestAnimationFrame(tick);\n  }\n\n  tick(now) {\n    if (!this.running) return false;\n\n    if (now > this.end) {\n      if (this.step) this.step(1);\n      if (this.complete) this.complete(1);\n\n      return false;\n    }\n\n    const elapsed = now - this.start;\n    const eased = this.easing(elapsed / this.duration);\n\n    if (this.step) this.step(eased);\n\n    return true;\n  }\n\n  stop() {\n    if (this.abort) this.abort();\n    this.running = false;\n  }\n}\n","import { hasOwn } from 'utils/object';\nimport { isString, isObjectType } from 'utils/is';\n\nconst prefixers = {};\n\n// TODO this is legacy. sooner we can replace the old adaptor API the better\n/* istanbul ignore next */\nfunction prefixKeypath(obj, prefix) {\n  const prefixed = {};\n\n  if (!prefix) {\n    return obj;\n  }\n\n  prefix += '.';\n\n  for (const key in obj) {\n    if (hasOwn(obj, key)) {\n      prefixed[prefix + key] = obj[key];\n    }\n  }\n\n  return prefixed;\n}\n\nexport default function getPrefixer(rootKeypath) {\n  let rootDot;\n\n  if (!prefixers[rootKeypath]) {\n    rootDot = rootKeypath ? rootKeypath + '.' : '';\n\n    /* istanbul ignore next */\n    prefixers[rootKeypath] = function(relativeKeypath, value) {\n      let obj;\n\n      if (isString(relativeKeypath)) {\n        obj = {};\n        obj[rootDot + relativeKeypath] = value;\n        return obj;\n      }\n\n      if (isObjectType(relativeKeypath)) {\n        // 'relativeKeypath' is in fact a hash, not a keypath\n        return rootDot ? prefixKeypath(relativeKeypath, rootKeypath) : relativeKeypath;\n      }\n    };\n  }\n\n  return prefixers[rootKeypath];\n}\n","import ModelBase, { maybeBind, shuffle } from './ModelBase';\nimport LinkModel from './LinkModel'; // eslint-disable-line no-unused-vars\nimport KeypathModel from './specials/KeypathModel';\nimport { capture } from 'src/global/capture';\nimport { isArray, isEqual, isNumeric, isObjectLike } from 'utils/is';\nimport { handleChange, mark, markForce, marked, teardown } from 'shared/methodCallers';\nimport Ticker from 'shared/Ticker';\nimport getPrefixer from './helpers/getPrefixer';\nimport { unescapeKey } from 'shared/keypaths';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn } from 'utils/object';\n\nexport default class Model extends ModelBase {\n  constructor(parent, key) {\n    super(parent);\n\n    this.ticker = null;\n\n    if (parent) {\n      this.key = unescapeKey(key);\n      this.isReadonly = parent.isReadonly;\n\n      if (parent.value) {\n        this.value = parent.value[this.key];\n        if (isArray(this.value)) this.length = this.value.length;\n        this.adapt();\n      }\n    }\n  }\n\n  adapt() {\n    const adaptors = this.root.adaptors;\n    const len = adaptors.length;\n\n    this.rewrap = false;\n\n    // Exit early if no adaptors\n    if (len === 0) return;\n\n    const value = this.wrapper\n      ? 'newWrapperValue' in this\n        ? this.newWrapperValue\n        : this.wrapperValue\n      : this.value;\n\n    // TODO remove this legacy nonsense\n    const ractive = this.root.ractive;\n    const keypath = this.getKeypath();\n\n    // tear previous adaptor down if present\n    if (this.wrapper) {\n      const shouldTeardown =\n        this.wrapperValue === value\n          ? false\n          : !this.wrapper.reset || this.wrapper.reset(value) === false;\n\n      if (shouldTeardown) {\n        this.wrapper.teardown();\n        delete this.wrapper;\n        delete this.wrapperValue;\n\n        // don't branch for undefined values\n        if (this.value !== undefined) {\n          const parentValue = this.parent.value || this.parent.createBranch(this.key);\n          if (parentValue[this.key] !== value) parentValue[this.key] = value;\n          this.value = value;\n        }\n      } else {\n        delete this.newWrapperValue;\n        this.value = this.wrapper.get();\n        return;\n      }\n    }\n\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const adaptor = adaptors[i];\n      if (adaptor.filter(value, keypath, ractive)) {\n        this.wrapper = adaptor.wrap(ractive, value, keypath, getPrefixer(keypath));\n        this.wrapperValue = value;\n        this.wrapper.__model = this; // massive temporary hack to enable array adaptor\n\n        this.value = this.wrapper.get();\n\n        break;\n      }\n    }\n  }\n\n  animate(from, to, options, interpolator) {\n    if (this.ticker) this.ticker.stop();\n\n    let fulfilPromise;\n    const promise = new Promise(fulfil => (fulfilPromise = fulfil));\n\n    this.ticker = new Ticker({\n      duration: options.duration,\n      easing: options.easing,\n      step: t => {\n        const value = interpolator(t);\n        this.applyValue(value);\n        if (options.step) options.step(t, value);\n      },\n      complete: () => {\n        this.applyValue(to);\n        if (options.complete) options.complete(to);\n\n        this.ticker = null;\n        fulfilPromise(to);\n      }\n    });\n\n    promise.stop = this.ticker.stop;\n    return promise;\n  }\n\n  applyValue(value, notify = true) {\n    if (isEqual(value, this.value)) return;\n    if (this.boundValue) this.boundValue = null;\n\n    if (this.parent.wrapper && this.parent.wrapper.set) {\n      this.parent.wrapper.set(this.key, value);\n      this.parent.value = this.parent.wrapper.get();\n\n      this.value = this.parent.value[this.key];\n      if (this.wrapper) this.newWrapperValue = this.value;\n      this.adapt();\n    } else if (this.wrapper) {\n      this.newWrapperValue = value;\n      this.adapt();\n    } else {\n      const parentValue = this.parent.value || this.parent.createBranch(this.key);\n      if (isObjectLike(parentValue)) {\n        parentValue[this.key] = value;\n      } else {\n        warnIfDebug(`Attempted to set a property of a non-object '${this.getKeypath()}'`);\n        return;\n      }\n\n      this.value = value;\n      this.adapt();\n    }\n\n    // keep track of array stuff\n    if (isArray(value)) {\n      this.length = value.length;\n      this.isArray = true;\n    } else {\n      this.isArray = false;\n    }\n\n    // notify dependants\n    this.links.forEach(handleChange);\n    this.children.forEach(mark);\n    this.deps.forEach(handleChange);\n\n    if (notify) this.notifyUpstream();\n\n    if (this.parent.isArray) {\n      if (this.key === 'length') this.parent.length = value;\n      else this.parent.joinKey('length').mark();\n    }\n  }\n\n  createBranch(key) {\n    const branch = isNumeric(key) ? [] : {};\n    this.applyValue(branch, false);\n\n    return branch;\n  }\n\n  get(shouldCapture, opts) {\n    if (this._link) return this._link.get(shouldCapture, opts);\n    if (shouldCapture) capture(this);\n    // if capturing, this value needs to be unwrapped because it's for external use\n    if (opts && opts.virtual) return this.getVirtual(false);\n    return maybeBind(\n      this,\n      (opts && 'unwrap' in opts ? opts.unwrap !== false : shouldCapture) && this.wrapper\n        ? this.wrapperValue\n        : this.value,\n      !opts || opts.shouldBind !== false\n    );\n  }\n\n  getKeypathModel() {\n    if (!this.keypathModel) this.keypathModel = new KeypathModel(this);\n    return this.keypathModel;\n  }\n\n  joinKey(key, opts) {\n    if (this._link) {\n      if (opts && opts.lastLink !== false && (key === undefined || key === '')) return this;\n      return this._link.joinKey(key);\n    }\n\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new Model(this, key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    if (this.childByKey[key]._link && (!opts || opts.lastLink !== false))\n      return this.childByKey[key]._link;\n    return this.childByKey[key];\n  }\n\n  mark(force) {\n    if (this._link) return this._link.mark(force);\n\n    const old = this.value;\n    const value = this.retrieve();\n\n    if (force || !isEqual(value, old)) {\n      this.value = value;\n      if (this.boundValue) this.boundValue = null;\n\n      // make sure the wrapper stays in sync\n      if (old !== value || this.rewrap) {\n        if (this.wrapper) this.newWrapperValue = value;\n        this.adapt();\n      }\n\n      // keep track of array stuff\n      if (isArray(value)) {\n        this.length = value.length;\n        this.isArray = true;\n      } else {\n        this.isArray = false;\n      }\n\n      this.children.forEach(force ? markForce : mark);\n      this.links.forEach(marked);\n\n      this.deps.forEach(handleChange);\n    }\n  }\n\n  merge(array, comparator) {\n    let oldArray = this.value;\n    let newArray = array;\n    if (oldArray === newArray) oldArray = recreateArray(this);\n    if (comparator) {\n      oldArray = oldArray.map(comparator);\n      newArray = newArray.map(comparator);\n    }\n\n    const oldLength = oldArray.length;\n\n    const usedIndices = {};\n    let firstUnusedIndex = 0;\n\n    const newIndices = oldArray.map(item => {\n      let index;\n      let start = firstUnusedIndex;\n\n      do {\n        index = newArray.indexOf(item, start);\n\n        if (index === -1) {\n          return -1;\n        }\n\n        start = index + 1;\n      } while (usedIndices[index] === true && start < oldLength);\n\n      // keep track of the first unused index, so we don't search\n      // the whole of newArray for each item in oldArray unnecessarily\n      if (index === firstUnusedIndex) {\n        firstUnusedIndex += 1;\n      }\n      // allow next instance of next \"equal\" to be found item\n      usedIndices[index] = true;\n      return index;\n    });\n\n    this.parent.value[this.key] = array;\n    this.shuffle(newIndices, true);\n  }\n\n  retrieve() {\n    return this.parent.value ? this.parent.value[this.key] : undefined;\n  }\n\n  set(value) {\n    if (this.ticker) this.ticker.stop();\n    this.applyValue(value);\n  }\n\n  shuffle(newIndices, unsafe) {\n    shuffle(this, newIndices, false, unsafe);\n  }\n\n  source() {\n    return this;\n  }\n\n  teardown() {\n    if (this._link) {\n      this._link.teardown();\n      this._link = null;\n    }\n    this.children.forEach(teardown);\n    if (this.wrapper) this.wrapper.teardown();\n    if (this.keypathModel) this.keypathModel.teardown();\n  }\n}\n\nfunction recreateArray(model) {\n  const array = [];\n\n  for (let i = 0; i < model.length; i++) {\n    array[i] = (model.childByKey[i] || {}).value;\n  }\n\n  return array;\n}\n","/* global global */\nimport Model from '../Model';\n\nexport const data = {};\n\nexport class SharedModel extends Model {\n  constructor(value, name) {\n    super(null, `@${name}`);\n    this.key = `@${name}`;\n    this.value = value;\n    this.isRoot = true;\n    this.root = this;\n    this.adaptors = [];\n  }\n\n  getKeypath() {\n    return this.key;\n  }\n\n  retrieve() {\n    return this.value;\n  }\n}\n\nexport default new SharedModel(data, 'shared');\n\nexport const GlobalModel = new SharedModel(\n  typeof global !== 'undefined' ? global : window,\n  'global'\n);\n","import { splitKeypath } from 'shared/keypaths';\nimport SharedModel, { GlobalModel } from 'src/model/specials/SharedModel';\nimport { warnIfDebug } from 'utils/log';\nimport { hasOwn } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nexport default function resolveReference(fragment, ref) {\n  const initialFragment = fragment;\n  // current context ref\n  if (ref === '.') return fragment.findContext();\n\n  // ancestor references\n  if (ref[0] === '~') return fragment.ractive.viewmodel.joinAll(splitKeypath(ref.slice(2)));\n\n  // scoped references\n  if (ref[0] === '.' || ref[0] === '^') {\n    let frag = fragment;\n    const parts = ref.split('/');\n    const explicitContext = parts[0] === '^^';\n    let context = explicitContext ? null : fragment.findContext();\n\n    // account for the first context hop\n    if (explicitContext) parts.unshift('^^');\n\n    // walk up the context chain\n    while (parts[0] === '^^') {\n      parts.shift();\n      context = null;\n      while (frag && !context) {\n        context = frag.context;\n        frag = frag.parent.component ? frag.parent.component.up : frag.parent;\n      }\n    }\n\n    if (!context && explicitContext) {\n      throw new Error(\n        `Invalid context parent reference ('${ref}'). There is not context at that level.`\n      );\n    }\n\n    // walk up the context path\n    while (parts[0] === '.' || parts[0] === '..') {\n      const part = parts.shift();\n\n      if (part === '..') {\n        context = context.parent;\n      }\n    }\n\n    ref = parts.join('/');\n\n    // special case - `{{.foo}}` means the same as `{{./foo}}`\n    if (ref[0] === '.') ref = ref.slice(1);\n    return context.joinAll(splitKeypath(ref));\n  }\n\n  const keys = splitKeypath(ref);\n  if (!keys.length) return;\n  const base = keys.shift();\n\n  // special refs\n  if (base[0] === '@') {\n    // shorthand from outside the template\n    // @this referring to local ractive instance\n    if (base === '@this' || base === '@') {\n      return fragment.ractive.viewmodel.getRactiveModel().joinAll(keys);\n    } else if (base === '@index' || base === '@key') {\n      // @index or @key referring to the nearest repeating index or key\n      if (keys.length) badReference(base);\n      const repeater = fragment.findRepeatingFragment();\n      // make sure the found fragment is actually an iteration\n      if (!repeater.isIteration) return;\n      return (\n        repeater.context && repeater.context.getKeyModel(repeater[ref[1] === 'i' ? 'index' : 'key'])\n      );\n    } else if (base === '@global') {\n      // @global referring to window or global\n      return GlobalModel.joinAll(keys);\n    } else if (base === '@shared') {\n      // @global referring to window or global\n      return SharedModel.joinAll(keys);\n    } else if (base === '@keypath' || base === '@rootpath') {\n      // @keypath or @rootpath, the current keypath string\n      const root = ref[1] === 'r' ? fragment.ractive.root : null;\n      let context = fragment.findContext();\n\n      // skip over component roots, which provide no context\n      while (root && context.isRoot && context.ractive.component) {\n        context = context.ractive.component.up.findContext();\n      }\n\n      return context.getKeypathModel(root);\n    } else if (base === '@context') {\n      return new ContextModel(fragment.getContext());\n    } else if (base === '@local') {\n      // @context-local data\n      return fragment.getContext()._data.joinAll(keys);\n    } else if (base === '@style') {\n      // @style shared model\n      return fragment.ractive.constructor._cssModel.joinAll(keys);\n    } else {\n      // nope\n      throw new Error(`Invalid special reference '${base}'`);\n    }\n  }\n\n  const context = fragment.findContext();\n\n  // check immediate context for a match\n  if (context.has(base)) {\n    return context.joinKey(base).joinAll(keys);\n  }\n\n  // walk up the fragment hierarchy looking for a matching ref, alias, or key in a context\n  let createMapping = false;\n  const shouldWarn = fragment.ractive.warnAboutAmbiguity;\n  let model;\n\n  while (fragment) {\n    // repeated fragments\n    if (fragment.isIteration) {\n      if (base === fragment.parent.keyRef) {\n        model = fragment.context.getKeyModel(fragment.key);\n      } else if (base === fragment.parent.indexRef) {\n        model = fragment.context.getKeyModel(fragment.index);\n      }\n\n      if (model && keys.length) badReference(base);\n    }\n\n    // alias node or iteration\n    if (!model && fragment.aliases && hasOwn(fragment.aliases, base)) {\n      model = fragment.aliases[base];\n    }\n\n    // check fragment context to see if it has the key we need\n    if (!model && fragment.context && fragment.context.has(base)) {\n      model = fragment.context.joinKey(base);\n\n      // this is an implicit mapping\n      if (createMapping) {\n        if (shouldWarn)\n          warnIfDebug(\n            `'${ref}' resolved but is ambiguous and will create a mapping to a parent component.`\n          );\n      } else if (shouldWarn) warnIfDebug(`'${ref}' resolved but is ambiguous.`);\n    }\n\n    if (model) {\n      if (createMapping) {\n        model = initialFragment.ractive.viewmodel.createLink(base, model, base, { implicit: true });\n      }\n\n      if (keys.length > 0 && isFunction(model.joinAll)) {\n        model = model.joinAll(keys);\n      }\n\n      return model;\n    }\n\n    if (\n      (fragment.componentParent || (!fragment.parent && fragment.ractive.component)) &&\n      !fragment.ractive.isolated\n    ) {\n      // ascend through component boundary\n      fragment = fragment.componentParent || fragment.ractive.component.up;\n      createMapping = true;\n    } else {\n      fragment = fragment.parent;\n    }\n  }\n\n  // if enabled, check the instance for a match\n  const instance = initialFragment.ractive;\n  if (instance.resolveInstanceMembers && base !== 'data' && base in instance) {\n    return instance.viewmodel\n      .getRactiveModel()\n      .joinKey(base)\n      .joinAll(keys);\n  }\n\n  if (shouldWarn) {\n    warnIfDebug(`'${ref}' is ambiguous and did not resolve.`);\n  }\n\n  // didn't find anything, so go ahead and create the key on the local model\n  return context.joinKey(base).joinAll(keys);\n}\n\nfunction badReference(key) {\n  throw new Error(`An index or key reference (${key}) cannot have child properties`);\n}\n\nclass ContextModel {\n  constructor(context) {\n    this.context = context;\n  }\n\n  get() {\n    return this.context;\n  }\n}\n","import noop from 'utils/noop';\nimport { assign, create } from 'utils/object';\n\nexport const extern = {};\n\nexport default function getRactiveContext(ractive, ...assigns) {\n  const fragment =\n    ractive.fragment ||\n    ractive._fakeFragment ||\n    (ractive._fakeFragment = new FakeFragment(ractive));\n  return fragment.getContext.apply(fragment, assigns);\n}\n\nexport function getContext(...assigns) {\n  if (!this.ctx) this.ctx = new extern.Context(this);\n  assigns.unshift(create(this.ctx));\n  return assign.apply(null, assigns);\n}\n\nexport class FakeFragment {\n  constructor(ractive) {\n    this.ractive = ractive;\n  }\n\n  findContext() {\n    return this.ractive.viewmodel;\n  }\n}\nconst proto = FakeFragment.prototype;\nproto.getContext = getContext;\nproto.find = proto.findComponent = proto.findAll = proto.findAllComponents = noop;\n\nexport function findParentWithContext(fragment) {\n  let frag = fragment;\n  while (frag && !frag.context) frag = frag.parent;\n  if (!frag) return fragment && fragment.ractive.fragment;\n  else return frag;\n}\n","import { isArray, isObject, isObjectType, isFunction, isString } from 'utils/is';\nimport { warnIfDebug } from 'utils/log';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from '../global/runloop';\nimport { splitKeypath } from './keypaths';\nimport { FakeFragment } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\n\nexport let keep = false;\n\nexport function set(pairs, options) {\n  const k = keep;\n\n  const deep = options && options.deep;\n  const shuffle = options && options.shuffle;\n  const promise = runloop.start();\n  if (options && 'keep' in options) keep = options.keep;\n\n  let i = pairs.length;\n  while (i--) {\n    const model = pairs[i][0];\n    const value = pairs[i][1];\n    const keypath = pairs[i][2];\n\n    if (!model) {\n      runloop.end();\n      throw new Error(`Failed to set invalid keypath '${keypath}'`);\n    }\n\n    if (deep) deepSet(model, value);\n    else if (shuffle) {\n      let array = value;\n      const target = model.get();\n      // shuffle target array with itself\n      if (!array) array = target;\n\n      // if there's not an array there yet, go ahead and set\n      if (target === undefined) {\n        model.set(array);\n      } else {\n        if (!isArray(target) || !isArray(array)) {\n          runloop.end();\n          throw new Error('You cannot merge an array with a non-array');\n        }\n\n        const comparator = getComparator(shuffle);\n        model.merge(array, comparator);\n      }\n    } else model.set(value);\n  }\n\n  runloop.end();\n\n  keep = k;\n\n  return promise;\n}\n\nconst star = /\\*/;\nexport function gather(ractive, keypath, base, isolated) {\n  if (!base && (keypath[0] === '.' || keypath[1] === '^')) {\n    warnIfDebug(\n      `Attempted to set a relative keypath from a non-relative context. You can use a context object to set relative keypaths.`\n    );\n    return [];\n  }\n\n  const keys = splitKeypath(keypath);\n  const model = base || ractive.viewmodel;\n\n  if (star.test(keypath)) {\n    return model.findMatches(keys);\n  } else {\n    if (model === ractive.viewmodel) {\n      // allow implicit mappings\n      if (\n        ractive.component &&\n        !ractive.isolated &&\n        !model.has(keys[0]) &&\n        keypath[0] !== '@' &&\n        keypath[0] &&\n        !isolated\n      ) {\n        return [resolveReference(ractive.fragment || new FakeFragment(ractive), keypath)];\n      } else {\n        return [model.joinAll(keys)];\n      }\n    } else {\n      return [model.joinAll(keys)];\n    }\n  }\n}\n\nexport function build(ractive, keypath, value, isolated) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push.apply(sets, gather(ractive, k, null, isolated).map(m => [m, keypath[k], k]));\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push.apply(sets, gather(ractive, keypath, null, isolated).map(m => [m, value, keypath]));\n  }\n\n  return sets;\n}\n\nconst deepOpts = { virtual: false };\nfunction deepSet(model, value) {\n  const dest = model.get(false, deepOpts);\n\n  // if dest doesn't exist, just set it\n  if (dest == null || !isObjectType(value)) return model.set(value);\n  if (!isObjectType(dest)) return model.set(value);\n\n  for (const k in value) {\n    if (hasOwn(value, k)) {\n      deepSet(model.joinKey(k), value[k]);\n    }\n  }\n}\n\nconst comparators = {};\nfunction getComparator(option) {\n  if (option === true) return null; // use existing arrays\n  if (isFunction(option)) return option;\n\n  if (isString(option)) {\n    return comparators[option] || (comparators[option] = thing => thing[option]);\n  }\n\n  throw new Error('If supplied, options.compare must be a string, function, or true'); // TODO link to docs\n}\n","import { isNumeric, isString } from 'utils/is';\nimport { build, set } from 'shared/set';\n\nconst errorMessage = 'Cannot add to a non-numeric value';\n\nexport default function add(ractive, keypath, d, options) {\n  if (!isString(keypath) || !isNumeric(d)) {\n    throw new Error('Bad arguments');\n  }\n\n  const sets = build(ractive, keypath, d, options && options.isolated);\n\n  return set(\n    sets.map(pair => {\n      const [model, add] = pair;\n      const value = model.get();\n      if (!isNumeric(add) || !isNumeric(value)) throw new Error(errorMessage);\n      return [model, value + add];\n    })\n  );\n}\n","import runloop from 'src/global/runloop';\nimport easing from 'src/Ractive/static/easing';\nimport interpolate from 'shared/interpolate';\nimport { isEqual, isFunction, isObjectType } from 'utils/is';\nimport noop from 'utils/noop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { defineProperty, keys as objectKeys } from 'utils/object';\n\nfunction immediate(value) {\n  const result = Promise.resolve(value);\n  defineProperty(result, 'stop', { value: noop });\n  return result;\n}\n\nconst linear = easing.linear;\n\nfunction getOptions(options, instance) {\n  options = options || {};\n\n  let easing;\n  if (options.easing) {\n    easing = isFunction(options.easing) ? options.easing : instance.easing[options.easing];\n  }\n\n  return {\n    easing: easing || linear,\n    duration: 'duration' in options ? options.duration : 400,\n    complete: options.complete || noop,\n    step: options.step || noop,\n    interpolator: options.interpolator\n  };\n}\n\nexport function animate(ractive, model, to, options) {\n  options = getOptions(options, ractive);\n  const from = model.get();\n\n  // don't bother animating values that stay the same\n  if (isEqual(from, to)) {\n    options.complete(options.to);\n    return immediate(to);\n  }\n\n  const interpolator = interpolate(from, to, ractive, options.interpolator);\n\n  // if we can't interpolate the value, set it immediately\n  if (!interpolator) {\n    runloop.start();\n    model.set(to);\n    runloop.end();\n\n    return immediate(to);\n  }\n\n  return model.animate(from, to, options, interpolator);\n}\n\nexport default function Ractive$animate(keypath, to, options) {\n  if (isObjectType(keypath)) {\n    const keys = objectKeys(keypath);\n\n    throw new Error(`ractive.animate(...) no longer supports objects. Instead of ractive.animate({\n  ${keys.map(key => `'${key}': ${keypath[key]}`).join('\\n  ')}\n}, {...}), do\n\n${keys.map(key => `ractive.animate('${key}', ${keypath[key]}, {...});`).join('\\n')}\n`);\n  }\n\n  return animate(this, this.viewmodel.joinAll(splitKeypath(keypath)), to, options);\n}\n","import { enqueue, dequeue } from './eventStack';\n\nconst initStars = {};\nconst bubbleStars = {};\n\n// cartesian product of name parts and stars\n// adjusted appropriately for special cases\nfunction variants(name, initial) {\n  const map = initial ? initStars : bubbleStars;\n  if (map[name]) return map[name];\n\n  const parts = name.split('.');\n  const result = [];\n  let base = false;\n\n  // initial events the implicit namespace of 'this'\n  if (initial) {\n    parts.unshift('this');\n    base = true;\n  }\n\n  // use max - 1 bits as a bitmap to pick a part or a *\n  // need to skip the full star case if the namespace is synthetic\n  const max = Math.pow(2, parts.length) - (initial ? 1 : 0);\n  for (let i = 0; i < max; i++) {\n    const join = [];\n    for (let j = 0; j < parts.length; j++) {\n      join.push(1 & (i >> j) ? '*' : parts[j]);\n    }\n    result.unshift(join.join('.'));\n  }\n\n  if (base) {\n    // include non-this-namespaced versions\n    if (parts.length > 2) {\n      result.push.apply(result, variants(name, false));\n    } else {\n      result.push('*');\n      result.push(name);\n    }\n  }\n\n  map[name] = result;\n  return result;\n}\n\nexport default function fireEvent(ractive, eventName, context, args = []) {\n  if (!eventName) {\n    return;\n  }\n\n  context.name = eventName;\n  args.unshift(context);\n\n  const eventNames = ractive._nsSubs ? variants(eventName, true) : ['*', eventName];\n\n  return fireEventAs(ractive, eventNames, context, args, true);\n}\n\nfunction fireEventAs(ractive, eventNames, context, args, initialFire = false) {\n  let bubble = true;\n\n  if (initialFire || ractive._nsSubs) {\n    enqueue(ractive, context);\n\n    let i = eventNames.length;\n    while (i--) {\n      if (eventNames[i] in ractive._subs) {\n        bubble = notifySubscribers(ractive, ractive._subs[eventNames[i]], context, args) && bubble;\n      }\n    }\n\n    dequeue(ractive);\n  }\n\n  if (ractive.parent && bubble) {\n    if (initialFire && ractive.component) {\n      const fullName = ractive.component.name + '.' + eventNames[eventNames.length - 1];\n      eventNames = variants(fullName, false);\n\n      if (context && !context.component) {\n        context.component = ractive;\n      }\n    }\n\n    bubble = fireEventAs(ractive.parent, eventNames, context, args);\n  }\n\n  return bubble;\n}\n\nfunction notifySubscribers(ractive, subscribers, context, args) {\n  let originalEvent = null;\n  let stopEvent = false;\n\n  // subscribers can be modified inflight, e.g. \"once\" functionality\n  // so we need to copy to make sure everyone gets called\n  subscribers = subscribers.slice();\n\n  for (let i = 0, len = subscribers.length; i < len; i += 1) {\n    if (!subscribers[i].off && subscribers[i].handler.apply(ractive, args) === false) {\n      stopEvent = true;\n    }\n  }\n\n  if (context && stopEvent && (originalEvent = context.event)) {\n    originalEvent.preventDefault && originalEvent.preventDefault();\n    originalEvent.stopPropagation && originalEvent.stopPropagation();\n  }\n\n  return !stopEvent;\n}\n","import fireEvent from './fireEvent';\nimport getRactiveContext from '../shared/getRactiveContext';\n\nexport default class Hook {\n  constructor(event) {\n    this.event = event;\n    this.method = 'on' + event;\n  }\n\n  fire(ractive, arg) {\n    const context = getRactiveContext(ractive);\n\n    if (ractive[this.method]) {\n      arg ? ractive[this.method](context, arg) : ractive[this.method](context);\n    }\n\n    fireEvent(ractive, this.event, context, arg ? [arg, ractive] : [ractive]);\n  }\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { unrenderChild, updateAnchors } from 'shared/anchors';\n\nconst attachHook = new Hook('attachchild');\n\nexport default function attachChild(child, options = {}) {\n  const children = this._children;\n  let idx;\n\n  if (child.parent && child.parent !== this)\n    throw new Error(\n      `Instance ${child._guid} is already attached to a different instance ${\n        child.parent._guid\n      }. Please detach it from the other instance using detachChild first.`\n    );\n  else if (child.parent)\n    throw new Error(`Instance ${child._guid} is already attached to this instance.`);\n\n  const meta = {\n    instance: child,\n    ractive: this,\n    name: options.name || child.constructor.name || 'Ractive',\n    target: options.target || false,\n    bubble,\n    findNextNode\n  };\n  meta.nameOption = options.name;\n\n  // child is managing itself\n  if (!meta.target) {\n    meta.up = this.fragment;\n    meta.external = true;\n  } else {\n    let list;\n    if (!(list = children.byName[meta.target])) {\n      list = [];\n      this.set(`@this.children.byName.${meta.target}`, list);\n    }\n    idx = options.prepend ? 0 : options.insertAt !== undefined ? options.insertAt : list.length;\n  }\n\n  child.set({\n    '@this.parent': this,\n    '@this.root': this.root\n  });\n  child.component = meta;\n  children.push(meta);\n\n  attachHook.fire(child);\n\n  const promise = runloop.start();\n\n  if (meta.target) {\n    unrenderChild(meta);\n    this.splice(`@this.children.byName.${meta.target}`, idx, 0, meta);\n    updateAnchors(this, meta.target);\n  } else {\n    if (!child.isolated) child.viewmodel.attached(this.fragment);\n  }\n\n  runloop.end();\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n\nfunction bubble() {\n  runloop.addFragment(this.instance.fragment);\n}\n\nfunction findNextNode() {\n  if (this.anchor) return this.anchor.findNextNode();\n}\n","import Hook from 'src/events/Hook';\nimport { removeFromArray } from 'utils/array';\n\nconst detachHook = new Hook('detach');\n\nexport default function Ractive$detach() {\n  if (this.isDetached) {\n    return this.el;\n  }\n\n  if (this.el) {\n    removeFromArray(this.el.__ractive_instances__, this);\n  }\n\n  this.el = this.fragment.detach();\n  this.isDetached = true;\n\n  detachHook.fire(this);\n  return this.el;\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { updateAnchors } from 'shared/anchors';\n\nconst detachHook = new Hook('detachchild');\n\nexport default function detachChild(child) {\n  const children = this._children;\n  let meta, index;\n\n  let i = children.length;\n  while (i--) {\n    if (children[i].instance === child) {\n      index = i;\n      meta = children[i];\n      break;\n    }\n  }\n\n  if (!meta || child.parent !== this)\n    throw new Error(`Instance ${child._guid} is not attached to this instance.`);\n\n  const promise = runloop.start();\n\n  if (meta.anchor) meta.anchor.removeChild(meta);\n  if (!child.isolated) child.viewmodel.detached();\n\n  runloop.end();\n\n  children.splice(index, 1);\n  if (meta.target) {\n    this.splice(\n      `@this.children.byName.${meta.target}`,\n      children.byName[meta.target].indexOf(meta),\n      1\n    );\n    updateAnchors(this, meta.target);\n  }\n  child.set({\n    '@this.parent': undefined,\n    '@this.root': child\n  });\n  child.component = null;\n\n  detachHook.fire(child);\n\n  promise.ractive = child;\n  return promise.then(() => child);\n}\n","export const TEXT = 1;\nexport const INTERPOLATOR = 2;\nexport const TRIPLE = 3;\nexport const SECTION = 4;\nexport const INVERTED = 5;\nexport const CLOSING = 6;\nexport const ELEMENT = 7;\nexport const PARTIAL = 8;\nexport const COMMENT = 9;\nexport const DELIMCHANGE = 10;\nexport const ANCHOR = 11;\nexport const ATTRIBUTE = 13;\nexport const CLOSING_TAG = 14;\nexport const COMPONENT = 15;\nexport const YIELDER = 16;\nexport const INLINE_PARTIAL = 17;\nexport const DOCTYPE = 18;\nexport const ALIAS = 19;\n\nexport const NUMBER_LITERAL = 20;\nexport const STRING_LITERAL = 21;\nexport const ARRAY_LITERAL = 22;\nexport const OBJECT_LITERAL = 23;\nexport const BOOLEAN_LITERAL = 24;\nexport const REGEXP_LITERAL = 25;\n\nexport const GLOBAL = 26;\nexport const KEY_VALUE_PAIR = 27;\n\nexport const REFERENCE = 30;\nexport const REFINEMENT = 31;\nexport const MEMBER = 32;\nexport const PREFIX_OPERATOR = 33;\nexport const BRACKETED = 34;\nexport const CONDITIONAL = 35;\nexport const INFIX_OPERATOR = 36;\n\nexport const INVOCATION = 40;\n\nexport const SECTION_IF = 50;\nexport const SECTION_UNLESS = 51;\nexport const SECTION_EACH = 52;\nexport const SECTION_WITH = 53;\nexport const SECTION_IF_WITH = 54;\n\nexport const ELSE = 60;\nexport const ELSEIF = 61;\n\nexport const EVENT = 70;\nexport const DECORATOR = 71;\nexport const TRANSITION = 72;\nexport const BINDING_FLAG = 73;\nexport const DELEGATE_FLAG = 74;\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\nimport getNewIndices from 'shared/getNewIndices';\nimport { isArray } from 'utils/is';\n\nconst arrayProto = Array.prototype;\n\nexport default function(methodName) {\n  function path(keypath, ...args) {\n    return model(this.viewmodel.joinAll(splitKeypath(keypath)), args);\n  }\n\n  function model(mdl, args) {\n    let array = mdl.get();\n\n    if (!isArray(array)) {\n      if (array === undefined) {\n        array = [];\n        const result = arrayProto[methodName].apply(array, args);\n        const promise = runloop.start().then(() => result);\n        mdl.set(array);\n        runloop.end();\n        return promise;\n      } else {\n        throw new Error(\n          `shuffle array method ${methodName} called on non-array at ${mdl.getKeypath()}`\n        );\n      }\n    }\n\n    const newIndices = getNewIndices(array.length, methodName, args);\n    const result = arrayProto[methodName].apply(array, args);\n\n    const promise = runloop.start().then(() => result);\n    promise.result = result;\n\n    if (newIndices) {\n      if (mdl.shuffle) {\n        mdl.shuffle(newIndices);\n      } else {\n        // it's a computation, which don't have a shuffle, so just invalidate\n        mdl.mark();\n      }\n    } else {\n      mdl.set(result);\n    }\n\n    runloop.end();\n\n    return promise;\n  }\n\n  return { path, model };\n}\n","import Hook from 'src/events/Hook';\nimport runloop from 'src/global/runloop';\nimport { splitKeypath } from 'shared/keypaths';\nimport { isString } from 'utils/is';\n\nconst updateHook = new Hook('update');\n\nexport function update(ractive, model, options) {\n  // if the parent is wrapped, the adaptor will need to be updated before\n  // updating on this keypath\n  if (model.parent && model.parent.wrapper) {\n    model.parent.adapt();\n  }\n\n  const promise = runloop.start();\n\n  model.mark(options && options.force);\n\n  // notify upstream of changes\n  model.notifyUpstream();\n\n  runloop.end();\n\n  updateHook.fire(ractive, model);\n\n  return promise;\n}\n\nexport default function Ractive$update(keypath, options) {\n  let opts, path;\n\n  if (isString(keypath)) {\n    path = splitKeypath(keypath);\n    opts = options;\n  } else {\n    opts = keypath;\n  }\n\n  return update(this, path ? this.viewmodel.joinAll(path) : this.viewmodel, opts);\n}\n","import resolveReference from 'src/view/resolvers/resolveReference';\nimport Model from 'src/model/Model';\nimport { isNumeric, isObject, isNumber, isObjectType, isString } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport findElement from 'src/view/items/shared/findElement';\nimport { set as sharedSet } from './set';\nimport makeArrayMethod from '../Ractive/prototype/shared/makeArrayMethod';\nimport { animate as protoAnimate } from '../Ractive/prototype/animate';\nimport { update as protoUpdate } from '../Ractive/prototype/update';\nimport getRactiveContext, { extern, findParentWithContext } from './getRactiveContext';\nimport { hasOwn } from 'utils/object';\nimport { ELEMENT, EVENT } from 'config/types';\n\nconst modelPush = makeArrayMethod('push').model;\nconst modelPop = makeArrayMethod('pop').model;\nconst modelShift = makeArrayMethod('shift').model;\nconst modelUnshift = makeArrayMethod('unshift').model;\nconst modelSort = makeArrayMethod('sort').model;\nconst modelSplice = makeArrayMethod('splice').model;\nconst modelReverse = makeArrayMethod('reverse').model;\n\nclass ContextData extends Model {\n  constructor(options) {\n    super(null, null);\n\n    this.isRoot = true;\n    this.root = this;\n    this.value = {};\n    this.ractive = options.ractive;\n    this.adaptors = [];\n    this.context = options.context;\n  }\n\n  getKeypath() {\n    return '@context.data';\n  }\n}\n\nexport default class Context {\n  constructor(fragment, element) {\n    this.fragment = fragment;\n    this.element = element || findElement(fragment);\n    this.node = this.element && this.element.node;\n    this.ractive = fragment.ractive;\n    this.root = this;\n  }\n\n  get decorators() {\n    const items = {};\n    if (!this.element) return items;\n    this.element.decorators.forEach(d => (items[d.name] = d.handle));\n    return items;\n  }\n\n  get _data() {\n    return (\n      this.model ||\n      (this.root.model = new ContextData({\n        ractive: this.ractive,\n        context: this.root\n      }))\n    );\n  }\n\n  // the usual mutation suspects\n  add(keypath, d, options) {\n    const num = isNumber(d) ? +d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value + val];\n      }),\n      opts\n    );\n  }\n\n  animate(keypath, value, options) {\n    const model = findModel(this, keypath).model;\n    return protoAnimate(this.ractive, model, value, options);\n  }\n\n  // get relative keypaths and values\n  get(keypath) {\n    if (!keypath) return this.fragment.findContext().get(true);\n\n    const { model } = findModel(this, keypath);\n\n    return model ? model.get(true) : undefined;\n  }\n\n  getParent(component) {\n    let fragment = this.fragment;\n\n    if (fragment.context)\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n    else {\n      fragment = findParentWithContext(fragment.parent || (component && fragment.componentParent));\n      if (fragment)\n        fragment = findParentWithContext(\n          fragment.parent || (component && fragment.componentParent)\n        );\n    }\n\n    if (!fragment || fragment === this.fragment) return;\n    else return fragment.getContext();\n  }\n\n  hasListener(name, bubble) {\n    let el = this.element || this.fragment.owner;\n\n    do {\n      if (el.template.t === ELEMENT) {\n        if (findEvent(el, name)) return true;\n      }\n      el = el.up && el.up.owner;\n      if (el && el.component) el = el.component;\n    } while (el && bubble);\n  }\n\n  link(source, dest) {\n    const there = findModel(this, source).model;\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    here.link(there, source);\n    runloop.end();\n    return promise;\n  }\n\n  listen(event, handler) {\n    const el = this.element;\n    el.on(event, handler);\n    return {\n      cancel() {\n        el.off(event, handler);\n      }\n    };\n  }\n\n  observe(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observe(keypath, callback, options);\n  }\n\n  observeOnce(keypath, callback, options = {}) {\n    if (isObject(keypath)) options = callback || {};\n    options.fragment = this.fragment;\n    return this.ractive.observeOnce(keypath, callback, options);\n  }\n\n  pop(keypath) {\n    return modelPop(findModel(this, keypath).model, []);\n  }\n\n  push(keypath, ...values) {\n    return modelPush(findModel(this, keypath).model, values);\n  }\n\n  raise(name, event, ...args) {\n    let el = this.element;\n    let ev;\n\n    while (el) {\n      if (el.component) el = el.component;\n      ev = findEvent(el, name);\n      if (ev) {\n        return ev.fire(\n          ev.element.getContext(\n            event || {},\n            event && !('original' in event) ? { original: {} } : {}\n          ),\n          args\n        );\n      }\n\n      el = el.up && el.up.owner;\n    }\n  }\n\n  readLink(keypath, options) {\n    return this.ractive.readLink(this.resolve(keypath), options);\n  }\n\n  resolve(path, ractive) {\n    const { model, instance } = findModel(this, path);\n    return model ? model.getKeypath(ractive || instance) : path;\n  }\n\n  reverse(keypath) {\n    return modelReverse(findModel(this, keypath).model, []);\n  }\n\n  set(keypath, value, options) {\n    return sharedSet(build(this, keypath, value), options);\n  }\n\n  shift(keypath) {\n    return modelShift(findModel(this, keypath).model, []);\n  }\n\n  splice(keypath, index, drop, ...add) {\n    add.unshift(index, drop);\n    return modelSplice(findModel(this, keypath).model, add);\n  }\n\n  sort(keypath) {\n    return modelSort(findModel(this, keypath).model, []);\n  }\n\n  subtract(keypath, d, options) {\n    const num = isNumber(d) ? d : 1;\n    const opts = isObjectType(d) ? d : options;\n    return sharedSet(\n      build(this, keypath, num).map(pair => {\n        const [model, val] = pair;\n        const value = model.get();\n        if (!isNumeric(val) || !isNumeric(value)) throw new Error('Cannot add non-numeric value');\n        return [model, value - val];\n      }),\n      opts\n    );\n  }\n\n  toggle(keypath, options) {\n    const { model } = findModel(this, keypath);\n    return sharedSet([[model, !model.get()]], options);\n  }\n\n  unlink(dest) {\n    const here = findModel(this, dest).model;\n    const promise = runloop.start();\n    if (here.owner && here.owner._link) here.owner.unlink();\n    runloop.end();\n    return promise;\n  }\n\n  unlisten(event, handler) {\n    this.element.off(event, handler);\n  }\n\n  unshift(keypath, ...add) {\n    return modelUnshift(findModel(this, keypath).model, add);\n  }\n\n  update(keypath, options) {\n    return protoUpdate(this.ractive, findModel(this, keypath).model, options);\n  }\n\n  updateModel(keypath, cascade) {\n    const { model } = findModel(this, keypath);\n    const promise = runloop.start();\n    model.updateFromBindings(cascade);\n    runloop.end();\n    return promise;\n  }\n\n  // two-way binding related helpers\n  isBound() {\n    const { model } = this.getBindingModel(this);\n    return !!model;\n  }\n\n  getBindingPath(ractive) {\n    const { model, instance } = this.getBindingModel(this);\n    if (model) return model.getKeypath(ractive || instance);\n  }\n\n  getBinding() {\n    const { model } = this.getBindingModel(this);\n    if (model) return model.get(true);\n  }\n\n  getBindingModel(ctx) {\n    const el = ctx.element;\n    return { model: el.binding && el.binding.model, instance: el.up.ractive };\n  }\n\n  setBinding(value) {\n    const { model } = this.getBindingModel(this);\n    return sharedSet([[model, value]]);\n  }\n}\n\nContext.forRactive = getRactiveContext;\n// circular deps are fun\nextern.Context = Context;\n\n// TODO: at some point perhaps this could support relative * keypaths?\nfunction build(ctx, keypath, value) {\n  const sets = [];\n\n  // set multiple keypaths in one go\n  if (isObject(keypath)) {\n    for (const k in keypath) {\n      if (hasOwn(keypath, k)) {\n        sets.push([findModel(ctx, k).model, keypath[k]]);\n      }\n    }\n  } else {\n    // set a single keypath\n    sets.push([findModel(ctx, keypath).model, value]);\n  }\n\n  return sets;\n}\n\nfunction findModel(ctx, path) {\n  const frag = ctx.fragment;\n\n  if (!isString(path)) {\n    return { model: frag.findContext(), instance: path };\n  }\n\n  return { model: resolveReference(frag, path), instance: frag.ractive };\n}\n\nfunction findEvent(el, name) {\n  return (\n    el.attributes && el.attributes.find(a => a.template.t === EVENT && ~a.template.n.indexOf(name))\n  );\n}\n","import { doc } from 'config/environment';\nimport getRactiveContext from 'shared/getRactiveContext';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { isString } from 'utils/is';\n\nconst query = doc && doc.querySelector;\n\nexport default function getContext(node) {\n  if (isString(node) && query) {\n    node = query.call(document, node);\n  }\n\n  let instances;\n  if (node) {\n    if (node._ractive) {\n      return node._ractive.proxy.getContext();\n    } else if ((instances = node.__ractive_instances__) && instances.length === 1) {\n      return getRactiveContext(instances[0]);\n    }\n  }\n}\n\nexport function getNodeInfo(node) {\n  warnOnceIfDebug(\n    `getNodeInfo has been renamed to getContext, and the getNodeInfo alias will be removed in a future release.`\n  );\n  return getContext(node);\n}\n","import { isClient, svg, vendors, win, doc } from 'config/environment';\nimport { html } from 'config/namespaces';\nimport { isString, isNumber } from 'utils/is';\n\nlet createElement, matches, div, methodNames, unprefixed, prefixed, i, j, makeFunction;\n\n// Test for SVG support\nif (!svg) {\n  /* istanbul ignore next */\n  createElement = (type, ns, extend) => {\n    if (ns && ns !== html) {\n      throw \"This browser does not support namespaces other than http://www.w3.org/1999/xhtml. The most likely cause of this error is that you're trying to render SVG in an older browser. See http://ractive.js.org/support/#svgs for more information\";\n    }\n\n    return extend ? doc.createElement(type, extend) : doc.createElement(type);\n  };\n} else {\n  createElement = (type, ns, extend) => {\n    if (!ns || ns === html) {\n      return extend ? doc.createElement(type, extend) : doc.createElement(type);\n    }\n\n    return extend ? doc.createElementNS(ns, type, extend) : doc.createElementNS(ns, type);\n  };\n}\n\nexport function createDocumentFragment() {\n  return doc.createDocumentFragment();\n}\n\nfunction getElement(input) {\n  let output;\n\n  if (!input || typeof input === 'boolean') {\n    return;\n  }\n\n  /* istanbul ignore next */\n  if (!win || !doc || !input) {\n    return null;\n  }\n\n  // We already have a DOM node - no work to do. (Duck typing alert!)\n  if (input.nodeType) {\n    return input;\n  }\n\n  // Get node from string\n  if (isString(input)) {\n    // try ID first\n    output = doc.getElementById(input);\n\n    // then as selector, if possible\n    if (!output && doc.querySelector) {\n      try {\n        output = doc.querySelector(input);\n      } catch (e) {\n        /* this space intentionally left blank */\n      }\n    }\n\n    // did it work?\n    if (output && output.nodeType) {\n      return output;\n    }\n  }\n\n  // If we've been given a collection (jQuery, Zepto etc), extract the first item\n  if (input[0] && input[0].nodeType) {\n    return input[0];\n  }\n\n  return null;\n}\n\nif (!isClient) {\n  matches = null;\n} else {\n  div = createElement('div');\n  methodNames = ['matches', 'matchesSelector'];\n\n  makeFunction = function(methodName) {\n    return function(node, selector) {\n      return node[methodName](selector);\n    };\n  };\n\n  i = methodNames.length;\n\n  while (i-- && !matches) {\n    unprefixed = methodNames[i];\n\n    if (div[unprefixed]) {\n      matches = makeFunction(unprefixed);\n    } else {\n      j = vendors.length;\n      while (j--) {\n        prefixed = vendors[i] + unprefixed.substr(0, 1).toUpperCase() + unprefixed.substring(1);\n\n        if (div[prefixed]) {\n          matches = makeFunction(prefixed);\n          break;\n        }\n      }\n    }\n  }\n\n  // IE8... and apparently phantom some?\n  /* istanbul ignore next */\n  if (!matches) {\n    matches = function(node, selector) {\n      let parentNode, i;\n\n      parentNode = node.parentNode;\n\n      if (!parentNode) {\n        // empty dummy <div>\n        div.innerHTML = '';\n\n        parentNode = div;\n        node = node.cloneNode();\n\n        div.appendChild(node);\n      }\n\n      const nodes = parentNode.querySelectorAll(selector);\n\n      i = nodes.length;\n      while (i--) {\n        if (nodes[i] === node) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  }\n}\n\nfunction detachNode(node) {\n  // stupid ie\n  // eslint-disable-next-line valid-typeof\n  if (node && typeof node.parentNode !== 'unknown' && node.parentNode) {\n    node.parentNode.removeChild(node);\n  }\n\n  return node;\n}\n\nfunction safeToStringValue(value) {\n  return value == null || (isNumber(value) && isNaN(value)) || !value.toString ? '' : '' + value;\n}\n\nfunction safeAttributeString(string) {\n  return safeToStringValue(string)\n    .replace(/&/g, '&amp;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;');\n}\n\nexport { createElement, detachNode, getElement, matches, safeToStringValue, safeAttributeString };\n","export const html = 'http://www.w3.org/1999/xhtml';\nexport const mathml = 'http://www.w3.org/1998/Math/MathML';\nexport const svg = 'http://www.w3.org/2000/svg';\nexport const xlink = 'http://www.w3.org/1999/xlink';\nexport const xml = 'http://www.w3.org/XML/1998/namespace';\nexport const xmlns = 'http://www.w3.org/2000/xmlns';\n\nexport default { html, mathml, svg, xlink, xml, xmlns };\n","import Hook from 'src/events/Hook';\nimport { getElement } from 'utils/dom';\n\nconst insertHook = new Hook('insert');\n\nexport default function Ractive$insert(target, anchor) {\n  if (!this.fragment.rendered) {\n    // TODO create, and link to, documentation explaining this\n    throw new Error(\n      'The API has changed - you must call `ractive.render(target[, anchor])` to render your Ractive instance. Once rendered you can use `ractive.insert()`.'\n    );\n  }\n\n  target = getElement(target);\n  anchor = getElement(anchor) || null;\n\n  if (!target) {\n    throw new Error('You must specify a valid target to insert into');\n  }\n\n  target.insertBefore(this.detach(), anchor);\n  this.el = target;\n\n  (target.__ractive_instances__ || (target.__ractive_instances__ = [])).push(this);\n  this.isDetached = false;\n\n  fireInsertHook(this);\n}\n\nfunction fireInsertHook(ractive) {\n  insertHook.fire(ractive);\n\n  ractive.findAllComponents('*').forEach(child => {\n    fireInsertHook(child.instance);\n  });\n}\n","import { isEqual, isFunction } from 'utils/is';\nimport { removeFromArray } from 'utils/array';\nimport runloop from 'src/global/runloop';\nimport { rebindMatch } from 'shared/rebind';\nimport { create } from 'utils/object';\n\nexport default class Observer {\n  constructor(ractive, model, callback, options) {\n    this.context = options.context || ractive;\n    this.callback = callback;\n    this.ractive = ractive;\n    this.keypath = options.keypath;\n    this.options = options;\n\n    if (model) this.resolved(model);\n\n    if (isFunction(options.old)) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    if (options.init !== false) {\n      this.dirty = true;\n      this.dispatch();\n    } else {\n      updateOld(this);\n    }\n\n    this.dirty = false;\n  }\n\n  cancel() {\n    this.cancelled = true;\n    if (this.model) {\n      this.model.unregister(this);\n    } else {\n      this.resolver.unbind();\n    }\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    if (!this.cancelled) {\n      this.callback.call(this.context, this.newValue, this.oldValue, this.keypath);\n      updateOld(this, true);\n      this.dirty = false;\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty) {\n      const newValue = this.model.get();\n      if (isEqual(newValue, this.oldValue)) return;\n\n      this.newValue = newValue;\n\n      if (this.options.strict && this.newValue === this.oldValue) return;\n\n      runloop.addObserver(this, this.options.defer);\n      this.dirty = true;\n\n      if (this.options.once) runloop.scheduleTask(() => this.cancel());\n    } else {\n      // make sure the newValue stays updated in case this observer gets touched multiple times in one loop\n      this.newValue = this.model.get();\n    }\n  }\n\n  rebind(next, previous) {\n    next = rebindMatch(this.keypath, next, previous);\n    if (next === this.model) return false;\n\n    if (this.model) this.model.unregister(this);\n    if (next) next.addShuffleTask(() => this.resolved(next));\n  }\n\n  resolved(model) {\n    this.model = model;\n\n    this.oldValue = undefined;\n    this.newValue = model.get();\n\n    model.register(this);\n  }\n}\n\nfunction updateOld(observer, fresh) {\n  const next = fresh\n    ? observer.model\n      ? observer.model.get()\n      : observer.newValue\n    : observer.newValue;\n  observer.oldValue = observer.oldFn\n    ? observer.oldFn.call(observer.oldContext, undefined, next, observer.keypath)\n    : next;\n}\n","import { escapeKey } from 'shared/keypaths';\nimport { removeFromArray } from 'utils/array';\nimport { isArray, isEqual } from 'utils/is';\nimport runloop from 'src/global/runloop';\nimport { create, keys } from 'utils/object';\n\nconst star = /\\*+/g;\n\nexport default class PatternObserver {\n  constructor(ractive, baseModel, keys, callback, options) {\n    this.context = options.context || ractive;\n    this.ractive = ractive;\n    this.baseModel = baseModel;\n    this.keys = keys;\n    this.callback = callback;\n\n    const pattern = keys.join('\\\\.').replace(star, '(.+)');\n    const baseKeypath = (this.baseKeypath = baseModel.getKeypath(ractive));\n    this.pattern = new RegExp(`^${baseKeypath ? baseKeypath + '\\\\.' : ''}${pattern}$`);\n    this.recursive = keys.length === 1 && keys[0] === '**';\n    if (this.recursive) this.keys = ['*'];\n    if (options.old) {\n      this.oldContext = create(ractive);\n      this.oldFn = options.old;\n    }\n\n    this.oldValues = {};\n    this.newValues = {};\n\n    this.defer = options.defer;\n    this.once = options.once;\n    this.strict = options.strict;\n\n    this.dirty = false;\n    this.changed = [];\n    this.partial = false;\n    this.links = options.links;\n\n    const models = baseModel.findMatches(this.keys);\n\n    models.forEach(model => {\n      this.newValues[model.getKeypath(this.ractive)] = model.get();\n    });\n\n    if (options.init !== false) {\n      this.dispatch();\n    } else {\n      updateOld(this, this.newValues);\n    }\n\n    baseModel.registerPatternObserver(this);\n  }\n\n  cancel() {\n    this.baseModel.unregisterPatternObserver(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    const newValues = this.newValues;\n    this.newValues = {};\n    keys(newValues).forEach(keypath => {\n      const newValue = newValues[keypath];\n      const oldValue = this.oldValues[keypath];\n\n      if (this.strict && newValue === oldValue) return;\n      if (isEqual(newValue, oldValue)) return;\n\n      let args = [newValue, oldValue, keypath];\n      if (keypath) {\n        const wildcards = this.pattern.exec(keypath);\n        if (wildcards) {\n          args = args.concat(wildcards.slice(1));\n        }\n      }\n\n      this.callback.apply(this.context, args);\n    });\n\n    updateOld(this, newValues, this.partial);\n\n    this.dirty = false;\n  }\n\n  notify(key) {\n    this.changed.push(key);\n  }\n\n  shuffle(newIndices) {\n    if (!isArray(this.baseModel.value)) return;\n\n    const max = this.baseModel.value.length;\n\n    for (let i = 0; i < newIndices.length; i++) {\n      if (newIndices[i] === -1 || newIndices[i] === i) continue;\n      this.changed.push([i]);\n    }\n\n    for (let i = newIndices.touchedFrom; i < max; i++) {\n      this.changed.push([i]);\n    }\n  }\n\n  handleChange() {\n    if (!this.dirty || this.changed.length) {\n      if (!this.dirty) this.newValues = {};\n\n      if (!this.changed.length) {\n        this.baseModel.findMatches(this.keys).forEach(model => {\n          const keypath = model.getKeypath(this.ractive);\n          this.newValues[keypath] = model.get();\n        });\n        this.partial = false;\n      } else {\n        let count = 0;\n\n        if (this.recursive) {\n          this.changed.forEach(keys => {\n            const model = this.baseModel.joinAll(keys);\n            if (model.isLink && !this.links) return;\n            count++;\n            this.newValues[model.getKeypath(this.ractive)] = model.get();\n          });\n        } else {\n          const ok = this.baseModel.isRoot\n            ? this.changed.map(keys => keys.map(escapeKey).join('.'))\n            : this.changed.map(keys => this.baseKeypath + '.' + keys.map(escapeKey).join('.'));\n\n          this.baseModel.findMatches(this.keys).forEach(model => {\n            const keypath = model.getKeypath(this.ractive);\n            const check = k => {\n              return (\n                (k.indexOf(keypath) === 0 &&\n                  (k.length === keypath.length || k[keypath.length] === '.')) ||\n                (keypath.indexOf(k) === 0 &&\n                  (k.length === keypath.length || keypath[k.length] === '.'))\n              );\n            };\n\n            // is this model on a changed keypath?\n            if (ok.filter(check).length) {\n              count++;\n              this.newValues[keypath] = model.get();\n            }\n          });\n        }\n\n        // no valid change triggered, so bail to avoid breakage\n        if (!count) return;\n\n        this.partial = true;\n      }\n\n      runloop.addObserver(this, this.defer);\n      this.dirty = true;\n      this.changed.length = 0;\n\n      if (this.once) this.cancel();\n    }\n  }\n}\n\nfunction updateOld(observer, vals, partial) {\n  const olds = observer.oldValues;\n\n  if (observer.oldFn) {\n    if (!partial) observer.oldValues = {};\n\n    keys(vals).forEach(k => {\n      const args = [olds[k], vals[k], k];\n      const parts = observer.pattern.exec(k);\n      if (parts) {\n        args.push.apply(args, parts.slice(1));\n      }\n      observer.oldValues[k] = observer.oldFn.apply(observer.oldContext, args);\n    });\n  } else {\n    if (partial) {\n      keys(vals).forEach(k => (olds[k] = vals[k]));\n    } else {\n      observer.oldValues = vals;\n    }\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport { isArray } from 'utils/is';\nimport runloop from 'src/global/runloop';\n\nfunction negativeOne() {\n  return -1;\n}\n\nexport default class ArrayObserver {\n  constructor(ractive, model, callback, options) {\n    this.ractive = ractive;\n    this.model = model;\n    this.keypath = model.getKeypath();\n    this.callback = callback;\n    this.options = options;\n\n    this.pending = null;\n\n    model.register(this);\n\n    if (options.init !== false) {\n      this.sliced = [];\n      this.shuffle([]);\n      this.dispatch();\n    } else {\n      this.sliced = this.slice();\n    }\n  }\n\n  cancel() {\n    this.model.unregister(this);\n    removeFromArray(this.ractive._observers, this);\n  }\n\n  dispatch() {\n    this.callback(this.pending);\n    this.pending = null;\n    if (this.options.once) this.cancel();\n  }\n\n  handleChange(path) {\n    if (this.pending) {\n      // post-shuffle\n      runloop.addObserver(this, this.options.defer);\n    } else if (!path) {\n      // entire array changed\n      this.shuffle(this.sliced.map(negativeOne));\n      this.handleChange();\n    }\n  }\n\n  shuffle(newIndices) {\n    const newValue = this.slice();\n\n    const inserted = [];\n    const deleted = [];\n    let start;\n\n    const hadIndex = {};\n\n    newIndices.forEach((newIndex, oldIndex) => {\n      hadIndex[newIndex] = true;\n\n      if (newIndex !== oldIndex && start === undefined) {\n        start = oldIndex;\n      }\n\n      if (newIndex === -1) {\n        deleted.push(this.sliced[oldIndex]);\n      }\n    });\n\n    if (start === undefined) start = newIndices.length;\n\n    const len = newValue.length;\n    for (let i = 0; i < len; i += 1) {\n      if (!hadIndex[i]) inserted.push(newValue[i]);\n    }\n\n    this.pending = { inserted, deleted, start };\n    this.sliced = newValue;\n  }\n\n  slice() {\n    const value = this.model.get();\n    return isArray(value) ? value.slice() : [];\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { assign } from 'utils/object';\n\nconst onceOptions = { init: false, once: true };\n\nexport default function observeOnce(keypath, callback, options) {\n  if (isObject(keypath) || isFunction(keypath)) {\n    options = assign(callback || {}, onceOptions);\n    return this.observe(keypath, options);\n  }\n\n  options = assign(options || {}, onceOptions);\n  return this.observe(keypath, callback, options);\n}\n","export default str => str.trim();\n","export default str => str !== '';\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('pop').path;\n","import makeArrayMethod from './shared/makeArrayMethod';\nexport default makeArrayMethod('push').path;\n","import { doc } from '../config/environment';\n\nconst PREFIX = '/* Ractive.js component styles */';\n\n// Holds current definitions of styles.\nconst styleDefinitions = [];\n\n// Flag to tell if we need to update the CSS\nlet isDirty = false;\n\n// These only make sense on the browser. See additional setup below.\nlet styleElement = null;\nlet useCssText = null;\n\nexport function addCSS(styleDefinition) {\n  styleDefinitions.push(styleDefinition);\n  isDirty = true;\n}\n\nexport function applyCSS(force) {\n  const styleElement = style();\n\n  // Apply only seems to make sense when we're in the DOM. Server-side renders\n  // can call toCSS to get the updated CSS.\n  if (!styleElement || (!force && !isDirty)) return;\n\n  if (useCssText) {\n    styleElement.styleSheet.cssText = getCSS(null);\n  } else {\n    styleElement.innerHTML = getCSS(null);\n  }\n\n  isDirty = false;\n}\n\nexport function getCSS(cssIds) {\n  const filteredStyleDefinitions = cssIds\n    ? styleDefinitions.filter(style => ~cssIds.indexOf(style.id))\n    : styleDefinitions;\n\n  filteredStyleDefinitions.forEach(d => (d.applied = true));\n\n  return filteredStyleDefinitions.reduce(\n    (styles, style) => `${styles ? `${styles}\\n\\n/* {${style.id}} */\\n${style.styles}` : ''}`,\n    PREFIX\n  );\n}\n\nfunction style() {\n  // If we're on the browser, additional setup needed.\n  if (doc && !styleElement) {\n    styleElement = doc.createElement('style');\n    styleElement.type = 'text/css';\n    styleElement.setAttribute('data-ractive-css', '');\n\n    doc.getElementsByTagName('head')[0].appendChild(styleElement);\n\n    useCssText = !!styleElement.styleSheet;\n  }\n\n  return styleElement;\n}\n","import { ensureArray, combine } from 'utils/array';\n\nexport default {\n  extend: (Parent, proto, options) => {\n    proto.adapt = combine(proto.adapt, ensureArray(options.adapt));\n  },\n\n  init() {}\n};\n","const remove = /\\/\\*(?:[\\s\\S]*?)\\*\\//g;\nconst escape = /url\\(\\s*(['\"])(?:\\\\[\\s\\S]|(?!\\1).)*\\1\\s*\\)|url\\((?:\\\\[\\s\\S]|[^)])*\\)|(['\"])(?:\\\\[\\s\\S]|(?!\\2).)*\\2/gi;\nconst value = /\\0(\\d+)/g;\n\n// Removes comments and strings from the given CSS to make it easier to parse.\n// Callback receives the cleaned CSS and a function which can be used to put\n// the removed strings back in place after parsing is done.\nexport default function(css, callback, additionalReplaceRules = []) {\n  const values = [];\n  const reconstruct = css => css.replace(value, (match, n) => values[n]);\n  css = css.replace(escape, match => `\\0${values.push(match) - 1}`).replace(remove, '');\n\n  additionalReplaceRules.forEach(pattern => {\n    css = css.replace(pattern, match => `\\0${values.push(match) - 1}`);\n  });\n\n  return callback(css, reconstruct);\n}\n","import cleanCss from 'utils/cleanCss';\n\nconst selectorsPattern = /(?:^|\\}|\\{)\\s*([^\\{\\}\\0]+)\\s*(?=\\{)/g;\nconst keyframesDeclarationPattern = /@keyframes\\s+[^\\{\\}]+\\s*\\{(?:[^{}]+|\\{[^{}]+})*}/gi;\nconst selectorUnitPattern = /((?:(?:\\[[^\\]]+\\])|(?:[^\\s\\+\\>~:]))+)((?:::?[^\\s\\+\\>\\~\\(:]+(?:\\([^\\)]+\\))?)*\\s*[\\s\\+\\>\\~]?)\\s*/g;\nconst excludePattern = /^(?:@|\\d+%)/;\nconst dataRvcGuidPattern = /\\[data-ractive-css~=\"\\{[a-z0-9-]+\\}\"]/g;\n\nfunction trim(str) {\n  return str.trim();\n}\n\nfunction extractString(unit) {\n  return unit.str;\n}\n\nfunction transformSelector(selector, parent) {\n  const selectorUnits = [];\n  let match;\n\n  while ((match = selectorUnitPattern.exec(selector))) {\n    selectorUnits.push({\n      str: match[0],\n      base: match[1],\n      modifiers: match[2]\n    });\n  }\n\n  // For each simple selector within the selector, we need to create a version\n  // that a) combines with the id, and b) is inside the id\n  const base = selectorUnits.map(extractString);\n\n  const transformed = [];\n  let i = selectorUnits.length;\n\n  while (i--) {\n    const appended = base.slice();\n\n    // Pseudo-selectors should go after the attribute selector\n    const unit = selectorUnits[i];\n    appended[i] = unit.base + parent + unit.modifiers || '';\n\n    const prepended = base.slice();\n    prepended[i] = parent + ' ' + prepended[i];\n\n    transformed.push(appended.join(' '), prepended.join(' '));\n  }\n\n  return transformed.join(', ');\n}\n\nexport default function transformCss(css, id) {\n  const dataAttr = `[data-ractive-css~=\"{${id}}\"]`;\n\n  let transformed;\n\n  if (dataRvcGuidPattern.test(css)) {\n    transformed = css.replace(dataRvcGuidPattern, dataAttr);\n  } else {\n    transformed = cleanCss(\n      css,\n      (css, reconstruct) => {\n        css = css.replace(selectorsPattern, (match, $1) => {\n          // don't transform at-rules and keyframe declarations\n          if (excludePattern.test($1)) return match;\n\n          const selectors = $1.split(',').map(trim);\n          const transformed =\n            selectors.map(selector => transformSelector(selector, dataAttr)).join(', ') + ' ';\n\n          return match.replace($1, transformed);\n        });\n\n        return reconstruct(css);\n      },\n      [keyframesDeclarationPattern]\n    );\n  }\n\n  return transformed;\n}\n","import { SharedModel } from './SharedModel';\nimport { applyChanges } from '../../Ractive/static/styleSet';\n\nexport default class CSSModel extends SharedModel {\n  constructor(component) {\n    super(component.cssData, '@style');\n    this.component = component;\n  }\n\n  downstreamChanged(path, depth) {\n    if (this.locked) return;\n\n    const component = this.component;\n\n    component.extensions.forEach(e => {\n      const model = e._cssModel;\n      model.mark();\n      model.downstreamChanged(path, depth || 1);\n    });\n\n    if (!depth) {\n      applyChanges(component, true);\n    }\n  }\n}\n","import { addCSS } from 'src/global/css';\nimport transformCss from './transform';\nimport { uuid } from 'utils/id';\nimport { warnIfDebug } from 'utils/log';\nimport { getElement } from 'utils/dom';\nimport { splitKeypath } from 'shared/keypaths';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperty } from 'utils/object';\nimport { isString, isFunction, isObjectType } from 'utils/is';\n\nconst hasCurly = /\\{/;\nexport default {\n  name: 'css',\n\n  // Called when creating a new component definition\n  extend: (Parent, proto, options, Child) => {\n    Child._cssIds = gatherIds(Parent);\n\n    defineProperty(Child, 'cssData', {\n      configurable: true,\n      value: assign(create(Parent.cssData), options.cssData || {})\n    });\n\n    defineProperty(Child, '_cssModel', {\n      configurable: true,\n      value: new CSSModel(Child)\n    });\n\n    if (options.css) initCSS(options, Child, proto);\n  },\n\n  // Called when creating a new component instance\n  init: (Parent, target, options) => {\n    if (!options.css) return;\n\n    warnIfDebug(`\nThe css option is currently not supported on a per-instance basis and will be discarded. Instead, we recommend instantiating from a component definition with a css option.\n\nconst Component = Ractive.extend({\n\t...\n\tcss: '/* your css */',\n\t...\n});\n\nconst componentInstance = new Component({ ... })\n\t\t`);\n  }\n};\n\nfunction gatherIds(start) {\n  let cmp = start;\n  const ids = [];\n\n  while (cmp) {\n    if (cmp.prototype.cssId) ids.push(cmp.prototype.cssId);\n    cmp = cmp.Parent;\n  }\n\n  return ids;\n}\n\nexport function evalCSS(component, css) {\n  const cssData = component.cssData;\n  const model = component._cssModel;\n  const data = function data(path) {\n    return model.joinAll(splitKeypath(path)).get();\n  };\n  data.__proto__ = cssData;\n\n  const result = css.call(component, data);\n  return isString(result) ? result : '';\n}\n\nexport function initCSS(options, target, proto) {\n  let css =\n    isString(options.css) && !hasCurly.test(options.css)\n      ? getElement(options.css) || options.css\n      : options.css;\n\n  const id = options.cssId || uuid();\n\n  if (isObjectType(css)) {\n    css = 'textContent' in css ? css.textContent : css.innerHTML;\n  } else if (isFunction(css)) {\n    target._css = options.css;\n    css = evalCSS(target, css);\n  }\n\n  const def = (target._cssDef = { transform: !options.noCssTransform });\n\n  def.styles = def.transform ? transformCss(css, id) : css;\n  def.id = proto.cssId = id;\n  target._cssIds.push(id);\n\n  addCSS(target._cssDef);\n}\n","import { fatal, warnIfDebug, warnOnceIfDebug } from 'utils/log';\nimport { isArray, isObject, isFunction, isObjectType } from 'utils/is';\nimport bind from 'utils/bind';\n\nfunction validate(data) {\n  // Warn if userOptions.data is a non-POJO\n  if (data && data.constructor !== Object) {\n    if (isFunction(data)) {\n      // TODO do we need to support this in the new Ractive() case?\n    } else if (!isObjectType(data)) {\n      fatal(`data option must be an object or a function, \\`${data}\\` is not valid`);\n    } else {\n      warnIfDebug(\n        'If supplied, options.data should be a plain JavaScript object - using a non-POJO as the root object may work, but is discouraged'\n      );\n    }\n  }\n}\n\nexport default {\n  name: 'data',\n\n  extend: (Parent, proto, options) => {\n    let key;\n    let value;\n\n    // check for non-primitives, which could cause mutation-related bugs\n    if (options.data && isObject(options.data)) {\n      for (key in options.data) {\n        value = options.data[key];\n\n        if (value && isObjectType(value)) {\n          if (isObject(value) || isArray(value)) {\n            warnIfDebug(`Passing a \\`data\\` option with object and array properties to Ractive.extend() is discouraged, as mutating them is likely to cause bugs. Consider using a data function instead:\n\n  // this...\n  data: function () {\n    return {\n      myObject: {}\n    };\n  })\n\n  // instead of this:\n  data: {\n    myObject: {}\n  }`);\n          }\n        }\n      }\n    }\n\n    proto.data = combine(proto.data, options.data);\n  },\n\n  init: (Parent, ractive, options) => {\n    let result = combine(Parent.prototype.data, options.data);\n\n    if (isFunction(result)) result = result.call(ractive);\n\n    // bind functions to the ractive instance at the top level,\n    // unless it's a non-POJO (in which case alarm bells should ring)\n    if (result && result.constructor === Object) {\n      for (const prop in result) {\n        if (isFunction(result[prop])) {\n          const value = result[prop];\n          result[prop] = bind(value, ractive);\n          result[prop]._r_unbound = value;\n        }\n      }\n    }\n\n    return result || {};\n  },\n\n  reset(ractive) {\n    const result = this.init(ractive.constructor, ractive, ractive.viewmodel);\n    ractive.viewmodel.root.set(result);\n    return true;\n  }\n};\n\nfunction emptyData() {\n  return {};\n}\n\nfunction combine(parentValue, childValue) {\n  validate(childValue);\n\n  const parentIsFn = isFunction(parentValue);\n\n  // Very important, otherwise child instance can become\n  // the default data object on Ractive or a component.\n  // then ractive.set() ends up setting on the prototype!\n  if (!childValue && !parentIsFn) {\n    // this needs to be a function so that it can still inherit parent defaults\n    childValue = emptyData;\n  }\n\n  const childIsFn = isFunction(childValue);\n\n  // Fast path, where we just need to copy properties from\n  // parent to child\n  if (!parentIsFn && !childIsFn) {\n    return fromProperties(childValue, parentValue);\n  }\n\n  return function() {\n    const child = childIsFn ? callDataFunction(childValue, this) : childValue;\n    const parent = parentIsFn ? callDataFunction(parentValue, this) : parentValue;\n\n    return fromProperties(child, parent);\n  };\n}\n\nfunction callDataFunction(fn, context) {\n  const data = fn.call(context);\n\n  if (!data) return;\n\n  if (!isObjectType(data)) {\n    fatal('Data function must return an object');\n  }\n\n  if (data.constructor !== Object) {\n    warnOnceIfDebug(\n      'Data function returned something other than a plain JavaScript object. This might work, but is strongly discouraged'\n    );\n  }\n\n  return data;\n}\n\nfunction fromProperties(primary, secondary) {\n  if (primary && secondary) {\n    for (const key in secondary) {\n      if (!(key in primary)) {\n        primary[key] = secondary[key];\n      }\n    }\n\n    return primary;\n  }\n\n  return primary || secondary;\n}\n","export const TEMPLATE_VERSION = 4;\n","const pattern = /\\$\\{([^\\}]+)\\}/g;\n\nexport function fromExpression(body, length = 0) {\n  const args = new Array(length);\n\n  while (length--) {\n    args[length] = `_${length}`;\n  }\n\n  // Functions created directly with new Function() look like this:\n  //     function anonymous (_0 /**/) { return _0*2 }\n  //\n  // With this workaround, we get a little more compact:\n  //     function (_0){return _0*2}\n  return new Function([], `return function (${args.join(',')}){return(${body});};`)();\n}\n\nexport function fromComputationString(str, bindTo) {\n  let hasThis;\n\n  let functionBody =\n    'return (' +\n    str.replace(pattern, (match, keypath) => {\n      hasThis = true;\n      return `__ractive.get(\"${keypath}\")`;\n    }) +\n    ');';\n\n  if (hasThis) functionBody = `var __ractive = this; ${functionBody}`;\n  const fn = new Function(functionBody);\n  return hasThis ? fn.bind(bindTo) : fn;\n}\n","import { warnIfDebug } from 'utils/log';\nimport { create, hasOwn } from 'utils/object';\n\nconst leadingWhitespace = /^\\s+/;\n\nconst ParseError = function(message) {\n  this.name = 'ParseError';\n  this.message = message;\n  try {\n    throw new Error(message);\n  } catch (e) {\n    this.stack = e.stack;\n  }\n};\n\nParseError.prototype = Error.prototype;\n\nconst Parser = function(str, options) {\n  let item;\n  let lineStart = 0;\n\n  this.str = str;\n  this.options = options || {};\n  this.pos = 0;\n\n  this.lines = this.str.split('\\n');\n  this.lineEnds = this.lines.map(line => {\n    const lineEnd = lineStart + line.length + 1; // +1 for the newline\n\n    lineStart = lineEnd;\n    return lineEnd;\n  }, 0);\n\n  // Custom init logic\n  if (this.init) this.init(str, options);\n\n  const items = [];\n\n  while (this.pos < this.str.length && (item = this.read())) {\n    items.push(item);\n  }\n\n  this.leftover = this.remaining();\n  this.result = this.postProcess ? this.postProcess(items, options) : items;\n};\n\nParser.prototype = {\n  read(converters) {\n    let i, item;\n\n    if (!converters) converters = this.converters;\n\n    const pos = this.pos;\n\n    const len = converters.length;\n    for (i = 0; i < len; i += 1) {\n      this.pos = pos; // reset for each attempt\n\n      if ((item = converters[i](this))) {\n        return item;\n      }\n    }\n\n    return null;\n  },\n\n  getContextMessage(pos, message) {\n    const [lineNum, columnNum] = this.getLinePos(pos);\n    if (this.options.contextLines === -1) {\n      return [lineNum, columnNum, `${message} at line ${lineNum} character ${columnNum}`];\n    }\n\n    const line = this.lines[lineNum - 1];\n\n    let contextUp = '';\n    let contextDown = '';\n    if (this.options.contextLines) {\n      const start =\n        lineNum - 1 - this.options.contextLines < 0 ? 0 : lineNum - 1 - this.options.contextLines;\n      contextUp = this.lines\n        .slice(start, lineNum - 1 - start)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      contextDown = this.lines\n        .slice(lineNum, lineNum + this.options.contextLines)\n        .join('\\n')\n        .replace(/\\t/g, '  ');\n      if (contextUp) {\n        contextUp += '\\n';\n      }\n      if (contextDown) {\n        contextDown = '\\n' + contextDown;\n      }\n    }\n\n    let numTabs = 0;\n    const annotation =\n      contextUp +\n      line.replace(/\\t/g, (match, char) => {\n        if (char < columnNum) {\n          numTabs += 1;\n        }\n\n        return '  ';\n      }) +\n      '\\n' +\n      new Array(columnNum + numTabs).join(' ') +\n      '^----' +\n      contextDown;\n\n    return [\n      lineNum,\n      columnNum,\n      `${message} at line ${lineNum} character ${columnNum}:\\n${annotation}`\n    ];\n  },\n\n  getLinePos(char) {\n    let lineNum = 0;\n    let lineStart = 0;\n\n    while (char >= this.lineEnds[lineNum]) {\n      lineStart = this.lineEnds[lineNum];\n      lineNum += 1;\n    }\n\n    const columnNum = char - lineStart;\n    return [lineNum + 1, columnNum + 1, char]; // line/col should be one-based, not zero-based!\n  },\n\n  error(message) {\n    const [lineNum, columnNum, msg] = this.getContextMessage(this.pos, message);\n\n    const error = new ParseError(msg);\n\n    error.line = lineNum;\n    error.character = columnNum;\n    error.shortMessage = message;\n\n    throw error;\n  },\n\n  matchString(string) {\n    if (this.str.substr(this.pos, string.length) === string) {\n      this.pos += string.length;\n      return string;\n    }\n  },\n\n  matchPattern(pattern) {\n    let match;\n\n    if ((match = pattern.exec(this.remaining()))) {\n      this.pos += match[0].length;\n      return match[1] || match[0];\n    }\n  },\n\n  sp() {\n    this.matchPattern(leadingWhitespace);\n  },\n\n  remaining() {\n    return this.str.substring(this.pos);\n  },\n\n  nextChar() {\n    return this.str.charAt(this.pos);\n  },\n\n  warn(message) {\n    const msg = this.getContextMessage(this.pos, message)[2];\n\n    warnIfDebug(msg);\n  }\n};\n\nParser.extend = function(proto) {\n  const Parent = this;\n  const Child = function(str, options) {\n    Parser.call(this, str, options);\n  };\n\n  Child.prototype = create(Parent.prototype);\n\n  for (const key in proto) {\n    if (hasOwn(proto, key)) {\n      Child.prototype[key] = proto[key];\n    }\n  }\n\n  Child.extend = Parser.extend;\n  return Child;\n};\n\nexport default Parser;\n","const delimiterChangePattern = /^[^\\s=]+/;\nconst whitespacePattern = /^\\s+/;\n\nexport default function readDelimiterChange(parser) {\n  if (!parser.matchString('=')) {\n    return null;\n  }\n\n  const start = parser.pos;\n\n  // allow whitespace before new opening delimiter\n  parser.sp();\n\n  const opening = parser.matchPattern(delimiterChangePattern);\n  if (!opening) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace (in fact, it's necessary...)\n  if (!parser.matchPattern(whitespacePattern)) {\n    return null;\n  }\n\n  const closing = parser.matchPattern(delimiterChangePattern);\n  if (!closing) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace before closing '='\n  parser.sp();\n\n  if (!parser.matchString('=')) {\n    parser.pos = start;\n    return null;\n  }\n\n  return [opening, closing];\n}\n","import { PREFIX_OPERATOR } from 'config/types';\nimport { expectedExpression } from './shared/errors';\nimport readMemberOrInvocation from './readMemberOrInvocation';\nimport readExpression from '../readExpression';\n\nlet readTypeOf;\n\nconst makePrefixSequenceMatcher = function(symbol, fallthrough) {\n  return function(parser) {\n    let expression;\n\n    if ((expression = fallthrough(parser))) {\n      return expression;\n    }\n\n    if (!parser.matchString(symbol)) {\n      return null;\n    }\n\n    parser.sp();\n\n    expression = readExpression(parser);\n    if (!expression) {\n      parser.error(expectedExpression);\n    }\n\n    return {\n      s: symbol,\n      o: expression,\n      t: PREFIX_OPERATOR\n    };\n  };\n};\n\n// create all prefix sequence matchers, return readTypeOf\n(function() {\n  let i, len, matcher, fallthrough;\n\n  const prefixOperators = '! ~ + - typeof'.split(' ');\n\n  fallthrough = readMemberOrInvocation;\n  for (i = 0, len = prefixOperators.length; i < len; i += 1) {\n    matcher = makePrefixSequenceMatcher(prefixOperators[i], fallthrough);\n    fallthrough = matcher;\n  }\n\n  // typeof operator is higher precedence than multiplication, so provides the\n  // fallthrough for the multiplication sequence matcher we're about to create\n  // (we're skipping void and delete)\n  readTypeOf = fallthrough;\n})();\n\nexport default readTypeOf;\n","import { REGEXP_LITERAL } from '../../../../../config/types';\n\nconst regexpPattern = /^(\\/(?:[^\\n\\r\\u2028\\u2029/\\\\[]|\\\\.|\\[(?:[^\\n\\r\\u2028\\u2029\\]\\\\]|\\\\.)*])+\\/(?:([gimuy])(?![a-z]*\\2))*(?![a-zA-Z_$0-9]))/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(regexpPattern))) {\n    return {\n      t: REGEXP_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","const pattern = /[-/\\\\^$*+?.()|[\\]{}]/g;\n\nexport default function escapeRegExp(str) {\n  return str.replace(pattern, '\\\\$&');\n}\n","import escapeRegExp from 'utils/escapeRegExp';\n\nconst regExpCache = {};\n\nexport default function(haystack, needles) {\n  return haystack.search(\n    regExpCache[needles.join()] ||\n      (regExpCache[needles.join()] = new RegExp(needles.map(escapeRegExp).join('|')))\n  );\n}\n","import { keys } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n// https://github.com/kangax/html-minifier/issues/63#issuecomment-37763316\nexport const booleanAttributes = /^(allowFullscreen|async|autofocus|autoplay|checked|compact|controls|declare|default|defaultChecked|defaultMuted|defaultSelected|defer|disabled|enabled|formNoValidate|hidden|indeterminate|inert|isMap|itemScope|loop|multiple|muted|noHref|noResize|noShade|noValidate|noWrap|open|pauseOnExit|readOnly|required|reversed|scoped|seamless|selected|sortable|translate|trueSpeed|typeMustMatch|visible)$/i;\nexport const voidElementNames = /^(?:area|base|br|col|command|doctype|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/i;\n\nconst htmlEntities = {\n  quot: 34,\n  amp: 38,\n  apos: 39,\n  lt: 60,\n  gt: 62,\n  nbsp: 160,\n  iexcl: 161,\n  cent: 162,\n  pound: 163,\n  curren: 164,\n  yen: 165,\n  brvbar: 166,\n  sect: 167,\n  uml: 168,\n  copy: 169,\n  ordf: 170,\n  laquo: 171,\n  not: 172,\n  shy: 173,\n  reg: 174,\n  macr: 175,\n  deg: 176,\n  plusmn: 177,\n  sup2: 178,\n  sup3: 179,\n  acute: 180,\n  micro: 181,\n  para: 182,\n  middot: 183,\n  cedil: 184,\n  sup1: 185,\n  ordm: 186,\n  raquo: 187,\n  frac14: 188,\n  frac12: 189,\n  frac34: 190,\n  iquest: 191,\n  Agrave: 192,\n  Aacute: 193,\n  Acirc: 194,\n  Atilde: 195,\n  Auml: 196,\n  Aring: 197,\n  AElig: 198,\n  Ccedil: 199,\n  Egrave: 200,\n  Eacute: 201,\n  Ecirc: 202,\n  Euml: 203,\n  Igrave: 204,\n  Iacute: 205,\n  Icirc: 206,\n  Iuml: 207,\n  ETH: 208,\n  Ntilde: 209,\n  Ograve: 210,\n  Oacute: 211,\n  Ocirc: 212,\n  Otilde: 213,\n  Ouml: 214,\n  times: 215,\n  Oslash: 216,\n  Ugrave: 217,\n  Uacute: 218,\n  Ucirc: 219,\n  Uuml: 220,\n  Yacute: 221,\n  THORN: 222,\n  szlig: 223,\n  agrave: 224,\n  aacute: 225,\n  acirc: 226,\n  atilde: 227,\n  auml: 228,\n  aring: 229,\n  aelig: 230,\n  ccedil: 231,\n  egrave: 232,\n  eacute: 233,\n  ecirc: 234,\n  euml: 235,\n  igrave: 236,\n  iacute: 237,\n  icirc: 238,\n  iuml: 239,\n  eth: 240,\n  ntilde: 241,\n  ograve: 242,\n  oacute: 243,\n  ocirc: 244,\n  otilde: 245,\n  ouml: 246,\n  divide: 247,\n  oslash: 248,\n  ugrave: 249,\n  uacute: 250,\n  ucirc: 251,\n  uuml: 252,\n  yacute: 253,\n  thorn: 254,\n  yuml: 255,\n  OElig: 338,\n  oelig: 339,\n  Scaron: 352,\n  scaron: 353,\n  Yuml: 376,\n  fnof: 402,\n  circ: 710,\n  tilde: 732,\n  Alpha: 913,\n  Beta: 914,\n  Gamma: 915,\n  Delta: 916,\n  Epsilon: 917,\n  Zeta: 918,\n  Eta: 919,\n  Theta: 920,\n  Iota: 921,\n  Kappa: 922,\n  Lambda: 923,\n  Mu: 924,\n  Nu: 925,\n  Xi: 926,\n  Omicron: 927,\n  Pi: 928,\n  Rho: 929,\n  Sigma: 931,\n  Tau: 932,\n  Upsilon: 933,\n  Phi: 934,\n  Chi: 935,\n  Psi: 936,\n  Omega: 937,\n  alpha: 945,\n  beta: 946,\n  gamma: 947,\n  delta: 948,\n  epsilon: 949,\n  zeta: 950,\n  eta: 951,\n  theta: 952,\n  iota: 953,\n  kappa: 954,\n  lambda: 955,\n  mu: 956,\n  nu: 957,\n  xi: 958,\n  omicron: 959,\n  pi: 960,\n  rho: 961,\n  sigmaf: 962,\n  sigma: 963,\n  tau: 964,\n  upsilon: 965,\n  phi: 966,\n  chi: 967,\n  psi: 968,\n  omega: 969,\n  thetasym: 977,\n  upsih: 978,\n  piv: 982,\n  ensp: 8194,\n  emsp: 8195,\n  thinsp: 8201,\n  zwnj: 8204,\n  zwj: 8205,\n  lrm: 8206,\n  rlm: 8207,\n  ndash: 8211,\n  mdash: 8212,\n  lsquo: 8216,\n  rsquo: 8217,\n  sbquo: 8218,\n  ldquo: 8220,\n  rdquo: 8221,\n  bdquo: 8222,\n  dagger: 8224,\n  Dagger: 8225,\n  bull: 8226,\n  hellip: 8230,\n  permil: 8240,\n  prime: 8242,\n  Prime: 8243,\n  lsaquo: 8249,\n  rsaquo: 8250,\n  oline: 8254,\n  frasl: 8260,\n  euro: 8364,\n  image: 8465,\n  weierp: 8472,\n  real: 8476,\n  trade: 8482,\n  alefsym: 8501,\n  larr: 8592,\n  uarr: 8593,\n  rarr: 8594,\n  darr: 8595,\n  harr: 8596,\n  crarr: 8629,\n  lArr: 8656,\n  uArr: 8657,\n  rArr: 8658,\n  dArr: 8659,\n  hArr: 8660,\n  forall: 8704,\n  part: 8706,\n  exist: 8707,\n  empty: 8709,\n  nabla: 8711,\n  isin: 8712,\n  notin: 8713,\n  ni: 8715,\n  prod: 8719,\n  sum: 8721,\n  minus: 8722,\n  lowast: 8727,\n  radic: 8730,\n  prop: 8733,\n  infin: 8734,\n  ang: 8736,\n  and: 8743,\n  or: 8744,\n  cap: 8745,\n  cup: 8746,\n  int: 8747,\n  there4: 8756,\n  sim: 8764,\n  cong: 8773,\n  asymp: 8776,\n  ne: 8800,\n  equiv: 8801,\n  le: 8804,\n  ge: 8805,\n  sub: 8834,\n  sup: 8835,\n  nsub: 8836,\n  sube: 8838,\n  supe: 8839,\n  oplus: 8853,\n  otimes: 8855,\n  perp: 8869,\n  sdot: 8901,\n  lceil: 8968,\n  rceil: 8969,\n  lfloor: 8970,\n  rfloor: 8971,\n  lang: 9001,\n  rang: 9002,\n  loz: 9674,\n  spades: 9824,\n  clubs: 9827,\n  hearts: 9829,\n  diams: 9830\n};\nconst controlCharacters = [\n  8364,\n  129,\n  8218,\n  402,\n  8222,\n  8230,\n  8224,\n  8225,\n  710,\n  8240,\n  352,\n  8249,\n  338,\n  141,\n  381,\n  143,\n  144,\n  8216,\n  8217,\n  8220,\n  8221,\n  8226,\n  8211,\n  8212,\n  732,\n  8482,\n  353,\n  8250,\n  339,\n  157,\n  382,\n  376\n];\nconst entityPattern = new RegExp(\n  '&(#?(?:x[\\\\w\\\\d]+|\\\\d+|' + keys(htmlEntities).join('|') + '));?',\n  'g'\n);\nconst codePointSupport = isFunction(String.fromCodePoint);\nconst codeToChar = codePointSupport ? String.fromCodePoint : String.fromCharCode;\n\nexport function decodeCharacterReferences(html) {\n  return html.replace(entityPattern, (match, entity) => {\n    let code;\n\n    // Handle named entities\n    if (entity[0] !== '#') {\n      code = htmlEntities[entity];\n    } else if (entity[1] === 'x') {\n      code = parseInt(entity.substring(2), 16);\n    } else {\n      code = parseInt(entity.substring(1), 10);\n    }\n\n    if (!code) {\n      return match;\n    }\n\n    return codeToChar(validateCode(code));\n  });\n}\n\nconst lessThan = /</g;\nconst greaterThan = />/g;\nconst amp = /&/g;\nconst invalid = 65533;\n\nexport function escapeHtml(str) {\n  return str\n    .replace(amp, '&amp;')\n    .replace(lessThan, '&lt;')\n    .replace(greaterThan, '&gt;');\n}\n\n// some code points are verboten. If we were inserting HTML, the browser would replace the illegal\n// code points with alternatives in some cases - since we're bypassing that mechanism, we need\n// to replace them ourselves\n//\n// Source: http://en.wikipedia.org/wiki/Character_encodings_in_HTML#Illegal_characters\n/* istanbul ignore next */\nfunction validateCode(code) {\n  if (!code) {\n    return invalid;\n  }\n\n  // line feed becomes generic whitespace\n  if (code === 10) {\n    return 32;\n  }\n\n  // ASCII range. (Why someone would use HTML entities for ASCII characters I don't know, but...)\n  if (code < 128) {\n    return code;\n  }\n\n  // code points 128-159 are dealt with leniently by browsers, but they're incorrect. We need\n  // to correct the mistake or we'll end up with missing € signs and so on\n  if (code <= 159) {\n    return controlCharacters[code - 128];\n  }\n\n  // basic multilingual plane\n  if (code < 55296) {\n    return code;\n  }\n\n  // UTF-16 surrogate halves\n  if (code <= 57343) {\n    return invalid;\n  }\n\n  // rest of the basic multilingual plane\n  if (code <= 65535) {\n    return code;\n  } else if (!codePointSupport) {\n    return invalid;\n  }\n\n  // supplementary multilingual plane 0x10000 - 0x1ffff\n  if (code >= 65536 && code <= 131071) {\n    return code;\n  }\n\n  // supplementary ideographic plane 0x20000 - 0x2ffff\n  if (code >= 131072 && code <= 196607) {\n    return code;\n  }\n\n  return invalid;\n}\n","export const expectedExpression = 'Expected a JavaScript expression';\nexport const expectedParen = 'Expected closing paren';\n","import { NUMBER_LITERAL } from '../../../../../config/types';\n\n// bulletproof number regex from https://gist.github.com/Rich-Harris/7544330\nconst numberPattern = /^(?:[+-]?)0*(?:(?:(?:[1-9]\\d*)?\\.\\d+)|(?:(?:0|[1-9]\\d*)\\.)|(?:0|[1-9]\\d*))(?:[eE][+-]?\\d+)?/;\n\nexport default function readNumberLiteral(parser) {\n  let result;\n\n  if ((result = parser.matchPattern(numberPattern))) {\n    return {\n      t: NUMBER_LITERAL,\n      v: result\n    };\n  }\n\n  return null;\n}\n","// Match one or more characters until: \", ', \\, or EOL/EOF.\n// EOL/EOF is written as (?!.) (meaning there's no non-newline char next).\nconst stringMiddlePattern = /^(?=.)[^\"'\\\\]+?(?:(?!.)|(?=[\"'\\\\]))/;\n\n// Match one escape sequence, including the backslash.\nexport const escapeSequencePattern = /^\\\\(?:[`'\"\\\\bfnrt]|0(?![0-9])|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|(?=.)[^ux0-9])/;\n\n// Match one ES5 line continuation (backslash + line terminator).\nexport const lineContinuationPattern = /^\\\\(?:\\r\\n|[\\u000A\\u000D\\u2028\\u2029])/;\n\n// Helper for defining getDoubleQuotedString and getSingleQuotedString.\nexport default function(okQuote) {\n  return function(parser) {\n    let literal = '\"';\n    let done = false;\n    let next;\n\n    while (!done) {\n      next =\n        parser.matchPattern(stringMiddlePattern) ||\n        parser.matchPattern(escapeSequencePattern) ||\n        parser.matchString(okQuote);\n      if (next) {\n        if (next === `\"`) {\n          literal += `\\\\\"`;\n        } else if (next === `\\\\'`) {\n          literal += `'`;\n        } else {\n          literal += next;\n        }\n      } else {\n        next = parser.matchPattern(lineContinuationPattern);\n        if (next) {\n          // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n          literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n        } else {\n          done = true;\n        }\n      }\n    }\n\n    literal += '\"';\n\n    // use JSON.parse to interpret escapes\n    return JSON.parse(literal);\n  };\n}\n","import { STRING_LITERAL } from '../../../../../config/types';\nimport makeQuotedStringMatcher from './stringLiteral/makeQuotedStringMatcher';\n\nconst singleMatcher = makeQuotedStringMatcher(`\"`);\nconst doubleMatcher = makeQuotedStringMatcher(`'`);\n\nexport default function(parser) {\n  const start = parser.pos;\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n\n  if (quote) {\n    const string = (quote === `'` ? singleMatcher : doubleMatcher)(parser);\n\n    if (!parser.matchString(quote)) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: STRING_LITERAL,\n      v: string\n    };\n  }\n\n  return null;\n}\n","import readExpression from '../../../readExpression';\nimport { STRING_LITERAL, BRACKETED, INFIX_OPERATOR } from '../../../../../config/types';\nimport {\n  escapeSequencePattern,\n  lineContinuationPattern\n} from './stringLiteral/makeQuotedStringMatcher';\n\n// Match one or more characters until: \", ', or \\\nconst stringMiddlePattern = /^[^`\"\\\\\\$]+?(?:(?=[`\"\\\\\\$]))/;\n\nconst escapes = /[\\r\\n\\t\\b\\f]/g;\nfunction getString(literal) {\n  return JSON.parse(`\"${literal.replace(escapes, escapeChar)}\"`);\n}\n\nfunction escapeChar(c) {\n  switch (c) {\n    case '\\n':\n      return '\\\\n';\n    case '\\r':\n      return '\\\\r';\n    case '\\t':\n      return '\\\\t';\n    case '\\b':\n      return '\\\\b';\n    case '\\f':\n      return '\\\\f';\n  }\n}\n\nexport default function readTemplateStringLiteral(parser) {\n  if (!parser.matchString('`')) return null;\n\n  let literal = '';\n  let done = false;\n  let next;\n  const parts = [];\n\n  while (!done) {\n    next =\n      parser.matchPattern(stringMiddlePattern) ||\n      parser.matchPattern(escapeSequencePattern) ||\n      parser.matchString('$') ||\n      parser.matchString('\"');\n    if (next) {\n      if (next === `\"`) {\n        literal += `\\\\\"`;\n      } else if (next === '\\\\`') {\n        literal += '`';\n      } else if (next === '$') {\n        if (parser.matchString('{')) {\n          parts.push({ t: STRING_LITERAL, v: getString(literal) });\n          literal = '';\n\n          parser.sp();\n          const expr = readExpression(parser);\n\n          if (!expr) parser.error('Expected valid expression');\n\n          parts.push({ t: BRACKETED, x: expr });\n\n          parser.sp();\n          if (!parser.matchString('}'))\n            parser.error(`Expected closing '}' after interpolated expression`);\n        } else {\n          literal += '$';\n        }\n      } else {\n        literal += next;\n      }\n    } else {\n      next = parser.matchPattern(lineContinuationPattern);\n      if (next) {\n        // convert \\(newline-like) into a \\u escape, which is allowed in JSON\n        literal += '\\\\u' + ('000' + next.charCodeAt(1).toString(16)).slice(-4);\n      } else {\n        done = true;\n      }\n    }\n  }\n\n  if (literal.length) parts.push({ t: STRING_LITERAL, v: getString(literal) });\n\n  if (!parser.matchString('`')) parser.error(\"Expected closing '`'\");\n\n  if (parts.length === 1) {\n    return parts[0];\n  } else {\n    let result = parts.pop();\n    let part;\n\n    while ((part = parts.pop())) {\n      result = {\n        t: INFIX_OPERATOR,\n        s: '+',\n        o: [part, result]\n      };\n    }\n\n    return {\n      t: BRACKETED,\n      x: result\n    };\n  }\n}\n","export const name = /^[a-zA-Z_$][a-zA-Z_$0-9]*/;\nexport const spreadPattern = /^\\s*\\.{3}/;\nexport const legalReference = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:\\.(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nexport const relaxedName = /^[a-zA-Z_$][-\\/a-zA-Z_$0-9]*(?:\\.(?:[a-zA-Z_$][-\\/a-zA-Z_$0-9]*))*/;\n","import readStringLiteral from '../primary/literal/readStringLiteral';\nimport readNumberLiteral from '../primary/literal/readNumberLiteral';\nimport { name as namePattern } from './patterns';\n\nconst identifier = /^[a-zA-Z_$][a-zA-Z_$0-9]*$/;\n\n// http://mathiasbynens.be/notes/javascript-properties\n// can be any name, string literal, or number literal\nexport default function readKey(parser) {\n  let token;\n\n  if ((token = readStringLiteral(parser))) {\n    return identifier.test(token.v) ? token.v : '\"' + token.v.replace(/\"/g, '\\\\\"') + '\"';\n  }\n\n  if ((token = readNumberLiteral(parser))) {\n    return token.v;\n  }\n\n  if ((token = parser.matchPattern(namePattern))) {\n    return token;\n  }\n\n  return null;\n}\n","import { OBJECT_LITERAL } from '../../../../../config/types';\nimport readKeyValuePairs from './objectLiteral/keyValuePairs';\n\nexport default function(parser) {\n  const start = parser.pos;\n\n  // allow whitespace\n  parser.sp();\n\n  if (!parser.matchString('{')) {\n    parser.pos = start;\n    return null;\n  }\n\n  const keyValuePairs = readKeyValuePairs(parser);\n\n  // allow whitespace between final value and '}'\n  parser.sp();\n\n  if (!parser.matchString('}')) {\n    parser.pos = start;\n    return null;\n  }\n\n  return {\n    t: OBJECT_LITERAL,\n    m: keyValuePairs\n  };\n}\n","import { ARRAY_LITERAL } from 'src/config/types';\nimport readExpressionList from '../../shared/readExpressionList';\n\nexport default function(parser) {\n  const start = parser.pos;\n\n  // allow whitespace before '['\n  parser.sp();\n\n  if (!parser.matchString('[')) {\n    parser.pos = start;\n    return null;\n  }\n\n  const expressionList = readExpressionList(parser, true);\n\n  if (!parser.matchString(']')) {\n    parser.pos = start;\n    return null;\n  }\n\n  return {\n    t: ARRAY_LITERAL,\n    m: expressionList\n  };\n}\n","import { BRACKETED, GLOBAL, REFERENCE } from 'src/config/types';\nimport { normalise } from 'src/shared/keypaths';\nimport { legalReference, relaxedName } from '../shared/patterns';\n\n// if a reference is a browser global, we don't deference it later, so it needs special treatment\nconst globals = /^(?:Array|console|Date|RegExp|decodeURIComponent|decodeURI|encodeURIComponent|encodeURI|isFinite|isNaN|parseFloat|parseInt|JSON|Math|NaN|undefined|null|Object|Number|String|Boolean)\\b/;\n\n// keywords are not valid references, with the exception of `this`\nconst keywords = /^(?:break|case|catch|continue|debugger|default|delete|do|else|finally|for|function|if|in|instanceof|new|return|switch|throw|try|typeof|var|void|while|with)$/;\n\nconst prefixPattern = /^(?:\\@\\.|\\@|~\\/|(?:\\^\\^\\/(?:\\^\\^\\/)*(?:\\.\\.\\/)*)|(?:\\.\\.\\/)+|\\.\\/(?:\\.\\.\\/)*|\\.)/;\nconst specials = /^(key|index|keypath|rootpath|this|global|shared|context|event|node|local|style)/;\n\nexport default function readReference(parser) {\n  let prefix, name, global, reference, lastDotIndex;\n\n  const startPos = parser.pos;\n\n  prefix = parser.matchPattern(prefixPattern) || '';\n  name =\n    (!prefix && parser.relaxedNames && parser.matchPattern(relaxedName)) ||\n    parser.matchPattern(legalReference);\n  const actual = prefix.length + ((name && name.length) || 0);\n\n  if (prefix === '@.') {\n    prefix = '@';\n    if (name) name = 'this.' + name;\n    else name = 'this';\n  }\n\n  if (!name && prefix) {\n    name = prefix;\n    prefix = '';\n  }\n\n  if (!name) {\n    return null;\n  }\n\n  if (prefix === '@') {\n    if (!specials.test(name)) {\n      parser.error(`Unrecognized special reference @${name}`);\n    } else if ((~name.indexOf('event') || ~name.indexOf('node')) && !parser.inEvent) {\n      parser.error(`@event and @node are only valid references within an event directive`);\n    } else if (~name.indexOf('context')) {\n      parser.pos = parser.pos - (name.length - 7);\n      return {\n        t: BRACKETED,\n        x: {\n          t: REFERENCE,\n          n: '@context'\n        }\n      };\n    }\n  }\n\n  // bug out if it's a keyword (exception for ancestor/restricted refs - see https://github.com/ractivejs/ractive/issues/1497)\n  if (!prefix && !parser.relaxedNames && keywords.test(name)) {\n    parser.pos = startPos;\n    return null;\n  }\n\n  // if this is a browser global, stop here\n  if (!prefix && globals.test(name)) {\n    global = globals.exec(name)[0];\n    parser.pos = startPos + global.length;\n\n    return {\n      t: GLOBAL,\n      v: global\n    };\n  }\n\n  reference = (prefix || '') + normalise(name);\n\n  if (parser.matchString('(')) {\n    // if this is a method invocation (as opposed to a function) we need\n    // to strip the method name from the reference combo, else the context\n    // will be wrong\n    // but only if the reference was actually a member and not a refinement\n    lastDotIndex = reference.lastIndexOf('.');\n    if (lastDotIndex !== -1 && name[name.length - 1] !== ']') {\n      if (lastDotIndex === 0) {\n        reference = '.';\n        parser.pos = startPos;\n      } else {\n        const refLength = reference.length;\n        reference = reference.substr(0, lastDotIndex);\n        parser.pos = startPos + (actual - (refLength - lastDotIndex));\n      }\n    } else {\n      parser.pos -= 1;\n    }\n  }\n\n  return {\n    t: REFERENCE,\n    n: reference.replace(/^this\\./, './').replace(/^this$/, '.')\n  };\n}\n","import readLiteral from './primary/readLiteral';\nimport readReference from './primary/readReference';\nimport readBracketedExpression from './primary/readBracketedExpression';\n\nexport default function(parser) {\n  return readLiteral(parser) || readReference(parser) || readBracketedExpression(parser);\n}\n","import { MEMBER, INVOCATION } from 'config/types';\nimport readPrimary from './readPrimary';\nimport readExpressionList from './shared/readExpressionList';\nimport readRefinement from './shared/readRefinement';\nimport { expectedParen } from './shared/errors';\n\nexport default function(parser) {\n  let expression = readPrimary(parser);\n\n  if (!expression) return null;\n\n  while (expression) {\n    const refinement = readRefinement(parser);\n    if (refinement) {\n      expression = {\n        t: MEMBER,\n        x: expression,\n        r: refinement\n      };\n    } else if (parser.matchString('(')) {\n      parser.sp();\n      const expressionList = readExpressionList(parser, true);\n\n      parser.sp();\n\n      if (!parser.matchString(')')) {\n        parser.error(expectedParen);\n      }\n\n      expression = {\n        t: INVOCATION,\n        x: expression\n      };\n\n      if (expressionList) expression.o = expressionList;\n    } else {\n      break;\n    }\n  }\n\n  return expression;\n}\n","import { INFIX_OPERATOR } from 'config/types';\nimport readTypeof from './readTypeof';\n\nlet readLogicalOr;\n\nconst makeInfixSequenceMatcher = function(symbol, fallthrough) {\n  return function(parser) {\n    // > and / have to be quoted\n    if (parser.inUnquotedAttribute && (symbol === '>' || symbol === '/'))\n      return fallthrough(parser);\n\n    let start, left, right;\n\n    left = fallthrough(parser);\n    if (!left) {\n      return null;\n    }\n\n    // Loop to handle left-recursion in a case like `a * b * c` and produce\n    // left association, i.e. `(a * b) * c`.  The matcher can't call itself\n    // to parse `left` because that would be infinite regress.\n    while (true) {\n      start = parser.pos;\n\n      parser.sp();\n\n      if (!parser.matchString(symbol)) {\n        parser.pos = start;\n        return left;\n      }\n\n      // special case - in operator must not be followed by [a-zA-Z_$0-9]\n      if (symbol === 'in' && /[a-zA-Z_$0-9]/.test(parser.remaining().charAt(0))) {\n        parser.pos = start;\n        return left;\n      }\n\n      parser.sp();\n\n      // right operand must also consist of only higher-precedence operators\n      right = fallthrough(parser);\n      if (!right) {\n        parser.pos = start;\n        return left;\n      }\n\n      left = {\n        t: INFIX_OPERATOR,\n        s: symbol,\n        o: [left, right]\n      };\n\n      // Loop back around.  If we don't see another occurrence of the symbol,\n      // we'll return left.\n    }\n  };\n};\n\n// create all infix sequence matchers, and return readLogicalOr\n(function() {\n  let i, len, matcher, fallthrough;\n\n  // All the infix operators on order of precedence (source: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Operator_Precedence)\n  // Each sequence matcher will initially fall through to its higher precedence\n  // neighbour, and only attempt to match if one of the higher precedence operators\n  // (or, ultimately, a literal, reference, or bracketed expression) already matched\n  const infixOperators = '* / % + - << >> >>> < <= > >= in instanceof == != === !== & ^ | && ||'.split(\n    ' '\n  );\n\n  // A typeof operator is higher precedence than multiplication\n  fallthrough = readTypeof;\n  for (i = 0, len = infixOperators.length; i < len; i += 1) {\n    matcher = makeInfixSequenceMatcher(infixOperators[i], fallthrough);\n    fallthrough = matcher;\n  }\n\n  // Logical OR is the fallthrough for the conditional matcher\n  readLogicalOr = fallthrough;\n})();\n\nexport default readLogicalOr;\n","import {\n  ARRAY_LITERAL,\n  ATTRIBUTE,\n  DECORATOR,\n  DELEGATE_FLAG,\n  BINDING_FLAG,\n  INTERPOLATOR,\n  TRANSITION,\n  EVENT\n} from '../../../config/types';\nimport getLowestIndex from '../utils/getLowestIndex';\nimport readMustache from '../readMustache';\nimport { decodeCharacterReferences } from 'src/utils/html';\nimport readExpressionList from '../expressions/shared/readExpressionList';\nimport readExpressionOrReference from '../readExpressionOrReference';\nimport flattenExpression from 'parse/utils/flattenExpression';\nimport refineExpression from 'parse/utils/refineExpression';\nimport { isString } from 'utils/is';\n\nconst attributeNamePattern = /^[^\\s\"'>\\/=]+/;\nconst onPattern = /^on/;\nconst eventPattern = /^on-([a-zA-Z\\*\\.$_]((?:[a-zA-Z\\*\\.$_0-9\\-]|\\\\-)+))$/;\nconst reservedEventNames = /^(?:change|reset|teardown|update|construct|config|init|render|complete|unrender|detach|insert|destruct|attachchild|detachchild)$/;\nconst decoratorPattern = /^as-([a-z-A-Z][-a-zA-Z_0-9]*)$/;\nconst transitionPattern = /^([a-zA-Z](?:(?!-in-out)[-a-zA-Z_0-9])*)-(in|out|in-out)$/;\nconst boundPattern = /^((bind|class)-(([-a-zA-Z0-9_])+))$/;\nconst directives = {\n  lazy: { t: BINDING_FLAG, v: 'l' },\n  twoway: { t: BINDING_FLAG, v: 't' },\n  'no-delegation': { t: DELEGATE_FLAG }\n};\nconst unquotedAttributeValueTextPattern = /^[^\\s\"'=<>\\/`]+/;\nconst proxyEvent = /^[^\\s\"'=<>@\\[\\]()]*/;\nconst whitespace = /^\\s+/;\n\nconst slashes = /\\\\/g;\nfunction splitEvent(str) {\n  const result = [];\n  let s = 0;\n\n  for (let i = 0; i < str.length; i++) {\n    if (str[i] === '-' && str[i - 1] !== '\\\\') {\n      result.push(str.substring(s, i).replace(slashes, ''));\n      s = i + 1;\n    }\n  }\n\n  result.push(str.substring(s).replace(slashes, ''));\n\n  return result;\n}\n\nexport default function readAttribute(parser) {\n  let name, i, nearest, idx;\n\n  parser.sp();\n\n  name = parser.matchPattern(attributeNamePattern);\n  if (!name) {\n    return null;\n  }\n\n  // check for accidental delimiter consumption e.g. <tag bool{{>attrs}} />\n  nearest = name.length;\n  for (i = 0; i < parser.tags.length; i++) {\n    if (~(idx = name.indexOf(parser.tags[i].open))) {\n      if (idx < nearest) nearest = idx;\n    }\n  }\n  if (nearest < name.length) {\n    parser.pos -= name.length - nearest;\n    name = name.substr(0, nearest);\n    if (!name) return null;\n  }\n\n  return { n: name };\n}\n\nfunction readAttributeValue(parser) {\n  const start = parser.pos;\n\n  // next character must be `=`, `/`, `>` or whitespace\n  if (!/[=\\/>\\s]/.test(parser.nextChar())) {\n    parser.error('Expected `=`, `/`, `>` or whitespace');\n  }\n\n  parser.sp();\n\n  if (!parser.matchString('=')) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n\n  const valueStart = parser.pos;\n  const startDepth = parser.sectionDepth;\n\n  const value =\n    readQuotedAttributeValue(parser, `'`) ||\n    readQuotedAttributeValue(parser, `\"`) ||\n    readUnquotedAttributeValue(parser);\n\n  if (value === null) {\n    parser.error('Expected valid attribute value');\n  }\n\n  if (parser.sectionDepth !== startDepth) {\n    parser.pos = valueStart;\n    parser.error(\n      'An attribute value must contain as many opening section tags as closing section tags'\n    );\n  }\n\n  if (!value.length) {\n    return '';\n  }\n\n  if (value.length === 1 && isString(value[0])) {\n    return decodeCharacterReferences(value[0]);\n  }\n\n  return value;\n}\n\nfunction readUnquotedAttributeValueToken(parser) {\n  let text, index;\n\n  const start = parser.pos;\n\n  text = parser.matchPattern(unquotedAttributeValueTextPattern);\n\n  if (!text) {\n    return null;\n  }\n\n  const haystack = text;\n  const needles = parser.tags.map(t => t.open); // TODO refactor... we do this in readText.js as well\n\n  if ((index = getLowestIndex(haystack, needles)) !== -1) {\n    text = text.substr(0, index);\n    parser.pos = start + text.length;\n  }\n\n  return text;\n}\n\nfunction readUnquotedAttributeValue(parser) {\n  parser.inAttribute = true;\n\n  const tokens = [];\n\n  let token = readMustache(parser) || readUnquotedAttributeValueToken(parser);\n  while (token) {\n    tokens.push(token);\n    token = readMustache(parser) || readUnquotedAttributeValueToken(parser);\n  }\n\n  if (!tokens.length) {\n    return null;\n  }\n\n  parser.inAttribute = false;\n  return tokens;\n}\n\nfunction readQuotedAttributeValue(parser, quoteMark) {\n  const start = parser.pos;\n\n  if (!parser.matchString(quoteMark)) {\n    return null;\n  }\n\n  parser.inAttribute = quoteMark;\n\n  const tokens = [];\n\n  let token = readMustache(parser) || readQuotedStringToken(parser, quoteMark);\n  while (token !== null) {\n    tokens.push(token);\n    token = readMustache(parser) || readQuotedStringToken(parser, quoteMark);\n  }\n\n  if (!parser.matchString(quoteMark)) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.inAttribute = false;\n\n  return tokens;\n}\n\nfunction readQuotedStringToken(parser, quoteMark) {\n  const haystack = parser.remaining();\n\n  const needles = parser.tags.map(t => t.open); // TODO refactor... we do this in readText.js as well\n  needles.push(quoteMark);\n\n  const index = getLowestIndex(haystack, needles);\n\n  if (index === -1) {\n    parser.error('Quoted attribute value must have a closing quote');\n  }\n\n  if (!index) {\n    return null;\n  }\n\n  parser.pos += index;\n  return haystack.substr(0, index);\n}\n\nexport function readAttributeOrDirective(parser) {\n  let match, directive;\n\n  const attribute = readAttribute(parser, false);\n\n  if (!attribute) return null;\n\n  // lazy, twoway\n  if ((directive = directives[attribute.n])) {\n    attribute.t = directive.t;\n    if (directive.v) attribute.v = directive.v;\n    delete attribute.n; // no name necessary\n    parser.sp();\n    if (parser.nextChar() === '=') attribute.f = readAttributeValue(parser);\n  } else if ((match = decoratorPattern.exec(attribute.n))) {\n    // decorators\n    attribute.n = match[1];\n    attribute.t = DECORATOR;\n    readArguments(parser, attribute);\n  } else if ((match = transitionPattern.exec(attribute.n))) {\n    // transitions\n    attribute.n = match[1];\n    attribute.t = TRANSITION;\n    readArguments(parser, attribute);\n    attribute.v = match[2] === 'in-out' ? 't0' : match[2] === 'in' ? 't1' : 't2';\n  } else if ((match = eventPattern.exec(attribute.n))) {\n    // on-click etc\n    attribute.n = splitEvent(match[1]);\n    attribute.t = EVENT;\n\n    parser.inEvent = true;\n\n    // check for a proxy event\n    if (!readProxyEvent(parser, attribute)) {\n      // otherwise, it's an expression\n      readArguments(parser, attribute, true);\n    } else if (reservedEventNames.test(attribute.f)) {\n      parser.pos -= attribute.f.length;\n      parser.error(\n        'Cannot use reserved event names (change, reset, teardown, update, construct, config, init, render, unrender, complete, detach, insert, destruct, attachchild, detachchild)'\n      );\n    }\n\n    parser.inEvent = false;\n  } else if ((match = boundPattern.exec(attribute.n))) {\n    // bound directives\n    const bind = match[2] === 'bind';\n    attribute.n = bind ? match[3] : match[1];\n    attribute.t = ATTRIBUTE;\n    readArguments(parser, attribute, false, true);\n\n    if (!attribute.f && bind) {\n      attribute.f = [{ t: INTERPOLATOR, r: match[3] }];\n    }\n  } else {\n    parser.sp();\n    const value = parser.nextChar() === '=' ? readAttributeValue(parser) : null;\n    attribute.f = value != null ? value : attribute.f;\n\n    if (parser.sanitizeEventAttributes && onPattern.test(attribute.n)) {\n      return { exclude: true };\n    } else {\n      attribute.f = attribute.f || (attribute.f === '' ? '' : 0);\n      attribute.t = ATTRIBUTE;\n    }\n  }\n\n  return attribute;\n}\n\nfunction readProxyEvent(parser, attribute) {\n  const start = parser.pos;\n  if (!parser.matchString('=')) parser.error(`Missing required directive arguments`);\n\n  const quote = parser.matchString(`'`) || parser.matchString(`\"`);\n  parser.sp();\n  const proxy = parser.matchPattern(proxyEvent);\n\n  if (proxy !== undefined) {\n    if (quote) {\n      parser.sp();\n      if (!parser.matchString(quote)) parser.pos = start;\n      else return (attribute.f = proxy) || true;\n    } else if (!parser.matchPattern(whitespace)) {\n      parser.pos = start;\n    } else {\n      return (attribute.f = proxy) || true;\n    }\n  } else {\n    parser.pos = start;\n  }\n}\n\nfunction readArguments(parser, attribute, required = false, single = false) {\n  parser.sp();\n  if (!parser.matchString('=')) {\n    if (required) parser.error(`Missing required directive arguments`);\n    return;\n  }\n  parser.sp();\n\n  const quote = parser.matchString('\"') || parser.matchString(\"'\");\n  const spread = parser.spreadArgs;\n  parser.spreadArgs = true;\n  parser.inUnquotedAttribute = !quote;\n  const expr = single\n    ? readExpressionOrReference(parser, [quote || ' ', '/', '>'])\n    : { m: readExpressionList(parser), t: ARRAY_LITERAL };\n  parser.inUnquotedAttribute = false;\n  parser.spreadArgs = spread;\n\n  if (quote) {\n    parser.sp();\n    if (parser.matchString(quote) !== quote) parser.error(`Expected matching quote '${quote}'`);\n  }\n\n  if (single) {\n    const interpolator = { t: INTERPOLATOR };\n    refineExpression(expr, interpolator);\n    attribute.f = [interpolator];\n  } else {\n    attribute.f = flattenExpression(expr);\n  }\n}\n","import { DELIMCHANGE } from 'config/types';\nimport readDelimiterChange from './mustache/readDelimiterChange';\nimport readRegexpLiteral from './expressions/primary/literal/readRegexpLiteral';\nimport { readAttributeOrDirective } from './element/readAttribute';\n\nconst delimiterChangeToken = { t: DELIMCHANGE, exclude: true };\n\nexport default function readMustache(parser) {\n  let mustache, i;\n\n  // If we're inside a <script> or <style> tag, and we're not\n  // interpolating, bug out\n  if (parser.interpolate[parser.inside] === false) {\n    return null;\n  }\n\n  for (i = 0; i < parser.tags.length; i += 1) {\n    if ((mustache = readMustacheOfType(parser, parser.tags[i]))) {\n      return mustache;\n    }\n  }\n\n  if (parser.inTag && !parser.inAttribute) {\n    mustache = readAttributeOrDirective(parser);\n    if (mustache) {\n      parser.sp();\n      return mustache;\n    }\n  }\n}\n\nfunction readMustacheOfType(parser, tag) {\n  let mustache, reader, i;\n\n  const start = parser.pos;\n\n  if (parser.matchString('\\\\' + tag.open)) {\n    if (start === 0 || parser.str[start - 1] !== '\\\\') {\n      return tag.open;\n    }\n  } else if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  // delimiter change?\n  if ((mustache = readDelimiterChange(parser))) {\n    // find closing delimiter or abort...\n    if (!parser.matchString(tag.close)) {\n      return null;\n    }\n\n    // ...then make the switch\n    tag.open = mustache[0];\n    tag.close = mustache[1];\n    parser.sortMustacheTags();\n\n    return delimiterChangeToken;\n  }\n\n  parser.sp();\n\n  // illegal section closer\n  if (parser.matchString('/')) {\n    parser.pos -= 1;\n    const rewind = parser.pos;\n    if (!readRegexpLiteral(parser)) {\n      parser.pos = rewind - tag.close.length;\n      if (parser.inAttribute) {\n        parser.pos = start;\n        return null;\n      } else {\n        parser.error(\"Attempted to close a section that wasn't open\");\n      }\n    } else {\n      parser.pos = rewind;\n    }\n  }\n\n  for (i = 0; i < tag.readers.length; i += 1) {\n    reader = tag.readers[i];\n\n    if ((mustache = reader(parser, tag))) {\n      if (tag.isStatic) {\n        mustache.s = 1;\n      }\n\n      if (parser.includeLinePositions) {\n        mustache.p = parser.getLinePos(start);\n      }\n\n      return mustache;\n    }\n  }\n\n  parser.pos = start;\n  return null;\n}\n","import readExpression from '../readExpression';\nimport refineExpression from '../../utils/refineExpression';\n\nconst legalAlias = /^(?:[a-zA-Z$_0-9]|\\\\\\.)+(?:(?:(?:[a-zA-Z$_0-9]|\\\\\\.)+)|(?:\\[[0-9]+\\]))*/;\nconst asRE = /^as/i;\n\nexport function readAliases(parser) {\n  const aliases = [];\n  let alias;\n  const start = parser.pos;\n\n  parser.sp();\n\n  alias = readAlias(parser);\n\n  if (alias) {\n    alias.x = refineExpression(alias.x, {});\n    aliases.push(alias);\n\n    parser.sp();\n\n    while (parser.matchString(',')) {\n      alias = readAlias(parser);\n\n      if (!alias) {\n        parser.error('Expected another alias.');\n      }\n\n      alias.x = refineExpression(alias.x, {});\n      aliases.push(alias);\n\n      parser.sp();\n    }\n\n    return aliases;\n  }\n\n  parser.pos = start;\n  return null;\n}\n\nexport function readAlias(parser) {\n  const start = parser.pos;\n\n  parser.sp();\n\n  const expr = readExpression(parser, []);\n\n  if (!expr) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n\n  if (!parser.matchPattern(asRE)) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n\n  const alias = parser.matchPattern(legalAlias);\n\n  if (!alias) {\n    parser.error('Expected a legal alias name.');\n  }\n\n  return { n: alias, x: expr };\n}\n","import { ELSE } from 'config/types';\n\nconst elsePattern = /^\\s*else\\s*/;\n\nexport default function readElse(parser, tag) {\n  const start = parser.pos;\n\n  if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  if (!parser.matchPattern(elsePattern)) {\n    parser.pos = start;\n    return null;\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  return {\n    t: ELSE\n  };\n}\n","import { ELSEIF } from 'config/types';\nimport readExpression from '../../readExpression';\n\nconst elsePattern = /^\\s*elseif\\s+/;\n\nexport default function readElseIf(parser, tag) {\n  const start = parser.pos;\n\n  if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  if (!parser.matchPattern(elsePattern)) {\n    parser.pos = start;\n    return null;\n  }\n\n  const expression = readExpression(parser);\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  return {\n    t: ELSEIF,\n    x: expression\n  };\n}\n","import { SECTION_EACH, SECTION_IF, SECTION_IF_WITH, SECTION_UNLESS } from 'config/types';\n\nexport default {\n  each: SECTION_EACH,\n  if: SECTION_IF,\n  with: SECTION_IF_WITH,\n  unless: SECTION_UNLESS\n};\n","import { ALIAS, SECTION, SECTION_IF, SECTION_UNLESS } from 'config/types';\nimport { READERS } from 'parse/_parse';\nimport readClosing from './section/readClosing';\nimport readElse from './section/readElse';\nimport readElseIf from './section/readElseIf';\nimport handlebarsBlockCodes from './handlebarsBlockCodes';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\nimport { readAlias, readAliases } from './readAliases';\nimport { keys } from 'utils/object';\n\nconst indexRefPattern = /^\\s*:\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nconst keyIndexRefPattern = /^\\s*,\\s*([a-zA-Z_$][a-zA-Z_$0-9]*)/;\nconst handlebarsBlockPattern = new RegExp('^(' + keys(handlebarsBlockCodes).join('|') + ')\\\\b');\n\nexport default function readSection(parser, tag) {\n  let expression, section, child, children, hasElse, block, unlessBlock, closed, i, expectedClose;\n  let aliasOnly = false;\n\n  const start = parser.pos;\n\n  if (parser.matchString('^')) {\n    // watch out for parent context refs - {{^^/^^/foo}}\n    if (parser.matchString('^/')) {\n      parser.pos = start;\n      return null;\n    }\n    section = { t: SECTION, f: [], n: SECTION_UNLESS };\n  } else if (parser.matchString('#')) {\n    section = { t: SECTION, f: [] };\n\n    if (parser.matchString('partial')) {\n      parser.pos = start - parser.standardDelimiters[0].length;\n      parser.error(\n        'Partial definitions can only be at the top level of the template, or immediately inside components'\n      );\n    }\n\n    if ((block = parser.matchPattern(handlebarsBlockPattern))) {\n      expectedClose = block;\n      section.n = handlebarsBlockCodes[block];\n    }\n  } else {\n    return null;\n  }\n\n  parser.sp();\n\n  if (block === 'with') {\n    const aliases = readAliases(parser);\n    if (aliases) {\n      aliasOnly = true;\n      section.z = aliases;\n      section.t = ALIAS;\n    }\n  } else if (block === 'each') {\n    const alias = readAlias(parser);\n    if (alias) {\n      section.z = [{ n: alias.n, x: { r: '.' } }];\n      expression = alias.x;\n    }\n  }\n\n  if (!aliasOnly) {\n    if (!expression) expression = readExpression(parser);\n\n    if (!expression) {\n      parser.error('Expected expression');\n    }\n\n    // optional index and key references\n    if ((i = parser.matchPattern(indexRefPattern))) {\n      let extra;\n\n      if ((extra = parser.matchPattern(keyIndexRefPattern))) {\n        section.i = i + ',' + extra;\n      } else {\n        section.i = i;\n      }\n    }\n\n    if (!block && expression.n) {\n      expectedClose = expression.n;\n    }\n  }\n\n  parser.sp();\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  parser.sectionDepth += 1;\n  children = section.f;\n\n  let pos;\n  do {\n    pos = parser.pos;\n    if ((child = readClosing(parser, tag))) {\n      if (expectedClose && child.r !== expectedClose) {\n        if (!block) {\n          if (child.r)\n            parser.warn(\n              `Expected ${tag.open}/${expectedClose}${tag.close} but found ${tag.open}/${child.r}${\n                tag.close\n              }`\n            );\n        } else {\n          parser.pos = pos;\n          parser.error(`Expected ${tag.open}/${expectedClose}${tag.close}`);\n        }\n      }\n\n      parser.sectionDepth -= 1;\n      closed = true;\n    } else if (!aliasOnly && (child = readElseIf(parser, tag))) {\n      if (section.n === SECTION_UNLESS) {\n        parser.error('{{else}} not allowed in {{#unless}}');\n      }\n\n      if (hasElse) {\n        parser.error('illegal {{elseif...}} after {{else}}');\n      }\n\n      if (!unlessBlock) {\n        unlessBlock = [];\n      }\n\n      const mustache = {\n        t: SECTION,\n        n: SECTION_IF,\n        f: (children = [])\n      };\n      refineExpression(child.x, mustache);\n\n      unlessBlock.push(mustache);\n    } else if (!aliasOnly && (child = readElse(parser, tag))) {\n      if (section.n === SECTION_UNLESS) {\n        parser.error('{{else}} not allowed in {{#unless}}');\n      }\n\n      if (hasElse) {\n        parser.error('there can only be one {{else}} block, at the end of a section');\n      }\n\n      hasElse = true;\n\n      // use an unless block if there's no elseif\n      if (!unlessBlock) {\n        unlessBlock = [];\n      }\n\n      unlessBlock.push({\n        t: SECTION,\n        n: SECTION_UNLESS,\n        f: (children = [])\n      });\n    } else {\n      child = parser.read(READERS);\n\n      if (!child) {\n        break;\n      }\n\n      children.push(child);\n    }\n  } while (!closed);\n\n  if (unlessBlock) {\n    section.l = unlessBlock;\n  }\n\n  if (!aliasOnly) {\n    refineExpression(expression, section);\n  }\n\n  // TODO if a section is empty it should be discarded. Don't do\n  // that here though - we need to clean everything up first, as\n  // it may contain removeable whitespace. As a temporary measure,\n  // to pass the existing tests, remove empty `f` arrays\n  if (!section.f.length) {\n    delete section.f;\n  }\n\n  return section;\n}\n","import { COMMENT } from 'config/types';\n\nconst OPEN_COMMENT = '<!--';\nconst CLOSE_COMMENT = '-->';\n\nexport default function readHtmlComment(parser) {\n  const start = parser.pos;\n\n  if (parser.textOnlyMode || !parser.matchString(OPEN_COMMENT)) {\n    return null;\n  }\n\n  const remaining = parser.remaining();\n  const endIndex = remaining.indexOf(CLOSE_COMMENT);\n\n  if (endIndex === -1) {\n    parser.error(\"Illegal HTML - expected closing comment sequence ('-->')\");\n  }\n\n  const content = remaining.substr(0, endIndex);\n  parser.pos += endIndex + 3;\n\n  const comment = {\n    t: COMMENT,\n    c: content\n  };\n\n  if (parser.includeLinePositions) {\n    comment.p = parser.getLinePos(start);\n  }\n\n  return comment;\n}\n","import { COMMENT, DELIMCHANGE, SECTION, INVERTED } from 'config/types';\nimport { lastItem } from 'utils/array';\nimport { isString } from 'utils/is';\n\nconst leadingLinebreak = /^[ \\t\\f\\r\\n]*\\r?\\n/;\nconst trailingLinebreak = /\\r?\\n[ \\t\\f\\r\\n]*$/;\n\nexport default function(items) {\n  let i, current, backOne, backTwo, lastSectionItem;\n\n  for (i = 1; i < items.length; i += 1) {\n    current = items[i];\n    backOne = items[i - 1];\n    backTwo = items[i - 2];\n\n    // if we're at the end of a [text][comment][text] sequence...\n    if (isString(current) && isComment(backOne) && isString(backTwo)) {\n      // ... and the comment is a standalone (i.e. line breaks either side)...\n      if (trailingLinebreak.test(backTwo) && leadingLinebreak.test(current)) {\n        // ... then we want to remove the whitespace after the first line break\n        items[i - 2] = backTwo.replace(trailingLinebreak, '\\n');\n\n        // and the leading line break of the second text token\n        items[i] = current.replace(leadingLinebreak, '');\n      }\n    }\n\n    // if the current item is a section, and it is preceded by a linebreak, and\n    // its first item is a linebreak...\n    if (isSection(current) && isString(backOne)) {\n      if (\n        trailingLinebreak.test(backOne) &&\n        isString(current.f[0]) &&\n        leadingLinebreak.test(current.f[0])\n      ) {\n        items[i - 1] = backOne.replace(trailingLinebreak, '\\n');\n        current.f[0] = current.f[0].replace(leadingLinebreak, '');\n      }\n    }\n\n    // if the last item was a section, and it is followed by a linebreak, and\n    // its last item is a linebreak...\n    if (isString(current) && isSection(backOne)) {\n      lastSectionItem = lastItem(backOne.f);\n\n      if (\n        isString(lastSectionItem) &&\n        trailingLinebreak.test(lastSectionItem) &&\n        leadingLinebreak.test(current)\n      ) {\n        backOne.f[backOne.f.length - 1] = lastSectionItem.replace(trailingLinebreak, '\\n');\n        items[i] = current.replace(leadingLinebreak, '');\n      }\n    }\n  }\n\n  return items;\n}\n\nfunction isComment(item) {\n  return item.t === COMMENT || item.t === DELIMCHANGE;\n}\n\nfunction isSection(item) {\n  return (item.t === SECTION || item.t === INVERTED) && item.f;\n}\n","import { lastItem } from 'utils/array';\nimport { isString } from 'utils/is';\n\nexport default function(items, leadingPattern, trailingPattern) {\n  let item;\n\n  if (leadingPattern) {\n    item = items[0];\n    if (isString(item)) {\n      item = item.replace(leadingPattern, '');\n\n      if (!item) {\n        items.shift();\n      } else {\n        items[0] = item;\n      }\n    }\n  }\n\n  if (trailingPattern) {\n    item = lastItem(items);\n    if (isString(item)) {\n      item = item.replace(trailingPattern, '');\n\n      if (!item) {\n        items.pop();\n      } else {\n        items[items.length - 1] = item;\n      }\n    }\n  }\n}\n","import { COMMENT, ELEMENT } from 'config/types';\nimport stripStandalones from './stripStandalones';\nimport trimWhitespace from './trimWhitespace';\nimport { isString } from 'utils/is';\n\nconst contiguousWhitespace = /[ \\t\\f\\r\\n]+/g;\nconst preserveWhitespaceElements = /^(?:pre|script|style|textarea)$/i;\nconst leadingWhitespace = /^[ \\t\\f\\r\\n]+/;\nconst trailingWhitespace = /[ \\t\\f\\r\\n]+$/;\nconst leadingNewLine = /^(?:\\r\\n|\\r|\\n)/;\nconst trailingNewLine = /(?:\\r\\n|\\r|\\n)$/;\n\nexport default function cleanup(\n  items,\n  stripComments,\n  preserveWhitespace,\n  removeLeadingWhitespace,\n  removeTrailingWhitespace\n) {\n  if (isString(items)) return;\n\n  let i,\n    item,\n    previousItem,\n    nextItem,\n    preserveWhitespaceInsideFragment,\n    removeLeadingWhitespaceInsideFragment,\n    removeTrailingWhitespaceInsideFragment;\n\n  // First pass - remove standalones and comments etc\n  stripStandalones(items);\n\n  i = items.length;\n  while (i--) {\n    item = items[i];\n\n    // Remove delimiter changes, unsafe elements etc\n    if (item.exclude) {\n      items.splice(i, 1);\n    } else if (stripComments && item.t === COMMENT) {\n      // Remove comments, unless we want to keep them\n      items.splice(i, 1);\n    }\n  }\n\n  // If necessary, remove leading and trailing whitespace\n  trimWhitespace(\n    items,\n    removeLeadingWhitespace ? leadingWhitespace : null,\n    removeTrailingWhitespace ? trailingWhitespace : null\n  );\n\n  i = items.length;\n  while (i--) {\n    item = items[i];\n\n    // Recurse\n    if (item.f) {\n      const isPreserveWhitespaceElement =\n        item.t === ELEMENT && preserveWhitespaceElements.test(item.e);\n      preserveWhitespaceInsideFragment = preserveWhitespace || isPreserveWhitespaceElement;\n\n      if (!preserveWhitespace && isPreserveWhitespaceElement) {\n        trimWhitespace(item.f, leadingNewLine, trailingNewLine);\n      }\n\n      if (!preserveWhitespaceInsideFragment) {\n        previousItem = items[i - 1];\n        nextItem = items[i + 1];\n\n        // if the previous item was a text item with trailing whitespace,\n        // remove leading whitespace inside the fragment\n        if (!previousItem || (isString(previousItem) && trailingWhitespace.test(previousItem))) {\n          removeLeadingWhitespaceInsideFragment = true;\n        }\n\n        // and vice versa\n        if (!nextItem || (isString(nextItem) && leadingWhitespace.test(nextItem))) {\n          removeTrailingWhitespaceInsideFragment = true;\n        }\n      }\n\n      cleanup(\n        item.f,\n        stripComments,\n        preserveWhitespaceInsideFragment,\n        removeLeadingWhitespaceInsideFragment,\n        removeTrailingWhitespaceInsideFragment\n      );\n    }\n\n    // Split if-else blocks into two (an if, and an unless)\n    if (item.l) {\n      cleanup(\n        item.l,\n        stripComments,\n        preserveWhitespace,\n        removeLeadingWhitespaceInsideFragment,\n        removeTrailingWhitespaceInsideFragment\n      );\n\n      item.l.forEach(s => (s.l = 1));\n      item.l.unshift(i + 1, 0);\n      items.splice.apply(items, item.l);\n      delete item.l; // TODO would be nice if there was a way around this\n    }\n\n    // Clean up conditional attributes\n    if (item.m) {\n      cleanup(\n        item.m,\n        stripComments,\n        preserveWhitespace,\n        removeLeadingWhitespaceInsideFragment,\n        removeTrailingWhitespaceInsideFragment\n      );\n      if (item.m.length < 1) delete item.m;\n    }\n  }\n\n  // final pass - fuse text nodes together\n  i = items.length;\n  while (i--) {\n    if (isString(items[i])) {\n      if (isString(items[i + 1])) {\n        items[i] = items[i] + items[i + 1];\n        items.splice(i + 1, 1);\n      }\n\n      if (!preserveWhitespace) {\n        items[i] = items[i].replace(contiguousWhitespace, ' ');\n      }\n\n      if (items[i] === '') {\n        items.splice(i, 1);\n      }\n    }\n  }\n}\n","import { CLOSING_TAG } from 'src/config/types';\n\nconst closingTagPattern = /^([a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*)\\s*\\>/;\n\nexport default function readClosingTag(parser) {\n  let tag;\n\n  const start = parser.pos;\n\n  // are we looking at a closing tag?\n  if (!parser.matchString('</')) {\n    return null;\n  }\n\n  if ((tag = parser.matchPattern(closingTagPattern))) {\n    if (parser.inside && tag !== parser.inside) {\n      parser.pos = start;\n      return null;\n    }\n\n    return {\n      t: CLOSING_TAG,\n      e: tag\n    };\n  }\n\n  // We have an illegal closing tag, report it\n  parser.pos -= 2;\n  parser.error('Illegal closing tag');\n}\n","import { ANCHOR, DOCTYPE, ELEMENT } from 'config/types';\nimport { voidElementNames } from 'utils/html';\nimport { READERS, PARTIAL_READERS } from '../_parse';\nimport cleanup from 'parse/utils/cleanup';\nimport readMustache from './readMustache';\nimport readClosingTag from './element/readClosingTag';\nimport readClosing from './mustache/section/readClosing';\nimport readElse from './mustache/section/readElse';\nimport readElseIf from './mustache/section/readElseIf';\nimport { create } from 'utils/object';\n\nconst tagNamePattern = /^[a-zA-Z]{1,}:?[a-zA-Z0-9\\-]*/;\nconst anchorPattern = /^[a-zA-Z_$][-a-zA-Z0-9_$]*/;\nconst validTagNameFollower = /^[\\s\\n\\/>]/;\nconst exclude = { exclude: true };\n\n// based on http://developers.whatwg.org/syntax.html#syntax-tag-omission\nconst disallowedContents = {\n  li: ['li'],\n  dt: ['dt', 'dd'],\n  dd: ['dt', 'dd'],\n  p: 'address article aside blockquote div dl fieldset footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol p pre section table ul'.split(\n    ' '\n  ),\n  rt: ['rt', 'rp'],\n  rp: ['rt', 'rp'],\n  optgroup: ['optgroup'],\n  option: ['option', 'optgroup'],\n  thead: ['tbody', 'tfoot'],\n  tbody: ['tbody', 'tfoot'],\n  tfoot: ['tbody'],\n  tr: ['tr', 'tbody'],\n  td: ['td', 'th', 'tr'],\n  th: ['td', 'th', 'tr']\n};\n\nexport default readElement;\n\nfunction readElement(parser) {\n  let attribute,\n    selfClosing,\n    children,\n    partials,\n    hasPartials,\n    child,\n    closed,\n    pos,\n    remaining,\n    closingTag,\n    anchor;\n\n  const start = parser.pos;\n\n  if (parser.inside || parser.inAttribute || parser.textOnlyMode) {\n    return null;\n  }\n\n  if (!parser.matchString('<')) {\n    return null;\n  }\n\n  // if this is a closing tag, abort straight away\n  if (parser.nextChar() === '/') {\n    return null;\n  }\n\n  const element = {};\n  if (parser.includeLinePositions) {\n    element.p = parser.getLinePos(start);\n  }\n\n  // check for doctype decl\n  if (parser.matchString('!')) {\n    element.t = DOCTYPE;\n    if (!parser.matchPattern(/^doctype/i)) {\n      parser.error('Expected DOCTYPE declaration');\n    }\n\n    element.a = parser.matchPattern(/^(.+?)>/);\n    return element;\n  } else if ((anchor = parser.matchString('#'))) {\n    // check for anchor\n    parser.sp();\n    element.t = ANCHOR;\n    element.n = parser.matchPattern(anchorPattern);\n  } else {\n    // otherwise, it's an element/component\n    element.t = ELEMENT;\n\n    // element name\n    element.e = parser.matchPattern(tagNamePattern);\n    if (!element.e) {\n      return null;\n    }\n  }\n\n  // next character must be whitespace, closing solidus or '>'\n  if (!validTagNameFollower.test(parser.nextChar())) {\n    parser.error('Illegal tag name');\n  }\n\n  parser.sp();\n\n  parser.inTag = true;\n\n  // directives and attributes\n  while ((attribute = readMustache(parser))) {\n    if (attribute !== false) {\n      if (!element.m) element.m = [];\n      element.m.push(attribute);\n    }\n\n    parser.sp();\n  }\n\n  parser.inTag = false;\n\n  // allow whitespace before closing solidus\n  parser.sp();\n\n  // self-closing solidus?\n  if (parser.matchString('/')) {\n    selfClosing = true;\n  }\n\n  // closing angle bracket\n  if (!parser.matchString('>')) {\n    return null;\n  }\n\n  const lowerCaseName = (element.e || element.n).toLowerCase();\n  const preserveWhitespace = parser.preserveWhitespace;\n\n  if (!selfClosing && (anchor || !voidElementNames.test(element.e))) {\n    if (!anchor) {\n      parser.elementStack.push(lowerCaseName);\n\n      // Special case - if we open a script element, further tags should\n      // be ignored unless they're a closing script element\n      if (lowerCaseName in parser.interpolate) {\n        parser.inside = lowerCaseName;\n      }\n    }\n\n    children = [];\n    partials = create(null);\n\n    do {\n      pos = parser.pos;\n      remaining = parser.remaining();\n\n      if (!remaining) {\n        // if this happens to be a script tag and there's no content left, it's because\n        // a closing script tag can't appear in a script\n        if (parser.inside === 'script') {\n          closed = true;\n          break;\n        }\n\n        parser.error(\n          `Missing end ${parser.elementStack.length > 1 ? 'tags' : 'tag'} (${parser.elementStack\n            .reverse()\n            .map(x => `</${x}>`)\n            .join('')})`\n        );\n      }\n\n      // if for example we're in an <li> element, and we see another\n      // <li> tag, close the first so they become siblings\n      if (!anchor && !canContain(lowerCaseName, remaining)) {\n        closed = true;\n      } else if (!anchor && (closingTag = readClosingTag(parser))) {\n        // closing tag\n        closed = true;\n\n        const closingTagName = closingTag.e.toLowerCase();\n\n        // if this *isn't* the closing tag for the current element...\n        if (closingTagName !== lowerCaseName) {\n          // rewind parser\n          parser.pos = pos;\n\n          // if it doesn't close a parent tag, error\n          if (!~parser.elementStack.indexOf(closingTagName)) {\n            let errorMessage = 'Unexpected closing tag';\n\n            // add additional help for void elements, since component names\n            // might clash with them\n            if (voidElementNames.test(closingTagName)) {\n              errorMessage += ` (<${closingTagName}> is a void element - it cannot contain children)`;\n            }\n\n            parser.error(errorMessage);\n          }\n        }\n      } else if (anchor && readAnchorClose(parser, element.n)) {\n        closed = true;\n      } else {\n        // implicit close by closing section tag. TODO clean this up\n        const tag = {\n          open: parser.standardDelimiters[0],\n          close: parser.standardDelimiters[1]\n        };\n        const implicitCloseCase = [readClosing, readElseIf, readElse];\n        if (implicitCloseCase.some(r => r(parser, tag))) {\n          closed = true;\n          parser.pos = pos;\n        } else if ((child = parser.read(PARTIAL_READERS))) {\n          if (partials[child.n]) {\n            parser.pos = pos;\n            parser.error('Duplicate partial definition');\n          }\n\n          cleanup(\n            child.f,\n            parser.stripComments,\n            preserveWhitespace,\n            !preserveWhitespace,\n            !preserveWhitespace\n          );\n\n          partials[child.n] = child.f;\n          hasPartials = true;\n        } else {\n          if ((child = parser.read(READERS))) {\n            children.push(child);\n          } else {\n            closed = true;\n          }\n        }\n      }\n    } while (!closed);\n\n    if (children.length) {\n      element.f = children;\n    }\n\n    if (hasPartials) {\n      element.p = partials;\n    }\n\n    parser.elementStack.pop();\n  }\n\n  parser.inside = null;\n\n  if (parser.sanitizeElements && parser.sanitizeElements.indexOf(lowerCaseName) !== -1) {\n    return exclude;\n  }\n\n  return element;\n}\n\nfunction canContain(name, remaining) {\n  const match = /^<([a-zA-Z][a-zA-Z0-9]*)/.exec(remaining);\n  const disallowed = disallowedContents[name];\n\n  if (!match || !disallowed) {\n    return true;\n  }\n\n  return !~disallowed.indexOf(match[1].toLowerCase());\n}\n\nfunction readAnchorClose(parser, name) {\n  const pos = parser.pos;\n  if (!parser.matchString('</')) {\n    return null;\n  }\n\n  parser.matchString('#');\n  parser.sp();\n\n  if (!parser.matchString(name)) {\n    parser.pos = pos;\n    return null;\n  }\n\n  parser.sp();\n\n  if (!parser.matchString('>')) {\n    parser.pos = pos;\n    return null;\n  }\n\n  return true;\n}\n","import { INLINE_PARTIAL } from 'config/types';\nimport { READERS } from '../_parse';\nimport readClosing from './mustache/section/readClosing';\n\nconst partialDefinitionSectionPattern = /^\\s*#\\s*partial\\s+/;\n\nexport default function readPartialDefinitionSection(parser) {\n  let child, closed;\n\n  const start = parser.pos;\n\n  const delimiters = parser.standardDelimiters;\n\n  if (!parser.matchString(delimiters[0])) {\n    return null;\n  }\n\n  if (!parser.matchPattern(partialDefinitionSectionPattern)) {\n    parser.pos = start;\n    return null;\n  }\n\n  const name = parser.matchPattern(/^[a-zA-Z_$][a-zA-Z_$0-9\\-\\/]*/);\n\n  if (!name) {\n    parser.error('expected legal partial name');\n  }\n\n  parser.sp();\n  if (!parser.matchString(delimiters[1])) {\n    parser.error(`Expected closing delimiter '${delimiters[1]}'`);\n  }\n\n  const content = [];\n\n  const [open, close] = delimiters;\n\n  do {\n    if ((child = readClosing(parser, { open, close }))) {\n      if (child.r !== 'partial') {\n        parser.error(`Expected ${open}/partial${close}`);\n      }\n\n      closed = true;\n    } else {\n      child = parser.read(READERS);\n\n      if (!child) {\n        parser.error(`Expected ${open}/partial${close}`);\n      }\n\n      content.push(child);\n    }\n  } while (!closed);\n\n  return {\n    t: INLINE_PARTIAL,\n    n: name,\n    f: content\n  };\n}\n","export default {};\n","import { TEMPLATE_VERSION } from 'config/template';\nimport Parser from './Parser';\nimport readMustache from './converters/readMustache';\nimport readTriple from './converters/mustache/readTriple';\nimport readUnescaped from './converters/mustache/readUnescaped';\nimport readPartial from './converters/mustache/readPartial';\nimport readMustacheComment from './converters/mustache/readMustacheComment';\nimport readInterpolator from './converters/mustache/readInterpolator';\nimport readSection from './converters/mustache/readSection';\nimport readHtmlComment from './converters/readHtmlComment';\nimport readElement from './converters/readElement';\nimport readText from './converters/readText';\nimport readPartialDefinitionSection from './converters/readPartialDefinitionSection';\nimport readTemplate from './converters/readTemplate';\nimport cleanup from './utils/cleanup';\nimport insertExpressions from './utils/insertExpressions';\nimport shared from '../Ractive/shared';\nimport { create, keys } from 'utils/object';\n\n// See https://github.com/ractivejs/template-spec for information\n// about the Ractive template specification\n\nconst STANDARD_READERS = [\n  readPartial,\n  readUnescaped,\n  readSection,\n  readInterpolator,\n  readMustacheComment\n];\nconst TRIPLE_READERS = [readTriple];\n\nexport const READERS = [readMustache, readHtmlComment, readElement, readText];\nexport const PARTIAL_READERS = [readPartialDefinitionSection];\n\nconst defaultInterpolate = ['script', 'style', 'template'];\n\nconst StandardParser = Parser.extend({\n  init(str, options) {\n    const tripleDelimiters = options.tripleDelimiters || shared.defaults.tripleDelimiters;\n    const staticDelimiters = options.staticDelimiters || shared.defaults.staticDelimiters;\n    const staticTripleDelimiters =\n      options.staticTripleDelimiters || shared.defaults.staticTripleDelimiters;\n\n    this.standardDelimiters = options.delimiters || shared.defaults.delimiters;\n\n    this.tags = [\n      {\n        isStatic: false,\n        isTriple: false,\n        open: this.standardDelimiters[0],\n        close: this.standardDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: false,\n        isTriple: true,\n        open: tripleDelimiters[0],\n        close: tripleDelimiters[1],\n        readers: TRIPLE_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: false,\n        open: staticDelimiters[0],\n        close: staticDelimiters[1],\n        readers: STANDARD_READERS\n      },\n      {\n        isStatic: true,\n        isTriple: true,\n        open: staticTripleDelimiters[0],\n        close: staticTripleDelimiters[1],\n        readers: TRIPLE_READERS\n      }\n    ];\n\n    this.contextLines = options.contextLines || shared.defaults.contextLines;\n\n    this.sortMustacheTags();\n\n    this.sectionDepth = 0;\n    this.elementStack = [];\n\n    this.interpolate = create(options.interpolate || shared.defaults.interpolate || {});\n    this.interpolate.textarea = true;\n    defaultInterpolate.forEach(\n      t => (this.interpolate[t] = !options.interpolate || options.interpolate[t] !== false)\n    );\n\n    if (options.sanitize === true) {\n      options.sanitize = {\n        // blacklist from https://code.google.com/p/google-caja/source/browse/trunk/src/com/google/caja/lang/html/html4-elements-whitelist.json\n        elements: 'applet base basefont body frame frameset head html isindex link meta noframes noscript object param script style title'.split(\n          ' '\n        ),\n        eventAttributes: true\n      };\n    }\n\n    this.stripComments = options.stripComments !== false;\n    this.preserveWhitespace = options.preserveWhitespace;\n    this.sanitizeElements = options.sanitize && options.sanitize.elements;\n    this.sanitizeEventAttributes = options.sanitize && options.sanitize.eventAttributes;\n    this.includeLinePositions = options.includeLinePositions;\n    this.textOnlyMode = options.textOnlyMode;\n    this.csp = options.csp;\n\n    if (options.attributes) this.inTag = true;\n  },\n\n  postProcess(result) {\n    // special case - empty string\n    if (!result.length) {\n      return { t: [], v: TEMPLATE_VERSION };\n    }\n\n    if (this.sectionDepth > 0) {\n      this.error('A section was left open');\n    }\n\n    cleanup(\n      result[0].t,\n      this.stripComments,\n      this.preserveWhitespace,\n      !this.preserveWhitespace,\n      !this.preserveWhitespace\n    );\n\n    if (this.csp !== false) {\n      const expr = {};\n      insertExpressions(result[0].t, expr);\n      if (keys(expr).length) result[0].e = expr;\n    }\n\n    return result[0];\n  },\n\n  converters: [readTemplate],\n\n  sortMustacheTags() {\n    // Sort in order of descending opening delimiter length (longer first),\n    // to protect against opening delimiters being substrings of each other\n    this.tags.sort((a, b) => {\n      return b.open.length - a.open.length;\n    });\n  }\n});\n\nexport default function parse(template, options) {\n  return new StandardParser(template, options || {}).result;\n}\n","import { doc } from 'config/environment';\n\nexport default function progressiveText(item, target, occupants, text) {\n  if (occupants) {\n    let n = occupants[0];\n    if (n && n.nodeType === 3) {\n      const idx = n.nodeValue.indexOf(text);\n      occupants.shift();\n\n      if (idx === 0) {\n        if (n.nodeValue.length !== text.length) {\n          occupants.unshift(n.splitText(text.length));\n        }\n      } else {\n        n.nodeValue = text;\n      }\n    } else {\n      n = item.node = doc.createTextNode(text);\n      if (occupants[0]) {\n        target.insertBefore(n, occupants[0]);\n      } else {\n        target.appendChild(n);\n      }\n    }\n\n    item.node = n;\n  } else {\n    if (!item.node) item.node = doc.createTextNode(text);\n    target.appendChild(item.node);\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { fillGaps, hasOwn } from 'utils/object';\nimport parser from 'src/Ractive/config/runtime-parser';\nimport { findInstance } from 'shared/registry';\nimport { isArray, isFunction } from 'utils/is';\n\nexport default function getPartialTemplate(ractive, name, up) {\n  // If the partial in instance or view heirarchy instances, great\n  let partial = getPartialFromRegistry(ractive, name, up || {});\n  if (partial) return partial;\n\n  // Does it exist on the page as a script tag?\n  partial = parser.fromId(name, { noThrow: true });\n  if (partial) {\n    // parse and register to this ractive instance\n    const parsed = parser.parseFor(partial, ractive);\n\n    // register extra partials on the ractive instance if they don't already exist\n    if (parsed.p) fillGaps(ractive.partials, parsed.p);\n\n    // register (and return main partial if there are others in the template)\n    return (ractive.partials[name] = parsed.t);\n  }\n}\n\nfunction getPartialFromRegistry(ractive, name, up) {\n  // if there was an instance up-hierarchy, cool\n  let partial = findParentPartial(name, up.owner);\n  if (partial) return partial;\n\n  // find first instance in the ractive or view hierarchy that has this partial\n  const instance = findInstance('partials', ractive, name);\n\n  if (!instance) {\n    return;\n  }\n\n  partial = instance.partials[name];\n\n  // partial is a function?\n  let fn;\n  if (isFunction(partial)) {\n    fn = partial;\n    // super partial\n    if (fn.styleSet) return fn;\n\n    fn = partial.bind(instance);\n    fn.isOwner = hasOwn(instance.partials, name);\n    partial = fn.call(ractive, parser);\n  }\n\n  if (!partial && partial !== '') {\n    warnIfDebug(noRegistryFunctionReturn, name, 'partial', 'partial', {\n      ractive\n    });\n    return;\n  }\n\n  // If this was added manually to the registry,\n  // but hasn't been parsed, parse it now\n  if (!parser.isParsed(partial)) {\n    // use the parseOptions of the ractive instance on which it was found\n    const parsed = parser.parseFor(partial, instance);\n\n    // Partials cannot contain nested partials!\n    // TODO add a test for this\n    if (parsed.p) {\n      warnIfDebug('Partials ({{>%s}}) cannot contain nested inline partials', name, { ractive });\n    }\n\n    // if fn, use instance to store result, otherwise needs to go\n    // in the correct point in prototype chain on instance or constructor\n    const target = fn ? instance : findOwner(instance, name);\n\n    // may be a template with partials, which need to be registered and main template extracted\n    target.partials[name] = partial = parsed.t;\n  }\n\n  // store for reset\n  if (fn) partial._fn = fn;\n\n  return partial.v ? partial.t : partial;\n}\n\nfunction findOwner(ractive, key) {\n  return hasOwn(ractive.partials, key) ? ractive : findConstructor(ractive.constructor, key);\n}\n\nfunction findConstructor(constructor, key) {\n  if (!constructor) {\n    return;\n  }\n  return hasOwn(constructor.partials, key) ? constructor : findConstructor(constructor.Parent, key);\n}\n\nfunction findParentPartial(name, parent) {\n  if (parent) {\n    if (\n      parent.template &&\n      parent.template.p &&\n      !isArray(parent.template.p) &&\n      hasOwn(parent.template.p, name)\n    ) {\n      return parent.template.p[name];\n    } else if (parent.up && parent.up.owner) {\n      return findParentPartial(name, parent.up.owner);\n    }\n  }\n}\n","import { noRegistryFunctionReturn } from 'config/errors';\nimport { warnIfDebug } from 'utils/log';\nimport { findInstance } from 'shared/registry';\nimport { hasOwn } from 'utils/object';\nimport { isString } from 'utils/is';\n\n// finds the component constructor in the registry or view hierarchy registries\nexport default function getComponentConstructor(ractive, name) {\n  const instance = findInstance('components', ractive, name);\n  let Component;\n\n  if (instance) {\n    Component = instance.components[name];\n\n    // if not from Ractive.extend or a Promise, it's a function that shold return a constructor\n    if (Component && !Component.isInstance && !Component.then) {\n      // function option, execute and store for reset\n      const fn = Component.bind(instance);\n      fn.isOwner = hasOwn(instance.components, name);\n      Component = fn();\n\n      if (!Component) {\n        warnIfDebug(noRegistryFunctionReturn, name, 'component', 'component', {\n          ractive\n        });\n        return;\n      }\n\n      if (isString(Component)) {\n        // allow string lookup\n        Component = getComponentConstructor(ractive, Component);\n      }\n\n      Component._fn = fn;\n      instance.components[name] = Component;\n    }\n  }\n\n  return Component;\n}\n","import Partial from './Partial';\nimport { ELEMENT } from 'config/types';\nimport { assign } from 'utils/object';\n\nexport default function asyncProxy(promise, options) {\n  const partials = options.template.p || {};\n  const name = options.template.e;\n\n  const opts = assign({}, options, {\n    template: { t: ELEMENT, e: name },\n    macro(handle) {\n      handle.setTemplate(partials['async-loading'] || []);\n      promise.then(\n        cmp => {\n          options.up.ractive.components[name] = cmp;\n          if (partials['async-loaded']) {\n            handle.partials.component = [options.template];\n            handle.setTemplate(partials['async-loaded']);\n          } else {\n            handle.setTemplate([options.template]);\n          }\n        },\n        err => {\n          if (partials['async-failed']) {\n            handle.aliasLocal('error', 'error');\n            handle.set('@local.error', err);\n            handle.setTemplate(partials['async-failed']);\n          } else {\n            handle.setTemplate([]);\n          }\n        }\n      );\n    }\n  });\n  return new Partial(opts);\n}\n","import { TEXT } from 'config/types';\n\n// TODO all this code needs to die\nexport default function processItems(items, values, guid, counter = 0) {\n  return items\n    .map(item => {\n      if (item.type === TEXT) {\n        return item.template;\n      }\n\n      if (item.fragment) {\n        if (item.fragment.iterations) {\n          return item.fragment.iterations\n            .map(fragment => {\n              return processItems(fragment.items, values, guid, counter);\n            })\n            .join('');\n        } else {\n          return processItems(item.fragment.items, values, guid, counter);\n        }\n      }\n\n      const placeholderId = `${guid}-${counter++}`;\n      const model = item.model || item.newModel;\n\n      values[placeholderId] = model\n        ? model.wrapper\n          ? model.wrapperValue\n          : model.get()\n        : undefined;\n\n      return '${' + placeholderId + '}';\n    })\n    .join('');\n}\n","import { getElement } from 'utils/dom';\nimport { toArray } from 'utils/array';\nimport { warnIfDebug } from 'utils/log';\nimport render from '../render';\nimport { teardown } from 'shared/methodCallers';\n\nexport default function Ractive$render(target, anchor) {\n  if (this.torndown) {\n    warnIfDebug('ractive.render() was called on a Ractive instance that was already torn down');\n    return Promise.resolve();\n  }\n\n  target = getElement(target) || this.el;\n\n  if (!this.append && target) {\n    // Teardown any existing instances *before* trying to set up the new one -\n    // avoids certain weird bugs\n    const others = target.__ractive_instances__;\n    if (others) others.forEach(teardown);\n\n    // make sure we are the only occupants\n    if (!this.enhance) {\n      target.innerHTML = ''; // TODO is this quicker than removeChild? Initial research inconclusive\n    }\n  }\n\n  const occupants = this.enhance ? toArray(target.childNodes) : null;\n  const promise = render(this, target, anchor, occupants);\n\n  if (occupants) {\n    while (occupants.length) target.removeChild(occupants.pop());\n  }\n\n  return promise;\n}\n","import { createDocumentFragment } from 'utils/dom';\nimport Fragment from 'src/view/Fragment';\nimport runloop from 'src/global/runloop';\nimport { default as templateConfigurator } from '../config/custom/template';\n\n// TODO should resetTemplate be asynchronous? i.e. should it be a case\n// of outro, update template, intro? I reckon probably not, since that\n// could be achieved with unrender-resetTemplate-render. Also, it should\n// conceptually be similar to resetPartial, which couldn't be async\n\nexport default function Ractive$resetTemplate(template) {\n  templateConfigurator.init(null, this, { template });\n\n  const transitionsEnabled = this.transitionsEnabled;\n  this.transitionsEnabled = false;\n\n  // Is this is a component, we need to set the `shouldDestroy`\n  // flag, otherwise it will assume by default that a parent node\n  // will be detached, and therefore it doesn't need to bother\n  // detaching its own nodes\n  const component = this.component;\n  if (component) component.shouldDestroy = true;\n  this.unrender();\n  if (component) component.shouldDestroy = false;\n\n  const promise = runloop.start();\n\n  // remove existing fragment and create new one\n  this.fragment.unbind().unrender(true);\n\n  this.fragment = new Fragment({\n    template: this.template,\n    root: this,\n    owner: this\n  });\n\n  const docFrag = createDocumentFragment();\n  this.fragment.bind(this.viewmodel).render(docFrag);\n\n  // if this is a component, its el may not be valid, so find a\n  // target based on the component container\n  if (component && !component.external) {\n    this.fragment.findParentNode().insertBefore(docFrag, component.findNextNode());\n  } else {\n    this.el.insertBefore(docFrag, this.anchor);\n  }\n\n  runloop.end();\n\n  this.transitionsEnabled = transitionsEnabled;\n\n  return promise;\n}\n","import { build, set } from 'shared/set';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$set(keypath, value, options) {\n  const ractive = this;\n\n  const opts = isObjectType(keypath) ? value : options;\n\n  return set(build(ractive, keypath, value, opts && opts.isolated), opts);\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$subtract(keypath, d, options) {\n  const num = isNumber(d) ? -d : -1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","import { badArguments } from 'config/errors';\nimport { gather, set } from 'shared/set';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$toggle(keypath, options) {\n  if (!isString(keypath)) {\n    throw new TypeError(badArguments);\n  }\n\n  return set(\n    gather(this, keypath, null, options && options.isolated).map(m => [m, !m.get()]),\n    options\n  );\n}\n","import { getCSS } from 'src/global/css';\nimport { keys } from 'utils/object';\n\nexport default function Ractive$toCSS() {\n  const cssIds = [this.cssId, ...this.findAllComponents().map(c => c.cssId)];\n  const uniqueCssIds = keys(cssIds.reduce((ids, id) => ((ids[id] = true), ids), {}));\n  return getCSS(uniqueCssIds);\n}\n","export default function Ractive$toHTML() {\n  return this.fragment.toString(true);\n}\n","export default function toText() {\n  return this.fragment.toString(false);\n}\n","import runloop from 'src/global/runloop';\nimport Transition from '../../view/items/element/Transition';\nimport { fatal } from 'utils/log';\nimport { isObject } from 'utils/is';\n\nexport default function Ractive$transition(name, node, params) {\n  if (node instanceof HTMLElement) {\n    // good to go\n  } else if (isObject(node)) {\n    // omitted, use event node\n    params = node;\n  }\n\n  // if we allow query selector, then it won't work\n  // simple params like \"fast\"\n\n  // else if ( typeof node === 'string' ) {\n  // \t// query selector\n  // \tnode = this.find( node )\n  // }\n\n  node = node || this.event.node;\n\n  if (!node || !node._ractive) {\n    fatal(`No node was supplied for transition ${name}`);\n  }\n\n  params = params || {};\n  const owner = node._ractive.proxy;\n  const transition = new Transition({ owner, up: owner.up, name, params });\n  transition.bind();\n\n  const promise = runloop.start();\n  runloop.registerTransition(transition);\n  runloop.end();\n\n  promise.then(() => transition.unbind());\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function unlink(here) {\n  const promise = runloop.start();\n  this.viewmodel.joinAll(splitKeypath(here), { lastLink: false }).unlink();\n  runloop.end();\n  return promise;\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport runloop from 'src/global/runloop';\n\nexport default function Ractive$updateModel(keypath, cascade) {\n  const promise = runloop.start();\n\n  if (!keypath) {\n    this.viewmodel.updateFromBindings(true);\n  } else {\n    this.viewmodel.joinAll(splitKeypath(keypath)).updateFromBindings(cascade !== false);\n  }\n\n  runloop.end();\n\n  return promise;\n}\n","export default function isInstance(object) {\n  return object && object instanceof this;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function styleGet(keypath) {\n  return this._cssModel.joinAll(splitKeypath(keypath)).get();\n}\n","import { build, set } from '../../shared/set';\nimport SharedModel from '../../model/specials/SharedModel';\nimport { isObjectType } from 'utils/is';\n\nexport default function sharedSet(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = SharedModel;\n\n  return set(build({ viewmodel: model }, keypath, value, true), opts);\n}\n","import SharedModel from '../../model/specials/SharedModel';\nimport { splitKeypath } from 'shared/keypaths';\n\nexport default function sharedGet(keypath) {\n  return SharedModel.joinAll(splitKeypath(keypath)).get();\n}\n","import styleGet from '../Ractive/static/styleGet';\nimport styleSet from '../Ractive/static/styleSet';\nimport CSSModel from 'src/model/specials/CSSModel';\nimport { assign, create, defineProperties, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\nimport { initCSS } from 'src/Ractive/config/custom/css/css';\n\nexport default function macro(fn, opts) {\n  if (!isFunction(fn)) throw new Error(`The macro must be a function`);\n\n  assign(fn, opts);\n\n  defineProperties(fn, {\n    extensions: { value: [] },\n    _cssIds: { value: [] },\n    cssData: { value: assign(create(this.cssData), fn.cssData || {}) },\n\n    styleGet: { value: styleGet.bind(fn) },\n    styleSet: { value: styleSet.bind(fn) }\n  });\n\n  defineProperty(fn, '_cssModel', { value: new CSSModel(fn) });\n\n  if (fn.css) initCSS(fn, fn, fn);\n\n  this.extensions.push(fn);\n\n  return fn;\n}\n","import { escapeKey, splitKeypath as splitKeypathI, unescapeKey } from 'shared/keypaths';\n\nexport function joinKeys(...keys) {\n  return keys.map(escapeKey).join('.');\n}\n\nexport function splitKeypath(keypath) {\n  return splitKeypathI(keypath).map(unescapeKey);\n}\n","import { findInViewHierarchy } from 'shared/registry';\n\nexport function findPlugin(name, type, instance) {\n  return findInViewHierarchy(type, instance, name);\n}\n","/* istanbul ignore if */\nif (!Object.assign) {\n  Object.assign = function(target, ...sources) {\n    if (target == null) throw new TypeError('Cannot convert undefined or null to object');\n\n    const to = Object(target);\n    const sourcesLength = sources.length;\n\n    for (let index = 0; index < sourcesLength; index++) {\n      const nextSource = sources[index];\n      for (const nextKey in nextSource) {\n        if (!Object.prototype.hasOwnProperty.call(nextSource, nextKey)) continue;\n        to[nextKey] = nextSource[nextKey];\n      }\n    }\n\n    return to;\n  };\n}\n","export function hasOwn(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nexport function fillGaps(target, ...sources) {\n  for (let i = 0; i < sources.length; i++) {\n    const source = sources[i];\n    for (const key in source) {\n      // Source can be a prototype-less object.\n      if (key in target || !hasOwn(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nexport function toPairs(obj = {}) {\n  const pairs = [];\n  for (const key in obj) {\n    // Source can be a prototype-less object.\n    if (!hasOwn(obj, key)) continue;\n    pairs.push([key, obj[key]]);\n  }\n  return pairs;\n}\n\nconst obj = Object;\n\nexport const assign = obj.assign;\n\nexport const create = obj.create;\n\nexport const defineProperty = obj.defineProperty;\n\nexport const defineProperties = obj.defineProperties;\n\nexport const keys = obj.keys;\n","const toString = Object.prototype.toString;\nconst arrayLikePattern = /^\\[object (?:Array|FileList)\\]$/;\n\nexport function isArrayLike(obj) {\n  return arrayLikePattern.test(toString.call(obj));\n}\n\nexport const isArray = Array.isArray;\n\nexport function isEqual(a, b) {\n  if (a === null && b === null) {\n    return true;\n  }\n\n  if (isObjectType(a) || isObjectType(b)) {\n    return false;\n  }\n\n  return a === b;\n}\n\n// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric\nexport function isNumeric(thing) {\n  return !isNaN(parseFloat(thing)) && isFinite(thing);\n}\n\nexport function isObject(thing) {\n  return thing && toString.call(thing) === '[object Object]';\n}\n\nexport function isObjectLike(thing) {\n  return !!(thing && (isObjectType(thing) || isFunction(thing)));\n}\n\nexport function isObjectType(thing) {\n  return typeof thing === 'object';\n}\n\nexport function isFunction(thing) {\n  return typeof thing === 'function';\n}\n\nexport function isString(thing) {\n  return typeof thing === 'string';\n}\n\nexport function isNumber(thing) {\n  return typeof thing === 'number';\n}\n","/* istanbul ignore if */\nif (typeof window !== 'undefined' && window.performance && !window.performance.now) {\n  window.performance = window.performance || {};\n\n  const nowOffset = Date.now();\n\n  window.performance.now = function() {\n    return Date.now() - nowOffset;\n  };\n}\n","import { hasOwn, defineProperty } from 'utils/object';\nimport { isFunction } from 'utils/is';\n\n/* istanbul ignore if */\nif (!Array.prototype.find) {\n  defineProperty(Array.prototype, 'find', {\n    value(callback, thisArg) {\n      if (this === null || this === undefined)\n        throw new TypeError('Array.prototype.find called on null or undefined');\n\n      if (!isFunction(callback)) throw new TypeError(`${callback} is not a function`);\n\n      const array = Object(this);\n      const arrayLength = array.length >>> 0;\n\n      for (let index = 0; index < arrayLength; index++) {\n        if (!hasOwn(array, index)) continue;\n        if (!callback.call(thisArg, array[index], index, array)) continue;\n        return array[index];\n      }\n\n      return undefined;\n    },\n    configurable: true,\n    writable: true\n  });\n}\n","// NOTE: Node doesn't exist in IE8. Nothing can be done.\n/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  window.Node &&\n  window.Node.prototype &&\n  !window.Node.prototype.contains\n) {\n  Node.prototype.contains = function(node) {\n    if (!node) throw new TypeError('node required');\n\n    do {\n      if (this === node) return true;\n    } while ((node = node && node.parentNode));\n\n    return false;\n  };\n}\n","import { isFunction, isObjectType } from 'utils/is';\n\n/* istanbul ignore if */\nif (typeof window !== 'undefined' && !window.Promise) {\n  const PENDING = {};\n  const FULFILLED = {};\n  const REJECTED = {};\n\n  const Promise = (window.Promise = function(callback) {\n    const fulfilledHandlers = [];\n    const rejectedHandlers = [];\n    let state = PENDING;\n    let result;\n    let dispatchHandlers;\n\n    const makeResolver = newState => {\n      return function(value) {\n        if (state !== PENDING) return;\n        result = value;\n        state = newState;\n        dispatchHandlers = makeDispatcher(\n          state === FULFILLED ? fulfilledHandlers : rejectedHandlers,\n          result\n        );\n        wait(dispatchHandlers);\n      };\n    };\n\n    const fulfill = makeResolver(FULFILLED);\n    const reject = makeResolver(REJECTED);\n\n    try {\n      callback(fulfill, reject);\n    } catch (err) {\n      reject(err);\n    }\n\n    return {\n      // `then()` returns a Promise - 2.2.7\n      then(onFulfilled, onRejected) {\n        const promise2 = new Promise((fulfill, reject) => {\n          const processResolutionHandler = (handler, handlers, forward) => {\n            if (isFunction(handler)) {\n              handlers.push(p1result => {\n                try {\n                  resolve(promise2, handler(p1result), fulfill, reject);\n                } catch (err) {\n                  reject(err);\n                }\n              });\n            } else {\n              handlers.push(forward);\n            }\n          };\n\n          processResolutionHandler(onFulfilled, fulfilledHandlers, fulfill);\n          processResolutionHandler(onRejected, rejectedHandlers, reject);\n\n          if (state !== PENDING) {\n            wait(dispatchHandlers);\n          }\n        });\n        return promise2;\n      },\n      catch(onRejected) {\n        return this.then(null, onRejected);\n      }\n    };\n  });\n\n  Promise.all = function(promises) {\n    return new Promise((fulfil, reject) => {\n      const result = [];\n      let pending;\n      let i;\n\n      if (!promises.length) {\n        fulfil(result);\n        return;\n      }\n\n      const processPromise = (promise, i) => {\n        if (promise && isFunction(promise.then)) {\n          promise.then(value => {\n            result[i] = value;\n            --pending || fulfil(result);\n          }, reject);\n        } else {\n          result[i] = promise;\n          --pending || fulfil(result);\n        }\n      };\n\n      pending = i = promises.length;\n\n      while (i--) {\n        processPromise(promises[i], i);\n      }\n    });\n  };\n\n  Promise.resolve = function(value) {\n    return new Promise(fulfill => {\n      fulfill(value);\n    });\n  };\n\n  Promise.reject = function(reason) {\n    return new Promise((fulfill, reject) => {\n      reject(reason);\n    });\n  };\n\n  // TODO use MutationObservers or something to simulate setImmediate\n  const wait = function(callback) {\n    setTimeout(callback, 0);\n  };\n\n  const makeDispatcher = function(handlers, result) {\n    return function() {\n      for (let handler; (handler = handlers.shift()); ) {\n        handler(result);\n      }\n    };\n  };\n\n  const resolve = function(promise, x, fulfil, reject) {\n    let then;\n    if (x === promise) {\n      throw new TypeError(`A promise's fulfillment handler cannot return the same promise`);\n    }\n    if (x instanceof Promise) {\n      x.then(fulfil, reject);\n    } else if (x && (isObjectType(x) || isFunction(x))) {\n      try {\n        then = x.then;\n      } catch (e) {\n        reject(e);\n        return;\n      }\n      if (isFunction(then)) {\n        let called;\n\n        const resolvePromise = function(y) {\n          if (called) return;\n          called = true;\n          resolve(promise, y, fulfil, reject);\n        };\n        const rejectPromise = function(r) {\n          if (called) return;\n          called = true;\n          reject(r);\n        };\n\n        try {\n          then.call(x, resolvePromise, rejectPromise);\n        } catch (e) {\n          if (!called) {\n            reject(e);\n            called = true;\n            return;\n          }\n        }\n      } else {\n        fulfil(x);\n      }\n    } else {\n      fulfil(x);\n    }\n  };\n}\n","/* istanbul ignore if */\nif (\n  typeof window !== 'undefined' &&\n  !(window.requestAnimationFrame && window.cancelAnimationFrame)\n) {\n  let lastTime = 0;\n  window.requestAnimationFrame = function(callback) {\n    const currentTime = Date.now();\n    const timeToNextCall = Math.max(0, 16 - (currentTime - lastTime));\n    const id = window.setTimeout(() => {\n      callback(currentTime + timeToNextCall);\n    }, timeToNextCall);\n    lastTime = currentTime + timeToNextCall;\n    return id;\n  };\n  window.cancelAnimationFrame = function(id) {\n    clearTimeout(id);\n  };\n}\n","export default {\n  // render placement:\n  el: void 0,\n  append: false,\n  delegate: true,\n\n  // template:\n  template: null,\n\n  // parse:\n  delimiters: ['{{', '}}'],\n  tripleDelimiters: ['{{{', '}}}'],\n  staticDelimiters: ['[[', ']]'],\n  staticTripleDelimiters: ['[[[', ']]]'],\n  csp: true,\n  interpolate: false,\n  preserveWhitespace: false,\n  sanitize: false,\n  stripComments: true,\n  contextLines: 0,\n\n  // data & binding:\n  data: {},\n  computed: {},\n  syncComputedChildren: false,\n  resolveInstanceMembers: true,\n  warnAboutAmbiguity: false,\n  adapt: [],\n  isolated: true,\n  twoway: true,\n  lazy: false,\n\n  // transitions:\n  noIntro: false,\n  noOutro: false,\n  transitionsEnabled: true,\n  complete: void 0,\n  nestedTransitions: true,\n\n  // css:\n  css: null,\n  noCssTransform: false\n};\n","/* global console */\n/* eslint no-console:\"off\" */\n\nimport { hasConsole } from '../config/environment';\nimport Ractive from '../Ractive';\nimport noop from './noop';\nimport { isObjectType } from 'utils/is';\n\nconst alreadyWarned = {};\nlet log, printWarning, welcome;\n\nif (hasConsole) {\n  const welcomeIntro = [\n    `%cRactive.js %cBUILD_PLACEHOLDER_VERSION %cin debug mode, %cmore...`,\n    'color: rgb(114, 157, 52); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(85, 85, 85); font-weight: normal;',\n    'color: rgb(82, 140, 224); font-weight: normal; text-decoration: underline;'\n  ];\n  const welcomeMessage = `You're running Ractive BUILD_PLACEHOLDER_VERSION in debug mode - messages will be printed to the console to help you fix problems and optimise your application.\n\nTo disable debug mode, add this line at the start of your app:\n  Ractive.DEBUG = false;\n\nTo disable debug mode when your app is minified, add this snippet:\n  Ractive.DEBUG = /unminified/.test(function(){/*unminified*/});\n\nGet help and support:\n  http://ractive.js.org\n  http://stackoverflow.com/questions/tagged/ractivejs\n  http://groups.google.com/forum/#!forum/ractive-js\n  http://twitter.com/ractivejs\n\nFound a bug? Raise an issue:\n  https://github.com/ractivejs/ractive/issues\n\n`;\n\n  welcome = () => {\n    if (Ractive.WELCOME_MESSAGE === false) {\n      welcome = noop;\n      return;\n    }\n    const message = 'WELCOME_MESSAGE' in Ractive ? Ractive.WELCOME_MESSAGE : welcomeMessage;\n    const hasGroup = !!console.groupCollapsed;\n    if (hasGroup) console.groupCollapsed.apply(console, welcomeIntro);\n    console.log(message);\n    if (hasGroup) {\n      console.groupEnd(welcomeIntro);\n    }\n\n    welcome = noop;\n  };\n\n  printWarning = (message, args) => {\n    welcome();\n\n    // extract information about the instance this message pertains to, if applicable\n    if (isObjectType(args[args.length - 1])) {\n      const options = args.pop();\n      const ractive = options ? options.ractive : null;\n\n      if (ractive) {\n        // if this is an instance of a component that we know the name of, add\n        // it to the message\n        let name;\n        if (ractive.component && (name = ractive.component.name)) {\n          message = `<${name}> ${message}`;\n        }\n\n        let node;\n        if (\n          (node =\n            options.node || (ractive.fragment && ractive.fragment.rendered && ractive.find('*')))\n        ) {\n          args.push(node);\n        }\n      }\n    }\n\n    console.warn.apply(\n      console,\n      ['%cRactive.js: %c' + message, 'color: rgb(114, 157, 52);', 'color: rgb(85, 85, 85);'].concat(\n        args\n      )\n    );\n  };\n\n  log = function() {\n    console.log.apply(console, arguments);\n  };\n} else {\n  printWarning = log = welcome = noop;\n}\n\nfunction format(message, args) {\n  return message.replace(/%s/g, () => args.shift());\n}\n\nfunction fatal(message, ...args) {\n  message = format(message, args);\n  throw new Error(message);\n}\n\nfunction logIfDebug() {\n  if (Ractive.DEBUG) {\n    log.apply(null, arguments);\n  }\n}\n\nfunction warn(message, ...args) {\n  message = format(message, args);\n  printWarning(message, args);\n}\n\nfunction warnOnce(message, ...args) {\n  message = format(message, args);\n\n  if (alreadyWarned[message]) {\n    return;\n  }\n\n  alreadyWarned[message] = true;\n  printWarning(message, args);\n}\n\nfunction warnIfDebug() {\n  if (Ractive.DEBUG) {\n    warn.apply(null, arguments);\n  }\n}\n\nfunction warnOnceIfDebug() {\n  if (Ractive.DEBUG) {\n    warnOnce.apply(null, arguments);\n  }\n}\n\nexport { fatal, log, logIfDebug, warn, warnOnce, warnIfDebug, warnOnceIfDebug, welcome };\n","// These are a subset of the easing equations found at\n// https://raw.github.com/danro/easing-js - license info\n// follows:\n\n// --------------------------------------------------\n// easing.js v0.5.4\n// Generic set of easing functions with AMD support\n// https://github.com/danro/easing-js\n// This code may be freely distributed under the MIT license\n// http://danro.mit-license.org/\n// --------------------------------------------------\n// All functions adapted from Thomas Fuchs & Jeremy Kahn\n// Easing Equations (c) 2003 Robert Penner, BSD license\n// https://raw.github.com/danro/easing-js/master/LICENSE\n// --------------------------------------------------\n\n// In that library, the functions named easeIn, easeOut, and\n// easeInOut below are named easeInCubic, easeOutCubic, and\n// (you guessed it) easeInOutCubic.\n//\n// You can add additional easing functions to this list, and they\n// will be globally available.\n\nexport default {\n  linear(pos) {\n    return pos;\n  },\n  easeIn(pos) {\n    /* istanbul ignore next */\n    return Math.pow(pos, 3);\n  },\n  easeOut(pos) {\n    return Math.pow(pos - 1, 3) + 1;\n  },\n  easeInOut(pos) {\n    /* istanbul ignore next */\n    if ((pos /= 0.5) < 1) {\n      return 0.5 * Math.pow(pos, 3);\n    }\n    /* istanbul ignore next */\n    return 0.5 * (Math.pow(pos - 2, 3) + 2);\n  }\n};\n","/* eslint no-console:\"off\" */\nimport { isFunction } from 'utils/is';\n\nconst win = typeof window !== 'undefined' ? window : null;\nconst doc = win ? document : null;\nconst isClient = !!doc;\nconst hasConsole =\n  typeof console !== 'undefined' && isFunction(console.warn) && isFunction(console.warn.apply);\n\nconst svg = doc\n  ? doc.implementation.hasFeature('http://www.w3.org/TR/SVG11/feature#BasicStructure', '1.1')\n  : false;\n\nconst vendors = ['o', 'ms', 'moz', 'webkit'];\n\nexport { win, doc, isClient, hasConsole, svg, vendors };\n","export default function() {}\n","// Error messages that are used (or could be) in multiple places\nexport const badArguments = 'Bad arguments';\nexport const noRegistryFunctionReturn =\n  'A function was specified for \"%s\" %s, but no %s was returned';\nexport const missingPlugin = (name, type) =>\n  `Missing \"${name}\" ${type} plugin. You may need to download a plugin via http://ractive.js.org/integrations/#${type}s`;\n","const stack = [];\nlet captureGroup;\n\nexport function startCapturing() {\n  stack.push((captureGroup = []));\n}\n\nexport function stopCapturing() {\n  const dependencies = stack.pop();\n  captureGroup = stack[stack.length - 1];\n  return dependencies;\n}\n\nexport function capture(model) {\n  if (captureGroup) {\n    captureGroup.push(model);\n  }\n}\n","import { isArray, isObject, isNumeric } from 'utils/is';\nimport interpolate from 'shared/interpolate';\nimport { hasOwn } from 'utils/object';\n\nconst interpolators = {\n  number(from, to) {\n    if (!isNumeric(from) || !isNumeric(to)) {\n      return null;\n    }\n\n    from = +from;\n    to = +to;\n\n    const delta = to - from;\n\n    if (!delta) {\n      return function() {\n        return from;\n      };\n    }\n\n    return function(t) {\n      return from + t * delta;\n    };\n  },\n\n  array(from, to) {\n    let len, i;\n\n    if (!isArray(from) || !isArray(to)) {\n      return null;\n    }\n\n    const intermediate = [];\n    const interpolators = [];\n\n    i = len = Math.min(from.length, to.length);\n    while (i--) {\n      interpolators[i] = interpolate(from[i], to[i]);\n    }\n\n    // surplus values - don't interpolate, but don't exclude them either\n    for (i = len; i < from.length; i += 1) {\n      intermediate[i] = from[i];\n    }\n\n    for (i = len; i < to.length; i += 1) {\n      intermediate[i] = to[i];\n    }\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        intermediate[i] = interpolators[i](t);\n      }\n\n      return intermediate;\n    };\n  },\n\n  object(from, to) {\n    if (!isObject(from) || !isObject(to)) {\n      return null;\n    }\n\n    const properties = [];\n    const intermediate = {};\n    const interpolators = {};\n\n    for (const prop in from) {\n      if (hasOwn(from, prop)) {\n        if (hasOwn(to, prop)) {\n          properties.push(prop);\n          interpolators[prop] = interpolate(from[prop], to[prop]) || (() => to[prop]);\n        } else {\n          intermediate[prop] = from[prop];\n        }\n      }\n    }\n\n    for (const prop in to) {\n      if (hasOwn(to, prop) && !hasOwn(from, prop)) {\n        intermediate[prop] = to[prop];\n      }\n    }\n\n    const len = properties.length;\n\n    return function(t) {\n      let i = len;\n\n      while (i--) {\n        const prop = properties[i];\n\n        intermediate[prop] = interpolators[prop](t);\n      }\n\n      return intermediate;\n    };\n  }\n};\n\nexport default interpolators;\n","import { isString } from 'utils/is';\n\nconst refPattern = /\\[\\s*(\\*|[0-9]|[1-9][0-9]+)\\s*\\]/g;\nconst splitPattern = /([^\\\\](?:\\\\\\\\)*)\\./;\nconst escapeKeyPattern = /\\\\|\\./g;\nconst unescapeKeyPattern = /((?:\\\\)+)\\1|\\\\(\\.)/g;\n\nexport function escapeKey(key) {\n  if (isString(key)) {\n    return key.replace(escapeKeyPattern, '\\\\$&');\n  }\n\n  return key;\n}\n\nexport function normalise(ref) {\n  return ref ? ref.replace(refPattern, '.$1') : '';\n}\n\nexport function splitKeypath(keypath) {\n  const result = [];\n  let match;\n\n  keypath = normalise(keypath);\n\n  while ((match = splitPattern.exec(keypath))) {\n    const index = match.index + match[1].length;\n    result.push(keypath.substr(0, index));\n    keypath = keypath.substr(index + 1);\n  }\n\n  result.push(keypath);\n\n  return result;\n}\n\nexport function unescapeKey(key) {\n  if (isString(key)) {\n    return key.replace(unescapeKeyPattern, '$1$2');\n  }\n\n  return key;\n}\n","import { addToArray, removeFromArray } from 'utils/array';\nimport { unescapeKey } from 'shared/keypaths';\nimport { capture } from 'src/global/capture';\nimport noop from 'utils/noop';\n\nexport default class KeyModel {\n  constructor(key, parent) {\n    this.value = key;\n    this.isReadonly = this.isKey = true;\n    this.deps = [];\n    this.links = [];\n    this.parent = parent;\n  }\n\n  get(shouldCapture) {\n    if (shouldCapture) capture(this);\n    return unescapeKey(this.value);\n  }\n\n  getKeypath() {\n    return unescapeKey(this.value);\n  }\n\n  has() {\n    return false;\n  }\n\n  rebind(next, previous) {\n    let i = this.deps.length;\n    while (i--) this.deps[i].rebind(next, previous, false);\n\n    i = this.links.length;\n    while (i--) this.links[i].relinking(next, false);\n  }\n\n  register(dependant) {\n    this.deps.push(dependant);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  unregister(dependant) {\n    removeFromArray(this.deps, dependant);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n}\n\nKeyModel.prototype.reference = noop;\nKeyModel.prototype.unreference = noop;\n","import { removeFromArray } from 'utils/array';\nimport { handleChange } from 'shared/methodCallers';\nimport { capture } from 'src/global/capture';\nimport noop from 'utils/noop';\nimport { keys as objectKeys } from 'utils/object';\n\nexport default class KeypathModel {\n  constructor(parent, ractive) {\n    this.parent = parent;\n    this.ractive = ractive;\n    this.value = ractive ? parent.getKeypath(ractive) : parent.getKeypath();\n    this.deps = [];\n    this.children = {};\n    this.isReadonly = this.isKeypath = true;\n  }\n\n  get(shouldCapture) {\n    if (shouldCapture) capture(this);\n    return this.value;\n  }\n\n  getChild(ractive) {\n    if (!(ractive._guid in this.children)) {\n      const model = new KeypathModel(this.parent, ractive);\n      this.children[ractive._guid] = model;\n      model.owner = this;\n    }\n    return this.children[ractive._guid];\n  }\n\n  getKeypath() {\n    return this.value;\n  }\n\n  handleChange() {\n    const keys = objectKeys(this.children);\n    let i = keys.length;\n    while (i--) {\n      this.children[keys[i]].handleChange();\n    }\n\n    this.deps.forEach(handleChange);\n  }\n\n  has() {\n    return false;\n  }\n\n  rebindChildren(next) {\n    const keys = objectKeys(this.children);\n    let i = keys.length;\n    while (i--) {\n      const child = this.children[keys[i]];\n      child.value = next.getKeypath(child.ractive);\n      child.handleChange();\n    }\n  }\n\n  rebind(next, previous) {\n    const model = next ? next.getKeypathModel(this.ractive) : undefined;\n\n    const keys = objectKeys(this.children);\n    let i = keys.length;\n    while (i--) {\n      this.children[keys[i]].rebind(next, previous, false);\n    }\n\n    i = this.deps.length;\n    while (i--) {\n      this.deps[i].rebind(model, this, false);\n    }\n  }\n\n  register(dep) {\n    this.deps.push(dep);\n  }\n\n  removeChild(model) {\n    if (model.ractive) delete this.children[model.ractive._guid];\n  }\n\n  teardown() {\n    if (this.owner) this.owner.removeChild(this);\n\n    const keys = objectKeys(this.children);\n    let i = keys.length;\n    while (i--) {\n      this.children[keys[i]].teardown();\n    }\n  }\n\n  unregister(dep) {\n    removeFromArray(this.deps, dep);\n    if (!this.deps.length) this.teardown();\n  }\n}\n\nKeypathModel.prototype.reference = noop;\nKeypathModel.prototype.unreference = noop;\n","const fnBind = Function.prototype.bind;\n\nexport default function bind(fn, context) {\n  if (!/this/.test(fn.toString())) return fn;\n\n  const bound = fnBind.call(fn, context);\n  for (const prop in fn) bound[prop] = fn[prop];\n\n  return bound;\n}\n","import KeyModel from './specials/KeyModel';\nimport KeypathModel from './specials/KeypathModel';\nimport { escapeKey, unescapeKey } from 'shared/keypaths';\nimport { addToArray, removeFromArray } from 'utils/array';\nimport { isArray, isObject, isFunction } from 'utils/is';\nimport bind from 'utils/bind';\nimport { hasOwn, keys as objectKeys } from 'utils/object';\n\nconst shuffleTasks = { early: [], mark: [] };\nconst registerQueue = { early: [], mark: [] };\n\nexport default class ModelBase {\n  constructor(parent) {\n    this.deps = [];\n\n    this.children = [];\n    this.childByKey = {};\n    this.links = [];\n\n    this.keyModels = {};\n\n    this.bindings = [];\n    this.patternObservers = [];\n\n    if (parent) {\n      this.parent = parent;\n      this.root = parent.root;\n    }\n  }\n\n  addShuffleTask(task, stage = 'early') {\n    shuffleTasks[stage].push(task);\n  }\n  addShuffleRegister(item, stage = 'early') {\n    registerQueue[stage].push({ model: this, item });\n  }\n\n  downstreamChanged() {}\n\n  findMatches(keys) {\n    const len = keys.length;\n\n    let existingMatches = [this];\n    let matches;\n    let i;\n\n    for (i = 0; i < len; i += 1) {\n      const key = keys[i];\n\n      if (key === '*') {\n        matches = [];\n        existingMatches.forEach(model => {\n          matches.push.apply(matches, model.getValueChildren(model.get()));\n        });\n      } else {\n        matches = existingMatches.map(model => model.joinKey(key));\n      }\n\n      existingMatches = matches;\n    }\n\n    return matches;\n  }\n\n  getKeyModel(key, skip) {\n    if (key !== undefined && !skip) return this.parent.getKeyModel(key, true);\n\n    if (!(key in this.keyModels)) this.keyModels[key] = new KeyModel(escapeKey(key), this);\n\n    return this.keyModels[key];\n  }\n\n  getKeypath(ractive) {\n    if (ractive !== this.ractive && this._link) return this._link.target.getKeypath(ractive);\n\n    if (!this.keypath) {\n      const parent = this.parent && this.parent.getKeypath(ractive);\n      this.keypath = parent\n        ? `${this.parent.getKeypath(ractive)}.${escapeKey(this.key)}`\n        : escapeKey(this.key);\n    }\n\n    return this.keypath;\n  }\n\n  getValueChildren(value) {\n    let children;\n    if (isArray(value)) {\n      children = [];\n      if ('length' in this && this.length !== value.length) {\n        children.push(this.joinKey('length'));\n      }\n      value.forEach((m, i) => {\n        children.push(this.joinKey(i));\n      });\n    } else if (isObject(value) || isFunction(value)) {\n      children = objectKeys(value).map(key => this.joinKey(key));\n    } else if (value != null) {\n      return [];\n    }\n\n    return children;\n  }\n\n  getVirtual(shouldCapture) {\n    const value = this.get(shouldCapture, { virtual: false });\n    if (isObject(value)) {\n      const result = isArray(value) ? [] : {};\n\n      const keys = objectKeys(value);\n      let i = keys.length;\n      while (i--) {\n        const child = this.childByKey[keys[i]];\n        if (!child) result[keys[i]] = value[keys[i]];\n        else if (child._link) result[keys[i]] = child._link.getVirtual();\n        else result[keys[i]] = child.getVirtual();\n      }\n\n      i = this.children.length;\n      while (i--) {\n        const child = this.children[i];\n        if (!(child.key in result) && child._link) {\n          result[child.key] = child._link.getVirtual();\n        }\n      }\n\n      return result;\n    } else return value;\n  }\n\n  has(key) {\n    if (this._link) return this._link.has(key);\n\n    const value = this.get();\n    if (!value) return false;\n\n    key = unescapeKey(key);\n    if (hasOwn(value, key)) return true;\n\n    // We climb up the constructor chain to find if one of them contains the key\n    let constructor = value.constructor;\n    while (constructor !== Function && constructor !== Array && constructor !== Object) {\n      if (hasOwn(constructor.prototype, key)) return true;\n      constructor = constructor.constructor;\n    }\n\n    return false;\n  }\n\n  joinAll(keys, opts) {\n    let model = this;\n    for (let i = 0; i < keys.length; i += 1) {\n      if (\n        opts &&\n        opts.lastLink === false &&\n        i + 1 === keys.length &&\n        model.childByKey[keys[i]] &&\n        model.childByKey[keys[i]]._link\n      )\n        return model.childByKey[keys[i]];\n      model = model.joinKey(keys[i], opts);\n    }\n\n    return model;\n  }\n\n  notifyUpstream(startPath) {\n    let parent = this.parent;\n    const path = startPath || [this.key];\n    while (parent) {\n      if (parent.patternObservers.length)\n        parent.patternObservers.forEach(o => o.notify(path.slice()));\n      path.unshift(parent.key);\n      parent.links.forEach(l => l.notifiedUpstream(path, this.root));\n      parent.deps.forEach(d => d.handleChange(path));\n      parent.downstreamChanged(startPath);\n      parent = parent.parent;\n    }\n  }\n\n  rebind(next, previous, safe) {\n    if (this._link) {\n      this._link.rebind(next, previous, false);\n    }\n\n    // tell the deps to move to the new target\n    let i = this.deps.length;\n    while (i--) {\n      if (this.deps[i].rebind) this.deps[i].rebind(next, previous, safe);\n    }\n\n    i = this.links.length;\n    while (i--) {\n      const link = this.links[i];\n      // only relink the root of the link tree\n      if (link.owner._link) link.relinking(next, safe);\n    }\n\n    i = this.children.length;\n    while (i--) {\n      const child = this.children[i];\n      child.rebind(next ? next.joinKey(child.key) : undefined, child, safe);\n    }\n\n    if (this.keypathModel) this.keypathModel.rebind(next, previous, false);\n\n    i = this.bindings.length;\n    while (i--) {\n      this.bindings[i].rebind(next, previous, safe);\n    }\n  }\n\n  reference() {\n    'refs' in this ? this.refs++ : (this.refs = 1);\n  }\n\n  register(dep) {\n    this.deps.push(dep);\n  }\n\n  registerLink(link) {\n    addToArray(this.links, link);\n  }\n\n  registerPatternObserver(observer) {\n    this.patternObservers.push(observer);\n    this.register(observer);\n  }\n\n  registerTwowayBinding(binding) {\n    this.bindings.push(binding);\n  }\n\n  unreference() {\n    if ('refs' in this) this.refs--;\n  }\n\n  unregister(dep) {\n    removeFromArray(this.deps, dep);\n  }\n\n  unregisterLink(link) {\n    removeFromArray(this.links, link);\n  }\n\n  unregisterPatternObserver(observer) {\n    removeFromArray(this.patternObservers, observer);\n    this.unregister(observer);\n  }\n\n  unregisterTwowayBinding(binding) {\n    removeFromArray(this.bindings, binding);\n  }\n\n  updateFromBindings(cascade) {\n    let i = this.bindings.length;\n    while (i--) {\n      const value = this.bindings[i].getValue();\n      if (value !== this.value) this.set(value);\n    }\n\n    // check for one-way bindings if there are no two-ways\n    if (!this.bindings.length) {\n      const oneway = findBoundValue(this.deps);\n      if (oneway && oneway.value !== this.value) this.set(oneway.value);\n    }\n\n    if (cascade) {\n      this.children.forEach(updateFromBindings);\n      this.links.forEach(updateFromBindings);\n      if (this._link) this._link.updateFromBindings(cascade);\n    }\n  }\n}\n\n// TODO: this may be better handled by overreiding `get` on models with a parent that isRoot\nexport function maybeBind(model, value, shouldBind) {\n  if (shouldBind && isFunction(value) && model.parent && model.parent.isRoot) {\n    if (!model.boundValue) {\n      model.boundValue = bind(value._r_unbound || value, model.parent.ractive);\n    }\n\n    return model.boundValue;\n  }\n\n  return value;\n}\n\nfunction updateFromBindings(model) {\n  model.updateFromBindings(true);\n}\n\nexport function findBoundValue(list) {\n  let i = list.length;\n  while (i--) {\n    if (list[i].bound) {\n      const owner = list[i].owner;\n      if (owner) {\n        const value = owner.name === 'checked' ? owner.node.checked : owner.node.value;\n        return { value };\n      }\n    }\n  }\n}\n\nexport function fireShuffleTasks(stage) {\n  if (!stage) {\n    fireShuffleTasks('early');\n    fireShuffleTasks('mark');\n  } else {\n    const tasks = shuffleTasks[stage];\n    shuffleTasks[stage] = [];\n    let i = tasks.length;\n    while (i--) tasks[i]();\n\n    const register = registerQueue[stage];\n    registerQueue[stage] = [];\n    i = register.length;\n    while (i--) register[i].model.register(register[i].item);\n  }\n}\n\nexport function shuffle(model, newIndices, link, unsafe) {\n  model.shuffling = true;\n\n  let i = newIndices.length;\n  while (i--) {\n    const idx = newIndices[i];\n    // nothing is actually changing, so move in the index and roll on\n    if (i === idx) {\n      continue;\n    }\n\n    // rebind the children on i to idx\n    if (i in model.childByKey)\n      model.childByKey[i].rebind(\n        !~idx ? undefined : model.joinKey(idx),\n        model.childByKey[i],\n        !unsafe\n      );\n\n    if (!~idx && model.keyModels[i]) {\n      model.keyModels[i].rebind(undefined, model.keyModels[i], false);\n    } else if (~idx && model.keyModels[i]) {\n      if (!model.keyModels[idx]) model.childByKey[idx].getKeyModel(idx);\n      model.keyModels[i].rebind(model.keyModels[idx], model.keyModels[i], false);\n    }\n  }\n\n  const upstream = model.source().length !== model.source().value.length;\n\n  model.links.forEach(l => l.shuffle(newIndices));\n  if (!link) fireShuffleTasks('early');\n\n  i = model.deps.length;\n  while (i--) {\n    if (model.deps[i].shuffle) model.deps[i].shuffle(newIndices);\n  }\n\n  model[link ? 'marked' : 'mark']();\n  if (!link) fireShuffleTasks('mark');\n\n  if (upstream) model.notifyUpstream();\n\n  model.shuffling = false;\n}\n\nKeyModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeyModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\nKeypathModel.prototype.addShuffleTask = ModelBase.prototype.addShuffleTask;\nKeypathModel.prototype.addShuffleRegister = ModelBase.prototype.addShuffleRegister;\n","import ModelBase, { fireShuffleTasks, maybeBind, shuffle } from './ModelBase';\nimport KeypathModel from './specials/KeypathModel';\nimport { capture } from '../global/capture';\nimport { handleChange, marked, markedAll, teardown } from 'shared/methodCallers';\nimport { rebindMatch } from 'shared/rebind';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport noop from 'utils/noop';\nimport { hasOwn } from 'utils/object';\n\n// temporary placeholder target for detached implicit links\nexport const Missing = {\n  key: '@missing',\n  animate: noop,\n  applyValue: noop,\n  get: noop,\n  getKeypath() {\n    return this.key;\n  },\n  joinAll() {\n    return this;\n  },\n  joinKey() {\n    return this;\n  },\n  mark: noop,\n  registerLink: noop,\n  shufle: noop,\n  set: noop,\n  unregisterLink: noop\n};\nMissing.parent = Missing;\n\nexport default class LinkModel extends ModelBase {\n  constructor(parent, owner, target, key) {\n    super(parent);\n\n    this.owner = owner;\n    this.target = target;\n    this.key = key === undefined ? owner.key : key;\n    if (owner.isLink) this.sourcePath = `${owner.sourcePath}.${this.key}`;\n\n    target.registerLink(this);\n\n    if (parent) this.isReadonly = parent.isReadonly;\n\n    this.isLink = true;\n  }\n\n  animate(from, to, options, interpolator) {\n    return this.target.animate(from, to, options, interpolator);\n  }\n\n  applyValue(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.applyValue(value);\n  }\n\n  attach(fragment) {\n    const model = resolveReference(fragment, this.key);\n    if (model) {\n      this.relinking(model, false);\n    } else {\n      // if there is no link available, move everything here to real models\n      this.owner.unlink();\n    }\n  }\n\n  detach() {\n    this.relinking(Missing, false);\n  }\n\n  get(shouldCapture, opts = {}) {\n    if (shouldCapture) {\n      capture(this);\n\n      // may need to tell the target to unwrap\n      opts.unwrap = 'unwrap' in opts ? opts.unwrap : true;\n    }\n\n    const bind = 'shouldBind' in opts ? opts.shouldBind : true;\n    opts.shouldBind = this.mapping && this.target.parent && this.target.parent.isRoot;\n\n    return maybeBind(this, this.target.get(false, opts), bind);\n  }\n\n  getKeypath(ractive) {\n    if (ractive && ractive !== this.root.ractive) return this.target.getKeypath(ractive);\n\n    return super.getKeypath(ractive);\n  }\n\n  getKeypathModel(ractive) {\n    if (!this.keypathModel) this.keypathModel = new KeypathModel(this);\n    if (ractive && ractive !== this.root.ractive) return this.keypathModel.getChild(ractive);\n    return this.keypathModel;\n  }\n\n  handleChange() {\n    this.deps.forEach(handleChange);\n    this.links.forEach(handleChange);\n    this.notifyUpstream();\n  }\n\n  isDetached() {\n    return this.virtual && this.target === Missing;\n  }\n\n  joinKey(key) {\n    // TODO: handle nested links\n    if (key === undefined || key === '') return this;\n\n    if (!hasOwn(this.childByKey, key)) {\n      const child = new LinkModel(this, this, this.target.joinKey(key), key);\n      this.children.push(child);\n      this.childByKey[key] = child;\n    }\n\n    return this.childByKey[key];\n  }\n\n  mark(force) {\n    this.target.mark(force);\n  }\n\n  marked() {\n    if (this.boundValue) this.boundValue = null;\n\n    this.links.forEach(marked);\n\n    this.deps.forEach(handleChange);\n  }\n\n  markedAll() {\n    this.children.forEach(markedAll);\n    this.marked();\n  }\n\n  notifiedUpstream(startPath, root) {\n    this.links.forEach(l => l.notifiedUpstream(startPath, this.root));\n    this.deps.forEach(handleChange);\n    if (startPath && this.rootLink && this.root !== root) {\n      const path = startPath.slice(1);\n      path.unshift(this.key);\n      this.notifyUpstream(path);\n    }\n  }\n\n  relinked() {\n    this.target.registerLink(this);\n    this.children.forEach(c => c.relinked());\n  }\n\n  relinking(target, safe) {\n    if (this.rootLink && this.sourcePath)\n      target = rebindMatch(this.sourcePath, target, this.target);\n    if (!target || this.target === target) return;\n\n    this.target.unregisterLink(this);\n    if (this.keypathModel) this.keypathModel.rebindChildren(target);\n\n    this.target = target;\n    this.children.forEach(c => {\n      c.relinking(target.joinKey(c.key), safe);\n    });\n\n    if (this.rootLink)\n      this.addShuffleTask(() => {\n        this.relinked();\n        if (!safe) {\n          this.markedAll();\n          this.notifyUpstream();\n        }\n      });\n  }\n\n  set(value) {\n    if (this.boundValue) this.boundValue = null;\n    this.target.set(value);\n  }\n\n  shuffle(newIndices) {\n    // watch for extra shuffles caused by a shuffle in a downstream link\n    if (this.shuffling) return;\n\n    // let the real model handle firing off shuffles\n    if (!this.target.shuffling) {\n      if (this.target.shuffle) {\n        this.target.shuffle(newIndices);\n      } else {\n        // the target is a computation, which can't shuffle\n        this.target.mark();\n      }\n    } else {\n      shuffle(this, newIndices, true);\n    }\n  }\n\n  source() {\n    if (this.target.source) return this.target.source();\n    else return this.target;\n  }\n\n  teardown() {\n    if (this._link) this._link.teardown();\n    this.target.unregisterLink(this);\n    this.children.forEach(teardown);\n  }\n}\n\nModelBase.prototype.link = function link(model, keypath, options) {\n  const lnk = this._link || new LinkModel(this.parent, this, model, this.key);\n  lnk.implicit = options && options.implicit;\n  lnk.mapping = options && options.mapping;\n  lnk.sourcePath = keypath;\n  lnk.rootLink = true;\n  if (this._link) this._link.relinking(model, false);\n  this.rebind(lnk, this, false);\n  fireShuffleTasks();\n\n  this._link = lnk;\n  lnk.markedAll();\n\n  this.notifyUpstream();\n  return lnk;\n};\n\nModelBase.prototype.unlink = function unlink() {\n  if (this._link) {\n    const ln = this._link;\n    this._link = undefined;\n    ln.rebind(this, ln, false);\n    fireShuffleTasks();\n    ln.teardown();\n    this.notifyUpstream();\n  }\n};\n","import { removeFromArray } from 'utils/array';\nimport { isFunction } from 'utils/is';\n\nexport default class TransitionManager {\n  constructor(callback, parent) {\n    this.callback = callback;\n    this.parent = parent;\n\n    this.intros = [];\n    this.outros = [];\n\n    this.children = [];\n    this.totalChildren = this.outroChildren = 0;\n\n    this.detachQueue = [];\n    this.outrosComplete = false;\n\n    if (parent) {\n      parent.addChild(this);\n    }\n  }\n\n  add(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    transition.starting = true;\n    list.push(transition);\n  }\n\n  addChild(child) {\n    this.children.push(child);\n\n    this.totalChildren += 1;\n    this.outroChildren += 1;\n  }\n\n  decrementOutros() {\n    this.outroChildren -= 1;\n    check(this);\n  }\n\n  decrementTotal() {\n    this.totalChildren -= 1;\n    check(this);\n  }\n\n  detachNodes() {\n    this.detachQueue.forEach(detach);\n    this.children.forEach(_detachNodes);\n    this.detachQueue = [];\n  }\n\n  ready() {\n    if (this.detachQueue.length) detachImmediate(this);\n  }\n\n  remove(transition) {\n    const list = transition.isIntro ? this.intros : this.outros;\n    removeFromArray(list, transition);\n    check(this);\n  }\n\n  start() {\n    this.children.forEach(c => c.start());\n    this.intros.concat(this.outros).forEach(t => t.start());\n    this.ready = true;\n    check(this);\n  }\n}\n\nfunction detach(element) {\n  element.detach();\n}\n\nfunction _detachNodes(tm) {\n  // _ to avoid transpiler quirk\n  tm.detachNodes();\n}\n\nfunction check(tm) {\n  if (!tm.ready || tm.outros.length || tm.outroChildren) return;\n\n  // If all outros are complete, and we haven't already done this,\n  // we notify the parent if there is one, otherwise\n  // start detaching nodes\n  if (!tm.outrosComplete) {\n    tm.outrosComplete = true;\n\n    if (tm.parent && !tm.parent.outrosComplete) {\n      tm.parent.decrementOutros(tm);\n    } else {\n      tm.detachNodes();\n    }\n  }\n\n  // Once everything is done, we can notify parent transition\n  // manager and call the callback\n  if (!tm.intros.length && !tm.totalChildren) {\n    if (isFunction(tm.callback)) {\n      tm.callback();\n    }\n\n    if (tm.parent && !tm.notifiedTotal) {\n      tm.notifiedTotal = true;\n      tm.parent.decrementTotal();\n    }\n  }\n}\n\n// check through the detach queue to see if a node is up or downstream from a\n// transition and if not, go ahead and detach it\nfunction detachImmediate(manager) {\n  const queue = manager.detachQueue;\n  const outros = collectAllOutros(manager);\n\n  let i = queue.length;\n  let j = 0;\n  let node, trans;\n  start: while (i--) {\n    node = queue[i].node;\n    j = outros.length;\n    while (j--) {\n      trans = outros[j].element.node;\n      // check to see if the node is, contains, or is contained by the transitioning node\n      if (trans === node || trans.contains(node) || node.contains(trans)) continue start;\n    }\n\n    // no match, we can drop it\n    queue[i].detach();\n    queue.splice(i, 1);\n  }\n}\n\nfunction collectAllOutros(manager, _list) {\n  let list = _list;\n\n  // if there's no list, we're starting at the root to build one\n  if (!list) {\n    list = [];\n    let parent = manager;\n    while (parent.parent) parent = parent.parent;\n    return collectAllOutros(parent, list);\n  } else {\n    // grab all outros from child managers\n    let i = manager.children.length;\n    while (i--) {\n      list = collectAllOutros(manager.children[i], list);\n    }\n\n    // grab any from this manager if there are any\n    if (manager.outros.length) list = list.concat(manager.outros);\n\n    return list;\n  }\n}\n","import { addToArray } from 'utils/array';\nimport TransitionManager from './TransitionManager';\n\nlet batch;\n\nconst runloop = {\n  active() {\n    return !!batch;\n  },\n\n  start() {\n    let fulfilPromise;\n    const promise = new Promise(f => (fulfilPromise = f));\n\n    batch = {\n      previousBatch: batch,\n      transitionManager: new TransitionManager(fulfilPromise, batch && batch.transitionManager),\n      fragments: [],\n      tasks: [],\n      immediateObservers: [],\n      deferredObservers: [],\n      promise\n    };\n\n    return promise;\n  },\n\n  end() {\n    flushChanges();\n\n    if (!batch.previousBatch) batch.transitionManager.start();\n\n    batch = batch.previousBatch;\n  },\n\n  addFragment(fragment) {\n    addToArray(batch.fragments, fragment);\n  },\n\n  // TODO: come up with a better way to handle fragments that trigger their own update\n  addFragmentToRoot(fragment) {\n    if (!batch) return;\n\n    let b = batch;\n    while (b.previousBatch) {\n      b = b.previousBatch;\n    }\n\n    addToArray(b.fragments, fragment);\n  },\n\n  addObserver(observer, defer) {\n    if (!batch) {\n      observer.dispatch();\n    } else {\n      addToArray(defer ? batch.deferredObservers : batch.immediateObservers, observer);\n    }\n  },\n\n  registerTransition(transition) {\n    transition._manager = batch.transitionManager;\n    batch.transitionManager.add(transition);\n  },\n\n  // synchronise node detachments with transition ends\n  detachWhenReady(thing) {\n    batch.transitionManager.detachQueue.push(thing);\n  },\n\n  scheduleTask(task, postRender) {\n    let _batch;\n\n    if (!batch) {\n      task();\n    } else {\n      _batch = batch;\n      while (postRender && _batch.previousBatch) {\n        // this can't happen until the DOM has been fully updated\n        // otherwise in some situations (with components inside elements)\n        // transitions and decorators will initialise prematurely\n        _batch = _batch.previousBatch;\n      }\n\n      _batch.tasks.push(task);\n    }\n  },\n\n  promise() {\n    if (!batch) return Promise.resolve();\n\n    let target = batch;\n    while (target.previousBatch) {\n      target = target.previousBatch;\n    }\n\n    return target.promise || Promise.resolve();\n  }\n};\n\nexport default runloop;\n\nfunction dispatch(observer) {\n  observer.dispatch();\n}\n\nfunction flushChanges() {\n  let which = batch.immediateObservers;\n  batch.immediateObservers = [];\n  which.forEach(dispatch);\n\n  // Now that changes have been fully propagated, we can update the DOM\n  // and complete other tasks\n  let i = batch.fragments.length;\n  let fragment;\n\n  which = batch.fragments;\n  batch.fragments = [];\n\n  while (i--) {\n    fragment = which[i];\n    fragment.update();\n  }\n\n  batch.transitionManager.ready();\n\n  which = batch.deferredObservers;\n  batch.deferredObservers = [];\n  which.forEach(dispatch);\n\n  const tasks = batch.tasks;\n  batch.tasks = [];\n\n  for (i = 0; i < tasks.length; i += 1) {\n    tasks[i]();\n  }\n\n  // If updating the view caused some model blowback - e.g. a triple\n  // containing <option> elements caused the binding on the <select>\n  // to update - then we start over\n  if (\n    batch.fragments.length ||\n    batch.immediateObservers.length ||\n    batch.deferredObservers.length ||\n    batch.tasks.length\n  )\n    return flushChanges();\n}\n","import { CONDITIONAL } from 'config/types';\nimport readLogicalOr from './readLogicalOr';\nimport { expectedExpression } from './shared/errors';\nimport readExpression from '../readExpression';\n\n// The conditional operator is the lowest precedence operator, so we start here\nexport default function getConditional(parser) {\n  const expression = readLogicalOr(parser);\n  if (!expression) {\n    return null;\n  }\n\n  const start = parser.pos;\n\n  parser.sp();\n\n  if (!parser.matchString('?')) {\n    parser.pos = start;\n    return expression;\n  }\n\n  parser.sp();\n\n  const ifTrue = readExpression(parser);\n  if (!ifTrue) {\n    parser.error(expectedExpression);\n  }\n\n  parser.sp();\n\n  if (!parser.matchString(':')) {\n    parser.error('Expected \":\"');\n  }\n\n  parser.sp();\n\n  const ifFalse = readExpression(parser);\n  if (!ifFalse) {\n    parser.error(expectedExpression);\n  }\n\n  return {\n    t: CONDITIONAL,\n    o: [expression, ifTrue, ifFalse]\n  };\n}\n","import readConditional from './expressions/readConditional';\n\nexport default function readExpression(parser) {\n  // The conditional operator is the lowest precedence operator (except yield,\n  // assignment operators, and commas, none of which are supported), so we\n  // start there. If it doesn't match, it 'falls through' to progressively\n  // higher precedence operators, until it eventually matches (or fails to\n  // match) a 'primary' - a literal or a reference. This way, the abstract syntax\n  // tree has everything in its proper place, i.e. 2 + 3 * 4 === 14, not 20.\n  return readConditional(parser);\n}\n","import { expectedExpression } from './errors';\nimport readExpression from '../../readExpression';\nimport { spreadPattern } from './patterns';\n\nexport default function readExpressionList(parser, spread) {\n  let isSpread;\n  const expressions = [];\n\n  const pos = parser.pos;\n\n  do {\n    parser.sp();\n\n    if (spread) {\n      isSpread = parser.matchPattern(spreadPattern);\n    }\n\n    const expr = readExpression(parser);\n\n    if (expr === null && expressions.length) {\n      parser.error(expectedExpression);\n    } else if (expr === null) {\n      parser.pos = pos;\n      return null;\n    }\n\n    if (isSpread) {\n      expr.p = true;\n    }\n\n    expressions.push(expr);\n\n    parser.sp();\n  } while (parser.matchString(','));\n\n  return expressions;\n}\n","import { REFERENCE } from 'config/types';\nimport readExpression from './readExpression';\nimport readReference from './expressions/primary/readReference';\n\nexport default function readExpressionOrReference(parser, expectedFollowers) {\n  const start = parser.pos;\n  const expression = readExpression(parser);\n\n  if (!expression) {\n    // valid reference but invalid expression e.g. `{{new}}`?\n    const ref = parser.matchPattern(/^(\\w+)/);\n    if (ref) {\n      return {\n        t: REFERENCE,\n        n: ref\n      };\n    }\n\n    return null;\n  }\n\n  for (let i = 0; i < expectedFollowers.length; i += 1) {\n    if (parser.remaining().substr(0, expectedFollowers[i].length) === expectedFollowers[i]) {\n      return expression;\n    }\n  }\n\n  parser.pos = start;\n  return readReference(parser);\n}\n","import {\n  REFERENCE,\n  BOOLEAN_LITERAL,\n  GLOBAL,\n  NUMBER_LITERAL,\n  REGEXP_LITERAL,\n  STRING_LITERAL,\n  ARRAY_LITERAL,\n  OBJECT_LITERAL,\n  KEY_VALUE_PAIR,\n  PREFIX_OPERATOR,\n  INFIX_OPERATOR,\n  INVOCATION,\n  BRACKETED,\n  MEMBER,\n  REFINEMENT,\n  CONDITIONAL\n} from 'config/types';\nimport { isObject, isString } from 'utils/is';\n\nexport default function flattenExpression(expression) {\n  let refs;\n  let count = 0;\n\n  extractRefs(expression, (refs = []));\n  const stringified = stringify(expression);\n\n  return {\n    r: refs,\n    s: getVars(stringified)\n  };\n\n  function getVars(expr) {\n    const vars = [];\n    for (let i = count - 1; i >= 0; i--) {\n      vars.push(`x$${i}`);\n    }\n    return vars.length ? `(function(){var ${vars.join(',')};return(${expr});})()` : expr;\n  }\n\n  function stringify(node) {\n    if (isString(node)) {\n      return node;\n    }\n\n    switch (node.t) {\n      case BOOLEAN_LITERAL:\n      case GLOBAL:\n      case NUMBER_LITERAL:\n      case REGEXP_LITERAL:\n        return node.v;\n\n      case STRING_LITERAL:\n        return JSON.stringify(String(node.v));\n\n      case ARRAY_LITERAL:\n        if (node.m && hasSpread(node.m)) {\n          return `[].concat(${makeSpread(node.m, '[', ']', stringify)})`;\n        } else {\n          return '[' + (node.m ? node.m.map(stringify).join(',') : '') + ']';\n        }\n\n      case OBJECT_LITERAL:\n        if (node.m && hasSpread(node.m)) {\n          return `Object.assign({},${makeSpread(node.m, '{', '}', stringifyPair)})`;\n        } else {\n          return '{' + (node.m ? node.m.map(n => `${n.k}:${stringify(n.v)}`).join(',') : '') + '}';\n        }\n\n      case PREFIX_OPERATOR:\n        return (node.s === 'typeof' ? 'typeof ' : node.s) + stringify(node.o);\n\n      case INFIX_OPERATOR:\n        return (\n          stringify(node.o[0]) +\n          (node.s.substr(0, 2) === 'in' ? ' ' + node.s + ' ' : node.s) +\n          stringify(node.o[1])\n        );\n\n      case INVOCATION:\n        if (node.o && hasSpread(node.o)) {\n          const id = count++;\n          return `(x$${id}=${stringify(node.x)}).apply(x$${id},${stringify({\n            t: ARRAY_LITERAL,\n            m: node.o\n          })})`;\n        } else {\n          return stringify(node.x) + '(' + (node.o ? node.o.map(stringify).join(',') : '') + ')';\n        }\n\n      case BRACKETED:\n        return '(' + stringify(node.x) + ')';\n\n      case MEMBER:\n        return stringify(node.x) + stringify(node.r);\n\n      case REFINEMENT:\n        return node.n ? '.' + node.n : '[' + stringify(node.x) + ']';\n\n      case CONDITIONAL:\n        return stringify(node.o[0]) + '?' + stringify(node.o[1]) + ':' + stringify(node.o[2]);\n\n      case REFERENCE:\n        return '_' + refs.indexOf(node.n);\n\n      default:\n        throw new Error('Expected legal JavaScript');\n    }\n  }\n\n  function stringifyPair(node) {\n    return node.p ? stringify(node.k) : `${node.k}:${stringify(node.v)}`;\n  }\n\n  function makeSpread(list, open, close, fn) {\n    const out = list.reduce(\n      (a, c) => {\n        if (c.p) {\n          a.str += `${a.open ? close + ',' : a.str.length ? ',' : ''}${fn(c)}`;\n        } else {\n          a.str += `${!a.str.length ? open : !a.open ? ',' + open : ','}${fn(c)}`;\n        }\n        a.open = !c.p;\n        return a;\n      },\n      { open: false, str: '' }\n    );\n    if (out.open) out.str += close;\n    return out.str;\n  }\n}\n\nfunction hasSpread(list) {\n  for (let i = 0; i < list.length; i++) {\n    if (list[i].p) return true;\n  }\n\n  return false;\n}\n\n// TODO maybe refactor this?\nfunction extractRefs(node, refs) {\n  if (node.t === REFERENCE && isString(node.n)) {\n    if (!~refs.indexOf(node.n)) {\n      refs.unshift(node.n);\n    }\n  }\n\n  const list = node.o || node.m;\n  if (list) {\n    if (isObject(list)) {\n      extractRefs(list, refs);\n    } else {\n      let i = list.length;\n      while (i--) {\n        extractRefs(list[i], refs);\n      }\n    }\n  }\n\n  if (node.k && node.t === KEY_VALUE_PAIR && !isString(node.k)) {\n    extractRefs(node.k, refs);\n  }\n\n  if (node.x) {\n    extractRefs(node.x, refs);\n  }\n\n  if (node.r) {\n    extractRefs(node.r, refs);\n  }\n\n  if (node.v) {\n    extractRefs(node.v, refs);\n  }\n}\n","import { REFERENCE, BRACKETED, MEMBER, REFINEMENT } from 'config/types';\nimport flattenExpression from './flattenExpression';\n\nexport default function refineExpression(expression, mustache) {\n  let referenceExpression;\n\n  if (expression) {\n    while (expression.t === BRACKETED && expression.x) {\n      expression = expression.x;\n    }\n\n    if (expression.t === REFERENCE) {\n      const n = expression.n;\n      if (!~n.indexOf('@context')) {\n        mustache.r = expression.n;\n      } else {\n        mustache.x = flattenExpression(expression);\n      }\n    } else {\n      if ((referenceExpression = getReferenceExpression(expression))) {\n        mustache.rx = referenceExpression;\n      } else {\n        mustache.x = flattenExpression(expression);\n      }\n    }\n\n    return mustache;\n  }\n}\n\n// TODO refactor this! it's bewildering\nfunction getReferenceExpression(expression) {\n  const members = [];\n  let refinement;\n\n  while (expression.t === MEMBER && expression.r.t === REFINEMENT) {\n    refinement = expression.r;\n\n    if (refinement.x) {\n      if (refinement.x.t === REFERENCE) {\n        members.unshift(refinement.x);\n      } else {\n        members.unshift(flattenExpression(refinement.x));\n      }\n    } else {\n      members.unshift(refinement.n);\n    }\n\n    expression = expression.x;\n  }\n\n  if (expression.t !== REFERENCE) {\n    return null;\n  }\n\n  return {\n    r: expression.n,\n    m: members\n  };\n}\n","import { TRIPLE } from 'config/types';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\n\nexport default function readTriple(parser, tag) {\n  const expression = readExpression(parser);\n\n  if (!expression) {\n    return null;\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  const triple = { t: TRIPLE };\n  refineExpression(expression, triple); // TODO handle this differently - it's mysterious\n\n  return triple;\n}\n","import { TRIPLE } from 'config/types';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\n\nexport default function readUnescaped(parser, tag) {\n  if (!parser.matchString('&')) {\n    return null;\n  }\n\n  parser.sp();\n\n  const expression = readExpression(parser);\n\n  if (!expression) {\n    return null;\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  const triple = { t: TRIPLE };\n  refineExpression(expression, triple); // TODO handle this differently - it's mysterious\n\n  return triple;\n}\n","import { PARTIAL, YIELDER } from 'src/config/types';\nimport readExpression from '../readExpression';\nimport refineExpression from 'parse/utils/refineExpression';\nimport { readAliases } from './readAliases';\n\nexport default function readPartial(parser, tag) {\n  const type = parser.matchString('>') || parser.matchString('yield');\n  const partial = { t: type === '>' ? PARTIAL : YIELDER };\n  let aliases;\n\n  if (!type) return null;\n\n  parser.sp();\n\n  if (type === '>' || !(aliases = parser.matchString('with'))) {\n    // Partial names can include hyphens, so we can't use readExpression\n    // blindly. Instead, we use the `relaxedNames` flag to indicate that\n    // `foo-bar` should be read as a single name, rather than 'subtract\n    // bar from foo'\n    parser.relaxedNames = parser.strictRefinement = true;\n    const expression = readExpression(parser);\n    parser.relaxedNames = parser.strictRefinement = false;\n\n    if (!expression && type === '>') return null;\n\n    if (expression) {\n      refineExpression(expression, partial); // TODO...\n      parser.sp();\n      if (type !== '>') aliases = parser.matchString('with');\n    }\n  }\n\n  parser.sp();\n\n  // check for alias context e.g. `{{>foo bar as bat, bip as bop}}`\n  if (aliases || type === '>') {\n    aliases = readAliases(parser);\n    if (aliases && aliases.length) {\n      partial.z = aliases;\n    } else if (type === '>') {\n      // otherwise check for literal context e.g. `{{>foo bar}}` then\n      // turn it into `{{#with bar}}{{>foo}}{{/with}}`\n      const context = readExpression(parser);\n      if (context) {\n        partial.c = {};\n        refineExpression(context, partial.c);\n      }\n    } else {\n      // {{yield with}} requires some aliases\n      parser.error(`Expected one or more aliases`);\n    }\n  }\n\n  parser.sp();\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}'`);\n  }\n\n  return partial;\n}\n","import { COMMENT } from 'src/config/types';\n\nexport default function readComment(parser, tag) {\n  if (!parser.matchString('!')) {\n    return null;\n  }\n\n  const index = parser.remaining().indexOf(tag.close);\n\n  if (index !== -1) {\n    parser.pos += index + tag.close.length;\n    return { t: COMMENT };\n  }\n}\n","import { INTERPOLATOR } from 'config/types';\nimport readExpressionOrReference from '../readExpressionOrReference';\nimport refineExpression from 'parse/utils/refineExpression';\n\nexport default function readInterpolator(parser, tag) {\n  let expression, err;\n\n  const start = parser.pos;\n\n  // TODO would be good for perf if we could do away with the try-catch\n  try {\n    expression = readExpressionOrReference(parser, [tag.close]);\n  } catch (e) {\n    err = e;\n  }\n\n  if (!expression) {\n    if (parser.str.charAt(start) === '!') {\n      // special case - comment\n      parser.pos = start;\n      return null;\n    }\n\n    if (err) {\n      throw err;\n    }\n  }\n\n  if (!parser.matchString(tag.close)) {\n    parser.error(`Expected closing delimiter '${tag.close}' after reference`);\n\n    if (!expression) {\n      // special case - comment\n      if (parser.nextChar() === '!') {\n        return null;\n      }\n\n      parser.error(`Expected expression or legal reference`);\n    }\n  }\n\n  const interpolator = { t: INTERPOLATOR };\n  refineExpression(expression, interpolator); // TODO handle this differently - it's mysterious\n\n  return interpolator;\n}\n","import { CLOSING } from 'config/types';\n\nexport default function readClosing(parser, tag) {\n  const start = parser.pos;\n\n  if (!parser.matchString(tag.open)) {\n    return null;\n  }\n\n  parser.sp();\n\n  if (!parser.matchString('/')) {\n    parser.pos = start;\n    return null;\n  }\n\n  parser.sp();\n\n  const remaining = parser.remaining();\n  const index = remaining.indexOf(tag.close);\n\n  if (index !== -1) {\n    const closing = {\n      t: CLOSING,\n      r: remaining.substr(0, index).split(' ')[0]\n    };\n\n    parser.pos += index;\n\n    if (!parser.matchString(tag.close)) {\n      parser.error(`Expected closing delimiter '${tag.close}'`);\n    }\n\n    return closing;\n  }\n\n  parser.pos = start;\n  return null;\n}\n","import getLowestIndex from './utils/getLowestIndex';\nimport { decodeCharacterReferences } from 'utils/html';\n\nexport default function readText(parser) {\n  let index, disallowed, barrier;\n\n  const remaining = parser.remaining();\n\n  if (parser.textOnlyMode) {\n    disallowed = parser.tags.map(t => t.open);\n    disallowed = disallowed.concat(parser.tags.map(t => '\\\\' + t.open));\n\n    index = getLowestIndex(remaining, disallowed);\n  } else {\n    barrier = parser.inside ? '</' + parser.inside : '<';\n\n    if (parser.inside && !parser.interpolate[parser.inside]) {\n      index = remaining.indexOf(barrier);\n    } else {\n      disallowed = parser.tags.map(t => t.open);\n      disallowed = disallowed.concat(parser.tags.map(t => '\\\\' + t.open));\n\n      // http://developers.whatwg.org/syntax.html#syntax-attributes\n      if (parser.inAttribute === true) {\n        // we're inside an unquoted attribute value\n        disallowed.push(`\"`, `'`, `=`, `<`, `>`, '`');\n      } else if (parser.inAttribute) {\n        // quoted attribute value\n        disallowed.push(parser.inAttribute);\n      } else {\n        disallowed.push(barrier);\n      }\n\n      index = getLowestIndex(remaining, disallowed);\n    }\n  }\n\n  if (!index) {\n    return null;\n  }\n\n  if (index === -1) {\n    index = remaining.length;\n  }\n\n  parser.pos += index;\n\n  if ((parser.inside && parser.inside !== 'textarea') || parser.textOnlyMode) {\n    return remaining.substr(0, index);\n  } else {\n    return decodeCharacterReferences(remaining.substr(0, index));\n  }\n}\n","import { TEMPLATE_VERSION } from 'config/template';\nimport { READERS, PARTIAL_READERS } from 'parse/_parse';\nimport cleanup from 'parse/utils/cleanup';\nimport { create } from 'utils/object';\n\nexport default function readTemplate(parser) {\n  const fragment = [];\n  const partials = create(null);\n  let hasPartials = false;\n\n  const preserveWhitespace = parser.preserveWhitespace;\n\n  while (parser.pos < parser.str.length) {\n    const pos = parser.pos;\n    let item, partial;\n\n    if ((partial = parser.read(PARTIAL_READERS))) {\n      if (partials[partial.n]) {\n        parser.pos = pos;\n        parser.error('Duplicated partial definition');\n      }\n\n      cleanup(\n        partial.f,\n        parser.stripComments,\n        preserveWhitespace,\n        !preserveWhitespace,\n        !preserveWhitespace\n      );\n\n      partials[partial.n] = partial.f;\n      hasPartials = true;\n    } else if ((item = parser.read(READERS))) {\n      fragment.push(item);\n    } else {\n      parser.error('Unexpected template content');\n    }\n  }\n\n  const result = {\n    v: TEMPLATE_VERSION,\n    t: fragment\n  };\n\n  if (hasPartials) {\n    result.p = partials;\n  }\n\n  return result;\n}\n","import { fromExpression } from './createFunction';\nimport { isArray, isObject } from 'utils/is';\nimport { keys } from 'utils/object';\n\nexport default function insertExpressions(obj, expr) {\n  keys(obj).forEach(key => {\n    if (isExpression(key, obj)) return addTo(obj, expr);\n\n    const ref = obj[key];\n    if (hasChildren(ref)) insertExpressions(ref, expr);\n  });\n}\n\nfunction isExpression(key, obj) {\n  return key === 's' && isArray(obj.r);\n}\n\nfunction addTo(obj, expr) {\n  const { s, r } = obj;\n  if (!expr[s]) expr[s] = fromExpression(s, r.length);\n}\n\nfunction hasChildren(ref) {\n  return isArray(ref) || isObject(ref);\n}\n","import noop from 'utils/noop';\nimport { isFunction } from 'utils/is';\n\nexport default function wrap(parent, name, method) {\n  if (!/_super/.test(method)) return method;\n\n  function wrapper() {\n    const superMethod = getSuperMethod(wrapper._parent, name);\n    const hasSuper = '_super' in this;\n    const oldSuper = this._super;\n\n    this._super = superMethod;\n\n    const result = method.apply(this, arguments);\n\n    if (hasSuper) {\n      this._super = oldSuper;\n    } else {\n      delete this._super;\n    }\n\n    return result;\n  }\n\n  wrapper._parent = parent;\n  wrapper._method = method;\n\n  return wrapper;\n}\n\nfunction getSuperMethod(parent, name) {\n  if (name in parent) {\n    const value = parent[name];\n\n    return isFunction(value) ? value : () => value;\n  }\n\n  return noop;\n}\n","import { warnIfDebug } from 'utils/log';\nimport { isArray } from 'utils/is';\n\nfunction getMessage(deprecated, correct, isError) {\n  return (\n    `options.${deprecated} has been deprecated in favour of options.${correct}.` +\n    (isError ? ` You cannot specify both options, please use options.${correct}.` : '')\n  );\n}\n\nfunction deprecateOption(options, deprecatedOption, correct) {\n  if (deprecatedOption in options) {\n    if (!(correct in options)) {\n      warnIfDebug(getMessage(deprecatedOption, correct));\n      options[correct] = options[deprecatedOption];\n    } else {\n      throw new Error(getMessage(deprecatedOption, correct, true));\n    }\n  }\n}\n\nexport default function deprecate(options) {\n  deprecateOption(options, 'beforeInit', 'onconstruct');\n  deprecateOption(options, 'init', 'onrender');\n  deprecateOption(options, 'complete', 'oncomplete');\n  deprecateOption(options, 'eventDefinitions', 'events');\n\n  // Using extend with Component instead of options,\n  // like Human.extend( Spider ) means adaptors as a registry\n  // gets copied to options. So we have to check if actually an array\n  if (isArray(options.adaptors)) {\n    deprecateOption(options, 'adaptors', 'adapt');\n  }\n}\n","import resolveReference from './resolveReference';\nimport ExpressionProxy from './ExpressionProxy';\nimport ReferenceExpressionProxy from './ReferenceExpressionProxy';\n\nexport default function resolve(fragment, template) {\n  if (template.r) {\n    return resolveReference(fragment, template.r);\n  } else if (template.x) {\n    return new ExpressionProxy(fragment, template.x);\n  } else if (template.rx) {\n    return new ReferenceExpressionProxy(fragment, template.rx);\n  }\n}\n","import { fatal } from 'utils/log';\nimport bind from 'utils/bind';\nimport { createFunctionFromString } from '../config/runtime-parser';\nimport { isFunction, isString, isObjectType } from 'utils/is';\n\nexport default function getComputationSignature(ractive, key, signature) {\n  let getter;\n  let setter;\n\n  // useful for debugging\n  let getterString;\n  let getterUseStack;\n  let setterString;\n\n  if (isFunction(signature)) {\n    getter = bind(signature, ractive);\n    getterString = signature.toString();\n    getterUseStack = true;\n  }\n\n  if (isString(signature)) {\n    getter = createFunctionFromString(signature, ractive);\n    getterString = signature;\n  }\n\n  if (isObjectType(signature)) {\n    if (isString(signature.get)) {\n      getter = createFunctionFromString(signature.get, ractive);\n      getterString = signature.get;\n    } else if (isFunction(signature.get)) {\n      getter = bind(signature.get, ractive);\n      getterString = signature.get.toString();\n      getterUseStack = true;\n    } else {\n      fatal('`%s` computation must have a `get()` method', key);\n    }\n\n    if (isFunction(signature.set)) {\n      setter = bind(signature.set, ractive);\n      setterString = signature.set.toString();\n    }\n  }\n\n  return {\n    getter,\n    setter,\n    getterString,\n    setterString,\n    getterUseStack\n  };\n}\n","import { create, toPairs } from 'utils/object';\nimport { isFunction, isObjectType } from 'utils/is';\n\nexport default function subscribe(instance, options, type) {\n  const subs = (instance.constructor[`_${type}`] || []).concat(toPairs(options[type] || []));\n  const single = type === 'on' ? 'once' : `${type}Once`;\n\n  subs.forEach(([target, config]) => {\n    if (isFunction(config)) {\n      instance[type](target, config);\n    } else if (isObjectType(config) && isFunction(config.handler)) {\n      instance[config.once ? single : type](target, config.handler, create(config));\n    }\n  });\n}\n","import getFunction from 'shared/getFunction';\nimport resolveReference from '../../resolvers/resolveReference';\n\nexport function setupArgsFn(item, template, fragment, opts = {}) {\n  if (template && template.f && template.f.s) {\n    item.fn = getFunction(template.f.s, template.f.r.length);\n    if (opts.register === true) {\n      item.models = resolveArgs(item, template, fragment, opts);\n    }\n  }\n}\n\nexport function resolveArgs(item, template, fragment, opts = {}) {\n  return template.f.r.map((ref, i) => {\n    let model;\n\n    if (opts.specialRef && (model = opts.specialRef(ref, i))) return model;\n\n    model = resolveReference(fragment, ref);\n    if (opts.register === true) {\n      model.register(item);\n    }\n\n    return model;\n  });\n}\n\nexport function teardownArgsFn(item, template) {\n  if (template && template.f && template.f.s) {\n    if (item.models)\n      item.models.forEach(m => {\n        if (m && m.unregister) m.unregister(item);\n      });\n    item.models = null;\n  }\n}\n","// This is the handler for DOM events that would lead to a change in the model\n// (i.e. change, sometimes, input, and occasionally click and keyup)\nexport default function handleDomEvent() {\n  this._ractive.binding.handleChange();\n}\n","import { toArray } from './array';\n\nexport default function getSelectedOptions(select) {\n  /* istanbul ignore next */\n  return select.selectedOptions\n    ? toArray(select.selectedOptions)\n    : select.options\n      ? toArray(select.options).filter(option => option.selected)\n      : [];\n}\n","import { INTERPOLATOR, TRIPLE } from 'config/types';\nimport { warnIfDebug } from 'utils/log';\nimport CheckboxBinding from './CheckboxBinding';\nimport CheckboxNameBinding from './CheckboxNameBinding';\nimport ContentEditableBinding from './ContentEditableBinding';\nimport FileBinding from './FileBinding';\nimport GenericBinding from './GenericBinding';\nimport MultipleSelectBinding from './MultipleSelectBinding';\nimport NumericBinding from './NumericBinding';\nimport RadioBinding from './RadioBinding';\nimport RadioNameBinding from './RadioNameBinding';\nimport SingleSelectBinding from './SingleSelectBinding';\n\nexport function isBindable(attribute) {\n  // The fragment must be a single non-string fragment\n  if (\n    !attribute ||\n    !attribute.template.f ||\n    attribute.template.f.length !== 1 ||\n    attribute.template.f[0].s\n  )\n    return false;\n\n  // A binding is an interpolator `{{ }}`, yey.\n  if (attribute.template.f[0].t === INTERPOLATOR) return true;\n\n  // The above is probably the only true case. For the rest, show an appropriate\n  // warning before returning false.\n\n  // You can't bind a triple curly. HTML values on an attribute makes no sense.\n  if (attribute.template.f[0].t === TRIPLE)\n    warnIfDebug('It is not possible create a binding using a triple mustache.');\n\n  return false;\n}\n\nexport default function selectBinding(element) {\n  const name = element.name;\n  const attributes = element.attributeByName;\n  const isBindableByValue = isBindable(attributes.value);\n  const isBindableByContentEditable = isBindable(attributes.contenteditable);\n  const isContentEditable = element.getAttribute('contenteditable');\n\n  // contenteditable\n  // Bind if the contenteditable is true or a binding that may become true.\n  if ((isContentEditable || isBindableByContentEditable) && isBindableByValue)\n    return ContentEditableBinding;\n\n  // <input>\n  if (name === 'input') {\n    const type = element.getAttribute('type');\n\n    if (type === 'radio') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // For radios we can either bind the name or checked, but not both.\n      // Name binding is handed instead.\n      if (isBindableByName && isBindableByChecked) {\n        warnIfDebug(\n          'A radio input can have two-way binding on its name attribute, or its checked attribute - not both',\n          { ractive: element.root }\n        );\n        return RadioNameBinding;\n      }\n\n      if (isBindableByName) return RadioNameBinding;\n\n      if (isBindableByChecked) return RadioBinding;\n\n      // Dead end. Unknown binding on radio input.\n      return null;\n    }\n\n    if (type === 'checkbox') {\n      const isBindableByName = isBindable(attributes.name);\n      const isBindableByChecked = isBindable(attributes.checked);\n\n      // A checkbox with bindings for both name and checked. Checked treated as\n      // the checkbox value, name is treated as a regular binding.\n      //\n      // See https://github.com/ractivejs/ractive/issues/1749\n      if (isBindableByName && isBindableByChecked) return CheckboxBinding;\n\n      if (isBindableByName) return CheckboxNameBinding;\n\n      if (isBindableByChecked) return CheckboxBinding;\n\n      // Dead end. Unknown binding on checkbox input.\n      return null;\n    }\n\n    if (type === 'file' && isBindableByValue) return FileBinding;\n\n    if (type === 'number' && isBindableByValue) return NumericBinding;\n\n    if (type === 'range' && isBindableByValue) return NumericBinding;\n\n    // Some input of unknown type (browser usually falls back to text).\n    if (isBindableByValue) return GenericBinding;\n\n    // Dead end. Some unknown input and an unbindable.\n    return null;\n  }\n\n  // <select>\n  if (name === 'select' && isBindableByValue) {\n    return element.getAttribute('multiple') ? MultipleSelectBinding : SingleSelectBinding;\n  }\n\n  // <textarea>\n  if (name === 'textarea' && isBindableByValue) return GenericBinding;\n\n  // Dead end. Some unbindable element.\n  return null;\n}\n","export function findInViewHierarchy(registryName, ractive, name) {\n  const instance = findInstance(registryName, ractive, name);\n  return instance ? instance[registryName][name] : null;\n}\n\nexport function findInstance(registryName, ractive, name) {\n  while (ractive) {\n    if (name in ractive[registryName]) {\n      return ractive;\n    }\n\n    if (ractive.isolated) {\n      return null;\n    }\n\n    ractive = ractive.parent;\n  }\n}\n","import { fatal } from 'utils/log';\nimport { missingPlugin } from 'config/errors';\nimport interpolators from '../Ractive/static/interpolators';\nimport { findInViewHierarchy } from './registry';\n\nexport default function interpolate(from, to, ractive, type) {\n  if (from === to) return null;\n\n  if (type) {\n    const interpol = findInViewHierarchy('interpolators', ractive, type);\n    if (interpol) return interpol(from, to) || null;\n\n    fatal(missingPlugin(type, 'interpolator'));\n  }\n\n  return (\n    interpolators.number(from, to) ||\n    interpolators.array(from, to) ||\n    interpolators.object(from, to) ||\n    null\n  );\n}\n","import { isArray, isString } from './is';\n\nexport function addToArray(array, value) {\n  const index = array.indexOf(value);\n\n  if (index === -1) {\n    array.push(value);\n  }\n}\n\nexport function arrayContains(array, value) {\n  for (let i = 0, c = array.length; i < c; i++) {\n    if (array[i] == value) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nexport function arrayContentsMatch(a, b) {\n  let i;\n\n  if (!isArray(a) || !isArray(b)) {\n    return false;\n  }\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  i = a.length;\n  while (i--) {\n    if (a[i] !== b[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function ensureArray(x) {\n  if (isString(x)) {\n    return [x];\n  }\n\n  if (x === undefined) {\n    return [];\n  }\n\n  return x;\n}\n\nexport function lastItem(array) {\n  return array[array.length - 1];\n}\n\nexport function removeFromArray(array, member) {\n  if (!array) {\n    return;\n  }\n\n  const index = array.indexOf(member);\n\n  if (index !== -1) {\n    array.splice(index, 1);\n  }\n}\n\nexport function combine(...arrays) {\n  const res = arrays.concat.apply([], arrays);\n  let i = res.length;\n  while (i--) {\n    const idx = res.indexOf(res[i]);\n    if (~idx && idx < i) res.splice(i, 1);\n  }\n\n  return res;\n}\n\nexport function toArray(arrayLike) {\n  const array = [];\n  let i = arrayLike.length;\n  while (i--) {\n    array[i] = arrayLike[i];\n  }\n\n  return array;\n}\n\nexport function findMap(array, fn) {\n  const len = array.length;\n  for (let i = 0; i < len; i++) {\n    const result = fn(array[i]);\n    if (result) return result;\n  }\n}\n","export function bind(x) {\n  x.bind();\n}\nexport function cancel(x) {\n  x.cancel();\n}\nexport function destroyed(x) {\n  x.destroyed();\n}\nexport function handleChange(x) {\n  x.handleChange();\n}\nexport function mark(x) {\n  x.mark();\n}\nexport function markForce(x) {\n  x.mark(true);\n}\nexport function marked(x) {\n  x.marked();\n}\nexport function markedAll(x) {\n  x.markedAll();\n}\nexport function render(x) {\n  x.render();\n}\nexport function shuffled(x) {\n  x.shuffled();\n}\nexport function teardown(x) {\n  x.teardown();\n}\nexport function unbind(x) {\n  x.unbind();\n}\nexport function unrender(x) {\n  x.unrender();\n}\nexport function unrenderAndDestroy(x) {\n  x.unrender(true);\n}\nexport function update(x) {\n  x.update();\n}\nexport function toString(x) {\n  return x.toString();\n}\nexport function toEscapedString(x) {\n  return x.toString(true);\n}\n","import { splitKeypath } from './keypaths';\nimport { isString } from 'utils/is';\n\n// this is the dry method of checking to see if a rebind applies to\n// a particular keypath because in some cases, a dep may be bound\n// directly to a particular keypath e.g. foo.bars.0.baz and need\n// to avoid getting kicked to foo.bars.1.baz if foo.bars is unshifted\nexport function rebindMatch(template, next, previous, fragment) {\n  const keypath = template.r || template;\n\n  // no valid keypath, go with next\n  if (!keypath || !isString(keypath)) return next;\n\n  // completely contextual ref, go with next\n  if (\n    keypath === '.' ||\n    keypath[0] === '@' ||\n    (next || previous).isKey ||\n    (next || previous).isKeypath\n  )\n    return next;\n\n  const parts = keypath.split('/');\n  let keys = splitKeypath(parts[parts.length - 1]);\n  const last = keys[keys.length - 1];\n\n  // check the keypath against the model keypath to see if it matches\n  let model = next || previous;\n\n  // check to see if this was an alias\n  if (model && keys.length === 1 && last !== model.key && fragment) {\n    keys = findAlias(last, fragment) || keys;\n  }\n\n  let i = keys.length;\n  let match = true;\n  let shuffling = false;\n\n  while (model && i--) {\n    if (model.shuffling) shuffling = true;\n    // non-strict comparison to account for indices in keypaths\n    if (keys[i] != model.key) match = false;\n    model = model.parent;\n  }\n\n  // next is undefined, but keypath is shuffling and previous matches\n  if (!next && match && shuffling) return previous;\n  else if (next && !match && shuffling)\n    // next is defined, but doesn't match the keypath\n    return previous;\n  else return next;\n}\n\nfunction findAlias(name, fragment) {\n  while (fragment) {\n    const z = fragment.aliases;\n    if (z && z[name]) {\n      const aliases = (fragment.owner.iterations ? fragment.owner : fragment).owner.template.z;\n      for (let i = 0; i < aliases.length; i++) {\n        if (aliases[i].n === name) {\n          const alias = aliases[i].x;\n          if (!alias.r) return false;\n          const parts = alias.r.split('/');\n          return splitKeypath(parts[parts.length - 1]);\n        }\n      }\n      return;\n    }\n\n    fragment = fragment.componentParent || fragment.parent;\n  }\n}\n","import add from './shared/add';\nimport { isNumber, isObjectType } from 'utils/is';\n\nexport default function Ractive$add(keypath, d, options) {\n  const num = isNumber(d) ? d : 1;\n  const opts = isObjectType(d) ? d : options;\n  return add(this, keypath, num, opts);\n}\n","export function enqueue(ractive, event) {\n  if (ractive.event) {\n    ractive._eventQueue.push(ractive.event);\n  }\n\n  ractive.event = event;\n}\n\nexport function dequeue(ractive) {\n  if (ractive._eventQueue.length) {\n    ractive.event = ractive._eventQueue.pop();\n  } else {\n    ractive.event = null;\n  }\n}\n","export function findAnchors(fragment, name = null) {\n  const res = [];\n\n  findAnchorsIn(fragment, name, res);\n\n  return res;\n}\n\nfunction findAnchorsIn(item, name, result) {\n  if (item.isAnchor) {\n    if (!name || item.name === name) {\n      result.push(item);\n    }\n  } else if (item.items) {\n    item.items.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.iterations) {\n    item.iterations.forEach(i => findAnchorsIn(i, name, result));\n  } else if (item.fragment && !item.component) {\n    findAnchorsIn(item.fragment, name, result);\n  }\n}\n\nexport function updateAnchors(instance, name = null) {\n  const anchors = findAnchors(instance.fragment, name);\n  const idxs = {};\n  const children = instance._children.byName;\n\n  anchors.forEach(a => {\n    const name = a.name;\n    if (!(name in idxs)) idxs[name] = 0;\n    const idx = idxs[name];\n    const child = (children[name] || [])[idx];\n\n    if (child && child.lastBound !== a) {\n      if (child.lastBound) child.lastBound.removeChild(child);\n      a.addChild(child);\n    }\n\n    idxs[name]++;\n  });\n}\n\nexport function unrenderChild(meta) {\n  if (meta.instance.fragment.rendered) {\n    meta.shouldDestroy = true;\n    meta.instance.unrender();\n  }\n  meta.instance.el = null;\n}\n","export default function Ractive$find(selector, options = {}) {\n  if (!this.el)\n    throw new Error(\n      `Cannot call ractive.find('${selector}') unless instance is rendered to the DOM`\n    );\n\n  let node = this.fragment.find(selector, options);\n  if (node) return node;\n\n  if (options.remote) {\n    for (let i = 0; i < this._children.length; i++) {\n      if (!this._children[i].instance.fragment.rendered) continue;\n      node = this._children[i].instance.find(selector, options);\n      if (node) return node;\n    }\n  }\n}\n","import { isArray } from 'utils/is';\n\nexport default function Ractive$findAll(selector, options = {}) {\n  if (!this.el)\n    throw new Error(\n      `Cannot call ractive.findAll('${selector}', ...) unless instance is rendered to the DOM`\n    );\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAll(selector, options);\n\n  if (options.remote) {\n    // seach non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        c.instance.findAll(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isArray, isObjectType } from 'utils/is';\n\nexport default function Ractive$findAllComponents(selector, options) {\n  if (!options && isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  options = options || {};\n\n  if (!isArray(options.result)) options.result = [];\n\n  this.fragment.findAllComponents(selector, options);\n\n  if (options.remote) {\n    // search non-fragment children\n    this._children.forEach(c => {\n      if (!c.target && c.instance.fragment && c.instance.fragment.rendered) {\n        if (!selector || c.name === selector) {\n          options.result.push(c.instance);\n        }\n\n        c.instance.findAllComponents(selector, options);\n      }\n    });\n  }\n\n  return options.result;\n}\n","import { isObjectType } from 'utils/is';\n\nexport default function Ractive$findComponent(selector, options = {}) {\n  if (isObjectType(selector)) {\n    options = selector;\n    selector = '';\n  }\n\n  let child = this.fragment.findComponent(selector, options);\n  if (child) return child;\n\n  if (options.remote) {\n    if (!selector && this._children.length) return this._children[0].instance;\n    for (let i = 0; i < this._children.length; i++) {\n      // skip children that are or should be in an anchor\n      if (this._children[i].target) continue;\n      if (this._children[i].name === selector) return this._children[i].instance;\n      child = this._children[i].instance.findComponent(selector, options);\n      if (child) return child;\n    }\n  }\n}\n","export default function Ractive$findContainer(selector) {\n  if (this.container) {\n    if (this.container.component && this.container.component.name === selector) {\n      return this.container;\n    } else {\n      return this.container.findContainer(selector);\n    }\n  }\n\n  return null;\n}\n","export default function Ractive$findParent(selector) {\n  if (this.parent) {\n    if (this.parent.component && this.parent.component.name === selector) {\n      return this.parent;\n    } else {\n      return this.parent.findParent(selector);\n    }\n  }\n\n  return null;\n}\n","import { ANCHOR, COMPONENT, ELEMENT } from 'config/types';\n\nexport default function findElement(start, orComponent = true, name) {\n  while (\n    start &&\n    (start.type !== ELEMENT || (name && start.name !== name)) &&\n    (!orComponent || (start.type !== COMPONENT && start.type !== ANCHOR))\n  ) {\n    // start is a fragment - look at the owner\n    if (start.owner) start = start.owner;\n    else if (start.component)\n      // start is a component or yielder - look at the container\n      start = start.containerFragment || start.component.up;\n    else if (start.parent)\n      // start is an item - look at the parent\n      start = start.parent;\n    else if (start.up)\n      // start is an item without a parent - look at the parent fragment\n      start = start.up;\n    else start = undefined;\n  }\n\n  return start;\n}\n","import { isNumber } from 'utils/is';\n\n// This function takes an array, the name of a mutator method, and the\n// arguments to call that mutator method with, and returns an array that\n// maps the old indices to their new indices.\n\n// So if you had something like this...\n//\n//     array = [ 'a', 'b', 'c', 'd' ];\n//     array.push( 'e' );\n//\n// ...you'd get `[ 0, 1, 2, 3 ]` - in other words, none of the old indices\n// have changed. If you then did this...\n//\n//     array.unshift( 'z' );\n//\n// ...the indices would be `[ 1, 2, 3, 4, 5 ]` - every item has been moved\n// one higher to make room for the 'z'. If you removed an item, the new index\n// would be -1...\n//\n//     array.splice( 2, 2 );\n//\n// ...this would result in [ 0, 1, -1, -1, 2, 3 ].\n//\n// This information is used to enable fast, non-destructive shuffling of list\n// sections when you do e.g. `ractive.splice( 'items', 2, 2 );\n\nexport default function getNewIndices(length, methodName, args) {\n  const newIndices = [];\n\n  const spliceArguments = getSpliceEquivalent(length, methodName, args);\n\n  if (!spliceArguments) {\n    return null; // TODO support reverse and sort?\n  }\n\n  const balance = spliceArguments.length - 2 - spliceArguments[1];\n\n  const removeStart = Math.min(length, spliceArguments[0]);\n  const removeEnd = removeStart + spliceArguments[1];\n  newIndices.startIndex = removeStart;\n\n  let i;\n  for (i = 0; i < removeStart; i += 1) {\n    newIndices.push(i);\n  }\n\n  for (; i < removeEnd; i += 1) {\n    newIndices.push(-1);\n  }\n\n  for (; i < length; i += 1) {\n    newIndices.push(i + balance);\n  }\n\n  // there is a net shift for the rest of the array starting with index + balance\n  if (balance !== 0) {\n    newIndices.touchedFrom = spliceArguments[0];\n  } else {\n    newIndices.touchedFrom = length;\n  }\n\n  return newIndices;\n}\n\n// The pop, push, shift an unshift methods can all be represented\n// as an equivalent splice\nfunction getSpliceEquivalent(length, methodName, args) {\n  switch (methodName) {\n    case 'splice':\n      if (args[0] !== undefined && args[0] < 0) {\n        args[0] = length + Math.max(args[0], -length);\n      }\n\n      if (args[0] === undefined) args[0] = 0;\n\n      while (args.length < 2) {\n        args.push(length - args[0]);\n      }\n\n      if (!isNumber(args[1])) {\n        args[1] = length - args[0];\n      }\n\n      // ensure we only remove elements that exist\n      args[1] = Math.min(args[1], length - args[0]);\n\n      return args;\n\n    case 'sort':\n    case 'reverse':\n      return null;\n\n    case 'pop':\n      if (length) {\n        return [length - 1, 1];\n      }\n      return [0, 0];\n\n    case 'push':\n      return [length, 0].concat(args);\n\n    case 'shift':\n      return [0, length ? 1 : 0];\n\n    case 'unshift':\n      return [0, 0].concat(args);\n  }\n}\n","import fireEvent from 'src/events/fireEvent';\nimport Context from 'shared/Context';\nimport { assign, create } from 'utils/object';\nimport { isObjectType } from 'utils/is';\n\nexport default function Ractive$fire(eventName, ...args) {\n  let ctx;\n\n  // watch for reproxy\n  if (args[0] instanceof Context) {\n    const proto = args.shift();\n    ctx = create(proto);\n    assign(ctx, proto);\n  } else if (isObjectType(args[0]) && (args[0] === null || args[0].constructor === Object)) {\n    ctx = Context.forRactive(this, args.shift());\n  } else {\n    ctx = Context.forRactive(this);\n  }\n\n  return fireEvent(this, eventName, ctx, args);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport { FakeFragment } from 'shared/getRactiveContext';\nimport { isString } from 'utils/is';\n\nexport default function Ractive$get(keypath, opts) {\n  if (!isString(keypath)) return this.viewmodel.get(true, keypath);\n\n  const keys = splitKeypath(keypath);\n  const key = keys[0];\n\n  let model;\n\n  if (!this.viewmodel.has(key)) {\n    // if this is an inline component, we may need to create\n    // an implicit mapping\n    if (this.component && !this.isolated) {\n      model = resolveReference(this.fragment || new FakeFragment(this), key);\n    }\n  }\n\n  model = this.viewmodel.joinAll(keys);\n  return model.get(true, opts);\n}\n","import staticContext, { getNodeInfo as staticInfo } from '../static/getContext';\nimport { isString } from 'utils/is';\n\nexport default function getContext(node, options) {\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticContext(node);\n}\n\nexport function getNodeInfo(node, options) {\n  if (isString(node)) {\n    node = this.find(node, options);\n  }\n\n  return staticInfo(node);\n}\n","import { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport runloop from 'src/global/runloop';\n\nexport default function link(there, here, options) {\n  let model;\n  const target = (options && (options.ractive || options.instance)) || this;\n\n  // may need to allow a mapping to resolve implicitly\n  const sourcePath = splitKeypath(there);\n  if (!target.viewmodel.has(sourcePath[0]) && target.component) {\n    model = resolveReference(target.component.up, sourcePath[0]);\n    model = model.joinAll(sourcePath.slice(1));\n  }\n\n  const src = model || target.viewmodel.joinAll(sourcePath);\n  const dest = this.viewmodel.joinAll(splitKeypath(here), { lastLink: false });\n\n  if (isUpstream(src, dest) || isUpstream(dest, src)) {\n    throw new Error('A keypath cannot be linked to itself.');\n  }\n\n  const promise = runloop.start();\n\n  dest.link(src, (options && options.keypath) || there);\n\n  runloop.end();\n\n  return promise;\n}\n\nfunction isUpstream(check, start) {\n  let model = start;\n  while (model) {\n    if (model === check || model.owner === check) return true;\n    model = model.target || model.parent;\n  }\n}\n","import { isObject, isFunction } from 'utils/is';\nimport { warnOnceIfDebug } from 'utils/log';\nimport { splitKeypath } from 'shared/keypaths';\nimport resolveReference from 'src/view/resolvers/resolveReference';\nimport Observer from './observe/Observer';\nimport PatternObserver from './observe/Pattern';\nimport ArrayObserver from './observe/Array';\nimport { keys } from 'utils/object';\n\nexport default function observe(keypath, callback, options) {\n  const observers = [];\n  let map;\n  let opts;\n\n  if (isObject(keypath)) {\n    map = keypath;\n    opts = callback || {};\n  } else {\n    if (isFunction(keypath)) {\n      map = { '': keypath };\n      opts = callback || {};\n    } else {\n      map = {};\n      map[keypath] = callback;\n      opts = options || {};\n    }\n  }\n\n  let silent = false;\n  keys(map).forEach(keypath => {\n    const callback = map[keypath];\n    const caller = function(...args) {\n      if (silent) return;\n      return callback.apply(this, args);\n    };\n\n    let keypaths = keypath.split(' ');\n    if (keypaths.length > 1) keypaths = keypaths.filter(k => k);\n\n    keypaths.forEach(keypath => {\n      opts.keypath = keypath;\n      const observer = createObserver(this, keypath, caller, opts);\n      if (observer) observers.push(observer);\n    });\n  });\n\n  // add observers to the Ractive instance, so they can be\n  // cancelled on ractive.teardown()\n  this._observers.push.apply(this._observers, observers);\n\n  return {\n    cancel: () => observers.forEach(o => o.cancel()),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n\nfunction createObserver(ractive, keypath, callback, options) {\n  const keys = splitKeypath(keypath);\n  let wildcardIndex = keys.indexOf('*');\n  if (!~wildcardIndex) wildcardIndex = keys.indexOf('**');\n\n  options.fragment = options.fragment || ractive.fragment;\n\n  let model;\n  if (!options.fragment) {\n    model = ractive.viewmodel.joinKey(keys[0]);\n  } else {\n    // .*.whatever relative wildcard is a special case because splitkeypath doesn't handle the leading .\n    if (~keys[0].indexOf('.*')) {\n      model = options.fragment.findContext();\n      wildcardIndex = 0;\n      keys[0] = keys[0].slice(1);\n    } else {\n      model =\n        wildcardIndex === 0\n          ? options.fragment.findContext()\n          : resolveReference(options.fragment, keys[0]);\n    }\n  }\n\n  // the model may not exist key\n  if (!model) model = ractive.viewmodel.joinKey(keys[0]);\n\n  if (!~wildcardIndex) {\n    model = model.joinAll(keys.slice(1));\n    if (options.array) {\n      return new ArrayObserver(ractive, model, callback, options);\n    } else {\n      return new Observer(ractive, model, callback, options);\n    }\n  } else {\n    const double = keys.indexOf('**');\n    if (~double) {\n      if (double + 1 !== keys.length || ~keys.indexOf('*')) {\n        warnOnceIfDebug(\n          `Recursive observers may only specify a single '**' at the end of the path.`\n        );\n        return;\n      }\n    }\n\n    model = model.joinAll(keys.slice(1, wildcardIndex));\n\n    return new PatternObserver(ractive, model, keys.slice(wildcardIndex), callback, options);\n  }\n}\n","import { removeFromArray } from 'utils/array';\nimport trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\n\nexport default function Ractive$off(eventName, callback) {\n  // if no event is specified, remove _all_ event listeners\n  if (!eventName) {\n    this._subs = {};\n  } else {\n    // Handle multiple space-separated event names\n    const eventNames = eventName\n      .split(' ')\n      .map(trim)\n      .filter(notEmptyString);\n\n    eventNames.forEach(event => {\n      const subs = this._subs[event];\n      // if given a specific callback to remove, remove only it\n      if (subs && callback) {\n        const entry = subs.find(s => s.callback === callback);\n        if (entry) {\n          removeFromArray(subs, entry);\n          entry.off = true;\n\n          if (event.indexOf('.')) this._nsSubs--;\n        }\n      } else if (subs) {\n        // otherwise, remove all listeners for this event\n        if (event.indexOf('.')) this._nsSubs -= subs.length;\n        subs.length = 0;\n      }\n    });\n  }\n\n  return this;\n}\n","import trim from './shared/trim';\nimport notEmptyString from './shared/notEmptyString';\nimport { hasOwn } from 'utils/object';\nimport { isObjectType, isString } from 'utils/is';\n\nexport default function Ractive$on(eventName, callback) {\n  // eventName may already be a map\n  const map = isObjectType(eventName) ? eventName : {};\n  // or it may be a string along with a callback\n  if (isString(eventName)) map[eventName] = callback;\n\n  let silent = false;\n  const events = [];\n\n  for (const k in map) {\n    const callback = map[k];\n    const caller = function(...args) {\n      if (!silent) return callback.apply(this, args);\n    };\n    const entry = {\n      callback,\n      handler: caller\n    };\n\n    if (hasOwn(map, k)) {\n      const names = k\n        .split(' ')\n        .map(trim)\n        .filter(notEmptyString);\n      names.forEach(n => {\n        (this._subs[n] || (this._subs[n] = [])).push(entry);\n        if (n.indexOf('.')) this._nsSubs++;\n        events.push([n, entry]);\n      });\n    }\n  }\n\n  return {\n    cancel: () => events.forEach(e => this.off(e[0], e[1].callback)),\n    isSilenced: () => silent,\n    silence: () => (silent = true),\n    resume: () => (silent = false)\n  };\n}\n","export default function Ractive$once(eventName, handler) {\n  const listener = this.on(eventName, function() {\n    handler.apply(this, arguments);\n    listener.cancel();\n  });\n\n  // so we can still do listener.cancel() manually\n  return listener;\n}\n","import { splitKeypath } from 'shared/keypaths';\n\nexport default function readLink(keypath, options = {}) {\n  const path = splitKeypath(keypath);\n\n  if (this.viewmodel.has(path[0])) {\n    let model = this.viewmodel.joinAll(path);\n\n    if (!model.isLink) return;\n\n    while ((model = model.target) && options.canonical !== false) {\n      if (!model.isLink) break;\n    }\n\n    if (model) return { ractive: model.root.ractive, keypath: model.getKeypath() };\n  }\n}\n","function s4() {\n  return Math.floor((1 + Math.random()) * 0x10000)\n    .toString(16)\n    .substring(1);\n}\n\nexport function uuid() {\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n","import { applyCSS } from '../../global/css';\nimport transformCSS from '../config/custom/css/transform';\nimport { evalCSS } from '../config/custom/css/css';\nimport { build, set } from '../../shared/set';\nimport runloop from '../../global/runloop';\nimport { isObjectType, isFunction } from 'utils/is';\n\nexport default function setCSSData(keypath, value, options) {\n  const opts = isObjectType(keypath) ? value : options;\n  const model = this._cssModel;\n\n  model.locked = true;\n  const promise = set(build({ viewmodel: model }, keypath, value, true), opts);\n  model.locked = false;\n\n  const cascade = runloop.start();\n  this.extensions.forEach(e => {\n    const model = e._cssModel;\n    model.mark();\n    model.downstreamChanged('', 1);\n  });\n  runloop.end();\n\n  applyChanges(this, !opts || opts.apply !== false);\n\n  return promise.then(() => cascade);\n}\n\nexport function applyChanges(component, apply) {\n  const local = recomputeCSS(component);\n  const child = component.extensions\n    .map(e => applyChanges(e, false))\n    .reduce((a, c) => c || a, false);\n\n  if (apply && (local || child)) {\n    const def = component._cssDef;\n    if (!def || (def && def.applied)) applyCSS(true);\n  }\n\n  return local || child;\n}\n\nfunction recomputeCSS(component) {\n  const css = component._css;\n\n  if (!isFunction(css)) return;\n\n  const def = component._cssDef;\n  const result = evalCSS(component, css);\n  const styles = def.transform ? transformCSS(result, def.id) : result;\n\n  if (def.styles === styles) return;\n\n  def.styles = styles;\n\n  return true;\n}\n","import { BOOLEAN_LITERAL } from '../../../../../config/types';\n\nexport default function readBooleanLiteral(parser) {\n  const remaining = parser.remaining();\n\n  if (remaining.substr(0, 4) === 'true') {\n    parser.pos += 4;\n    return {\n      t: BOOLEAN_LITERAL,\n      v: 'true'\n    };\n  }\n\n  if (remaining.substr(0, 5) === 'false') {\n    parser.pos += 5;\n    return {\n      t: BOOLEAN_LITERAL,\n      v: 'false'\n    };\n  }\n\n  return null;\n}\n","import { KEY_VALUE_PAIR, REFERENCE } from 'src/config/types';\nimport readKey from '../../../shared/readKey';\nimport readExpression from '../../../../readExpression';\nimport { name as namePattern, spreadPattern } from '../../../shared/patterns';\n\nexport default function readKeyValuePair(parser) {\n  let spread;\n  const start = parser.pos;\n\n  // allow whitespace between '{' and key\n  parser.sp();\n\n  const refKey = parser.nextChar() !== \"'\" && parser.nextChar() !== '\"';\n  if (refKey) spread = parser.matchPattern(spreadPattern);\n\n  const key = spread ? readExpression(parser) : readKey(parser);\n  if (key === null) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace between key and ':'\n  parser.sp();\n\n  // es2015 shorthand property\n  if (refKey && (parser.nextChar() === ',' || parser.nextChar() === '}')) {\n    if (!spread && !namePattern.test(key)) {\n      parser.error(`Expected a valid reference, but found '${key}' instead.`);\n    }\n\n    const pair = {\n      t: KEY_VALUE_PAIR,\n      k: key,\n      v: {\n        t: REFERENCE,\n        n: key\n      }\n    };\n\n    if (spread) {\n      pair.p = true;\n    }\n\n    return pair;\n  }\n\n  // next character must be ':'\n  if (!parser.matchString(':')) {\n    parser.pos = start;\n    return null;\n  }\n\n  // allow whitespace between ':' and value\n  parser.sp();\n\n  // next expression must be a, well... expression\n  const value = readExpression(parser);\n  if (value === null) {\n    parser.pos = start;\n    return null;\n  }\n\n  return {\n    t: KEY_VALUE_PAIR,\n    k: key,\n    v: value\n  };\n}\n","import getKeyValuePair from './keyValuePair';\n\nexport default function readKeyValuePairs(parser) {\n  const start = parser.pos;\n\n  const pair = getKeyValuePair(parser);\n  if (pair === null) {\n    return null;\n  }\n\n  const pairs = [pair];\n\n  if (parser.matchString(',')) {\n    const keyValuePairs = readKeyValuePairs(parser);\n\n    if (!keyValuePairs) {\n      parser.pos = start;\n      return null;\n    }\n\n    return pairs.concat(keyValuePairs);\n  }\n\n  return pairs;\n}\n","import readNumberLiteral from './literal/readNumberLiteral';\nimport readBooleanLiteral from './literal/readBooleanLiteral';\nimport readStringLiteral from './literal/readStringLiteral';\nimport readTemplateStringLiteral from './literal/readTemplateStringLiteral';\nimport readObjectLiteral from './literal/readObjectLiteral';\nimport readArrayLiteral from './literal/readArrayLiteral';\nimport readRegexpLiteral from './literal/readRegexpLiteral';\n\nexport default function readLiteral(parser) {\n  return (\n    readNumberLiteral(parser) ||\n    readBooleanLiteral(parser) ||\n    readStringLiteral(parser) ||\n    readTemplateStringLiteral(parser) ||\n    readObjectLiteral(parser) ||\n    readArrayLiteral(parser) ||\n    readRegexpLiteral(parser)\n  );\n}\n","import { BRACKETED } from 'src/config/types';\nimport { expectedExpression, expectedParen } from '../shared/errors';\nimport readExpression from '../../readExpression';\n\nexport default function readBracketedExpression(parser) {\n  if (!parser.matchString('(')) return null;\n\n  parser.sp();\n\n  const expr = readExpression(parser);\n\n  if (!expr) parser.error(expectedExpression);\n\n  parser.sp();\n\n  if (!parser.matchString(')')) parser.error(expectedParen);\n\n  return {\n    t: BRACKETED,\n    x: expr\n  };\n}\n","import { REFINEMENT } from 'config/types';\nimport { expectedExpression } from './errors';\nimport { name as namePattern } from './patterns';\nimport readExpression from '../../readExpression';\n\nexport default function readRefinement(parser) {\n  // some things call for strict refinement (partial names), meaning no space between reference and refinement\n  if (!parser.strictRefinement) {\n    parser.sp();\n  }\n\n  // \".\" name\n  if (parser.matchString('.')) {\n    parser.sp();\n\n    const name = parser.matchPattern(namePattern);\n    if (name) {\n      return {\n        t: REFINEMENT,\n        n: name\n      };\n    }\n\n    parser.error('Expected a property name');\n  }\n\n  // \"[\" expression \"]\"\n  if (parser.matchString('[')) {\n    parser.sp();\n\n    const expr = readExpression(parser);\n    if (!expr) parser.error(expectedExpression);\n\n    parser.sp();\n\n    if (!parser.matchString(']')) parser.error(`Expected ']'`);\n\n    return {\n      t: REFINEMENT,\n      x: expr\n    };\n  }\n\n  return null;\n}\n"],"names":["frag","detach","super","prototype","call","this","Section__proto__","isTruthy","subordinate","sibling","const","value","model","isRoot","get","undefined","templateSectionType","SECTION_IF_WITH","isEmpty","rebind","next","previous","safe","fragment","sectionType","SECTION_IF","SECTION_UNLESS","render","target","occupants","rendered","shuffle","newIndices","SECTION_EACH","unbind","unrender","shouldDestroy","update","dirty","context","siblingFalsey","lastType","getType","template","i","let","newFragment","fragmentShouldExist","SECTION_WITH","detached","attach","bound","bind","RepeatedFragment","owner","f","indexRef","Fragment","keep","runloop","promise","then","nextSibling","MustacheContainer","Select","Element","options","Select__proto__","constructor","foundNode","node","binding","selectedOptions","getSelectedOptions","length","sync","defaultSelected","selected","selectNode","toArray","forEach","o","indexOf","setFromNode","selectValue","getAttribute","isMultiple","array","isArray","optionWasSelected","optionValue","_ractive","shouldSelect","valueContains","compare","forceUpdate","comparator","isFunction","Textarea","Input","deferContent","attributeByName","isBindable","attributes","push","createItem","t","ATTRIBUTE","n","up","cssIds","Textarea__proto__","bubble","scheduleTask","toString","Text","Item","type","TEXT","Text__proto__","detachNode","firstNode","inAttributes","progressiveText","escape","escapeHtml","valueOf","proto","noop","visible","hidden","doc","prefix","vendors","vendor","addEventListener","onChange","onHide","onShow","win","isClient","prefixCache","testStyle","createElement","style","prop","name","hyphenateCamel","createTransitions","prefix$1","vendorPattern","RegExp","join","hyphenate","str","test","replace","match","toLowerCase","TRANSITION","TRANSITIONEND","CSS_TRANSITIONS_ENABLED","TRANSITION_DURATION","TRANSITION_PROPERTY","TRANSITION_TIMING_FUNCTION","linear","x","canUseCssTransitions","cannotUseCssTransitions","transition","webkitTransition","to","changedProperties","resolve","setTimeout","transitionDone","clearTimeout","cssTimeout","checkComplete","jsTransitionsComplete","cssTransitionsComplete","unregisterCompleteHandler","ractive","fire","isIntro","transitionEndHandler","event","index","propertyName","splice","cssTransitionsDone","property","duration","timing","removeEventListener","hashPrefix","namespaceURI","tagName","delay","registerCompleteHandler","easingName","easing","cssTiming","hash","suffix","interpolator","originalValue","propertiesToTransitionInJs","initial","getStyle","warnIfDebug","exec","interpolate","parseFloat","isString","warnOnceIfDebug","missingPlugin","Ticker","step","pos","complete","createTransitions$1","getComputedStyle","resolved","Promise","names","t0","t1","t2","Transition","findElement","element","onComplete","Transition__proto__","animateStyle","arguments","Error","setStyle","fulfil","this$1","propertyNames","keys","computedStyle","current","init","originals","targets","v","intro","outro","eventName","params","_fn","findInViewHierarchy","setupArgsFn","getParams","fn","values","resolveArgs","map","apply","props","styles","processParams","defaults","isNumber","assign","addToArray","hasOwn","shouldFire","transitionsEnabled","rendering","nearestProp","unrendering","parent","isObject","nested","el","starting","start","completed","args","noReset","k","_manager","remove","concat","unbinding","removeFromArray","destroyed","ieBug","ieBlacklist","elementCache","innerHTML","err","TABLE","THEAD","TBODY","TR","SELECT","insertHtml","html","nodes","container","wrapper","selectedOption","querySelector","selectedIndex","svg","textContent","child","firstChild","removeChild","Triple","Mustache","Triple__proto__","docFrag","createDocumentFragment","appendChild","find","selector","len","nodeType","matches","queryResult","findAll","result","queryAllResult","querySelectorAll","findComponent","anchor","shift","outerHTML","nodeValue","slice","insertBefore","inAttribute","decodeCharacterReferences","detachWhenReady","findParentNode","findNextNode","constructors","ALIAS","Alias","ANCHOR","Component","DOCTYPE","Doctype","INTERPOLATOR","Interpolator","PARTIAL","Partial","SECTION","Section","TRIPLE","YIELDER","Attribute","BINDING_FLAG","BindingFlag","DECORATOR","Decorator","EVENT","EventDirective","COMMENT","Comment","specialElements","doctype","form","Form","input","option","Option","select","textarea","componentParent","component","delegate","containerFragment","dirtyValue","createItems","Fragment__proto__","items","addFragment","max","xs","findMap","findAllComponents","findContext","base","findParentWithContext","viewmodel","item","it","ELEMENT","findRepeatingFragment","isIteration","skipParent","resetTemplate","wasBound","wasRendered","parentNode","shuffled","toEscapedString","unrenderAndDestroy","updating","addFragmentToRoot","source","processItems","_guid","parsed","parseJSON","getContext","HookQueue","hook","Hook","inProcess","queue","HookQueue__proto__","begin","end","getChildQueue","configHook","initHook","renderHook","completeHook","shouldRerender","resetHook","unrenderHook","resetPartial","partial","collection","collect","partials","handleChange","reverse","makeArrayMethod","path","sort","unshift","add","animate","attachChild","detachChild","findContainer","findParent","getNodeInfo","insert","link","observe","observeOnce","off","on","once","pop","readLink","reset","set","subtract","teardown","toggle","toCSS","toCss","toHTML","toHtml","toText","unlink","updateModel","defineProperty","callsSuper","defineProperties","Ractive","sharedGet","sharedSet","styleGet","configurable","styleSet","opts","script","document","currentScript","warn","shared","DEBUG","writable","DEBUG_PROMISES","extend","extendWith","escapeKey","evalObjectString","findPlugin","getCSS","isInstance","joinKeys","macro","normaliseKeypath","normalise","parse","splitKeypath","unescapeKey","enhance","VERSION","adaptors","components","decorators","events","extensions","interpolators","transitions","cssData","sharedData","Context","extern","CSSModel","valueSoFar","group","CheckboxNameBinding__proto__","handleDomEvent","arrayContains","Binding","ContentEditableBinding","ContentEditableBinding__proto__","getInitialValue","getValue","lazy","attachEvent","GenericBinding","GenericBinding__proto__","timeout","isNumeric","handler","handleDelay","handleBlur","FileBinding","FileBinding__proto__","files","MultipleSelectBinding","MultipleSelectBinding__proto__","filter","selectedValues","attribute","previousValue","arrayContentsMatch","Array","NumericBinding","NumericBinding__proto__","isNaN","siblings","RadioBinding","getSiblings","RadioBinding__proto__","checked","RadioNameBinding","getBindingGroup","RadioNameBinding__proto__","nameAttributeBinding","getKeypath","getKeypathModel","register","lastVal","setting","lastValue","unregister","SingleSelectBinding","SingleSelectBinding__proto__","locked","disabled","endsWithSemi","ContainerItem","e","attrs","attr","val","cls","leftovers","m","DELEGATE_FLAG","ConditionalAttribute","Element__proto__","recreateTwowayBinding","createTwowayBinding","twoway","selectBinding","listeners","ls","ref","assigns","ctx","create","callback","capture","refs","delegateHandler","rem","namespace","getNamespace","existing","nodeName","toUpperCase","proxy","isOutro","registerTransition","children","childNodes","wasUndefined","removeAttribute","setAttribute","stringifyAttribute","isSelected","inputIsCheckedRadio","safeAttributeString","getString","inlineClass","voidElementNames","UIEvent","formBindings","Form__proto__","handleReset","whitelist","animationend","animationiteration","animationstart","transitioncancel","transitionend","transitionstart","transitionrun","DOMEvent","fatal","DOMEvent__proto__","directive","original","CustomEvent","eventPlugin","CustomEvent__proto__","RactiveEvent","RactiveEvent__proto__","instance","cancel","specialPattern","dollarArgsPattern","COMPONENT","models","EventDirective__proto__","action","refire","specialRef","specialMatch","special","substr","dollarMatch","obj","which","wrapperValue","oldEvent","returned","preventDefault","stopPropagation","fireEvent","isStatic","s","Mustache__proto__","unreference","rebindMatch","addShuffleRegister","Object","Interpolator__proto__","safeToStringValue","string","data","Input__proto__","defaultValue","attrValue","specials","true","false","null","specialsPattern","numberPattern","placeholderPattern","placeholderAtStartPattern","onlyWhitespace","JsonParser","Parser","sp","postProcess","leftover","converters","parser","placeholder","matchPattern","number","stringLiteral","readStringLiteral","$1","matchString","pair","getKeyValuePair","key","valueToken","read","Mapping","Mapping__proto__","joinKey","createMapping","boundFragment","a","Option__proto__","selectedAttribute","yielder","r","tx","refName","partialFromValue","createFragment","initMacro","dirtyTemplate","externalChange","refreshAttrs","_attrs","handle","fnTemplate","getPartialTemplate","unbindAttrs","_cssDef","applied","applyCSS","aliases","dirtyAttrs","invalidate","extras","findDelegate","iterations","keyRef","pendingNewIndices","previousIterations","RepeatedFragment__proto__","createIteration","split","bubbled","z","iteration","newIndex","oldIndex","updatePostShuffle","toRemove","oldKeys","wasArray","newLength","indices","oldLen","removed","contiguous","startIndex","l","noThrow","id","getElementById","isParsed","getParseOptions","parseOptions","reduce","throwNoParse","TEMPLATE_INSTRUCTIONS","addFunctions","parseFor","functions","templateConfigurator","Parent","parseTemplate","TEMPLATE_VERSION","getDynamicTemplate","_config","p","extendPartials","resetValue","registryNames","registriesOnDefaults","Registry","useDefaults","Registry__proto__","configure","registry","changed","isOwner","registries","putInDefaults","custom","adapt","adaptConfigurator","css","cssConfigurator","dataConfigurator","defaultKeys","isStandardKey","makeObj","isBlacklisted","order","config","Child","c","_super","Item__proto__","ContainerItem__proto__","ComputationChild","Model","isReadonly","root","syncComputedChildren","prototypeAccessors$1","setRoot","ComputationChild__proto__","applyValue","dependencies","mark","shouldCapture","parentValue","newWrapperValue","unwrap","boundValue","links","marked","deps","childByKey","Computation","signature","isExpression","setter","computationContext","prototypeAccessors$2","Computation__proto__","old","active","isEqual","notifyUpstream","maybeBind","shouldBind","startCapturing","getter","message","hasConsole","console","groupCollapsed","sig","error","getterUseStack","stack","groupEnd","stopCapturing","setDependencies","computations","ExpressionProxy","getFunction","resolveReference","ExpressionProxy__proto__","actuallyChanged","keypath","d","idx","retrieve","dep","computation","ReferenceExpressionChild","ReferenceExpressionChild__proto__","joinAll","missing","ReferenceExpressionProxy","intermediary","members","addShuffleTask","REFERENCE","ReferenceExpressionProxy__proto__","String","unregisterTwowayBinding","registerTwowayBinding","keypathModel","bindings","oneway","findBoundValue","unsafe","shuffling","Alias__proto__","resolveAliases","camelCaseStr","space","textTypes","accept-charset","accesskey","bgcolor","class","codebase","colspan","contenteditable","datetime","dirname","for","http-equiv","ismap","maxlength","novalidate","pubdate","readonly","rowspan","tabindex","usemap","div","ConditionalAttribute__proto__","isSvg","parseAttributes","notIn","updateDelegate","Attribute__proto__","booleanAttributes","namespaces","useProperty","isTwoway","isBoolean","lookupNamespace","getUpdateDelegate","twowayBinding","flag","bubbler","BindingFlag__proto__","createComment","teardownHook","destructHook","RactiveModel","SharedModel","RactiveModel__proto__","isLink","_cssModel","initLink","RootModel","RootModel__proto__","attached","attachImplicits","compute","createLink","targetPath","detachImplicits","virtual","getVirtual","objectKeys","getRactiveModel","ractiveModel","getValueChildren","_link","has","unescapedKey","Function","GlobalModel","shouldTeardown","constructHook","uid","ComponentConstructor","isAnchor","content","_partials","addChild","construct","mappings","_inlinePartials","eventHandlers","Component__proto__","initialise","getRactiveContext","checking","checkAnchors","callRender","unrenderItem","missingDecorator","Decorator__proto__","warnOnce","teardownArgsFn","Doctype__proto__","parentForm","Binding__proto__","CheckboxBinding","CheckboxBinding__proto__","BindingGroup","BindingGroup__proto__","CheckboxNameBinding","checkboxName","noInitialValue","existingValue","bindingValue","isChecked","elapsed","now","eased","Ticker__proto__","stop","abort","running","prefixers","ModelBase","ticker","Model__proto__","rewrap","createBranch","adaptor","wrap","getPrefixer","__model","from","fulfilPromise","notify","isObjectLike","branch","KeypathModel","lastLink","force","markForce","merge","oldArray","newArray","recreateArray","oldLength","usedIndices","firstUnusedIndex","SharedModel__proto__","SharedModel$1","global","window","ContextModel","FakeFragment","star","deepOpts","comparators","errorMessage","initStars","bubbleStars","method","arg","attachHook","detachHook","INVERTED","CLOSING","DELIMCHANGE","CLOSING_TAG","INLINE_PARTIAL","NUMBER_LITERAL","STRING_LITERAL","ARRAY_LITERAL","OBJECT_LITERAL","BOOLEAN_LITERAL","REGEXP_LITERAL","GLOBAL","KEY_VALUE_PAIR","REFINEMENT","MEMBER","PREFIX_OPERATOR","BRACKETED","CONDITIONAL","INFIX_OPERATOR","INVOCATION","ELSE","ELSEIF","arrayProto","methodName","mdl","getNewIndices","updateHook","modelPush","modelPop","modelShift","modelUnshift","modelSort","modelSplice","modelReverse","ContextData","ContextData__proto__","prototypeAccessors","_data","Context__proto__","num","isObjectType","build","findModel","protoAnimate","getParent","hasListener","findEvent","dest","there","here","listen","raise","ev","drop","unlisten","protoUpdate","cascade","updateFromBindings","isBound","getBindingModel","getBindingPath","getBinding","setBinding","forRactive","methodNames","unprefixed","prefixed","j","makeFunction","query","mathml","xlink","xml","xmlns","ns","createElementNS","substring","cloneNode","insertHook","Observer","oldContext","oldFn","dispatch","updateOld","Observer__proto__","cancelled","resolver","_observers","newValue","oldValue","strict","addObserver","defer","PatternObserver","baseModel","pattern","baseKeypath","recursive","oldValues","newValues","findMatches","registerPatternObserver","PatternObserver__proto__","unregisterPatternObserver","wildcards","touchedFrom","count","ok","check","ArrayObserver","pending","sliced","ArrayObserver__proto__","negativeOne","inserted","deleted","hadIndex","onceOptions","trim","notEmptyString","PREFIX","styleDefinitions","isDirty","styleElement","useCssText","combine","ensureArray","cleanCss","additionalReplaceRules","reconstruct","selectorsPattern","keyframesDeclarationPattern","selectorUnitPattern","excludePattern","dataRvcGuidPattern","CSSModel__proto__","downstreamChanged","depth","applyChanges","hasCurly","_cssIds","gatherIds","initCSS","_r_unbound","leadingWhitespace","ParseError","lineStart","lines","lineEnds","line","lineEnd","remaining","getContextMessage","getLinePos","lineNum","columnNum","contextLines","contextUp","contextDown","numTabs","annotation","char","msg","character","shortMessage","nextChar","charAt","readTypeOf","delimiterChangePattern","whitespacePattern","regexpPattern","regExpCache","getLowestIndex","haystack","needles","search","escapeRegExp","htmlEntities","quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","acirc","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","OElig","oelig","Scaron","scaron","Yuml","fnof","circ","tilde","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigmaf","sigma","tau","upsilon","phi","chi","psi","omega","thetasym","upsih","piv","ensp","emsp","thinsp","zwnj","zwj","lrm","rlm","ndash","mdash","lsquo","rsquo","sbquo","ldquo","rdquo","bdquo","dagger","Dagger","bull","hellip","permil","prime","Prime","lsaquo","rsaquo","oline","frasl","euro","image","weierp","real","trade","alefsym","larr","uarr","rarr","darr","harr","crarr","lArr","uArr","rArr","dArr","hArr","forall","part","exist","empty","nabla","isin","notin","ni","prod","sum","minus","lowast","radic","infin","ang","and","or","cap","cup","int","there4","sim","cong","asymp","ne","equiv","le","ge","sub","sup","nsub","sube","supe","oplus","otimes","perp","sdot","lceil","rceil","lfloor","rfloor","lang","rang","loz","spades","clubs","hearts","diams","controlCharacters","entityPattern","codePointSupport","fromCodePoint","codeToChar","fromCharCode","lessThan","greaterThan","invalid","expectedExpression","expectedParen","stringMiddlePattern","escapeSequencePattern","lineContinuationPattern","makeQuotedStringMatcher","okQuote","literal","done","charCodeAt","JSON","singleMatcher","doubleMatcher","quote","escapes","spreadPattern","legalReference","relaxedName","identifier","readObjectLiteral","keyValuePairs","readKeyValuePairs","readArrayLiteral","expressionList","readExpressionList","globals","keywords","prefixPattern","readPrimary","readLiteral","readReference","readBracketedExpression","readMemberOrInvocation","expression","refinement","readRefinement","makePrefixSequenceMatcher","symbol","fallthrough","readExpression","matcher","prefixOperators","readLogicalOr","readTypeof","makeInfixSequenceMatcher","inUnquotedAttribute","left","right","infixOperators","readLogicalOr$1","attributeNamePattern","onPattern","eventPattern","reservedEventNames","decoratorPattern","transitionPattern","boundPattern","directives","no-delegation","unquotedAttributeValueTextPattern","proxyEvent","whitespace","slashes","delimiterChangeToken","exclude","legalAlias","asRE","elsePattern","handlebarsBlockCodes","each","if","with","unless","indexRefPattern","keyIndexRefPattern","handlebarsBlockPattern","OPEN_COMMENT","CLOSE_COMMENT","leadingLinebreak","trailingLinebreak","stripStandalones","backOne","backTwo","lastSectionItem","isComment","isSection","lastItem","trimWhitespace","leadingPattern","trailingPattern","contiguousWhitespace","preserveWhitespaceElements","trailingWhitespace","leadingNewLine","trailingNewLine","closingTagPattern","tagNamePattern","anchorPattern","validTagNameFollower","disallowedContents","li","dt","dd","rt","rp","optgroup","thead","tbody","tfoot","tr","td","th","partialDefinitionSectionPattern","STANDARD_READERS","readPartial","readUnescaped","readSection","readInterpolator","readMustacheComment","TRIPLE_READERS","readTriple","READERS","readMustache","readHtmlComment","readElement","readText","PARTIAL_READERS","readPartialDefinitionSection","defaultInterpolate","StandardParser","tripleDelimiters","staticDelimiters","staticTripleDelimiters","standardDelimiters","delimiters","tags","isTriple","open","close","readers","sortMustacheTags","sectionDepth","elementStack","sanitize","elements","eventAttributes","stripComments","preserveWhitespace","sanitizeElements","sanitizeEventAttributes","includeLinePositions","textOnlyMode","csp","inTag","cleanup","expr","insertExpressions","readTemplate","b","COMPUTATION_INSTRUCTIONS","fromId","text","splitText","createTextNode","readKey","childData","mapping","getPartialFromRegistry","fillGaps","findParentPartial","findInstance","noRegistryFunctionReturn","findOwner","findConstructor","tpl","self","contextifyTemplate","okToParse","parsePartial","setTemplate","initing","aliasLocal","findFirstNode","hasIndexRef","section","getComponentConstructor","asyncProxy","cmp","ctor","guid","counter","placeholderId","newModel","hookQueue","childQueue","userOptions","subscribe","getElement","append","logIfDebug","cssId","__ractive_instances__","torndown","Ractive$render","others","Ractive$reset","rerender","changes","Ractive$resetTemplate","external","Ractive$set","isolated","Ractive$subtract","Ractive$toggle","TypeError","badArguments","gather","Ractive$toCSS","uniqueCssIds","ids","Ractive$toHTML","Ractive$transition","HTMLElement","Ractive$unrender","Ractive$updateModel","object","extendOne","Class","Target","_on","toPairs","_observe","optional","required","computed","splitKeypathI","sourcesLength","sources","nextSource","nextKey","hasOwnProperty","thisArg","arrayLength","Node","contains","performance","nowOffset","Date","PENDING","FULFILLED","REJECTED","dispatchHandlers","fulfilledHandlers","rejectedHandlers","state","makeResolver","newState","makeDispatcher","wait","fulfill","reject","onFulfilled","onRejected","promise2","processResolutionHandler","handlers","forward","p1result","catch","all","promises","processPromise","reason","called","resolvePromise","y","rejectPromise","requestAnimationFrame","cancelAnimationFrame","lastTime","currentTime","timeToNextCall","Math","log","printWarning","welcome","resolveInstanceMembers","warnAboutAmbiguity","noIntro","noOutro","nestedTransitions","noCssTransform","easeIn","pow","easeOut","easeInOut","implementation","hasFeature","alreadyWarned","welcomeIntro","welcomeMessage","WELCOME_MESSAGE","hasGroup","captureGroup","intermediate","min","properties","loop","refPattern","splitPattern","escapeKeyPattern","unescapeKeyPattern","KeyModel","isKey","KeyModel__proto__","relinking","dependant","registerLink","unregisterLink","reference","isKeypath","KeypathModel__proto__","getChild","rebindChildren","fnBind","shuffleTasks","early","registerQueue","keyModels","patternObservers","ModelBase__proto__","task","stage","existingMatches","getKeyModel","skip","startPath","notifiedUpstream","observer","Missing","shufle","LinkModel","sourcePath","LinkModel__proto__","isDetached","markedAll","rootLink","relinked","lnk","implicit","fireShuffleTasks","ln","TransitionManager","intros","outros","totalChildren","outroChildren","detachQueue","outrosComplete","TransitionManager__proto__","list","decrementOutros","decrementTotal","detachNodes","_detachNodes","ready","detachImmediate","batch","previousBatch","transitionManager","fragments","tasks","immediateObservers","deferredObservers","flushChanges","thing","postRender","_batch","tickers","tick","ifTrue","ifFalse","readConditional","spread","isSpread","expressions","readExpressionOrReference","expectedFollowers","flattenExpression","getVars","vars","stringify","hasSpread","makeSpread","stringifyPair","out","extractRefs","stringified","refineExpression","mustache","referenceExpression","getReferenceExpression","rx","splitEvent","readAttribute","nearest","readAttributeValue","valueStart","startDepth","readQuotedAttributeValue","readUnquotedAttributeValue","readUnquotedAttributeValueToken","tokens","token","quoteMark","readQuotedStringToken","readAttributeOrDirective","readArguments","inEvent","readProxyEvent","single","spreadArgs","inside","readMustacheOfType","tag","reader","readDelimiterChange","rewind","readRegexpLiteral","triple","readAliases","alias","readAlias","relaxedNames","strictRefinement","readComment","readClosing","closing","readElse","readElseIf","hasElse","block","unlessBlock","closed","expectedClose","aliasOnly","extra","endIndex","comment","removeLeadingWhitespace","removeTrailingWhitespace","previousItem","nextItem","preserveWhitespaceInsideFragment","removeLeadingWhitespaceInsideFragment","removeTrailingWhitespaceInsideFragment","isPreserveWhitespaceElement","readClosingTag","selfClosing","hasPartials","closingTag","lowerCaseName","canContain","closingTagName","readAnchorClose","implicitCloseCase","some","disallowed","barrier","addTo","hasChildren","fromExpression","instructions","createFunction","body","createFunctionFromString","bindTo","fromComputationString","exp","parseAsString","validate","existingPartials","newPartials","overwrite","superMethod","getSuperMethod","_parent","hasSuper","oldSuper","_method","getMessage","deprecated","correct","isError","deprecateOption","deprecatedOption","deprecate","extendOtherMethods","member","RactiveProto","wrapPrototype","readStyle","rule","rules","readClass","updateMultipleSelectValue","updateSelectValue","updateStringValue","updateContentEditableValue","updateRadioValue","updateValue","updateRadioName","updateCheckboxName","updateStyleAttribute","updateInlineStyle","updateClassName","updateInlineClass","updateBoolean","updateNamespacedAttribute","updateAttribute","wasSelected","wasChecked","valueAttribute","prev","setProperty","getPropertyValue","last","className","baseVal","getAttributeNS","removeAttributeNS","setAttributeNS","needle","qualified","hasAttribute","Ractive$teardown","getPromise","getComputationSignature","getterString","setterString","subs","initialiseProperties","handleAttributes","_attributePartial","getAdaptors","protoAdapt","lookup","srcs","_subs","_nsSubs","_eventQueue","_children","byName","mapAll","meta","nameOption","renderItem","nextNode","lastBound","updateAnchors","res","isBindableByValue","isBindableByContentEditable","isContentEditable","isBindableByName","isBindableByChecked","nameAttr","currentTarget","endEl","correspondingUseElement","pairs","isFinite","format","registryName","interpol","arrays","arrayLike","upstream","parts","findAlias","tm","notifiedTotal","manager","trans","collectAllOutros","_list","prefixKeypath","rootKeypath","rootDot","relativeKeypath","initialFragment","explicitContext","badReference","repeater","shouldWarn","_fakeFragment","deep","deepSet","getComparator","sets","Ractive$add","immediate","getOptions","Ractive$animate","enqueue","dequeue","variants","eventNames","fireEventAs","initialFire","notifySubscribers","fullName","subscribers","originalEvent","stopEvent","findAnchors","findAnchorsIn","anchors","idxs","unrenderChild","prepend","insertAt","@this.parent","@this.root","Ractive$detach","Ractive$find","remote","Ractive$findAll","Ractive$findAllComponents","Ractive$findComponent","Ractive$findContainer","Ractive$findParent","orComponent","spliceArguments","getSpliceEquivalent","balance","removeStart","removeEnd","Ractive$update","Ractive$fire","Ractive$get","instances","staticContext","staticInfo","output","Ractive$insert","fireInsertHook","src","isUpstream","fresh","vals","olds","observers","silent","caller","keypaths","createObserver","isSilenced","silence","resume","wildcardIndex","double","Ractive$off","entry","Ractive$on","Ractive$once","listener","canonical","addCSS","styleDefinition","styleSheet","cssText","filteredStyleDefinitions","getElementsByTagName","extractString","unit","transformSelector","selectorUnits","modifiers","transformed","appended","prepended","transformCss","dataAttr","selectors","s4","floor","random","uuid","setCSSData","local","recomputeCSS","def","_css","evalCSS","transform","transformCSS","__proto__","emptyData","childValue","parentIsFn","childIsFn","callDataFunction","fromProperties","primary","secondary","hasThis","functionBody","opening","readNumberLiteral","entity","code","parseInt","validateCode","readBooleanLiteral","escapeChar","readTemplateStringLiteral","namePattern","readKeyValuePair","refKey","lastDotIndex","startPos","actual","lastIndexOf","refLength","getConditional"],"mappings":"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"}