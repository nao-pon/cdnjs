{"version":3,"file":"react-popper.umd.js","sources":["../src/index.js"],"sourcesContent":["// @flow\nimport { Component, type Node } from 'react';\nimport PopperJS from 'popper.js';\n\ntype PopperInstance = {\n  destroy: () => void,\n};\n\ntype Placement =\n  | 'auto-start'\n  | 'auto'\n  | 'auto-end'\n  | 'top-start'\n  | 'top'\n  | 'top-end'\n  | 'right-start'\n  | 'right'\n  | 'right-end'\n  | 'bottom-end'\n  | 'bottom'\n  | 'bottom-start'\n  | 'left-end'\n  | 'left'\n  | 'left-start';\n\ntype getRefFn = (?HTMLElement) => void;\ntype Style = { [string]: string | number };\n\ntype RenderProp = ({|\n  referenceProps: {\n    getRef: getRefFn,\n  },\n  popperProps: {\n    getRef: getRefFn,\n    style: Style,\n    placement: ?Placement,\n  },\n  arrowProps: {\n    getRef: getRefFn,\n    style: Style,\n    placement: ?Placement,\n  },\n|}) => Node;\n\ntype PopperProps = {\n  modifiers?: {\n    [string]: { order: number, enabled: boolean, fn: Object => Object },\n  },\n  placement?: Placement,\n  eventsEnabled?: boolean,\n  referenceElement?: {\n    +getBoundingClientRect: () => {\n      width: number,\n      height: number,\n      top: number,\n      right: number,\n      bottom: number,\n      left: number,\n    },\n    +clientWidth: number,\n    +clientHeight: number,\n  },\n  children: RenderProp,\n};\n\ntype PopperState = {\n  referenceNode: ?HTMLElement,\n  popperNode: ?HTMLElement,\n  arrowNode: ?HTMLElement,\n  popperInstance: ?PopperInstance,\n  data: ?Object,\n};\n\nconst initialStyle = {\n  position: 'absolute',\n  opacity: 0,\n  pointerEvents: 'none',\n};\n\nconst initialArrowStyle = {};\n\nexport default class Popper extends Component<PopperProps, PopperState> {\n  static defaultProps = {\n    placement: 'bottom',\n    eventsEnabled: true,\n    referenceElement: undefined,\n  };\n\n  state = {\n    referenceNode: undefined,\n    popperNode: undefined,\n    arrowNode: undefined,\n    popperInstance: undefined,\n    data: undefined,\n  };\n\n  setReferenceNode = (referenceNode: ?HTMLElement) =>\n    this.setState({ referenceNode });\n  setPopperNode = (popperNode: ?HTMLElement) => this.setState({ popperNode });\n  setArrowNode = (arrowNode: ?HTMLElement) => this.setState({ arrowNode });\n\n  updateStateModifier = {\n    enabled: true,\n    order: 900,\n    fn: (data: Object) => {\n      this.setState({ data });\n      return data;\n    },\n  };\n\n  getOptions = () => ({\n    placement: this.props.placement,\n    eventsEnabled: this.props.eventsEnabled,\n    modifiers: {\n      ...this.props.modifiers,\n      arrow: {\n        enabled: !!this.state.arrowNode,\n        element: this.state.arrowNode,\n      },\n      applyStyle: { enabled: false },\n      updateStateModifier: this.updateStateModifier,\n    },\n  });\n\n  getPopperStyle = () =>\n    !this.state.popperNode || !this.state.data\n      ? initialStyle\n      : {\n          position: this.state.data.offsets.popper.position,\n          ...this.state.data.styles,\n        };\n\n  getPopperPlacement = () =>\n    !this.state.data ? undefined : this.state.data.placement;\n\n  getArrowStyle = () =>\n    !this.state.arrowNode || !this.state.data\n      ? initialArrowStyle\n      : this.state.data.arrowStyles;\n\n  initPopperInstance = () => {\n    const { referenceElement } = this.props;\n    const { referenceNode, popperNode, popperInstance } = this.state;\n    const reference = referenceElement || referenceNode;\n    if (reference && popperNode && !popperInstance) {\n      const popperInstance = new PopperJS(\n        reference,\n        popperNode,\n        this.getOptions()\n      );\n      this.setState({ popperInstance });\n      return true;\n    }\n    return false;\n  };\n\n  destroyPopperInstance = (callback: () => boolean) => {\n    if (this.state.popperInstance) {\n      this.state.popperInstance.destroy();\n    }\n    this.setState({ popperInstance: undefined }, callback);\n  };\n\n  updatePopperInstance = () => {\n    if (this.state.popperInstance) {\n      this.destroyPopperInstance(() => this.initPopperInstance());\n    }\n  };\n\n  componentDidUpdate(prevProps: PopperProps, prevState: PopperState) {\n    // If needed, initialize the Popper.js instance\n    // it will return `true` if it initialized a new instance, or `false` otherwise\n    // if it returns `false`, we make sure Popper props haven't changed, and update\n    // the Popper.js instance if needed\n    if (!this.initPopperInstance()) {\n      // If the Popper.js options have changed, update the instance (destroy + create)\n      if (\n        this.props.placement !== prevProps.placement ||\n        this.props.eventsEnabled !== prevProps.eventsEnabled ||\n        this.state.referenceNode !== prevState.referenceNode ||\n        this.state.arrowNode !== prevState.arrowNode ||\n        this.state.popperNode !== prevState.popperNode ||\n        this.props.referenceElement !== prevProps.referenceElement\n      ) {\n        this.updatePopperInstance();\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.state.popperInstance) {\n      this.state.popperInstance.destroy();\n    }\n  }\n\n  render() {\n    return this.props.children({\n      referenceProps: {\n        getRef: this.setReferenceNode,\n      },\n      popperProps: {\n        getRef: this.setPopperNode,\n        style: this.getPopperStyle(),\n        placement: this.getPopperPlacement(),\n      },\n      arrowProps: {\n        getRef: this.setArrowNode,\n        style: this.getArrowStyle(),\n        placement: this.getPopperPlacement(),\n      },\n    });\n  }\n}\n\nconst placements = PopperJS.placements;\nexport { placements };\n"],"names":["initialStyle","position","opacity","pointerEvents","initialArrowStyle","Popper","state","referenceNode","undefined","popperNode","arrowNode","popperInstance","data","setReferenceNode","setState","setPopperNode","setArrowNode","updateStateModifier","enabled","order","fn","getOptions","placement","props","eventsEnabled","modifiers","arrow","element","applyStyle","getPopperStyle","offsets","popper","styles","getPopperPlacement","getArrowStyle","arrowStyles","initPopperInstance","referenceElement","reference","PopperJS","destroyPopperInstance","callback","destroy","updatePopperInstance","prevProps","prevState","children","referenceProps","getRef","popperProps","style","arrowProps","Component","defaultProps","placements"],"mappings":"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"}