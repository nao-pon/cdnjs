!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.JSData=t():e.JSData=t()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}return r.m=e,r.c=t,r.p="",r(0)}([function(e,t,r){"use strict";var n=a(r(1)),i=a(r(2)),o=a(r(3));function a(e){return e&&e.__esModule?e:{default:e}}e.exports={DS:n.default,DSUtils:i.default,DSErrors:o.default,createStore:function(e){return new n.default(e)},version:{full:"2.10.1",major:parseInt("2",10),minor:parseInt("10",10),patch:parseInt("1",10),alpha:"false",beta:"false"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=f(r(2)),a=f(r(3)),u=f(r(41)),s=f(r(47));function f(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t,r){r(null,t)}function d(e,t){return t}var p=function(){function e(){l(this,e)}return i(e,[{key:"errorFn",value:function(e,t){if(this.error&&"function"==typeof this.error){try{throw"string"==typeof e?new Error(e):e}catch(t){e=t}this.error(this.name||null,e||null,t||null)}}}]),e}(),h=p.prototype;h.actions={},h.afterCreate=c,h.afterCreateCollection=d,h.afterCreateInstance=d,h.afterDestroy=c,h.afterEject=d,h.afterFind=c,h.afterFindAll=c,h.afterInject=d,h.afterLoadRelations=c,h.afterReap=d,h.afterUpdate=c,h.afterValidate=c,h.allowSimpleWhere=!0,h.applyDefaultsOnInject=!1,h.basePath="",h.beforeCreate=c,h.beforeCreateCollection=d,h.beforeCreateInstance=d,h.beforeDestroy=c,h.beforeEject=d,h.beforeInject=d,h.beforeReap=d,h.beforeUpdate=c,h.beforeValidate=c,h.bypassCache=!1,h.cacheResponse=!!o.default.w,h.csp=!1,h.clearEmptyQueries=!0,h.computed={},h.defaultAdapter="http",h.debug=!1,h.defaultValues={},h.eagerEject=!1,h.eagerInject=!1,h.endpoint="",h.error=!!console&&function(e,t,r){return console["function"==typeof console.error?"error":"log"](e,t,r)},h.errorHandler=function(){return o.default.Promise.reject(arguments.length<=0?void 0:arguments[0])},h.fallbackAdapters=["http"],h.findStrictCache=!1,h.idAttribute="id",h.ignoredChanges=[/\$/],h.instanceEvents=!!o.default.w,h.keepChangeHistory=!1,h.linkRelations=!!o.default.w,h.log=!!console&&function(e,t,r,n,i){return console["function"==typeof console.info?"info":"log"](e,t,r,n,i)},h.logFn=function(e,t,r,n){var i=this;i.debug&&i.log&&"function"==typeof i.log&&i.log(i.name||null,e||null,t||null,r||null,n||null)},h.maxAge=!1,h.methods={},h.notify=!!o.default.w,h.omit=[],h.onConflict="merge",h.reapAction=o.default.w?"inject":"none",h.reapInterval=!!o.default.w&&3e4,h.relationsEnumerable=!1,h.resetHistoryOnInject=!0,h.returnMeta=!1,h.scopes={},h.strategy="single",h.upsert=!!o.default.w,h.useClass=!0,h.useFilter=!1,h.usePendingFind=!0,h.usePendingFindAll=!0,h.validate=c,h.watchChanges=!!o.default.w;var v=/([.*+?^=!:${}()|[\]\/\\])/g,g=/%/g,m=/_/g;function y(e,t){return new RegExp("^"+(r=e,r.replace(v,"\\$1")).replace(g,".*").replace(m,".")+"$",t);var r}h.defaultFilter=function(e,t,r,i){var u=this.definitions[t],s="id",f=void 0;u&&(s=u.idAttribute,f=this.store[t]);var l=e,c=null,d={skip:"",offset:"",where:"",limit:"",orderBy:"",sort:""};r=r||{},i=i||{},c=o.default._o(r.where)?r.where:{},i.allowSimpleWhere&&o.default.forOwn(r,function(e,t){t in d||t in c||(c[t]={"==":e})}),o.default.isEmpty(c)&&(c=null),c?l=o.default.filter(l,function(e){var t=!0,r=!0;return!(i.excludeTemporary&&f&&f.temporaryItems[e[s]])&&(o.default.forOwn(c,function(n,i){o.default._o(n)||(n={"==":n}),o.default.forOwn(n,function(n,a){var u=void 0,s="|"===a[0],f=o.default.get(e,i);"=="===(a=s?a.substr(1):a)?u=f==n:"==="===a?u=f===n:"!="===a?u=f!=n:"!=="===a?u=f!==n:">"===a?u=f>n:">="===a?u=f>=n:"<"===a?u=f<n:"<="===a?u=f<=n:"isectEmpty"===a?u=!o.default.intersection(f||[],n||[]).length:"isectNotEmpty"===a?u=o.default.intersection(f||[],n||[]).length:"in"===a?u=o.default._s(n)?-1!==n.indexOf(f):o.default.contains(n,f):"notIn"===a?u=o.default._s(n)?-1===n.indexOf(f):!o.default.contains(n,f):0===a.indexOf("like")?u=null!==y(n,a.substr(4)).exec(f):0===a.indexOf("notLike")?u=null===y(n,a.substr(7)).exec(f):"contains"===a?u=o.default._s(f)?-1!==f.indexOf(n):o.default.contains(f,n):"notContains"===a&&(u=o.default._s(f)?-1===f.indexOf(n):!o.default.contains(f,n)),void 0!==u&&(r=t?u:s?r||u:r&&u),t=!1})}),r)}):i.excludeTemporary&&f&&(l=o.default.filter(l,function(e){return f.temporaryItems[e[s]]}));var p=null;if(o.default._s(r.orderBy)?p=[[r.orderBy,"ASC"]]:o.default._a(r.orderBy)&&(p=r.orderBy),!p&&o.default._s(r.sort)?p=[[r.sort,"ASC"]]:!p&&o.default._a(r.sort)&&(p=r.sort),p){o.default.forEach(p,function(e,r){if(o.default._s(e))p[r]=[e,"ASC"];else if(!o.default._a(e))throw new a.default.IA('DS.filter("'+t+'"[, params][, options]): '+o.default.toJson(e)+": Must be a string or an array!",{params:{"orderBy[i]":{actual:void 0===e?"undefined":n(e),expected:"string|array"}}})}),l=o.default.sort(l,function(e,t){return function e(t,r,n,i){var a=t[r],u=o.default.get(n,a[0]),s=o.default.get(i,a[0]);return o.default._s(u)&&(u=o.default.upperCase(u)),o.default._s(s)&&(s=o.default.upperCase(s)),"DESC"===a[1]?s<u?-1:s>u?1:r<t.length-1?e(t,r+1,n,i):0:u<s?-1:u>s?1:r<t.length-1?e(t,r+1,n,i):0}(p,0,e,t)})}var h=o.default._n(r.limit)?r.limit:null,v=null;return o.default._n(r.skip)?v=r.skip:o.default._n(r.offset)&&(v=r.offset),h&&v?l=o.default.slice(l,v,Math.min(l.length,v+h)):o.default._n(h)?l=o.default.slice(l,0,Math.min(l.length,h)):o.default._n(v)&&(l=v<l.length?o.default.slice(l,v):[]),l===e?l.slice():l};var b=function(){function e(t){l(this,e);var r=this;t=t||{},r.store={},r.definitions={},r.adapters={},r.defaults=new p,r.observe=o.default.observe,o.default.forOwn(t,function(e,t){"omit"===t?r.defaults.omit=e.concat(p.prototype.omit):r.defaults[t]=e}),r.defaults.logFn("new data store created",r.defaults);var n=o.default.Promise;n&&!n.prototype.spread&&(n.prototype.spread=function(e){return this.then(function(t){return e.apply(this,t)})}),o.default.Events(r)}return i(e,[{key:"getAdapterName",value:function(e){var t=!1;if(e=e||{},this.defaults.logFn("getAdapterName",e),o.default._s(e)&&(t=!0,e={adapter:e}),this.adapters[e.adapter])return e.adapter;if(t)throw new Error(e.adapter+" is not a registered adapter!");return e.defaultAdapter}},{key:"getAdapter",value:function(e){return e=e||{},this.defaults.logFn("getAdapter",e),this.adapters[this.getAdapterName(e)]}},{key:"registerAdapter",value:function(e,t,r){var n=this;r=r||{},n.defaults.logFn("registerAdapter",e,t,r),o.default.isFunction(t)?n.adapters[e]=new t(r):n.adapters[e]=t,r.default&&(n.defaults.defaultAdapter=e),n.defaults.logFn("default adapter is "+n.defaults.defaultAdapter)}},{key:"is",value:function(e,t){var r=this.definitions[e];if(!r)throw new a.default.NER(e);return t instanceof r[r.class]}},{key:"clear",value:function(){var e=this,t={};return o.default.forOwn(this.definitions,function(r){var n=r.name;t[n]=r.ejectAll(),e.store[n].completedQueries={},e.store[n].queryData={}}),t}},{key:"errorFn",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[t.length-1],i=this.defaults.errorHandler,o=n?n.errorHandler:i;return o=o||i,function(e){return o.apply(void 0,[e].concat(t))}}}]),e}(),_=b.prototype;function w(e,t){o.default.forOwn(t,function(t,r){e[r]=t,e[r].before=function(t){var n=e[r];e[r]=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return n.apply(this,t.apply(this,r)||r)}}})}_.getAdapterName.shorthand=!1,_.getAdapter.shorthand=!1,_.registerAdapter.shorthand=!1,_.errors=a.default,_.utils=o.default,w(_,u.default),w(_,s.default),t.default=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(3),a=(n=o)&&n.__esModule?n:{default:n};var u=r(4),s=r(5),f=r(6),l=r(7),c=r(10),d=r(12),p=r(14),h=r(21),v=r(22),g=r(23),m=r(24),y=r(19),b=r(25),_=r(27),w=r(29),A=r(30),x=void 0,j=void 0,E=void 0,O=Object.prototype.toString;try{j=Promise}catch(e){console.error("js-data requires a global Promise constructor!")}try{E=window.File}catch(e){E=function(){}}var F=Array.isArray||function(e){return"[object Array]"===O.call(e)||!1};function C(e){return"[object RegExp]"===O.call(e)||!1}function D(e){return"string"==typeof e||e&&"object"===(void 0===e?"undefined":i(e))&&"[object String]"===O.call(e)||!1}function S(e){return"[object Object]"===O.call(e)||!1}function I(e){return e&&"object"===(void 0===e?"undefined":i(e))&&"[object Date]"===O.call(e)||!1}function R(e){var t=void 0===e?"undefined":i(e);return"number"===t||e&&"object"===t&&"[object Number]"===O.call(e)||!1}function k(e){return"function"==typeof e||e&&"[object Function]"===O.call(e)||!1}function P(e,t,r){var n=[];return s(e,function(e,r,i){t(e,r,i)&&n.push(e)},r),n}try{x=window,x={}}catch(e){x=null}var N=["beforeValidate","validate","afterValidate","beforeCreate","afterCreate","beforeUpdate","afterUpdate","beforeDestroy","afterDestroy"],T=w.isBlacklisted;function M(e,t,r,n,i){if(t){if(e===t)throw new Error("Cannot copy! Source and destination are identical.");if(r=r||[],n=n||[],S(e)){var o=r.indexOf(e);if(-1!==o)return n[o];r.push(e),n.push(t)}var a=void 0;if(F(e)){var u=void 0;for(t.length=0,u=0;u<e.length;u++)a=M(e[u],null,r,n,i),S(e[u])&&(r.push(e[u]),n.push(a)),t.push(a)}else for(var f in F(t)?t.length=0:s(t,function(e,r){delete t[r]}),e)if(e.hasOwnProperty(f)){if(T(f,i))continue;a=M(e[f],null,r,n,i),S(e[f])&&(r.push(e[f]),n.push(a)),t[f]=a}}else t=e,e&&(F(e)?t=M(e,[],r,n,i):I(e)?t=new Date(e.getTime()):C(e)?(t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0])).lastIndex=e.lastIndex:S(e)&&(t=M(e,Object.create(Object.getPrototypeOf(e)),r,n,i)));return t}function H(e){return null!=e&&""!==e}t.default={Promise:j,_:function(e,t){var r=this;if(e=e||{},(t=t||{})&&t.constructor===e.constructor)return t;if(!S(t))throw new a.default.IA('"options" must be an object!');s(N,function(e){"function"==typeof t[e]&&-1===t[e].toString().indexOf("for (var _len3 = arg")&&(t[e]=r.promisify(t[e]))});var n=function(e){var t=this;l(e,function(e,r){t[r]=e})};return(n.prototype=e).orig=function(){var e={};return l(this,function(t,r){e[r]=t}),e},new n(t)},_n:R,_s:D,_sn:function(e){return D(e)||R(e)},_snErr:function(e){return new a.default.IA('"'+e+'" must be a string or a number!')},_o:S,_oErr:function(e){return new a.default.IA('"'+e+'" must be an object!')},_a:F,_aErr:function(e){return new a.default.IA('"'+e+'" must be an array!')},applyScope:function(e,t,r){var n=r.scope,i=M(t);n?D(n)&&(n=[n]):n=[],n.unshift("defaultScope"),s(n,function(n){var i=r.scopes[n];"function"==typeof i?d(t,i(e)):i&&d(t,i)}),d(t,i)},compute:function(e,t){var r=this,n=[];S(e)||(s(e.deps,function(e){n.push(b(r,e))}),_(r,t,e[e.length-1].apply(r,n)))},contains:c,copy:M,deepMixIn:d,diffObjectFromOldObject:w.diffObjectFromOldObject,BinaryHeap:u,equals:function e(t,r){if(t===r)return!0;if(null===t||null===r)return!1;if(t!=t&&r!=r)return!0;var n,o,a,u=void 0===t?"undefined":i(t);if(u==(void 0===r?"undefined":i(r))&&"object"==u){if(!F(t)){if(I(t))return!!I(r)&&e(t.getTime(),r.getTime());if(C(t)&&C(r))return t.toString()==r.toString();if(F(r))return!1;for(o in a={},t)if("$"!==o.charAt(0)&&!k(t[o])){if(!e(t[o],r[o]))return!1;a[o]=!0}for(o in r)if(!a.hasOwnProperty(o)&&"$"!==o.charAt(0)&&void 0!==r[o]&&!k(r[o]))return!1;return!0}if(!F(r))return!1;if((n=t.length)===r.length){for(o=0;o<n;o++)if(!e(t[o],r[o]))return!1;return!0}}return!1},Events:function(e){var t={};e=e||this,Object.defineProperties(e,{on:{value:function(e,r,n){t[e]=t[e]||[],t[e].push({f:r,c:n})}},off:{value:function(e,r){var n=t[e];if(n)if(r){for(var i=0;i<n.length;i++)if(n[i].f===r){n.splice(i,1);break}}else n.splice(0,n.length);else t={}}},emit:{value:function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];var i=t[r.shift()]||[];if(i)for(var o=0;o<i.length;o++)i[o].f.apply(i[o].c,r)}}})},filter:P,fillIn:function(e,t){return l(t,function(t,r){r in e||(e[r]=t)}),e},forEach:s,forOwn:l,fromJson:function(e){return D(e)?JSON.parse(e):e},get:b,guid:A,intersection:function(e,t){if(!e||!t)return[];for(var r=[],n=void 0,i=0,o=e.length;i<o;i++)n=e[i],c(r,n)||c(t,n)&&r.push(n);return r},isArray:F,isBlacklisted:T,isEmpty:function(e){if(null==e)return!0;if("string"==typeof e||F(e))return!e.length;if("object"===(void 0===e?"undefined":i(e))){var t=!0;return l(e,function(){return t=!1,!1}),t}return!0},isFunction:k,isObject:S,isNumber:R,isString:D,keys:g,makePath:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n;return(n=(n="/")||"",P(t,H).join(n)).replace(/([^:\/]|^)\/{2,}/g,"$1/")},observe:w,omit:function(e,t){var r=[];return l(e,function(e,n){T(n,t)&&r.push(n)}),s(r,function(t){delete e[t]}),e},pascalCase:p,pick:v,promisify:function(e,t){var r=this;if(e){if("function"!=typeof e)throw new Error("Can only promisify functions!");return function(){for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];return new r.Promise(function(r,n){i.push(function(e,t){e?n(e):r(t)});try{var o=e.apply(t||this,i);o&&o.then&&o.then(r,n)}catch(e){n(e)}})}}},remove:h,set:_,slice:f,sort:m,toJson:JSON.stringify,updateTimestamp:function(e){var t="function"==typeof Date.now?Date.now():(new Date).getTime();return e&&t<=e?e+1:t},upperCase:y,removeCircular:function(e){return function e(t,r){var n=void 0,o=void 0;if(!("object"!==(void 0===t?"undefined":i(t))||null===t||t instanceof Boolean||t instanceof Date||t instanceof Number||t instanceof RegExp||t instanceof String||E&&t instanceof E)){for(var a=r.cur,u=r.ctx;u;){if(u.cur===a)return;u=u.ctx}if(F(t))for(o=[],n=0;n<t.length;n+=1)o[n]=e(t[n],{ctx:r,cur:t[n]});else o={},l(t,function(n,i){o[i]=e(t[i],{ctx:r,cur:t[i]})});return o}return t}(e,{ctx:null,cur:e})},resolveItem:function(e,t){return e&&(D(t)||R(t))&&e.index[t]||t},resolveId:function(e,t){return D(t)||R(t)?t:t&&e&&t[e.idAttribute]||t},respond:function(e,t,r){return"array"===r.returnMeta?[e,t]:"object"===r.returnMeta?{response:e,meta:t}:e},w:x,applyRelationGettersToTarget:function(e,t,r){this.forEach(t.relationList,function(n){var i=n.relation,o=n.localField,a=n.localKey,u=n.foreignKey,f=n.localKeys,l=n.foreignKeys,d="boolean"==typeof n.enumerable?n.enumerable:!!t.relationsEnumerable;if("boolean"==typeof n.link?n.link:t.linkRelations){delete r[o];var p={enumerable:d};if("belongsTo"===n.type?(p.get=function(){var e=b(this,a);return!(!e&&0!==e)?t.getResource(i).get(e):void 0},p.set=function(e){return e&&_(this,a,b(e,t.getResource(i).idAttribute)),b(this,o)}):"hasMany"===n.type?(p.get=function(){var r={};if(u)return r[u]=this[t.idAttribute],t.getResource(i).defaultFilter.call(e,e.store[i].collection,i,r,{allowSimpleWhere:!0});if(f){var n=b(this,f)||[];return t.getResource(i).getAll(F(n)?n:g(n))}return l?(_(r,"where."+l+".contains",this[t.idAttribute]),t.getResource(i).defaultFilter.call(e,e.store[i].collection,i,r)):void 0},p.set=function(e){if(e&&e.length){var r=b(this,t.idAttribute);if(u)s(e,function(e){_(e,u,r)});else if(f){var n=[];s(e,function(e){n.push(b(e,t.getResource(i).idAttribute))}),_(this,f,n)}else l&&s(e,function(e){var t=b(e,l);t?c(t,r)||t.push(r):_(e,l,[r])})}return b(this,o)}):"hasOne"===n.type&&(a?(p.get=function(){var e=b(this,a);return!(!e&&0!==e)?t.getResource(i).get(e):void 0},p.set=function(e){return e&&_(this,a,b(e,t.getResource(i).idAttribute)),b(this,o)}):(p.get=function(){var r={};r[u]=this[t.idAttribute];var n=r[u]?t.getResource(i).defaultFilter.call(e,e.store[i].collection,i,r,{allowSimpleWhere:!0}):[];if(n.length)return n[0]},p.set=function(e){return e&&_(e,u,b(this,t.idAttribute)),b(this,o)})),n.get){var h=p.get;p.get=function(){var e=this;return n.get(t,n,this,function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return h.apply(e,r)})}}Object.defineProperty(r,o,p)}})}}},function(e,t){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(i,i.constructor),i.type=i.constructor.name,i.message=e,i}return i(t,Error),t}(),a=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(i,i.constructor),i.type=i.constructor.name,i.message=e,i}return i(t,Error),t}(),u=function(e){function t(e){r(this,t);var i=n(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(i,i.constructor),i.type=i.constructor.name,i.message=e+" is not a registered resource!",i}return i(t,Error),t}();t.default={IllegalArgumentError:o,IA:o,RuntimeError:a,R:a,NonexistentResourceError:u,NER:u}},function(e,t,r){var n;n=function(){"use strict";var e=function(e,t,r){for(var n=e[r],i=t(n);r>0;){var o=Math.floor((r+1)/2)-1,a=e[o];if(i>=t(a))break;e[o]=n,e[r]=a,r=o}},t=function(e,t,r){for(var n=e.length,i=e[r],o=t(i);;){var a=2*(r+1),u=a-1,s=null;if(u<n)t(e[u])<o&&(s=u);if(a<n)t(e[a])<(null===s?o:t(e[u]))&&(s=a);if(null===s)break;e[r]=e[s],e[s]=i,r=s}};function r(e,t){if(e||(e=function(e){return e}),t||(t=function(e,t){return e===t}),"function"!=typeof e)throw new Error('BinaryHeap([weightFunc][, compareFunc]): "weightFunc" must be a function!');if("function"!=typeof t)throw new Error('BinaryHeap([weightFunc][, compareFunc]): "compareFunc" must be a function!');this.weightFunc=e,this.compareFunc=t,this.heap=[]}var n=r.prototype;return n.push=function(t){this.heap.push(t),e(this.heap,this.weightFunc,this.heap.length-1)},n.peek=function(){return this.heap[0]},n.pop=function(){var e=this.heap[0],r=this.heap.pop();return this.heap.length>0&&(this.heap[0]=r,t(this.heap,this.weightFunc,0)),e},n.remove=function(r){for(var n=this.heap.length,i=0;i<n;i++)if(this.compareFunc(this.heap[i],r)){var o=this.heap[i],a=this.heap.pop();return i!==n-1&&(this.heap[i]=a,e(this.heap,this.weightFunc,i),t(this.heap,this.weightFunc,i)),o}return null},n.removeAll=function(){this.heap=[]},n.size=function(){return this.heap.length},r},e.exports=n()},function(e,t){e.exports=function(e,t,r){if(null!=e)for(var n=-1,i=e.length;++n<i&&!1!==t.call(r,e[n],n,e););}},function(e,t){e.exports=function(e,t,r){var n=e.length;t=null==t?0:t<0?Math.max(n+t,0):Math.min(t,n),r=null==r?n:r<0?Math.max(n+r,0):Math.min(r,n);for(var i=[];t<r;)i.push(e[t++]);return i}},function(e,t,r){var n=r(8),i=r(9);e.exports=function(e,t,r){i(e,function(i,o){if(n(e,o))return t.call(r,e[o],o,e)})}},function(e,t){e.exports=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},function(e,t,r){var n,i,o=r(8);function a(e,t,r,n){return e.call(n,t[r],r,t)}e.exports=function(e,t,r){var u,s=0;for(u in null==n&&function(){for(var e in i=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=!0,{toString:null})n=!1}(),e)if(!1===a(t,e,u,r))break;if(n)for(var f=e.constructor,l=!!f&&e===f.prototype;(u=i[s++])&&("constructor"===u&&(l||!o(e,u))||e[u]===Object.prototype[u]||!1!==a(t,e,u,r)););}},function(e,t,r){var n=r(11);e.exports=function(e,t){return-1!==n(e,t)}},function(e,t){e.exports=function(e,t,r){if(r=r||0,null==e)return-1;for(var n=e.length,i=r<0?n+r:r;i<n;){if(e[i]===t)return i;i++}return-1}},function(e,t,r){var n=r(7),i=r(13);function o(e,t){for(var r,i=0,o=arguments.length;++i<o;)(r=arguments[i])&&n(r,a,e);return e}function a(e,t){var r=this[t];i(e)&&i(r)?o(r,e):this[t]=e}e.exports=o},function(e,t){e.exports=function(e){return!!e&&"object"==typeof e&&e.constructor===Object}},function(e,t,r){var n=r(15),i=r(16),o=r(19);e.exports=function(e){return e=n(e),i(e).replace(/^[a-z]/,o)}},function(e,t){e.exports=function(e){return null==e?"":e.toString()}},function(e,t,r){var n=r(15),i=r(17),o=r(18),a=r(19),u=r(20);e.exports=function(e){return e=n(e),e=i(e),e=o(e).replace(/[\-_]/g," ").replace(/\s[a-z]/g,a).replace(/\s+/g,"").replace(/^[A-Z]/g,u)}},function(e,t,r){var n=r(15);e.exports=function(e){return(e=n(e)).search(/[\xC0-\xFF]/g)>-1&&(e=e.replace(/[\xC0-\xC5]/g,"A").replace(/[\xC6]/g,"AE").replace(/[\xC7]/g,"C").replace(/[\xC8-\xCB]/g,"E").replace(/[\xCC-\xCF]/g,"I").replace(/[\xD0]/g,"D").replace(/[\xD1]/g,"N").replace(/[\xD2-\xD6\xD8]/g,"O").replace(/[\xD9-\xDC]/g,"U").replace(/[\xDD]/g,"Y").replace(/[\xDE]/g,"P").replace(/[\xE0-\xE5]/g,"a").replace(/[\xE6]/g,"ae").replace(/[\xE7]/g,"c").replace(/[\xE8-\xEB]/g,"e").replace(/[\xEC-\xEF]/g,"i").replace(/[\xF1]/g,"n").replace(/[\xF2-\xF6\xF8]/g,"o").replace(/[\xF9-\xFC]/g,"u").replace(/[\xFE]/g,"p").replace(/[\xFD\xFF]/g,"y")),e}},function(e,t,r){var n=r(15),i=/[^\x20\x2D0-9A-Z\x5Fa-z\xC0-\xD6\xD8-\xF6\xF8-\xFF]/g;e.exports=function(e){return(e=n(e)).replace(i,"")}},function(e,t,r){var n=r(15);e.exports=function(e){return(e=n(e)).toUpperCase()}},function(e,t,r){var n=r(15);e.exports=function(e){return(e=n(e)).toLowerCase()}},function(e,t,r){var n=r(11);e.exports=function(e,t){var r=n(e,t);-1!==r&&e.splice(r,1)}},function(e,t,r){var n=r(6);e.exports=function(e,t){for(var r,i="string"!=typeof arguments[1]?arguments[1]:n(arguments,1),o={},a=0;r=i[a++];)o[r]=e[r];return o}},function(e,t,r){var n=r(7),i=Object.keys||function(e){var t=[];return n(e,function(e,r){t.push(r)}),t};e.exports=i},function(e,t){function r(e,t){return e<t?-1:e>t?1:0}e.exports=function e(t,n){return null==t?[]:t.length<2?t:(null==n&&(n=r),i=~~(t.length/2),function(e,t,r){for(var n=[];e.length&&t.length;)r(e[0],t[0])<=0?n.push(e.shift()):n.push(t.shift());return e.length&&n.push.apply(n,e),t.length&&n.push.apply(n,t),n}(e(t.slice(0,i),n),e(t.slice(i,t.length),n),n));var i}},function(e,t,r){r(26);e.exports=function(e,t){for(var r=t.split("."),n=r.pop();t=r.shift();)if(null==(e=e[t]))return;return e[n]}},function(e,t){e.exports=function(e){switch(typeof e){case"string":case"number":case"boolean":return!0}return null==e}},function(e,t,r){var n=r(28);e.exports=function(e,t,r){var i=/^(.+)\.(.+)$/.exec(t);i?n(e,i[1])[i[2]]=r:e[t]=r}},function(e,t,r){var n=r(5);e.exports=function(e,t){return t?(n(t.split("."),function(t){e[t]||(e[t]={}),e=e[t]}),e):e}},function(e,t){!function(e){var t=e.testingExposeCycleCount;var r=function(){if("function"!=typeof Object.observe||"function"!=typeof Array.observe)return!1;var e=[];function t(t){e=t}var r={},n=[];return Object.observe(r,t),Array.observe(n,t),r.id=1,r.id=2,delete r.id,n.push(1,2),n.length=0,Object.deliverChangeRecords(t),5===e.length&&"add"==e[0].type&&"update"==e[1].type&&"delete"==e[2].type&&"splice"==e[3].type&&"splice"==e[4].type&&(Object.unobserve(r,t),Array.unobserve(n,t),!0)}(),n="__proto__"in{}?function(e){return e}:function(e){var t=e.__proto__;if(!t)return e;var r=Object.create(t);return Object.getOwnPropertyNames(e).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}),r},i=1e3;function o(r){for(var n=0;n<i&&r.check_();)n++;return t&&(e.dirtyCheckCycleCount=n),n>0}function a(e){for(var t in e)return!1;return!0}function u(e,t){if(!t||!t.length)return!1;for(var r,n=0;n<t.length;n++)if("[object RegExp]"===Object.prototype.toString.call(t[n])&&t[n].test(e)||t[n]===e)return e;return!!r}function s(e,t,r,n){var i={},o={},a={};for(var s in t){var f=e[s];u(s,n)||(void 0!==f&&(r?r(f,t[s]):f===t[s])||(s in e?(r?r(f,t[s]):f===t[s])||(a[s]=f):o[s]=void 0))}for(var s in e)s in t||u(s,n)||(i[s]=e[s]);return Array.isArray(e)&&e.length!==t.length&&(a.length=e.length),{added:i,removed:o,changed:a}}var f=[];function l(){if(!f.length)return!1;for(var e=0;e<f.length;e++)f[e]();return f.length=0,!0}var c=r?function(e){return Promise.resolve().then(e)}:function(e){f.push(e)},d=[];function p(e,t,r){var n=d.pop()||function(){var e,t,r=!1,n=!0;function i(t){e&&e.state_===v&&!r&&e.check_(t)}return{open:function(t){if(e)throw Error("ObservedObject in use");n||Object.deliverChangeRecords(i),e=t,n=!1},observe:function(e,r){t=e,r?Array.observe(t,i):Object.observe(t,i)},deliver:function(e){r=e,Object.deliverChangeRecords(i),r=!1},close:function(){e=void 0,Object.unobserve(t,i),d.push(this)}}}();return n.open(e),n.observe(t,r),n}var h=0,v=1,g=1;function m(){this.state_=h,this.callback_=void 0,this.target_=void 0,this.directObserver_=void 0,this.value_=void 0,this.id_=g++}m.prototype={open:function(e,t){if(this.state_!=h)throw Error("Observer has already been opened.");return function(e){if(m._allObserversCount++,!b)return;y.push(e)}(this),this.callback_=e,this.target_=t,this.connect_(),this.state_=v,this.value_},close:function(){this.state_==v&&(m._allObserversCount--,this.disconnect_(),this.value_=void 0,this.callback_=void 0,this.target_=void 0,this.state_=2)},deliver:function(){this.state_==v&&o(this)},report_:function(e){try{this.callback_.apply(this.target_,e)}catch(e){m._errorThrownDuringCallback=!0,console.error("Exception caught during observer callback: "+(e.stack||e))}},discardChanges:function(){return this.check_(void 0,!0),this.value_}};var y,b=!r;m._allObserversCount=0,b&&(y=[]);var _=!1;function w(e){m.call(this),this.value_=e,this.oldObject_=void 0}e.Platform=e.Platform||{},e.Platform.performMicrotaskCheckpoint=function(){if(!_&&b){_=!0;var r,n,o=0;do{o++,n=y,y=[],r=!1;for(var a=0;a<n.length;a++){var u=n[a];u.state_==v&&(u.check_()&&(r=!0),y.push(u))}l()&&(r=!0)}while(o<i&&r);t&&(e.dirtyCheckCycleCount=o),_=!1}},b&&(e.Platform.clearObservers=function(){y=[]}),w.prototype=n({__proto__:m.prototype,arrayObserve:!1,connect_:function(e,t){r?this.directObserver_=p(this,this.value_,this.arrayObserve):this.oldObject_=this.copyObject(this.value_)},copyObject:function(e){var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=e[r];return Array.isArray(e)&&(t.length=e.length),t},check_:function(e,t){var n,i,o;if(r){if(!e)return!1;i={},n=function(e,t,r){for(var n={},i={},o=0;o<t.length;o++){var a=t[o];A[a.type]?(a.name in r||(r[a.name]=a.oldValue),"update"!=a.type&&("add"!=a.type?a.name in n?(delete n[a.name],delete r[a.name]):i[a.name]=!0:a.name in i?delete i[a.name]:n[a.name]=!0)):(console.error("Unknown changeRecord type: "+a.type),console.error(a))}for(var u in n)n[u]=e[u];for(var u in i)i[u]=void 0;var s={};for(var u in r)if(!(u in n||u in i)){var f=e[u];r[u]!==f&&(s[u]=f)}return{added:n,removed:i,changed:s}}(this.value_,e,i)}else i=this.oldObject_,n=s(this.value_,this.oldObject_);return!(a((o=n).added)&&a(o.removed)&&a(o.changed))&&(r||(this.oldObject_=this.copyObject(this.value_)),this.report_([n.added||{},n.removed||{},n.changed||{},function(e){return i[e]}]),!0)},disconnect_:function(){r?(this.directObserver_.close(),this.directObserver_=void 0):this.oldObject_=void 0},deliver:function(){this.state_==v&&(r?this.directObserver_.deliver(!1):o(this))},discardChanges:function(){return this.directObserver_?this.directObserver_.deliver(!0):this.oldObject_=this.copyObject(this.value_),this.value_}});var A={add:!0,update:!0,delete:!0};e.Observer=m,e.isBlacklisted=u,e.Observer.runEOM_=c,e.Observer.observerSentinel_={},e.Observer.hasObjectObserve=r,e.diffObjectFromOldObject=s,e.ObjectObserver=w}(t)},function(e,t,r){var n=r(31),i=r(32);e.exports=function(){return n(8)+"-"+n(4)+"-4"+n(3)+"-"+i(8,9,"a","b")+n(3)+"-"+n(12)}},function(e,t,r){var n=r(32),i="0123456789abcdef".split("");e.exports=function(e){e=e&&e>0?e:6;for(var t="";e--;)t+=n(i);return t}},function(e,t,r){var n=r(33),i=r(38);e.exports=function(e){var t=1===arguments.length&&i(e)?e:arguments;return t[n(0,t.length-1)]}},function(e,t,r){var n=r(34),i=r(35),o=r(36);e.exports=function(e,t){return e=null==e?n:~~e,t=null==t?i:~~t,Math.round(o(e-.5,t+.499999999999))}},function(e,t){e.exports=-2147483648},function(e,t){e.exports=2147483647},function(e,t,r){var n=r(37),i=r(34),o=r(35);e.exports=function(e,t){return(e=null==e?i:e)+((t=null==t?o:t)-e)*n()}},function(e,t){function r(){return r.get()}r.get=Math.random,e.exports=r},function(e,t,r){var n=r(39),i=Array.isArray||function(e){return n(e,"Array")};e.exports=i},function(e,t,r){var n=r(40);e.exports=function(e,t){return n(e)===t}},function(e,t){var r,n=/^\[object (.*)\]$/,i=Object.prototype.toString;e.exports=function(e){return null===e?"Null":e===r?"Undefined":n.exec(i.call(e))[1]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(r(2)),i=o(r(3));function o(e){return e&&e.__esModule?e:{default:e}}var a=i.default.NER,u=i.default.IA,s=i.default.R,f="DS_"+(new Date).getTime();function l(e,t,r,i){var o=this.definitions[t];if(i=i||{},r=n.default.resolveId(o,r),!o)throw new a(t);if(!n.default._sn(r))throw n.default._snErr("id");return r=r===f?void 0:r,(i=n.default._(o,i)).logFn(e,r,i),{_this:this,definition:o,_resourceName:t,_id:r,_options:i}}t.default={changes:function(e,t,r){var i=l.call(this,"changes",e,t,r),o=i._this,a=i.definition,u=i._resourceName,s=i._id,f=i._options,c=a.get(s);if(c){var d=o.store[u].observers[s];d&&"function"==typeof d&&d.deliver();var p=n.default.copy(f.ignoredChanges||[]);n.default.forEach(a.relationFields,function(e){n.default.contains(p,e)||p.push(e)});var h=n.default.diffObjectFromOldObject(c,o.store[u].previousAttributes[s],n.default.equals,p);return n.default.forOwn(h,function(e,t){var r=[];n.default.forOwn(e,function(e,t){n.default.isFunction(e)||r.push(t)}),h[t]=n.default.pick(h[t],r)}),n.default.forEach(a.relationFields,function(e){delete h.added[e],delete h.removed[e],delete h.changed[e]}),h}},changeHistory:function(e,t){var r=l.call(this,"changeHistory",e,t||f),n=r._this,i=r.definition,o=r._resourceName,a=r._id,u=n.store[o];if(i.keepChangeHistory){if(!o)return u.changeHistory;if(i.get(a))return u.changeHistories[a]}else i.errorFn("changeHistory is disabled for this resource!")},commit:function(e,t){var r=l.call(this,"commit",e,t),i=r._this,o=r.definition,a=r._resourceName,u=r._id,s=i.store[a],f=i.store[a].index[u];if(f){var c=o.relationFields||[],d={};for(var p in f)-1===c.indexOf(p)&&(d[p]=n.default.copy(f[p],null,null,null,[]));s.previousAttributes[u]=d}return s.changeHistories[u].length&&(n.default.forEach(s.changeHistories[u],function(e){n.default.remove(s.changeHistory,e)}),s.changeHistories[u].splice(0,s.changeHistories[u].length)),f},compute:function(e,t){var r=this.definitions[e];if(t=n.default.resolveItem(this.store[e],t),!r)throw new a(e);if(!t)throw new s("Item not in the store!");if(!n.default._o(t)&&!n.default._sn(t))throw new u('"instance" must be an object, string or number!');return r.logFn("compute",t),n.default.forOwn(r.computed,function(e,r){n.default.compute.call(t,e,r)}),t},createInstance:function(e,t,r){var i,o=this.definitions[e];if(t=t||{},!o)throw new a(e);if(t&&!n.default.isObject(t))throw new u('"attrs" must be an object!');r=n.default._(o,r);var s=o.relationList||[];return s.length&&n.default.forEach(s,function(e){var i=n.default.get(t,e.localField);if(i)if(n.default.isArray(i)){var a=[],u=o.getResource(e.relation),s=r.orig();n.default.forEach(i,function(e){a.push(u.createInstance(e,s))}),n.default.set(t,e.localField,a)}else n.default.isObject(i)&&n.default.set(t,e.localField,o.getResource(e.relation).createInstance(i,r.orig()))}),r.logFn("createInstance",t,r),r.beforeCreateInstance(r,t),i=new(0,o[o.class]),o.instanceEvents&&n.default.Events(i),r.defaultValues&&n.default.deepMixIn(i,n.default.copy(r.defaultValues)),n.default.deepMixIn(i,t),o.computed&&o.compute(i),r.afterCreateInstance(r,i),i},createCollection:function(e,t,r,i){var o=this,s=o.definitions[e];if(t=t||[],r=r||{},!s)throw new a(e);if(t&&!n.default.isArray(t))throw new u('"arr" must be an array!');return(i=n.default._(s,i)).logFn("createCollection",t,i),i.beforeCreateCollection(i,t),Object.defineProperties(t,{fetch:{value:function(t,r){var i=this;return i.params=t||i.params,s.findAll(i.params,r).then(function(t){return t===i?i:(t.unshift(i.length),t.unshift(0),i.splice.apply(i,t),t.shift(),t.shift(),t.$$injected&&(o.store[e].queryData[n.default.toJson(i.params)]=i,i.$$injected=!0),i)})}},params:{value:r,writable:!0},resourceName:{value:e}}),i.afterCreateCollection(i,t),t},defineResource:r(42),digest:function(){this.observe.Platform.performMicrotaskCheckpoint()},eject:r(43),ejectAll:r(44),filter:r(45),get:function(e,t){var r=l.call(this,"get",e,t),n=r._this,i=r._resourceName,o=r._id;return n.store[i].index[o]},getAll:function(e,t){var r=this.definitions[e],i=this.store[e],o=[];if(!r)throw new a(e);if(t&&!n.default._a(t))throw n.default._aErr("ids");if(r.logFn("getAll",t),n.default._a(t))for(var u=t.length,s=0;s<u;s++)i.index[t[s]]&&o.push(i.index[t[s]]);else o=i.collection.slice();return o},hasChanges:function(e,t){var r,i=l.call(this,"hasChanges",e,t),o=i.definition,a=i._id;return!!o.get(a)&&(r=o.changes(a),!(n.default.isEmpty(r.added)&&n.default.isEmpty(r.removed)&&n.default.isEmpty(r.changed)))},inject:r(46),isNew:function(e,t){var r=l.call(this,"isNew",e,t||f),n=r._this,i=r._resourceName,o=r._id;return!!n.store[i].temporaryItems[o]},lastModified:function(e,t){var r=l.call(this,"lastModified",e,t||f),n=r._this,i=r._resourceName,o=r._id,a=n.store[i];return o?(o in a.modified||(a.modified[o]=0),a.modified[o]):a.collectionModified},lastSaved:function(e,t){var r=l.call(this,"lastSaved",e,t||f),n=r._this,i=r._resourceName,o=r._id,a=n.store[i];return o in a.saved||(a.saved[o]=0),a.saved[o]},previous:function(e,t){var r=l.call(this,"previous",e,t),i=r._this,o=r._resourceName,a=r._id,u=i.store[o];return u.previousAttributes[a]?n.default.copy(u.previousAttributes[a]):void 0},revert:function(e,t,r){var i=l.call(this,"revert",e,t,r),o=i._this,a=i.definition,u=i._resourceName,s=i._id,f=i._options.preserve||[],c={};if(0===f.length)c=o.previous(u,s);else{var d=a.get(t),p=o.previous(u,s);if(!d)return;n.default.forOwn(d,function(e,t){n.default.contains(f,t)?c[t]=d[t]:c[t]=p[t]})}return a.inject(c,{onConflict:"replace"})}}},function(e,t,r){"use strict";var n=o(r(2)),i=o(r(3));function o(e){return e&&e.__esModule?e:{default:e}}var a=["compute","eject","refresh","save","update","destroy","loadRelations","changeHistory","changes","commit","hasChanges","isNew","lastModified","lastSaved","previous","revert"];e.exports=function(e){var t=this,r=t.definitions;if(n.default._s(e)&&(e={name:e.replace(/\s/gi,"")}),!n.default._o(e))throw n.default._oErr("definition");if(!n.default._s(e.name))throw new i.default.IA('"name" must be a string!');if(r[e.name])throw new i.default.R(e.name+" is already registered!");function o(i){this.defaultValues={},this.methods={},this.computed={},this.scopes={},this.actions={},n.default.deepMixIn(this,i);var o=t.defaults;e.extends&&r[e.extends]&&(o=r[e.extends]),n.default.fillIn(this.defaultValues,o.defaultValues),n.default.fillIn(this.methods,o.methods),n.default.fillIn(this.computed,o.computed),n.default.fillIn(this.scopes,o.scopes),n.default.fillIn(this.actions,o.actions),this.endpoint="endpoint"in i?i.endpoint:this.name}try{e.extends&&r[e.extends]?o.prototype=r[e.extends]:o.prototype=t.defaults,r[e.name]=new o(e);var u=r[e.name];if(u.getResource=function(e){return t.definitions[e]},u.logFn("Preparing resource."),!n.default._s(u.idAttribute))throw new i.default.IA('"idAttribute" must be a string!');u.relations&&(u.relationList=[],u.relationFields=[],n.default.forOwn(u.relations,function(e,t){n.default.forOwn(e,function(r,i){n.default._a(r)||(e[i]=[r]),n.default.forEach(e[i],function(e){e.type=t,e.relation=i,e.name=u.name,u.relationList.push(e),e.localField&&u.relationFields.push(e.localField)})})}),u.relations.belongsTo&&(u.parents={},n.default.forOwn(u.relations.belongsTo,function(e,t){n.default.forEach(e,function(e){e.parent&&(u.parent=t,u.parentKey=e.localKey,u.parentField=e.localField,u.parents[t]={key:u.parentKey,field:u.parentField})})})),"function"==typeof Object.freeze&&(Object.freeze(u.relations),Object.freeze(u.relationList)));var s=u.class=n.default.pascalCase(u.name);try{"function"==typeof u.useClass?(u.csp?u[s]=function(){u.useClass.call(this)}:u[s]=new Function("def","return function "+s+"() { def.useClass.call(this); }")(u),u[s].prototype=function(e){function t(){}return t.prototype=e,new t}(u.useClass.prototype)):u.csp?u[s]=function(){}:u[s]=new Function("return function "+s+"() {}")()}catch(e){u[s]=function(){}}n.default.forOwn(u.methods,function(e,t){u[s].prototype[t]=e}),u[s].prototype.set=function(e,t){var r=this;return n.default.set(this,e,t),u.compute(this),u.instanceEvents&&setTimeout(function(){r.emit("DS.change",u,r)},0),u.handleChange(this),this},u[s].prototype.get=function(e){return n.default.get(this,e)},n.default.applyRelationGettersToTarget(t,u,u[s].prototype);var f=null;u.hasOwnProperty("omit")?f=t.defaults.omit:(f=u.omit,u.omit=[]),u.omit=u.omit.concat(f||[]),n.default.forOwn(u.computed,function(e,t){if(n.default.isFunction(e)&&(u.computed[t]=[e],e=u.computed[t]),u.methods&&t in u.methods&&u.errorFn('Computed property "'+t+'" conflicts with previously defined prototype method!'),u.omit.push(t),n.default.isArray(e)){var r;if(1===e.length){var i=e[0].toString().match(/function.*?\(([\s\S]*?)\)/);r=i[1].split(","),r=n.default.filter(r,function(e){return e}),u.computed[t]=r.concat(e),e=u.computed[t],r.length&&u.errorFn("Use the computed property array syntax for compatibility with minified code!")}r=e.slice(0,e.length-1),n.default.forEach(r,function(e,t){r[t]=e.trim()}),e.deps=n.default.filter(r,function(e){return!!e})}else n.default.isObject(e)&&Object.defineProperty(u[s].prototype,t,e)}),n.default.forEach(a,function(e){u[s].prototype["DS"+n.default.pascalCase(e)]=function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return n.unshift(this[u.idAttribute]||this),n.unshift(u.name),t[e].apply(t,n)}}),u[s].prototype.DSCreate=function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.unshift(this),r.unshift(u.name),t.create.apply(t,r)},t.store[u.name]={collection:[],expiresHeap:new n.default.BinaryHeap(function(e){return e.expires},function(e,t){return e.item===t}),completedQueries:{},queryData:{},pendingQueries:{},index:{},modified:{},saved:{},previousAttributes:{},observers:{},changeHistories:{},changeHistory:[],collectionModified:0,temporaryItems:{}};var l=t.store[u.name];u.reapInterval&&setInterval(function(){return u.reap()},u.reapInterval);var c=["registerAdapter","getAdapterName","getAdapter","is","!clear"];for(var d in t)"function"==typeof t[d]&&c.push(d);n.default.forEach(c,function(e){var r=e;"!"!==r[0]&&(!1!==t[r].shorthand?(u[r]=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return n.unshift(u.name),t[r].apply(t,n)},u[r].before=function(e){var t=u[r];u[r]=function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.apply(u,e.apply(u,n)||n)}}):u[r]=function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return t[r].apply(t,n)})}),u.beforeValidate=n.default.promisify(u.beforeValidate),u.validate=n.default.promisify(u.validate),u.afterValidate=n.default.promisify(u.afterValidate),u.beforeCreate=n.default.promisify(u.beforeCreate),u.afterCreate=n.default.promisify(u.afterCreate),u.afterFind=n.default.promisify(u.afterFind),u.afterFindAll=n.default.promisify(u.afterFindAll),u.afterLoadRelations=n.default.promisify(u.afterLoadRelations),u.beforeUpdate=n.default.promisify(u.beforeUpdate),u.afterUpdate=n.default.promisify(u.afterUpdate),u.beforeDestroy=n.default.promisify(u.beforeDestroy),u.afterDestroy=n.default.promisify(u.afterDestroy);var p=void 0;return u.hasOwnProperty("defaultAdapter")&&(p=u.defaultAdapter),n.default.forOwn(u.actions,function(e,t){if(u[t]&&!u.actions[t])throw new Error('Cannot override existing method "'+t+'"!');e.request=e.request||function(e){return e},e.response=e.response||function(e){return e},e.responseError=e.responseError||function(e){return n.default.Promise.reject(e)},u[t]=function(r,i){n.default._o(r)&&(i=r),i=i||{};var o=u.getAdapter(e.adapter||p||"http"),a=n.default.deepMixIn({},e);if(!i.hasOwnProperty("endpoint")&&a.endpoint&&(i.endpoint=a.endpoint),"function"==typeof i.getEndpoint)a.url=i.getEndpoint(u,i);else{var s=[i.basePath||u.basePath||o.defaults.basePath,o.getEndpoint(u,n.default._sn(r)?r:null,i)];n.default._sn(r)&&s.push(r),s.push(e.pathname||t),a.url=n.default.makePath.apply(null,s)}return a.method=a.method||"GET",a.resourceName=u.name,n.default.deepMixIn(a,i),new n.default.Promise(function(e){return e(a)}).then(i.request||e.request).then(function(e){return o.HTTP(e)}).then(function(e){return e&&e.config&&(e.config.resourceName=u.name),e}).then(i.response||e.response,i.responseError||e.responseError)}}),n.default.Events(u),u.handleChange=function(e){l.collectionModified=n.default.updateTimestamp(l.collectionModified),u.notify&&setTimeout(function(){u.emit("DS.change",u,e)},0)},u.logFn("Done preparing resource."),u}catch(n){throw t.defaults.errorFn(n),delete r[e.name],delete t.store[e.name],n}}},function(e,t){"use strict";e.exports=function(e,t,r){var n=this.utils,i=this.definitions[e],o=this.store[e],a=void 0,u=!1;if(t=n.resolveId(i,t),!i)throw new this.errors.NER(e);if(!n._sn(t))throw n._snErr("id");(r=n._(i,r)).logFn("eject",t,r);for(var s=0;s<o.collection.length;s++)if(o.collection[s][i.idAttribute]==t){a=o.collection[s],o.expiresHeap.remove(a),u=!0;break}if(u){i.beforeEject(r,a),r.notify&&i.emit("DS.beforeEject",i,a);var f=[];return n.forOwn(o.queryData,function(e,t){e.$$injected&&n.remove(e,a),!e.length&&r.clearEmptyQueries&&f.push(t)}),n.forEach(o.changeHistories[t],function(e){n.remove(o.changeHistory,e)}),n.forEach(f,function(e){delete o.completedQueries[e],delete o.queryData[e]}),o.observers[t]&&"function"==typeof o.observers[t].close&&o.observers[t].close(),delete o.observers[t],delete o.index[t],delete o.previousAttributes[t],delete o.completedQueries[t],delete o.pendingQueries[t],delete o.changeHistories[t],delete o.modified[t],delete o.saved[t],i.instanceEvents&&a.off&&a.off(),o.collection.splice(s,1),i.handleChange(a),i.afterEject(r,a),r.notify&&i.emit("DS.afterEject",i,a),a}}},function(e,t){"use strict";e.exports=function(e,t,r){var n=this.utils,i=this.definitions[e];if(t=t||{},!i)throw new this.errors.NER(e);if(!n._o(t))throw n._oErr("params");r=n._(i,r),i.logFn("ejectAll",t,r),n.applyScope(i,t,r);var o=this.store[e],a=n.toJson(t),u=void 0;return n.isEmpty(t)?(u=i.getAll(),o.completedQueries={}):(u=i.filter(t),delete o.completedQueries[a]),n.forEach(u,function(e){e&&e[i.idAttribute]&&i.eject(e[i.idAttribute],r)}),i.handleChange(u),u}},function(e,t){"use strict";e.exports=function(e,t,r){var n=this,i=n.utils,o=n.definitions[e];if(!o)throw new n.errors.NER(e);if(t&&!i._o(t))throw i._oErr("params");return t=t||{},(r=i._(o,r)).logFn("filter",t,r),i.applyScope(o,t,r),o.defaultFilter.call(n,n.store[e].collection,e,t,r)}},function(e,t,r){"use strict";var n=o(r(2)),i=o(r(3));function o(e){return e&&e.__esModule?e:{default:e}}function a(e,t,r,o){var u=this,s=void 0;if(n.default._a(r)){s=[];for(var f=0;f<r.length;f++)s.push(a.call(u,e,t,r[f],o))}else{var l=e.computed,c=e.idAttribute;if(l&&l[c]){var d=[];n.default.forEach(l[c].deps,function(e){d.push(r[e])}),r[c]=l[c][l[c].length-1].apply(r,d)}else o.temporary&&(r[c]=n.default.guid());if(!(c in r)){var p=new i.default.R(e.name+'.inject: "attrs" must contain the property specified by "idAttribute"!');throw o.errorFn(p),p}try{n.default.forEach(e.relationList,function(t){var a=t.relation,s=u.definitions[a],f=r[t.localField];if("function"==typeof t.inject)t.inject(e,t,r);else if(f&&!1!==t.inject){if(!s)throw new i.default.R(e.name+" relation is defined but the resource is not!");if(n.default._a(f)){var l=[];n.default.forEach(f,function(i){if(i!==u.store[a].index[i[s.idAttribute]])try{var f=s.inject(i,o.orig());t.foreignKey&&n.default.set(f,t.foreignKey,r[e.idAttribute]),l.push(f)}catch(e){o.errorFn(e,"Failed to inject "+t.type+' relation: "'+a+'"!')}})}else if(f!==u.store[a].index[f[s.idAttribute]])try{var c=s.inject(r[t.localField],o.orig());t.foreignKey&&n.default.set(c,t.foreignKey,r[e.idAttribute]),t.localKey&&n.default.set(r,t.localKey,n.default.get(c,s.idAttribute))}catch(e){o.errorFn(e,"Failed to inject "+t.type+' relation: "'+a+'"!')}}});var h=r[c],v=e.get(h),g=v?t.modified[h]:0;if(v)"merge"===o.onConflict?(n.default.deepMixIn(v,r),n.default.forOwn(e.computed,function(e,t){n.default.compute.call(v,e,t)})):"replace"===o.onConflict&&(n.default.forOwn(e.computed,function(e,t){n.default.compute.call(r,e,t)}),n.default.forOwn(v,function(t,n){n!==e.idAttribute&&(r.hasOwnProperty(n)||delete v[n])}),n.default.forOwn(r,function(t,r){r!==e.idAttribute&&(v[r]=t)})),e.resetHistoryOnInject&&u.commit(e.name,h),t.observers[h]&&"function"==typeof t.observers[h]&&t.observers[h].deliver();else{r instanceof e[e.class]?v=r:(v=new e[e.class],o.applyDefaultsOnInject&&o.defaultValues&&n.default.deepMixIn(v,n.default.copy(o.defaultValues))),e.instanceEvents&&"function"!=typeof v.emit&&n.default.Events(v),n.default.forEach(e.relationList,function(t){("boolean"==typeof t.link?t.link:e.linkRelations)&&delete r[t.localField]}),n.default.deepMixIn(v,r),t.collection.push(v),t.changeHistories[h]=[];var m=function(e,t){var r=this,i=e.name;return function(o,a,u,s,f){var l=void 0,c=s&&s(e.idAttribute)?s(e.idAttribute):this[e.idAttribute];if(n.default.forEach(e.relationFields,function(e){delete o[e],delete a[e],delete u[e]}),(!n.default.isEmpty(o)||!n.default.isEmpty(a)||!n.default.isEmpty(u)||f)&&(l=r.get(i,c),t.modified[c]=n.default.updateTimestamp(t.modified[c]),l&&e.instanceEvents&&setTimeout(function(){l.emit("DS.change",e,l)},0),e.handleChange(l),e.keepChangeHistory)){var d={resourceName:i,target:l,added:o,removed:a,changed:u,timestamp:t.modified[c]};t.changeHistories[c].push(d),t.changeHistory.push(d)}e.computed&&(l=l||r.get(i,c),n.default.forOwn(e.computed,function(e,t){if(!n.default._o(e)){var r=!1;n.default.forEach(e.deps,function(e){!(e in o||e in a||e in u)&&t in l||(r=!0)}),(r=r||!e.deps.length)&&n.default.compute.call(l,e,t)}})),e.idAttribute in u&&e.errorFn('Doh! You just changed the primary key of an object! Your data for the "'+i+'" resource is now in an undefined (probably broken) state.')}}.call(u,e,t);e.watchChanges&&(t.observers[h]=new u.observe.ObjectObserver(v),t.observers[h].open(m,v)),t.index[h]=v,m.call(v,{},{},{},null,!0),t.previousAttributes[h]=n.default.copy(v,null,null,null,e.relationFields),o.temporary&&(t.temporaryItems[h]=!0)}t.modified[h]=g&&t.modified[h]===g?n.default.updateTimestamp(t.modified[h]):t.modified[h],t.expiresHeap.remove(v);var y=(new Date).getTime();t.expiresHeap.push({item:v,timestamp:y,expires:e.maxAge?y+e.maxAge:Number.MAX_VALUE}),s=v}catch(e){o.errorFn(e,r)}}return s}e.exports=function(e,t,r){var o,u=this.definitions[e],s=this.store[e];if(!u)throw new i.default.NER(e);if(!n.default._o(t)&&!n.default._a(t))throw new i.default.IA(e+'.inject: "attrs" must be an object or an array!');return(r=n.default._(u,r)).logFn("inject",t,r),r.beforeInject(r,t),r.notify&&u.emit("DS.beforeInject",u,t),o=a.call(this,u,s,t,r),u.handleChange(o),r.afterInject(r,o),r.notify&&u.emit("DS.afterInject",u,o),o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={create:r(48),destroy:r(49),destroyAll:r(50),find:r(51),findAll:r(52),loadRelations:r(53),reap:r(54),refresh:function(e,t,r){var n=this,i=n.utils;return new i.Promise(function(o,a){var u=n.definitions[e];t=i.resolveId(n.definitions[e],t),u?i._sn(t)?((r=i._(u,r)).bypassCache=!0,r.logFn("refresh",t,r),o(n.get(e,t))):a(i._snErr("id")):a(new n.errors.NER(e))}).then(function(i){return i?n.find(e,t,r):i}).catch(n.errorFn("refresh",e,t,r))},refreshAll:function(e,t,r){var n=this,i=n.utils,o=n.definitions[e];return t=t||{},new i.Promise(function(a,u){o?i._o(t)?((r=i._(o,r)).bypassCache=!0,r.logFn("refreshAll",t,r),a(n.filter(e,t,r))):u(i._oErr("params")):u(new n.errors.NER(e))}).then(function(a){return r.bypassCache=!0,n.findAll(e,t,r).then(function(e){return i.forEach(a,function(t){-1===e.indexOf(t)&&o.eject(t)}),e})}).catch(n.errorFn("refreshAll",e,t,r))},save:r(55),update:r(56),updateAll:r(57)}},function(e,t){"use strict";e.exports=function(e,t,r){var n=this,i=n.utils,o=n.definitions[e],a=n.store[e],u=void 0;r=r||{},t=t||{};var s=void 0;if(o)if(i._o(t)){if((r=i._(o,r)).upsert&&i._sn(t[o.idAttribute])&&!a.temporaryItems[t[o.idAttribute]])return n.update(e,t[o.idAttribute],t,r);r.logFn("create",t,r)}else s=i._oErr("attrs");else s=new n.errors.NER(e);return new i.Promise(function(e,r){s?r(s):e(t)}).then(function(e){return r.beforeValidate.call(e,r,e)}).then(function(e){return r.validate.call(e,r,e)}).then(function(e){return r.afterValidate.call(e,r,e)}).then(function(e){return r.beforeCreate.call(e,r,e)}).then(function(e){return r.notify&&o.emit("DS.beforeCreate",o,e),u=n.getAdapterName(r),n.adapters[u].create(o,i.omit(e,r.omit),r)}).then(function(e){return r.afterCreate.call(e,r,e)}).then(function(t){if(r.notify&&o.emit("DS.afterCreate",o,t),r.cacheResponse){var a=n.inject(o.name,t,r.orig()),u=a[o.idAttribute],s=n.store[e];return s.completedQueries[u]=(new Date).getTime(),s.saved[u]=i.updateTimestamp(s.saved[u]),a}return n.createInstance(e,t,r)}).then(function(e){return i.respond(e,{adapter:u},r)}).catch(n.errorFn("create",e,t,r))}},function(e,t){"use strict";e.exports=function(e,t,r){var n=this,i=n.utils,o=n.definitions[e],a=void 0,u=void 0;return new i.Promise(function(u,s){t=i.resolveId(o,t),o?i._sn(t)?(a=o.get(t)||{id:t},(r=i._(o,r)).logFn("destroy",t,r),u(a)):s(i._snErr("id")):s(new n.errors.NER(e))}).then(function(e){return r.beforeDestroy.call(e,r,e)}).then(function(e){return r.notify&&o.emit("DS.beforeDestroy",o,e),r.eagerEject&&o.eject(t),(u=o.getAdapter(r)).destroy(o,t,r)}).then(function(){return r.afterDestroy.call(a,r,a)}).then(function(e){return r.notify&&o.emit("DS.afterDestroy",o,e),o.eject(t),i.respond(t,{adapter:u},r)}).catch(function(i){return r&&r.eagerEject&&a&&o.inject(a,{notify:!1}),n.errorFn("destroy",e,t,r)(i)})}},function(e,t){"use strict";e.exports=function(e,t,r){var n=this,i=n.utils,o=n.definitions[e],a=void 0,u=void 0,s=void 0;return t=t||{},new i.Promise(function(a,u){o?i._o(t)?((r=i._(o,r)).logFn("destroyAll",t,r),i.applyScope(o,t,r),a()):u(i._oErr("attrs")):u(new n.errors.NER(e))}).then(function(){return u=o.defaultFilter.call(n,e,t),r.beforeDestroy(r,u)}).then(function(){return r.notify&&o.emit("DS.beforeDestroy",o,u),r.eagerEject&&(a=o.ejectAll(t)),s=o.getAdapterName(r),n.adapters[s].destroyAll(o,t,r)}).then(function(){return r.afterDestroy(r,u)}).then(function(){return r.notify&&o.emit("DS.afterDestroy",o,u),a||o.ejectAll(t)}).then(function(e){return i.respond(e,{adapter:s},r)}).catch(function(i){return r&&r.eagerEject&&a&&o.inject(a,{notify:!1}),n.errorFn("destroyAll",e,t,r)(i)})}},function(e,t){"use strict";e.exports=function(e,t,r){var n=this,i=n.utils,o=n.definitions[e],a=n.store[e],u=void 0;return new i.Promise(function(u,s){if(o)if(i._sn(t)){(r=i._(o,r)).logFn("find",t,r),r.params&&(r.params=i.copy(r.params)),!r.bypassCache&&r.cacheResponse||delete a.completedQueries[t];var f=r.maxAge&&t in a.completedQueries&&a.completedQueries[t]+r.maxAge<(new Date).getTime();r.findStrictCache&&!(t in a.completedQueries)||!o.get(t)||r.bypassCache||f?(delete a.completedQueries[t],u()):u(o.get(t))}else s(i._snErr("id"));else s(new n.errors.NER(e))}).then(function(s){if(s)return s;var f=void 0,l=i.isFunction(r.usePendingFind)?r.usePendingFind.call(this,e,t,r):r.usePendingFind;if(t in a.pendingQueries&&l)f=a.pendingQueries[t];else{var c=void 0;if("fallback"===(r.findStrategy||r.strategy)){c=function e(a){return u=o.getAdapterName((r.findFallbackAdapters||r.fallbackAdapters)[a]),n.adapters[u].find(o,t,r).catch(function(t){return++a<r.fallbackAdapters.length?e(a):i.Promise.reject(t)})}(0)}else u=o.getAdapterName(r),c=n.adapters[u].find(o,t,r);f=c.then(function(e){return r.afterFind.call(e,r,e)}).then(function(e){if(delete a.pendingQueries[t],r.cacheResponse){var n=o.inject(e,r.orig());return a.completedQueries[t]=(new Date).getTime(),a.saved[t]=i.updateTimestamp(a.saved[t]),n}return o.createInstance(e,r.orig())}),l&&(a.pendingQueries[t]=f)}return f}).then(function(e){return i.respond(e,{adapter:u},r)}).catch(function(i){return a&&delete a.pendingQueries[t],n.errorFn("find",e,t,r)(i)})}},function(e,t){"use strict";e.exports=function(e,t,r){var n=this,i=n.utils,o=n.definitions[e],a=n.store[e],u=void 0,s=void 0;return new i.Promise(function(s,f){if(t=t||{},n.definitions[e])if(i._o(t)){r=i._(o,r),u=i.toJson(t),r.logFn("findAll",t,r),r.params&&(r.params=i.copy(r.params)),i.applyScope(o,t,r),!r.bypassCache&&r.cacheResponse||(delete a.completedQueries[u],delete a.queryData[u]);var l=r.maxAge&&u in a.completedQueries&&a.completedQueries[u]+r.maxAge<(new Date).getTime();u in a.completedQueries&&!l?r.useFilter?r.localKeys?s(o.getAll(r.localKeys,r.orig())):s(o.filter(t,r.orig())):s(a.queryData[u]):s()}else f(i._oErr("params"));else f(new n.errors.NER(e))}).then(function(f){if(f)return f;var l=void 0,c=i.isFunction(r.usePendingFindAll)?r.usePendingFindAll.call(this,e,t,r):r.usePendingFindAll;if(u in a.pendingQueries&&c)l=a.pendingQueries[u];else{var d=void 0;if("fallback"===(r.findAllStrategy||r.strategy)){d=function e(a){return s=o.getAdapterName((r.findAllFallbackAdapters||r.fallbackAdapters)[a]),n.adapters[s].findAll(o,t,r).catch(function(t){return++a<r.fallbackAdapters.length?e(a):i.Promise.reject(t)})}(0)}else s=o.getAdapterName(r),d=n.adapters[s].findAll(o,t,r);l=d.then(function(e){return r.afterFindAll.call(e,r,e)}).then(function(t){return delete a.pendingQueries[u],r.cacheResponse?(a.queryData[u]=function(e,t,r,n){var i=this.utils,o=this.definitions[t],a=this.store[t],u=o.idAttribute,s=(new Date).getTime();e=e||[],delete a.pendingQueries[r],a.completedQueries[r]=s;var f=o.inject(e,n.orig());return i._a(f)?i.forEach(f,function(e){if(e){var t=e[u];t&&(a.completedQueries[t]=s,a.saved[t]=i.updateTimestamp(a.saved[t]))}}):(n.errorFn("response is expected to be an array!"),a.completedQueries[f[u]]=s),f}.call(n,t,e,u,r),a.queryData[u].$$injected=!0,a.queryData[u]):(i.forEach(t,function(e,n){t[n]=o.createInstance(e,r.orig())}),t)}),c&&(a.pendingQueries[u]=l)}return l}).then(function(e){return i.respond(e,{adapter:s},r)}).catch(function(i){return a&&delete a.pendingQueries[u],n.errorFn("findAll",e,t,r)(i)})}},function(e,t){"use strict";function r(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.exports=function(e,t,n,i){var o=this.utils,a=this.errors,u=this.definitions[e],s=void 0;return new o.Promise(function(f,l){if(o._sn(t)&&(t=u.get(t)),o._s(n)&&(n=[n]),n=n||[],u)if(o._o(t))if(o._a(n)){(s=o._(u,i)).logFn("loadRelations",t,n,s);var c=[];o.forEach(u.relationList,function(e){var a=e.relation,f=u.getResource(a),l=o._(f,i);if(!n.length||o.contains(n,a)||o.contains(n,e.localField)){var d=void 0,p={};l.allowSimpleWhere?p[e.foreignKey]=t[u.idAttribute]:(p.where={},p.where[e.foreignKey]={"==":t[u.idAttribute]});var h=l.orig(),v=e.localKey?o.get(t,e.localKey):null,g=!(!v&&0!==v);if("function"==typeof e.load)d=e.load(u,e,t,h);else if("hasMany"===e.type){if(e.localKeys){delete p[e.foreignKey];var m=o.get(t,e.localKeys)||[];m=o._a(m)?m:o.keys(m),p.where=r({},f.idAttribute,{in:m}),h.localKeys=m}else e.foreignKeys&&(delete p[e.foreignKey],p.where=r({},e.foreignKeys,{contains:t[u.idAttribute]}));d=f.findAll(p,h)}else"hasOne"===e.type?e.localKey&&g?d=f.find(v,h):e.foreignKey&&(d=f.findAll(p,h).then(function(e){return e.length?e[0]:null})):g&&(d=f.find(v,h));d&&(s.linkRelations||(d=d.then(function(r){t[e.localField]=r})),c.push(d))}}),f(c)}else l(new a.IA('"relations" must be a string or an array!'));else l(new a.IA('"instance(id)" must be a string, number or object!'));else l(new a.NER(e))}).then(function(e){return o.Promise.all(e)}).then(function(){return s.afterLoadRelations.call(t,s,t)}).catch(this.errorFn("loadRelations",e,t,n,i))}},function(e,t){"use strict";e.exports=function(e,t){var r=this,n=r.utils,i=r.definitions[e],o=r.store[e];return new n.Promise(function(a,u){if(i){(t=n._(i,t)).hasOwnProperty("notify")||(t.notify=!1),t.logFn("reap",t);for(var s=[],f=(new Date).getTime(),l=void 0;(l=o.expiresHeap.peek())&&l.expires<f;)s.push(l.item),delete l.item,o.expiresHeap.pop();a(s)}else u(new r.errors.NER(e))}).then(function(e){if(e.length&&(i.beforeReap(t,e),t.notify&&i.emit("DS.beforeReap",i,e)),"inject"===t.reapAction){var r=(new Date).getTime();n.forEach(e,function(e){o.expiresHeap.push({item:e,timestamp:r,expires:i.maxAge?r+i.maxAge:Number.MAX_VALUE})})}else if("eject"===t.reapAction)n.forEach(e,function(e){i.eject(e[i.idAttribute])});else if("refresh"===t.reapAction){var a=[];return n.forEach(e,function(e){a.push(i.refresh(e[i.idAttribute]))}),n.Promise.all(a)}return e}).then(function(e){return e.length&&(i.afterReap(t,e),t.notify&&i.emit("DS.afterReap",i,e)),e}).catch(r.errorFn("reap",e,t))}},function(e,t){"use strict";e.exports=function(e,t,r){var n=this,i=n.utils,o=n.errors,a=n.definitions[e],u=n.store[e],s=void 0,f=void 0,l=void 0;return new i.Promise(function(n,u){t=i.resolveId(a,t),a?i._sn(t)?a.get(t)?(s=a.get(t),(r=i._(a,r)).logFn("save",t,r),n(s)):u(new o.R('id "'+t+'" not found in cache!')):u(i._snErr("id")):u(new o.NER(e))}).then(function(e){return r.beforeValidate.call(e,r,e)}).then(function(e){return r.validate.call(e,r,e)}).then(function(e){return r.afterValidate.call(e,r,e)}).then(function(e){return r.beforeUpdate.call(e,r,e)}).then(function(e){if(r.notify&&a.emit("DS.beforeUpdate",a,e),r.changesOnly){u.observers[t]&&"function"==typeof u.observers[t]&&u.observers[t].deliver();var o=[],s=a.changes(t);for(var c in s.added)o.push(c);for(c in s.changed)o.push(c);if(i.forEach(r.always,function(e){o.push(e)}),s=i.pick(e,o),i.isEmpty(s))return r.logFn("save - no changes",t,r),f=!0,e;e=s}return l=a.getAdapterName(r),n.adapters[l].update(a,t,i.omit(e,r.omit),r)}).then(function(e){return r.afterUpdate.call(e,r,e)}).then(function(e){if(r.notify&&a.emit("DS.afterUpdate",a,e),f)return e;if(r.cacheResponse){var n=a.inject(e,r.orig());return u.saved[t]=i.updateTimestamp(u.saved[t]),a.resetHistoryOnInject||(u.previousAttributes[t]=i.copy(n,null,null,null,a.relationFields)),n}return a.createInstance(e,r.orig())}).then(function(e){return i.respond(e,{adapter:l},r)}).catch(n.errorFn("save",e,t,r))}},function(e,t){"use strict";e.exports=function(e,t,r,n){var i=this,o=i.utils,a=i.errors,u=i.definitions[e],s=void 0;return new o.Promise(function(i,s){t=o.resolveId(u,t),u?o._sn(t)?((n=o._(u,n)).logFn("update",t,r,n),i(r)):s(o._snErr("id")):s(new a.NER(e))}).then(function(e){return n.beforeValidate.call(e,n,e)}).then(function(e){return n.validate.call(e,n,e)}).then(function(e){return n.afterValidate.call(e,n,e)}).then(function(e){return n.beforeUpdate.call(e,n,e)}).then(function(e){return n.notify&&u.emit("DS.beforeUpdate",u,e),s=u.getAdapterName(n),i.adapters[s].update(u,t,o.omit(e,n.omit),n)}).then(function(e){return n.afterUpdate.call(e,n,e)}).then(function(t){if(n.notify&&u.emit("DS.afterUpdate",u,t),n.cacheResponse){var r=u.inject(t,n.orig()),a=i.store[e],s=r[u.idAttribute];return a.saved[s]=o.updateTimestamp(a.saved[s]),u.resetHistoryOnInject||(a.previousAttributes[s]=o.copy(r,null,null,null,u.relationFields)),r}return u.createInstance(t,n.orig())}).then(function(e){return o.respond(e,{adapter:s},n)}).catch(i.errorFn("update",e,t,r,n))}},function(e,t){"use strict";e.exports=function(e,t,r,n){var i=this,o=i.utils,a=i.errors,u=i.definitions[e],s=void 0;return new o.Promise(function(i,s){u?((n=o._(u,n)).logFn("updateAll",t,r,n),o.applyScope(u,r,n),i(t)):s(new a.NER(e))}).then(function(e){return n.beforeValidate.call(e,n,e)}).then(function(e){return n.validate.call(e,n,e)}).then(function(e){return n.afterValidate.call(e,n,e)}).then(function(e){return n.beforeUpdate.call(e,n,e)}).then(function(e){return n.notify&&u.emit("DS.beforeUpdate",u,e),s=u.getAdapterName(n),i.adapters[s].updateAll(u,o.omit(e,n.omit),r,n)}).then(function(e){return n.afterUpdate.call(e,n,e)}).then(function(r){n.notify&&u.emit("DS.afterUpdate",u,t);var a=n.orig();if(n.cacheResponse){var s=u.inject(r,a),f=i.store[e];return o.forEach(s,function(e){var t=e[u.idAttribute];f.saved[t]=o.updateTimestamp(f.saved[t]),u.resetHistoryOnInject||(f.previousAttributes[t]=o.copy(e,null,null,null,u.relationFields))}),s}var l=[];return o.forEach(r,function(e){l.push(u.createInstance(e,a))}),l}).then(function(e){return o.respond(e,{adapter:s},n)}).catch(i.errorFn("updateAll",e,t,r,n))}}])});