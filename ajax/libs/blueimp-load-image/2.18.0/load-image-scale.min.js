!function(t){"use strict";"function"==typeof define&&define.amd?define(["./load-image"],t):"object"==typeof module&&module.exports?t(require("./load-image")):t(window.loadImage)}(function(t){"use strict";var e=t.transform;t.transform=function(i,o,a,n,r){e.call(t,t.scale(i,o,r),o,a,n,r)},t.transformCoordinates=function(){},t.getTransformedOptions=function(t,e){var i,o,a,n,r=e.aspectRatio;if(!r)return e;i={};for(o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);return i.crop=!0,(a=t.naturalWidth||t.width)/(n=t.naturalHeight||t.height)>r?(i.maxWidth=n*r,i.maxHeight=n):(i.maxWidth=a,i.maxHeight=a/r),i},t.renderImageToCanvas=function(t,e,i,o,a,n,r,h,d,s){return t.getContext("2d").drawImage(e,i,o,a,n,r,h,d,s),t},t.hasCanvasOption=function(t){return t.canvas||t.crop||!!t.aspectRatio},t.scale=function(e,i,o){i=i||{};var a,n,r,h,d,s,c,g,m,u,f,v=document.createElement("canvas"),l=e.getContext||t.hasCanvasOption(i)&&v.getContext,p=e.naturalWidth||e.width,x=e.naturalHeight||e.height,w=p,C=x;function H(){var t=Math.max((r||w)/w,(h||C)/C);t>1&&(w*=t,C*=t)}function W(){var t=Math.min((a||w)/w,(n||C)/C);t<1&&(w*=t,C*=t)}if(l&&(c=(i=t.getTransformedOptions(e,i,o)).left||0,g=i.top||0,i.sourceWidth?(d=i.sourceWidth,void 0!==i.right&&void 0===i.left&&(c=p-d-i.right)):d=p-c-(i.right||0),i.sourceHeight?(s=i.sourceHeight,void 0!==i.bottom&&void 0===i.top&&(g=x-s-i.bottom)):s=x-g-(i.bottom||0),w=d,C=s),a=i.maxWidth,n=i.maxHeight,r=i.minWidth,h=i.minHeight,l&&a&&n&&i.crop?(w=a,C=n,(f=d/s-a/n)<0?(s=n*d/a,void 0===i.top&&void 0===i.bottom&&(g=(x-s)/2)):f>0&&(d=a*s/n,void 0===i.left&&void 0===i.right&&(c=(p-d)/2))):((i.contain||i.cover)&&(r=a=a||r,h=n=n||h),i.cover?(W(),H()):(H(),W())),l){if((m=i.pixelRatio)>1&&(v.style.width=w+"px",v.style.height=C+"px",w*=m,C*=m,v.getContext("2d").scale(m,m)),(u=i.downsamplingRatio)>0&&u<1&&w<d&&C<s)for(;d*u>w;)v.width=d*u,v.height=s*u,t.renderImageToCanvas(v,e,c,g,d,s,0,0,v.width,v.height),c=0,g=0,d=v.width,s=v.height,(e=document.createElement("canvas")).width=d,e.height=s,t.renderImageToCanvas(e,v,0,0,d,s,0,0,d,s);return v.width=w,v.height=C,t.transformCoordinates(v,i),t.renderImageToCanvas(v,e,c,g,d,s,0,0,w,C)}return e.width=w,e.height=C,e}});