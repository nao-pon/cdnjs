{"version":3,"sources":["dist/hyperapp.js"],"names":["global","factory","exports","module","define","amd","hyperapp","this","h","tag","props","node","stack","children","i","arguments","length","push","Array","isArray","pop","app","model","view","container","vnode","element","map","tagName","toLowerCase","call","childNodes","nodeType","nodeValue","render","next","lock","store","root","patch","repaint","setTimeout","assign","target","source","result","setDeep","path","value","slice","get","init","state","actions","key","action","data","then","concat","getKey","setElementProp","name","oldValue","style","_","removeAttribute","setAttribute","createElement","isSVG","document","createTextNode","createElementNS","oncreate","appendChild","destroyChildren","ondestroy","removeElement","parent","done","removeChild","onremove","oldNode","nextSibling","insertBefore","oldProps","onupdate","updateElement","len","oldLen","oldKeyed","oldElements","keyed","oldElement","oldKey","oldChild","j","newChild","newKey","keyedNode","reusableNode"],"mappings":"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","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.hyperapp = {})));\n}(this, (function (exports) { 'use strict';\n\nfunction h(tag, props) {\n  var node;\n  var stack = [];\n  var children = [];\n\n  for (var i = arguments.length; i-- > 2; ) {\n    stack.push(arguments[i]);\n  }\n\n  while (stack.length) {\n    if (Array.isArray((node = stack.pop()))) {\n      for (i = node.length; i--; ) {\n        stack.push(node[i]);\n      }\n    } else if (null == node || true === node || false === node) {\n    } else {\n      children.push(typeof node === \"number\" ? node + \"\" : node);\n    }\n  }\n\n  return typeof tag === \"string\"\n    ? {\n        tag: tag,\n        props: props || {},\n        children: children\n      }\n    : tag(props || {}, children)\n}\n\nfunction app(model, view, container) {\n  function vnode(element, map) {\n    return (\n      element && {\n        tag: element.tagName.toLowerCase(),\n        props: {},\n        children: map.call(element.childNodes, function(element) {\n          return element.nodeType === 3\n            ? element.nodeValue\n            : vnode(element, map)\n        })\n      }\n    )\n  }\n\n  function render(next) {\n    lock = !lock;\n    next = view(store);\n\n    if (container && !lock) {\n      root = patch(container, root, node, (node = next));\n    }\n\n    while ((next = stack.pop())) next();\n  }\n\n  function repaint() {\n    if (view && !lock) {\n      setTimeout(render, (lock = !lock));\n    }\n  }\n\n  function assign(target, source) {\n    var result = {};\n\n    for (var i in target) {\n      result[i] = target[i];\n    }\n\n    for (var i in source) {\n      result[i] = source[i];\n    }\n\n    return result\n  }\n\n  function setDeep(path, value, source) {\n    var target = {};\n    return 0 === path.length\n      ? value\n      : (target[path[0]] =\n          1 < path.length\n            ? setDeep(path.slice(1), value, source[path[0]])\n            : value, assign(source, target))\n  }\n\n  function get(path, source) {\n    for (var i = 0; i < path.length; i++) {\n      source = source[path[i]];\n    }\n    return source\n  }\n\n  function init(path, state, actions) {\n    for (var key in actions) {\n      typeof actions[key] === \"function\"\n        ? (function(key, action) {\n            actions[key] = function(data) {\n              state = get(path, store.state);\n\n              if (typeof (data = action(data)) === \"function\") {\n                data = data(state, actions);\n              }\n\n              if (data && data !== state && !data.then) {\n                repaint(\n                  (store.state = setDeep(\n                    path,\n                    assign(state, data),\n                    store.state\n                  ))\n                );\n              }\n\n              return data\n            };\n          })(key, actions[key])\n        : init(path.concat(key), (state[key] = state[key] || {}), actions[key]);\n    }\n  }\n\n  function getKey(node) {\n    if (node && node.props) {\n      return node.props.key\n    }\n  }\n\n  function setElementProp(element, name, value, oldValue) {\n    if (name === \"key\") {\n    } else if (name === \"style\") {\n      for (var i in assign(oldValue, (value = value || {}))) {\n        element.style[i] = null == value[i] ? \"\" : value[i];\n      }\n    } else {\n      try {\n        element[name] = null == value ? \"\" : value;\n      } catch (_) {}\n\n      if (typeof value !== \"function\") {\n        if (null == value || false === value) {\n          element.removeAttribute(name);\n        } else {\n          element.setAttribute(name, value);\n        }\n      }\n    }\n  }\n\n  function createElement(node, isSVG) {\n    if (typeof node === \"string\") {\n      var element = document.createTextNode(node);\n    } else {\n      var element = (isSVG = isSVG || node.tag === \"svg\")\n        ? document.createElementNS(\"http://www.w3.org/2000/svg\", node.tag)\n        : document.createElement(node.tag);\n\n      if (node.props.oncreate) {\n        stack.push(function() {\n          node.props.oncreate(element);\n        });\n      }\n\n      for (var i = 0; i < node.children.length; i++) {\n        element.appendChild(createElement(node.children[i], isSVG));\n      }\n\n      for (var i in node.props) {\n        setElementProp(element, i, node.props[i]);\n      }\n    }\n    return element\n  }\n\n  function updateElement(element, oldProps, props) {\n    for (var i in assign(oldProps, props)) {\n      var value = props[i];\n      var oldValue = i === \"value\" || i === \"checked\" ? element[i] : oldProps[i];\n\n      if (value !== oldValue) {\n        setElementProp(element, i, value, oldValue);\n      }\n    }\n\n    if (props.onupdate) {\n      stack.push(function() {\n        props.onupdate(element, oldProps);\n      });\n    }\n  }\n\n  function destroyChildren(element, node) {\n    if (typeof node !== \"string\") {\n      for (var i = 0; i < node.children.length; i++) {\n        destroyChildren(element.childNodes[i], node.children[i]);\n      }\n\n      if (node.props.ondestroy) {\n        node.props.ondestroy(element);\n      }\n    }\n  }\n\n  function removeElement(parent, element, node) {\n    function done() {\n      destroyChildren(element, node);\n      parent.removeChild(element);\n    }\n\n    if (node.props && node.props.onremove) {\n      node.props.onremove(element, done);\n    } else {\n      done();\n    }\n  }\n\n  function patch(parent, element, oldNode, node, isSVG, nextSibling) {\n    if (oldNode === node) {\n    } else if (null == oldNode) {\n      element = parent.insertBefore(createElement(node, isSVG), element);\n    } else if (node.tag != null && node.tag === oldNode.tag) {\n      updateElement(element, oldNode.props, node.props);\n\n      isSVG = isSVG || node.tag === \"svg\";\n\n      var len = node.children.length;\n      var oldLen = oldNode.children.length;\n      var oldKeyed = {};\n      var oldElements = [];\n      var keyed = {};\n\n      for (var i = 0; i < oldLen; i++) {\n        var oldElement = (oldElements[i] = element.childNodes[i]);\n        var oldChild = oldNode.children[i];\n        var oldKey = getKey(oldChild);\n\n        if (null != oldKey) {\n          oldKeyed[oldKey] = [oldElement, oldChild];\n        }\n      }\n\n      var i = 0;\n      var j = 0;\n\n      while (j < len) {\n        var oldElement = oldElements[i];\n        var oldChild = oldNode.children[i];\n        var newChild = node.children[j];\n\n        var oldKey = getKey(oldChild);\n        if (keyed[oldKey]) {\n          i++;\n          continue\n        }\n\n        var newKey = getKey(newChild);\n        var keyedNode = oldKeyed[newKey] || [];\n\n        if (null == newKey) {\n          if (null == oldKey) {\n            patch(element, oldElement, oldChild, newChild, isSVG);\n            j++;\n          }\n          i++;\n        } else {\n          if (oldKey === newKey) {\n            patch(element, keyedNode[0], keyedNode[1], newChild, isSVG);\n            i++;\n          } else if (keyedNode[0]) {\n            element.insertBefore(keyedNode[0], oldElement);\n            patch(element, keyedNode[0], keyedNode[1], newChild, isSVG);\n          } else {\n            patch(element, oldElement, null, newChild, isSVG);\n          }\n\n          j++;\n          keyed[newKey] = newChild;\n        }\n      }\n\n      while (i < oldLen) {\n        var oldChild = oldNode.children[i];\n        var oldKey = getKey(oldChild);\n        if (null == oldKey) {\n          removeElement(element, oldElements[i], oldChild);\n        }\n        i++;\n      }\n\n      for (var i in oldKeyed) {\n        var keyedNode = oldKeyed[i];\n        var reusableNode = keyedNode[1];\n        if (!keyed[reusableNode.props.key]) {\n          removeElement(element, keyedNode[0], reusableNode);\n        }\n      }\n    } else if (element && node !== element.nodeValue) {\n      if (typeof node === \"string\" && typeof oldNode === \"string\") {\n        element.nodeValue = node;\n      } else {\n        element = parent.insertBefore(\n          createElement(node, isSVG),\n          (nextSibling = element)\n        );\n        removeElement(parent, nextSibling, oldNode);\n      }\n    }\n\n    return element\n  }\n\n  var lock;\n  var root = container && container.children[0];\n  var node = vnode(root, [].map);\n  var stack = [];\n  var store = assign({}, model);\n\n  repaint(\n    init(\n      [],\n      (store.state = assign({}, store.state)),\n      (store.actions = assign({}, store.actions))\n    )\n  );\n\n  return store\n}\n\nexports.h = h;\nexports.app = app;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=hyperapp.js.map\n"]}