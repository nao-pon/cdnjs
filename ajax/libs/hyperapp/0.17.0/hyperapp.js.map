{"version":3,"sources":["dist/hyperapp.js"],"names":["global","factory","exports","module","define","amd","hyperapp","this","h","tag","props","node","stack","children","i","arguments","length","push","Array","isArray","pop","app","model","view","container","vnode","element","map","tagName","toLowerCase","call","childNodes","nodeType","nodeValue","set","target","source","merge","setDeep","path","value","slice","get","init","key","action","data","then","repaint","concat","getKey","setElementProp","name","oldValue","style","_","removeAttribute","setAttribute","createElement","isSVG","document","createTextNode","createElementNS","oncreate","appendChild","removeElement","parent","done","removeChild","onremove","patch","oldNode","nextSibling","insertBefore","oldProps","onupdate","updateElement","len","oldLen","oldKeyed","oldElements","keyed","oldElement","oldKey","oldChild","j","newChild","newKey","keyedNode","reusableNode","render","next","lock","root","setTimeout","body"],"mappings":"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","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.hyperapp = {})));\n}(this, (function (exports) { 'use strict';\n\nfunction h(tag, props) {\n  var node;\n  var stack = [];\n  var children = [];\n\n  for (var i = arguments.length; i-- > 2; ) {\n    stack.push(arguments[i]);\n  }\n\n  while (stack.length) {\n    if (Array.isArray((node = stack.pop()))) {\n      for (var i = node.length; i--; ) {\n        stack.push(node[i]);\n      }\n    } else if (null == node || true === node || false === node) {\n    } else {\n      children.push(typeof node === \"number\" ? (node += \"\") : node);\n    }\n  }\n\n  return typeof tag === \"string\"\n    ? {\n        tag: tag,\n        props: props || {},\n        children: children\n      }\n    : tag(props || {}, children)\n}\n\nfunction app(model, view, container) {\n  var lock;\n  var root = (container = container || document.body).children[0];\n  var node = vnode(root, [].map);\n  var stack = [];\n\n  repaint(init(model, []));\n\n  return model\n\n  function vnode(element, map) {\n    return (\n      element && {\n        tag: element.tagName.toLowerCase(),\n        props: {},\n        children: map.call(element.childNodes, function(element) {\n          return 3 === element.nodeType\n            ? element.nodeValue\n            : vnode(element, map)\n        })\n      }\n    )\n  }\n\n  function set(target, source) {\n    for (var i in source) {\n      target[i] = source[i];\n    }\n    return target\n  }\n\n  function merge(target, source) {\n    return set(set({}, target), source)\n  }\n\n  function setDeep(path, value, source) {\n    var target = {};\n    return 0 === path.length\n      ? value\n      : (target[path[0]] =\n          1 < path.length\n            ? setDeep(path.slice(1), value, source[path[0]])\n            : value, merge(source, target))\n  }\n\n  function get(path, source) {\n    for (var i = 0; i < path.length; i++) {\n      source = source[path[i]];\n    }\n    return source\n  }\n\n  function init(source, path) {\n    for (var key in source) {\n      typeof source[key] === \"function\"\n        ? (function(key, action) {\n            source[key] = function(data) {\n              source = get(path, model);\n\n              if (typeof (data = action(data)) === \"function\") {\n                data = data(source);\n              }\n\n              if (data && data !== source && !data.then) {\n                repaint((model = setDeep(path, merge(source, data), model)));\n              }\n\n              return data\n            };\n          })(key, source[key])\n        : typeof source[key] === \"object\" &&\n          !Array.isArray(source[key]) &&\n          init(source[key], path.concat(key));\n    }\n  }\n\n  function getKey(node) {\n    if (node && node.props) {\n      return node.props.key\n    }\n  }\n\n  function setElementProp(element, name, value, oldValue) {\n    if (name === \"key\") {\n    } else if (name === \"style\") {\n      for (var i in merge(oldValue, (value = value || {}))) {\n        element.style[i] = null == value[i] ? \"\" : value[i];\n      }\n    } else {\n      try {\n        element[name] = null == value ? \"\" : value;\n      } catch (_) {}\n\n      if (typeof value !== \"function\") {\n        if (null == value || false === value) {\n          element.removeAttribute(name);\n        } else {\n          element.setAttribute(name, value);\n        }\n      }\n    }\n  }\n\n  function createElement(node, isSVG) {\n    if (typeof node === \"string\") {\n      var element = document.createTextNode(node);\n    } else {\n      var element = (isSVG = isSVG || node.tag === \"svg\")\n        ? document.createElementNS(\"http://www.w3.org/2000/svg\", node.tag)\n        : document.createElement(node.tag);\n\n      if (node.props.oncreate) {\n        stack.push(function() {\n          node.props.oncreate(element);\n        });\n      }\n\n      for (var i = 0; i < node.children.length; i++) {\n        element.appendChild(createElement(node.children[i], isSVG));\n      }\n\n      for (var i in node.props) {\n        setElementProp(element, i, node.props[i]);\n      }\n    }\n    return element\n  }\n\n  function updateElement(element, oldProps, props) {\n    for (var i in merge(oldProps, props)) {\n      var value = props[i];\n      var oldValue = i === \"value\" || i === \"checked\" ? element[i] : oldProps[i];\n\n      if (value !== oldValue) {\n        setElementProp(element, i, value, oldValue);\n      }\n    }\n\n    if (props.onupdate) {\n      stack.push(function() {\n        props.onupdate(element, oldProps);\n      });\n    }\n  }\n\n  function removeElement(parent, element, props) {\n    function done() {\n      parent.removeChild(element);\n    }\n\n    if (props && props.onremove) {\n      props.onremove(element, done);\n    } else {\n      done();\n    }\n  }\n\n  function patch(parent, element, oldNode, node, isSVG, nextSibling) {\n    if (oldNode === node) {\n    } else if (null == oldNode) {\n      element = parent.insertBefore(createElement(node, isSVG), element);\n    } else if (node.tag != null && node.tag === oldNode.tag) {\n      updateElement(element, oldNode.props, node.props);\n\n      isSVG = isSVG || node.tag === \"svg\";\n\n      var len = node.children.length;\n      var oldLen = oldNode.children.length;\n      var oldKeyed = {};\n      var oldElements = [];\n      var keyed = {};\n\n      for (var i = 0; i < oldLen; i++) {\n        var oldElement = (oldElements[i] = element.childNodes[i]);\n        var oldChild = oldNode.children[i];\n        var oldKey = getKey(oldChild);\n\n        if (null != oldKey) {\n          oldKeyed[oldKey] = [oldElement, oldChild];\n        }\n      }\n\n      var i = 0;\n      var j = 0;\n\n      while (j < len) {\n        var oldElement = oldElements[i];\n        var oldChild = oldNode.children[i];\n        var newChild = node.children[j];\n\n        var oldKey = getKey(oldChild);\n        if (keyed[oldKey]) {\n          i++;\n          continue\n        }\n\n        var newKey = getKey(newChild);\n        var keyedNode = oldKeyed[newKey] || [];\n\n        if (null == newKey) {\n          if (null == oldKey) {\n            patch(element, oldElement, oldChild, newChild, isSVG);\n            j++;\n          }\n          i++;\n        } else {\n          if (oldKey === newKey) {\n            patch(element, keyedNode[0], keyedNode[1], newChild, isSVG);\n            i++;\n          } else if (keyedNode[0]) {\n            element.insertBefore(keyedNode[0], oldElement);\n            patch(element, keyedNode[0], keyedNode[1], newChild, isSVG);\n          } else {\n            patch(element, oldElement, null, newChild, isSVG);\n          }\n\n          j++;\n          keyed[newKey] = newChild;\n        }\n      }\n\n      while (i < oldLen) {\n        var oldChild = oldNode.children[i];\n        var oldKey = getKey(oldChild);\n        if (null == oldKey) {\n          removeElement(element, oldElements[i], oldChild.props);\n        }\n        i++;\n      }\n\n      for (var i in oldKeyed) {\n        var keyedNode = oldKeyed[i];\n        var reusableNode = keyedNode[1];\n        if (!keyed[reusableNode.props.key]) {\n          removeElement(element, keyedNode[0], reusableNode.props);\n        }\n      }\n    } else if (element && node !== element.nodeValue) {\n      if (typeof node === \"string\" && typeof oldNode === \"string\") {\n        element.nodeValue = node;\n      } else {\n        element = parent.insertBefore(\n          createElement(node, isSVG),\n          (nextSibling = element)\n        );\n        removeElement(parent, nextSibling, oldNode.props);\n      }\n    }\n\n    return element\n  }\n\n  function render(next) {\n    lock = !lock;\n    next = view(model);\n\n    if (!lock) {\n      root = patch(container, root, node, (node = next));\n    }\n\n    while ((next = stack.pop())) next();\n  }\n\n  function repaint() {\n    if (view && !lock) {\n      setTimeout(render, (lock = !lock));\n    }\n  }\n}\n\nexports.h = h;\nexports.app = app;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=hyperapp.js.map\n"]}