(function(t){"use strict";var e=0,r=Array.prototype.slice,i=function(e,r){var i=e[r];if(i===t&&j.strict)throw new Error("Bottle was unable to resolve a service.  `"+r+"` is undefined.");return i},n=function(t){var e;return this.nested[t]||(e=m.pop(),this.nested[t]=e,this.factory(t,function(){return e.container})),this.nested[t]},o=function(t){return t.split(".").reduce(i,this)},s=function(t,e){Object.defineProperty(this,t,{configurable:!1,enumerable:!0,value:e,writable:!1})},a=function(t,e){var r,i;return"function"==typeof t&&(e=t,t="__global__"),r=t.split("."),i=r.shift(),r.length?n.call(this,i).decorator(r.join("."),e):(this.decorators[i]||(this.decorators[i]=[]),this.decorators[i].push(e)),this},c=function(t,e){return h.call(this,t,function(){this.$get=e})},l=function(t){return!/^\$(?:decorator|register|list)$|Provider$/.test(t)},u=function(t){return Object.keys(t||this.container||{}).filter(l)},d={},f=function(t,e){return e(t)},h=function(t,e){var r,i;return r=t.split("."),this.providerMap[t]&&1===r.length&&!this.container[t+"Provider"]?console.error(t+" provider already instantiated."):(this.originalProviders[t]=e,this.providerMap[t]=!0,i=r.shift(),r.length?(n.call(this,i).provider(r.join("."),e),this):v.call(this,i,e))},p=function(t,e){return(t[e]||[]).concat(t.__global__||[])},v=function(e,r){var i,n,o,s,a;return this.id,o=this.container,s=this.decorators,a=this.middlewares,i=e+"Provider",n=Object.create(null),n[i]={configurable:!0,enumerable:!0,get:function(){var t=new r;return delete o[i],o[i]=t,t}},n[e]={configurable:!0,enumerable:!0,get:function(){var r,n=o[i];return n&&(r=p(s,e).reduce(f,n.$get(o)),delete o[i],delete o[e]),r===t?r:function(t,e,r,i){var n={configurable:!0,enumerable:!0};return t.length?n.get=function(){var e=0,i=function(n){if(n)throw n;t[e]&&t[e++](r,i)};return i(),r}:(n.value=r,n.writable=!0),Object.defineProperty(i,e,n),i[e]}(p(a,e),e,r,o)}},Object.defineProperties(o,n),this},b=function(e){var r=e.$value===t?e:e.$value;return this[e.$type||"service"].apply(this,[e.$name,r].concat(e.$inject||[]))},g=function(t){delete this.providerMap[t],delete this.container[t],delete this.container[t+"Provider"]},y=function(t,e){var r=t[e];return r||(r={},w.call(t,e,r)),r},w=function(t,e){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:e,writable:!0})},m=function t(r){if(!(this instanceof t))return t.pop(r);this.id=e++,this.decorators={},this.middlewares={},this.nested={},this.providerMap={},this.originalProviders={},this.deferred=[],this.container={$decorator:a.bind(this),$register:b.bind(this),$list:u.bind(this)}};m.prototype={constant:function(t,e){var r=t.split(".");return t=r.pop(),s.call(r.reduce(y,this.container),t,e),this},decorator:a,defer:function(t){return this.deferred.push(t),this},digest:function(t){return(t||[]).map(o,this.container)},factory:c,instanceFactory:function(t,e){return c.call(this,t,function(t){return{instance:e.bind(e,t)}})},list:u,middleware:function(t,e){var r,i;return"function"==typeof t&&(e=t,t="__global__"),r=t.split("."),i=r.shift(),r.length?n.call(this,i).middleware(r.join("."),e):(this.middlewares[i]||(this.middlewares[i]=[]),this.middlewares[i].push(e)),this},provider:h,resetProviders:function(){var t=this.originalProviders;Object.keys(this.originalProviders).forEach(function(e){var r=e.split(".");r.length>1&&(g.call(this,r[0]),r.forEach(g,n.call(this,r[0]))),g.call(this,e),this.provider(e,t[e])},this)},register:b,resolve:function(t){return this.deferred.forEach(function(e){e(t)}),this},service:function(t,e){var i=arguments.length>2?r.call(arguments,2):null,n=this;return c.call(this,t,function(){var t=e;if(i){var r=i.map(o,n.container);r.unshift(e),t=e.bind.apply(e,r)}return new t})},value:function(t,e){var r;return r=t.split("."),t=r.pop(),w.call(r.reduce(y,this.container),t,e),this}},m.pop=function(t){var e;return"string"==typeof t?((e=d[t])||(d[t]=e=new m,e.constant("BOTTLE_NAME",t)),e):new m},m.clear=function(t){"string"==typeof t?delete d[t]:d={}},m.list=u;var j=m.config={strict:!1},P={function:!0,object:!0};!function(t){var e=P[typeof exports]&&exports&&!exports.nodeType&&exports,r=P[typeof module]&&module&&!module.nodeType&&module,i=r&&r.exports===e&&e,n=P[typeof global]&&global;!n||n.global!==n&&n.window!==n||(t=n),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t.Bottle=m,define(function(){return m})):e&&r?i?(r.exports=m).Bottle=m:e.Bottle=m:t.Bottle=m}(P[typeof window]&&window||this)}).call(this);