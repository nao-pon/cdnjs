!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).parser=e()}}(function(){return function e(t,r,n){function i(a,l){if(!r[a]){if(!t[a]){var f="function"==typeof require&&require;if(!l&&f)return f(a,!0);if(o)return o(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){var r=t[a][1][e];return i(r||e)},u,u.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){function n(e,t){if(t){var r=e.split(":"),n="/"===e.charAt(0)?"/":"";2===r.length&&(e=n+r[1])}return e}function i(e,t){return e=e?!t||isNaN(e)?""+e:-1!==e.indexOf(".")?parseFloat?parseFloat(e):Number.parseFloat(e):parseInt?parseInt(e,10):Number.parseInt(e,10):""}function o(e,t,r,o,l,f){if(e=e||e.trim(),!t&&e.length>3){var d=a(e,v),u={},s=u;o&&d.length&&(s=u[o]={});for(var g=0;g<d.length;g++){s[r+n(d[g][1],l)]=i(d[g][3],f)}return u}}var a=e("./util").getAllMatches,l=function(e,t,r){this.tagname=e,this.parent=t,this.child=[],this.val=r,this.addChild=function(e){this.child.push(e)}},f="<!\\[CDATA\\[(.*?)(\\]\\]>)",d=new RegExp("<(\\/?[\\w:\\-._]+)([^>]*)>("+f+")*([^<]+)?","g"),u={attrPrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreNonTextNodeAttr:!0,ignoreTextNodeAttr:!0,ignoreNameSpace:!1,ignoreRootElement:!1,textNodeConversion:!0,textAttrConversion:!1,arrayMode:!1},s=function(e){e||(e={});for(var t=["attrPrefix","attrNodeName","ignoreNonTextNodeAttr","ignoreTextNodeAttr","ignoreNameSpace","ignoreRootElement","textNodeName","textNodeConversion","textAttrConversion","arrayMode"],r=0;r<t.length;r++)void 0===e[t[r]]&&(e[t[r]]=u[t[r]]);return e},g=function(e,t){t=s(t);for(var r=a(e,d),f=new l("!xml"),u=f,g=0;g<r.length;g++){var v,h=n(r[g][1],t.ignoreNameSpace),x=g+1<r.length?n(r[g+1][1],t.ignoreNameSpace):void 0,p=r[g][2],N=void 0===r[g][4]?r[g][6]:function(e){for(var t=a(e,c),r="",n=0;n<t.length;n++)r+=t[n][1];return r}(r[g][0]);if(0!==h.indexOf("/")){var m="/"===p.charAt(p.length-1),A=new l(h,u);if(m)v=o(p,t.ignoreTextNodeAttr,t.attrPrefix,t.attrNodeName,t.ignoreNameSpace,t.textAttrConversion),A.val=v||"",u.addChild(A);else if("/"+h===x)v=o(p,t.ignoreTextNodeAttr,t.attrPrefix,t.attrNodeName,t.ignoreNameSpace,t.textAttrConversion),N=i(N,t.textNodeConversion),v?(v[t.textNodeName]=N,A.val=v):A.val=void 0!==N&&null!=N?N:"",u.addChild(A),g++;else if(x&&-1===x.indexOf("/")&&void 0!==N&&null!=N&&""!==N.trim())N=i(N,t.textNodeConversion),A.addChild(new l(t.textNodeName,A,N)),u.addChild(A),u=A;else{if(v=o(p,t.ignoreNonTextNodeAttr,t.attrPrefix,t.attrNodeName,t.ignoreNameSpace,t.textAttrConversion))for(var w in v)v.hasOwnProperty(w)&&A.addChild(new l(w,A,v[w]));u.addChild(A),u=A}}else u=u.parent}return f},c=new RegExp(f,"g"),v=new RegExp("(\\S+)\\s*=\\s*(['\"])(.*?)\\2","g"),h=function(e,t){var r={};if(void 0!==e.val&&null!=e.val||""===e.val)return e.val;for(var n=0;n<e.child.length;n++){var i=e.child[n].tagname,o=h(e.child[n],t);if(void 0!==r[i]){if(!Array.isArray(r[i])){var a=r[i];r[i]=[],r[i].push(a)}r[i].push(o)}else r[i]=t?[o]:o}return r};r.parse=function(e,t){return h(g(e,t),s(t).arrayMode)},r.getTraversalObj=g,r.convertToJson=h,r.validate=e("./validator").validate},{"./util":2,"./validator":3}],2:[function(e,t,r){var n=function(e,t){var r=t.exec(e);return null!==r&&void 0!==r};r.doesMatch=n,r.doesNotMatch=function(e,t){return!n(e,t)},r.getAllMatches=function(e,t){for(var r=[],n=t.exec(e);n;){for(var i=[],o=0;o<n.length;o++)i.push(n[o]);r.push(i),n=t.exec(e)}return r}},{}],3:[function(e,t,r){function n(e){return!a.doesMatch(e,f)&&!a.doesNotMatch(e,d)}function o(e,t){if(e.length===t)return!0;if(0===e[t][0].indexOf("</"))return t;if(e[t][0].indexOf("/>")===e[t][0].length-2)return!1===n(e[t][0].substring(1))?-1:o(e,t+1);if(e.length>t+1){if(0===e[t+1][0].indexOf("</"))return!1===n(e[t][1])?-1:e[t][1]===e[t+1][1]?o(e,t+2):-1;var r=o(e,t+1);if(-1!==r&&void 0!==e[r]&&0===e[r][0].indexOf("</"))return!1===n(e[t][1])?-1:e[t][1]===e[r][1]?o(e,r+1):-1}return-1}var a=e("./util"),l=new RegExp("<\\/?([\\w:\\-_.]+)\\s*/?>","g");r.validate=function(e){if(e=e.replace(/\n/g,""),e=e.replace(/(<!\[CDATA\[.*?\]\]>)/g,""),e=e.replace(/(<!--.*?(?:-->))/g,""),!0!==function(e){var t=a.getAllMatches(e,u);for(i=0;i<t.length;i++){if(t[i][1].trim().length>0&&t[i][1].trim().length<4)return!1;if(0!==t[i][1].trim().length){var r=a.getAllMatches(t[i][1],s),n=[];for(j=0;j<r.length;j++){if(n.hasOwnProperty(r[j][1]))return!1;n[r[j][1]]=1}}}return!0}(e))return!1;if(e=e.replace(/(\s+(?:[\w:\-]+)\s*=\s*(['\"]).*?\2)/g,""),(e=e.replace(/(^\s*<\?xml\s*\?>)/g,"")).indexOf("<![CDATA[")>0||e.indexOf("\x3c!--")>0)return!1;var t=a.getAllMatches(e,l);if(0===t.length)return!1;return!0===o(t,0)};var f=new RegExp("^[Xx][Mm][Ll]"),d=new RegExp("^([a-zA-Z]|_)[\\w.\\-_:]*"),u=new RegExp("<[\\w:\\-_.]+(.*?)/?>","g"),s=new RegExp("\\s+([\\w:-]+)\\s*=\\s*(['\"])(.*?)\\2","g")},{"./util":2}]},{},[1])(1)});