!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).parser=e()}}(function(){return function e(t,r,n){function i(a,f){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!f&&l)return l(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var d=r[a]={exports:{}};t[a][0].call(d.exports,function(e){var r=t[a][1][e];return i(r||e)},d,d.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){var n=e("./util").getAllMatches,i=function(e,t,r){this.tagname=e,this.parent=t,this.child=[],this.val=r,this.addChild=function(e){this.child.push(e)}},o="<!\\[CDATA\\[(.*?)(\\]\\]>)",a=new RegExp("<(\\/?[\\w:\\-._]+)([^>]*)>(\\s*"+o+")*([^<]+)?","g"),f={attrPrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreNonTextNodeAttr:!0,ignoreTextNodeAttr:!0,ignoreNameSpace:!1,ignoreRootElement:!1,textNodeConversion:!0,textAttrConversion:!1,arrayMode:!1},l=function(e){e||(e={});for(var t=["attrPrefix","attrNodeName","ignoreNonTextNodeAttr","ignoreTextNodeAttr","ignoreNameSpace","ignoreRootElement","textNodeName","textNodeConversion","textAttrConversion","arrayMode"],r=0;r<t.length;r++)void 0===e[t[r]]&&(e[t[r]]=f[t[r]]);return e},u=function(e,t){t=l(t),e=e.replace(/<!--(.|\n)*?-->/g,"");for(var r=n(e,a),o=new i("!xml"),f=o,u=0;u<r.length;u++){var d,v=g(r[u][1],t.ignoreNameSpace),p=u+1<r.length?g(r[u+1][1],t.ignoreNameSpace):void 0,x=r[u][2],N=void 0===r[u][4]?r[u][6]:s(r[u][0]);if(0!==v.indexOf("/")){var m="/"===x.charAt(x.length-1),w=new i(v,f);if(m)d=c(x,t.ignoreTextNodeAttr,t.attrPrefix,t.attrNodeName,t.ignoreNameSpace,t.textAttrConversion),w.val=d||"",f.addChild(w);else if("/"+v===p)d=c(x,t.ignoreTextNodeAttr,t.attrPrefix,t.attrNodeName,t.ignoreNameSpace,t.textAttrConversion),N=h(N,t.textNodeConversion),d?(d[t.textNodeName]=N,w.val=d):w.val=N,f.addChild(w),u++;else if(p&&-1===p.indexOf("/")&&void 0!==N&&null!=N&&""!==N.trim())N=h(N,t.textNodeConversion),w.addChild(new i(t.textNodeName,w,N)),f.addChild(w),f=w;else{if(d=c(x,t.ignoreNonTextNodeAttr,t.attrPrefix,t.attrNodeName,t.ignoreNameSpace,t.textAttrConversion))for(var A in d)d.hasOwnProperty(A)&&w.addChild(new i(A,w,d[A]));f.addChild(w),f=w}}else f=f.parent}return o},d=new RegExp(o,"g");function s(e){for(var t=n(e,d),r="",i=0;i<t.length;i++)r+=t[i][1];return r}function g(e,t){if(t){var r=e.split(":"),n="/"===e.charAt(0)?"/":"";if(2===r.length){if("xmlns"===r[0])return"";e=n+r[1]}}return e}function h(e,t){return e=e?!t||isNaN(e)?(e=""+e).replace("\n"," "):-1!==e.indexOf(".")?parseFloat?parseFloat(e):Number.parseFloat(e):parseInt?parseInt(e,10):Number.parseInt(e,10):""}var v=new RegExp("([\\w\\-\\.\\:]+)\\s*=\\s*(['\"])((.|\n)*?)\\2","gm");function c(e,t,r,i,o,a){if(e=e||e.trim(),!t&&e.length>3){for(var f=n(e,v),l={},u=0;u<f.length;u++){var d=g(f[u][1],o);d.length&&"xmlns"!==d&&(l[r+d]=h(f[u][3],a))}if(!Object.keys(l).length)return;if(i){var s={};return s[i]=l,s}return l}}var p=function(e,t){var r={};if(void 0!==e.val&&null!=e.val||""===e.val)return e.val;for(var n=0;n<e.child.length;n++){var i=e.child[n].tagname,o=p(e.child[n],t);if(void 0!==r[i]){if(!Array.isArray(r[i])){var a=r[i];r[i]=[],r[i].push(a)}r[i].push(o)}else r[i]=t?[o]:o}return r};r.parse=function(e,t){return p(u(e,t),l(t).arrayMode)},r.getTraversalObj=u,r.convertToJson=p,r.validate=e("./validator").validate},{"./util":2,"./validator":3}],2:[function(e,t,r){var n=function(e,t){var r=t.exec(e);return null!==r&&void 0!==r};r.doesMatch=n,r.doesNotMatch=function(e,t){return!n(e,t)},r.getAllMatches=function(e,t){for(var r=[],n=t.exec(e);n;){for(var i=[],o=0;o<n.length;o++)i.push(n[o]);r.push(i),n=t.exec(e)}return r}},{}],3:[function(e,t,r){var n=e("./util");new RegExp("<\\/?([\\w:\\-_.]+)\\s*/?>","g");function i(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}function o(e){for(var t,r=[],i=0;i<e.length;i++){for(var o="",f="";i<e.length&&"="!==e[i];i++)f+=e[i];if(f=f.trim(),r.hasOwnProperty(f))return!1;if(r[f]=1,t=f,!n.doesMatch(t,a))return!1;for(i++;i<e.length&&(" "===e[i]||"\t"===e[i]);i++);o=e[i++];for(;i<e.length&&e[i]!==o;i++)e[i];if(""!==o){if(++i<e.length&&" "!==e[i]&&"\t"!==e[i])return!1;o=""}}return!0}r.validate=function(e){e=(e=(e=e.replace(/\n/g,"")).replace(/(^\s*<\?xml.*?\?>)/g,"")).replace(/(<!DOCTYPE[\s\w\"\.\/\-\:]+(\[.*\])*\s*>)/g,"");for(var t=[],r=0;r<e.length;r++){if("<"!==e[r]){if(" "===e[r]||"\t"===e[r])continue;return!1}if("!"!==e[++r]){var n=!1;"/"===e[r]&&(n=!0,r++);for(var a="";r<e.length&&">"!==e[r]&&" "!==e[r]&&"\t"!==e[r];r++)a+=e[r];if("/"===(a=a.trim())[a.length-1])return l(a=a.substring(0,a.length-2));if(!l(a))return!1;for(var f="",u="";r<e.length;r++){if('"'===e[r]||"'"===e[r])u=""===u?e[r]:"";else if(">"===e[r]&&""===u)break;f+=e[r]}if(""!==u)return!1;if("/"===(f=f.trim())[f.length-1]){if(o(f=f.substring(0,f.length-2)))continue;return!1}if(n){if(f.length>0)return!1;if(a!==t.pop())return!1}else{if(!o(f))return!1;t.push(a)}for(r++;r<e.length;r++)if("<"===e[r]){if("!"===e[r+1]){r=i(e,++r);continue}break}"<"===e[r]&&r--}else r=i(e,r)}return!(t.length>0)};var a=new RegExp("^[_a-zA-Z][\\w\\-\\.\\:]*$");var f=new RegExp("^([a-zA-Z]|_)[\\w.\\-_:]*");function l(e){return!n.doesNotMatch(e,f)}},{"./util":2}]},{},[1])(1)});