!function(t){var e=t.paramquery=t.paramquery||{};t.paramquery.pqgrid=t.paramquery.pqgrid||{},e.xmlToArray=function(e,i){var r=i.itemParent,o=i.itemNames,n=[];return t(e).find(r).each(function(e,i){var r=t(i),a=[];t(o).each(function(t,e){a.push(r.find(e).text().replace(/\r|\n|\t/g,""))}),n.push(a)}),n},e.xmlToJson=function(e,i){var r=i.itemParent,o=i.itemNames,n=[];return t(e).find(r).each(function(e,i){for(var r=t(i),a={},l=0,s=o.length;l<s;l++){var d=o[l];a[d]=r.find(d).text().replace(/\r|\n|\t/g,"")}n.push(a)}),n},e.tableToArray=function(e){var i=[],r=[],o=t(e).children("tbody").children("tr"),n=o.length?t(o[0]):t(),a=o.length>1?t(o[1]):t();return n.children("th,td").each(function(e,r){var o=t(r),n=o.html(),l=o.width(),s="left";if(a.length){var d=a.find("td:eq("+e+")").attr("align");s=d||s}var h={title:n,width:l,dataType:"string",align:s,dataIndx:e};i.push(h)}),o.each(function(e,i){if(0!=e){var o=[];t(i).children("td").each(function(e,i){o.push(t.trim(t(i).html()))}),r.push(o)}}),{data:r,colModel:i}},e.formatCurrency=function(t){if(isNaN(t))return t;t=Math.round(10*t)/10,-1==(t+="").indexOf(".")&&(t+=".0");for(var e=t.length,i=t.substring(0,e-2),r=t.substring(e-2,e),o=i.match(/\d/g).reverse(),n=[],a=0;a<o.length;a++)a>0&&a%3==0&&n.push(","),n.push(o[a]);return n=n.reverse(),(i=n.join(""))+r},e.validation={is:function(t,e){return"string"==t||!t||(t=t.substring(0,1).toUpperCase()+t.substring(1,t.length),this["is"+t](e))},isFloat:function(t){var e=parseFloat(t);return!isNaN(e)&&e==t},isInteger:function(t){var e=parseInt(t);return!isNaN(e)&&e==t},isDate:function(t){var e=Date.parse(t);return!isNaN(e)}}}(jQuery),function(t){var e={};e.options={curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20},e._regional={strDisplay:"Displaying {0} to {1} of {2} items.",strFirstPage:"First Page",strLastPage:"Last Page",strNextPage:"Next Page",strPage:"Page {0} of {1}",strPrevPage:"Previous Page",strRefresh:"Refresh",strRpp:"Records per page:{0}"},t.extend(e.options,e._regional),e._create=function(){var e=this,i=this.options;this.element.addClass("pq-pager"),this.first=t("<button type='button' title='"+i.strFirstPage+"'></button>",{}).appendTo(this.element).button({icons:{primary:"ui-icon-seek-first"},text:!1}).bind("click.paramquery",function(t){e.options.curPage>1&&e._onChange(t,1)}),this.prev=t("<button type='button' title='"+i.strPrevPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-prev"},text:!1}).bind("click",function(t){if(e.options.curPage>1){var i=e.options.curPage-1;e._onChange(t,i)}}),t("<span class='pq-separator'></span>").appendTo(this.element),this.pageHolder=t("<span class='pq-page-placeholder'></span>").appendTo(this.element),t("<span class='pq-separator'></span>").appendTo(this.element),this.next=t("<button type='button' title='"+this.options.strNextPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-next"},text:!1}).bind("click",function(t){var i=e.options.curPage+1;e._onChange(t,i)}),this.last=t("<button type='button' title='"+this.options.strLastPage+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-seek-end"},text:!1}).bind("click",function(t){var i=e.options.totalPages;e._onChange(t,i)}),t("<span class='pq-separator'></span>").appendTo(this.element),this.rPPHolder=t("<span class='pq-page-placeholder'></span>").appendTo(this.element),this.$refresh=t("<button type='button' title='"+this.options.strRefresh+"'></button>").appendTo(this.element).button({icons:{primary:"ui-icon-refresh"},text:!1}).bind("click",function(t){if(!1===e._trigger("beforeRefresh",t))return!1;e._trigger("refresh",t)}),t("<span class='pq-separator'></span>").appendTo(this.element),this.$msg=t("<span class='pq-pager-msg'></span>").appendTo(this.element),this._refresh()},e._refreshPage=function(){var e=this;this.pageHolder.empty();for(var i=this.options,r=i.strPage.split(" "),o=[],n=0,a=r.length;n<a;n++){var l=r[n];"{0}"==l?o.push("<input type='text' tabindex='0' class='ui-corner-all' />"):"{1}"==l?o.push("<span class='total'></span>"):o.push("<span>",l,"</span>")}var s=o.join(""),d=t(s).appendTo(this.pageHolder);this.page=d.filter("input").bind("change",function(r){var o=t(this),n=o.val();return isNaN(n)||n<1?(o.val(i.curPage),!1):(n=parseInt(n))>i.totalPages?(o.val(i.curPage),!1):!1===e._onChange(r,n)?(o.val(i.curPage),!1):void 0}),this.$total=d.filter("span.total")},e._onChange=function(t,e){return!1!==this._trigger("beforeChange",t,{curPage:e})&&(!1!==this._trigger("change",t,{curPage:e})&&void this.option({curPage:e}))},e._refresh=function(){this._refreshPage();this.$rPP;var e=this,i=this.options;if(this.first.attr("title",i.strFirstPage),this.prev.attr("title",i.strPrevPage),this.next.attr("title",i.strNextPage),this.last.attr("title",i.strLastPage),this.$refresh.attr("title",i.strRefresh),this.rPPHolder.empty(),i.strRpp){var r=i.rPPOptions,o=i.strRpp;if(-1!=o.indexOf("{0}")){for(var n=["<select class='ui-corner-all'>"],a=0,l=r.length;a<l;a++){var s=r[a];n.push('<option value="',s,'">',s,"</option>")}n.push("</select>");var d=n.join("");o="<span>"+(o=o.replace("{0}","</span>"+d))+"<span class='pq-separator'></span>"}else o="<span>"+o+"</span><span class='pq-separator'></span>";this.$rPP=t(o).appendTo(this.rPPHolder).filter("select").val(i.rPP).change(function(i){var r=t(this),o=r.val();if(!1===e._trigger("beforeChange",i,{rPP:o}))return r.val(e.options.rPP),!1;!1!==e._trigger("change",i,{rPP:o})&&(e.options.rPP=o)})}if(i.curPage>=i.totalPages?(this.next.button({disabled:!0}),this.last.button({disabled:!0})):(this.next.button({disabled:!1}),this.last.button({disabled:!1})),i.curPage<=1?(this.first.button({disabled:!0}),this.prev.button({disabled:!0})):(this.first.button({disabled:!1}),this.prev.button({disabled:!1})),this.page.val(i.curPage),this.$total.text(i.totalPages),this.options.totalRecords>0){var h=i.rPP,c=i.curPage,u=i.totalRecords,f=(c-1)*h,p=c*h;p>u&&(p=u);var g=i.strDisplay;g=(g=(g=g.replace("{0}",f+1)).replace("{1}",p)).replace("{2}",u),this.$msg.html(g)}else this.$msg.html("")},e._destroy=function(){this.element.empty().removeClass("pq-pager").enableSelection()},e._setOption=function(t,e){"curPage"!=t&&"totalPages"!=t||(e=parseInt(e)),this._super.call(this,t,e)},e._setOptions=function(){this._super.apply(this,arguments),this._refresh()},t.widget("paramquery.pqPager",e),t.paramquery.pqPager.regional={},t.paramquery.pqPager.regional.en=e._regional}(jQuery),function(t){var e={};e.options={length:200,num_eles:3,cur_pos:0,ratio:0,timeout:350,pace:"optimum",direction:"vertical",theme:!1},e._destroy=function(){this.element.removeClass("pq-sb-vert pq-sb-vert-t pq-sb-vert-wt").enableSelection().removeClass("pq-sb-horiz pq-sb-horiz-t pq-sb-horiz-wt").unbind("click.pq-scrollbar").empty(),this.element.removeData()},e._create=function(){this._createLayout()},e._createLayout=function(){var e=this,i=this.options,r=i.direction,o=i.theme,n=this.element.empty();"vertical"==r?(n.removeClass("pq-sb-vert-t pq-sb-vert-wt").addClass("pq-sb-vert"),o?(n.addClass("pq-sb-vert-t"),n.html(["<div class='top-btn pq-sb-btn ui-state-default ui-corner-top'>","<div class='ui-icon ui-icon-triangle-1-n'></div></div>","<div class='pq-sb-slider ui-corner-all ui-state-default'>","</div>","<div class='bottom-btn pq-sb-btn ui-state-default ui-corner-bottom'>","<div class='ui-icon ui-icon-triangle-1-s'></div></div>"].join(""))):(n.addClass("pq-sb-vert-wt"),n.html(["<div class='top-btn pq-sb-btn'></div>","<div class='pq-sb-slider'>","<div class='vert-slider-top'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-center'></div>","<div class='vert-slider-bg'></div>","<div class='vert-slider-bottom'></div>","</div>","<div class='bottom-btn pq-sb-btn'></div>"].join("")))):(n.removeClass("pq-sb-horiz-t pq-sb-horiz-wt").addClass("pq-sb-horiz"),o?(n.addClass("pq-sb-horiz-t"),n.html(["<div class='left-btn pq-sb-btn ui-state-default ui-corner-left'>","<div class='ui-icon ui-icon-triangle-1-w'></div></div>","<div class='pq-sb-slider pq-sb-slider-h ui-state-default ui-corner-all'>","</div>","<div class='right-btn pq-sb-btn ui-state-default ui-corner-right'>","<div class='ui-icon ui-icon-triangle-1-e'></div></div>"].join(""))):(n.addClass("pq-sb-horiz-wt"),n.width(this.width),n.html(["<div class='left-btn pq-sb-btn'></div>","<div class='pq-sb-slider pq-sb-slider-h'>","<span class='horiz-slider-left'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-center'></span>","<span class='horiz-slider-bg'></span>","<span class='horiz-slider-right'></span>","</div>","<div class='right-btn pq-sb-btn'></div>"].join("")))),n.disableSelection().unbind(".pq-scrollbar").on("mouseup.pq-scrollbar",function(t){e._mouseup(t)}).on("mousedown.pq-scrollbar",function(t){if(!i.disabled&&!e.$slider.is(":hidden"))if("vertical"==r){var o=t.pageY,n=(h=e.element.offset().top)+i.length,a=e.$slider,l=a.offset().top,s=a.height(),d=l+s;o<l&&o>h+17?e.mousedownInterval=window.setInterval(function(){o>=a.offset().top?(window.clearInterval(e.mousedownInterval),e.mousedownInterval=null):e._pageUp(t)},0):o>d&&o<n-17&&(e.mousedownInterval=window.setInterval(function(){o<=a.offset().top+s?(window.clearInterval(e.mousedownInterval),e.mousedownInterval=null):e._pageDown(t)},0))}else{var h,c=t.pageX;n=(h=e.element.offset().left)+i.length,d=(l=e.$slider.offset().left)+e.$slider.width();c<l&&c>h+17?(e.$slider.css("left",c-e.element.offset().left),e._updateCurPosAndTrigger(t)):c>d&&c<n-17&&(e.$slider.css("left",c-e.element.offset().left-e.$slider.width()),e._updateCurPosAndTrigger(t))}});var a=this.$slider=t("div.pq-sb-slider",this.element);o&&a.attr("tabindex","0"),this._bindSliderEvents(a),this.$top_btn=t("div.top-btn,div.left-btn",this.element).click(function(t){if(!e.options.disabled)return e.decr_cur_pos(t),t.preventDefault(),!1}).mousedown(function(t){e.options.disabled||(e.mousedownTimeout=window.setTimeout(function(){e.mousedownInterval=window.setInterval(function(){e.decr_cur_pos(t)},0)},e.options.timeout))}).bind("mouseup mouseout",function(t){e._mouseup(t)}),this.$bottom_btn=t("div.bottom-btn,div.right-btn",this.element).click(function(t){if(!e.options.disabled)return e.incr_cur_pos(t),t.preventDefault(),!1}).mousedown(function(t){e.options.disabled||(e.mousedownTimeout=window.setTimeout(function(){e.mousedownInterval=window.setInterval(function(){e.incr_cur_pos(t)},0)},e.options.timeout))}).bind("mouseup mouseout",function(t){e._mouseup(t)}),this._refresh()},e._bindSliderEvents=function(e){var i=this,r="x";"vertical"==this.options.direction&&(r="y"),e.draggable({axis:r,helper:function(t,e){return i._setDragLimits(),this},start:function(t){i.topWhileDrag=null},drag:function(t){i.dragging=!0;var e=i.options.pace;"optimum"==e?i._setNormalPace(t):"fast"==e&&i._updateCurPosAndTrigger(t)},stop:function(t){i._updateCurPosAndTrigger(t),i.dragging=!1}}).on("keydown.pq-scrollbar",function(e){var r=e.keyCode,o=i.options,n=o.cur_pos,a=o.ratio,l=o.num_eles,s=t.ui.keyCode;if(null==i.keydownTimeout&&(i.keydownTimeout=window.setTimeout(function(){r==s.DOWN||r==s.RIGHT?i.incr_cur_pos(e):r==s.UP||r==s.LEFT?i.decr_cur_pos(e):r==s.HOME?o.steps?n>0&&(o.cur_pos=0,i.updateSliderPos(),i.scroll(e)):a>0&&(o.ratio=0,i.updateSliderPos(),i.drag(e)):r==s.END?o.steps?n<l&&(o.cur_pos=l,i.updateSliderPos(),i.scroll(e)):a<1&&(o.ratio=1,i.updateSliderPos(),i.drag(e)):"vertical"==o.direction&&(r==s.PAGE_DOWN?i._pageDown(e):r==s.PAGE_UP&&i._pageUp(e)),i.keydownTimeout=null},0)),r==s.DOWN||r==s.RIGHT||r==s.UP||r==s.LEFT||r==s.PAGE_DOWN||r==s.PAGE_UP||r==s.HOME||r==s.END)return e.preventDefault(),!1})},e.decr_cur_pos=function(t){var e=this.options;if(e.steps)e.cur_pos>0&&(e.cur_pos--,this.updateSliderPos(),this.scroll(t));else if(e.ratio>0){var i=e.ratio-1/(e.num_eles-1);i<0&&(i=0),e.ratio=i,this.updateSliderPos(),this.drag(t)}},e.incr_cur_pos=function(t){var e=this.options;if(e.steps)e.cur_pos<e.num_eles-1&&e.cur_pos++,this.updateSliderPos(),this.scroll(t);else{if(e.ratio<1){var i=e.ratio+1/(e.num_eles-1);i>1&&(i=1),e.ratio=i}this.updateSliderPos(),this.drag(t)}},e._mouseup=function(t){if(!this.options.disabled){window.clearTimeout(this.mousedownTimeout),this.mousedownTimeout=null,window.clearInterval(this.mousedownInterval),this.mousedownInterval=null}},e._setDragLimits=function(){var t=this.options;if("vertical"==t.direction){var e=this.element.offset().top+17,i=e+t.length-34-this.slider_length;this.$slider.draggable("option","containment",[0,e,0,i])}else i=(e=this.element.offset().left+17)+t.length-34-this.slider_length,this.$slider.draggable("option","containment",[e,0,i,0])},e._refresh=function(){var t=this.options;t.num_eles<=1?this.element.css("display","none"):this.element.css("display",""),this._validateCurPos(),this.$slider.css("display",""),"vertical"==t.direction?(this.element.height(t.length),this._setSliderBgLength(),this.scroll_space=t.length-34-this.slider_length,(this.scroll_space<4||t.num_eles<=1)&&this.$slider.css("display","none"),this.updateSliderPos(t.cur_pos)):(this.element.width(t.length),this._setSliderBgLength(),this.scroll_space=t.length-34-this.slider_length,(this.scroll_space<4||t.num_eles<=1)&&this.$slider.css("display","none"),this.updateSliderPos(t.cur_pos))},e._setSliderBgLength=function(){var e=this.options,i=e.theme,r=e.length,o=(r-34)*r/(40*e.num_eles+r),n=Math.round((o-14)/2);n<1&&(n=1),this.slider_length=14+2*n,"vertical"==e.direction?i?this.$slider.height(this.slider_length-2):(t("div.vert-slider-bg",this.element).height(n),this.$slider.height(this.slider_length)):i?this.$slider.width(this.slider_length-2):(t(".horiz-slider-bg",this.element).width(n),this.$slider.width(this.slider_length))},e._updateCurPosAndTrigger=function(t,e){var i=this.options,r=i.direction,o=this.$slider;null==e&&(e="vertical"==r?parseInt(o[0].style.top,10):parseInt(o[0].style.left,10));var n=(e-17)/(i.length-34-this.slider_length);if(i.steps){var a=n*(i.num_eles-1);if(a=Math.round(a),i.cur_pos!=a){if(this.dragging){if(null!=this.topWhileDrag){if(this.topWhileDrag<e&&i.cur_pos>a)return;if(this.topWhileDrag>e&&i.cur_pos<a)return}this.topWhileDrag=e}this.options.cur_pos=a,this.scroll(t)}}else i.ratio=n,this.drag(t)},e._setNormalPace=function(t){this.timer&&(window.clearInterval(this.timer),this.timer=null);var e=this,i=this.options.direction;e.timer=window.setInterval(function(){var r=e.$slider,o="vertical"==i?parseInt(r[0].style.top,10):parseInt(r[0].style.left,10);e.prev_top==o&&(e._updateCurPosAndTrigger(t,o),window.clearInterval(e.timer),e.timer=null),e.prev_top=o},20)},e.setNumEles=function(t){this.options.num_eles=t,this.updateSliderPos()},e._validateCurPos=function(){var t=this.options;t.cur_pos>=t.num_eles&&(t.cur_pos=t.num_eles-1),t.cur_pos<0&&(t.cur_pos=0)},e._updateSliderPosRatio=function(){var t=this.options,e=t.direction,i=t.ratio,r=this.$slider,o=t.length-34-this.slider_length;if(null==i)throw"ration N/A";var n=i*o+17;"vertical"==e?r.css("top",n):r.css("left",n)},e._updateSliderPosCurPos=function(){var t=this.options,e=this.scroll_space*t.cur_pos/(t.num_eles-1);"vertical"==t.direction?this.$slider.css("top",17+e):this.$slider.css("left",17+e)},e.updateSliderPos=function(){var t=this.options;if(void 0===t.steps)throw"assert failed. steps N/A";t.steps?this._updateSliderPosCurPos():this._updateSliderPosRatio()},e.scroll=function(t){var e=this.options;this._trigger("scroll",t,{cur_pos:e.cur_pos,num_eles:e.num_eles})},e.drag=function(t){var e=this.options;this._trigger("drag",t,{ratio:e.ratio})},e._pageDown=function(t){this._trigger("pageDown",t,null)},e._pageUp=function(t){this._trigger("pageUp",t,null)},e._setOption=function(t,e){"disabled"==t?(this._super.call(this,t,e),1==e?this.$slider.draggable("disable"):this.$slider.draggable("enable")):"theme"==t?(this._super.call(this,t,e),this._createLayout()):"ratio"==t?e>=0&&e<=1&&this._super.call(this,t,e):this._super.call(this,t,e)},e._setOptions=function(){this._super.apply(this,arguments),this._refresh()},t.widget("paramquery.pqScrollBar",e)}(jQuery),function(t){var e=function(){};e.prototype.belongs=function(t){if(t.target==this.that.element[0])return!0},t.paramquery.cClass=e;var i=function(t){this.that=t,this.hidearrHS1=[],this.options=t.options,this.offset=null};t.paramquery.cGenerateView=i;var r=i.prototype;r.generateView=function(e){var i,r,o=this.that,n=o.options,a=n.freezeCols,l=(n.virtualX,n.virtualY,o.colModel),s=o.initH,d=o.finalH,h=n.groupModel,u=o.pqpanes;if(e){var f=this._generateTables(null,null,e);(D=e.$cont).empty(),u.v?D.append(["<div class='pq-cont-inner'>",f,"</div>","<div class='pq-cont-inner'>",f,"</div>"].join("")):D.append("<div class='pq-cont-inner'>"+f+"</div>");var p=D.children("div"),g=p.children("table"),v=g[0].scrollHeight-1;if(D.height(v),u.v){var w=t(p[0]),x=g[0].scrollWidth,I=t(p[1]),m=t(g[1]),_=c.call(o,-1,a),b=c.call(o,a,s);w.css({width:_,zIndex:1}),I.css({left:_-1,width:x,position:"absolute",height:v}),m.css({left:-1*(b+_)})}o.tables||(o.tables=[]);for(var y=-1,q=0;q<o.tables.length;q++){o.tables[q].cont==e.$cont[0]&&(y=q)}-1==y?o.tables.push({$tbl:g,cont:e.$cont[0]}):o.tables[y].$tbl=g}else{o._bufferObj_calcInitFinal(),i=o.initV,r=o.finalV;var C=h?o.dataGM:o.pdata,D=o.$cont;null!=n.editModel.indices&&o.blurEditor({force:!0});f=this._generateTables(i,r,e);D.empty(),0===o.totalVisibleRows?D.append("<div class='pq-cont-inner pq-grid-norows' >"+n.strNoRows+"</div>"):u.h&&u.v?D.append(["<div class='pq-cont-inner'>",f,"</div>","<div class='pq-cont-inner'>",f,"</div>","<div class='pq-cont-inner'>",f,"</div>","<div class='pq-cont-inner'>",f,"</div>"].join("")):u.h||u.v?D.append(["<div class='pq-cont-inner'>",f,"</div>","<div class='pq-cont-inner'>",f,"</div>"].join("")):D.append("<div class='pq-cont-inner'>"+f+"</div>"),o.$tbl=D.children("div").children("table"),o._fixTableViewPort(),o._trigger("afterTable",null,{dataModel:n.dataModel,colModel:l,pageData:C,initV:i,finalV:r,initH:s,finalH:d})}o._saveDims(),this.scrollView(),e||o._trigger("refresh",null,{dataModel:n.dataModel,colModel:l,pageData:C,initV:i,finalV:r,initH:s,finalH:d}),o._saveDims(),this.scrollView()},r.scrollView=function(){var t=this.that,e=this.options,i=e.virtualX,r=e.virtualY;i||t.$hscroll.pqScrollBar("drag"),r||t.$vscroll.pqScrollBar("drag")},r.setPanes=function(){var e,i,r=this.that,o=r.$cont,n=r.pqpanes,a=o.children("div"),l=r.$tbl,s=r.options,d=parseInt(s.freezeCols),h=r.initH;if(l&&l.length){var u=l[0].scrollWidth;if(n.h&&n.v){var f=t(a[0]),p=t(a[1]),g=t(l[1]),v=t(a[2]),w=t(l[2]),x=t(a[3]),I=t(l[3]);e=c.call(r,-1,d);var m=r.calcHeightFrozenRows();f.css({width:e,height:m,zIndex:2}),p.css({left:e,width:u,height:m,position:"absolute"}),g.css({left:-1*e}),v.css({width:e,zIndex:1,top:m,position:"absolute"}),w.css({top:-m}),x.css({left:e,width:u,zIndex:1,top:m,position:"absolute"}),I.css({top:-m,left:-1*e})}else if(n.v){var _=t(a[0]),b=t(a[1]),y=t(l[1]);e=c.call(r,-1,d),i=c.call(r,d,h),_.css({width:e,zIndex:1}),b.css({left:e,width:u,position:"absolute"}),y.css({left:-1*(i+e)})}else if(n.h){var q=t(a[0]),C=t(a[1]),D=t(l[1]);m=r.calcHeightFrozenRows(),q.css({height:m,zIndex:1}),C.css({width:u,top:m,position:"absolute"}),D.css({top:-1*m})}}},r._generateTables=function(t,e,i){var r=this.that,o=r.colModel,n=(o.length,r.options),a=n.virtualX,l=r.initH,s=r.finalH,d=n.numberCell,h=n.columnBorders,c=n.rowBorders,u=n.wrap,f=(n.scrollModel,n.groupModel),p=(r.hidearrHS,n.freezeCols),g=parseInt(n.freezeRows),v=!1,w=0,x=i?i.data.length-1:e,I=!!f,m=(n.treeModel,i&&i.data?i.data:I?r.dataGM:r.pdata),_=r.rowIndxOffset;if(i||null!=t&&null!=x){i||r._trigger("beforeTableView",null,{pageData:m,initV:t,finalV:e,initH:l,finalH:s,colModel:o});var b="pq-grid-table ";h&&(b+="pq-td-border-right "),c&&(b+="pq-td-border-bottom ");var y=["<table class='"+(b+=u?"pq-wrap ":"pq-no-wrap ")+"' cellpadding=0 cellspacing=0 >"];if(this.hidearrHS1=[],y.push("<tr class='pq-row-hidden'>"),d.show){var q=d.width+1;y.push("<td style='width:"+q+"px;' ></td>")}for(var C=0;C<=s;C++){if(C<l&&C>=p&&(a||i)&&(C=l)>s)throw"initH>finalH";var D=o[C];D.hidden||(q=D.outerWidth,y.push("<td style='width:",q,"px;' pq-col-indx='",C,"'></td>"))}y.push("</tr>"),this.offsetRow=null;for(w=0;w<=x;w++){w<t&&w>=g&&(w=t);var M=m[w],R=I?M.rowIndx-_:w;if(!(!!M&&M.pq_hidden)){v=r.lastFrozenRow===R;if(f&&M.groupTitle)this._generateTitleRow(f,M,y,v);else if(f&&M.groupSummary)this._generateSummaryRow(M.data,o,y,v);else{var P=M.pq_detail&&M.pq_detail.show;this._generateRow(M,R,o,y,i,v,P),P&&this._generateDetailRow(M,R,o,y,i,v)}}}r.scrollMode=!1,y.push("</table>");return y.join("")}},r._renderCell=function(t,e){this.that;var i=this.options,r=t.rowData,o=t.column,n=o.type,a=o.dataIndx,l=r[a];if(r){var s;if(void 0!=e)s=e;else if("checkBoxSelection"==n)s="<input type='checkbox' "+(l?"checked='checked'":"")+" />";else if("detail"==n){var d=i.detailModel;s="<div class='ui-icon "+(l&&l.show?d.expandIcon:d.collapseIcon)+"'></div>"}else s=l;""!==s&&void 0!=s||(s="&nbsp;");var h,c="";if(t.tree&&(h=i.treeModel)&&h.labelIndx==a){var u=r.pq_leaf,f=r.pq_level,p=!r.pq_collapse,g=["<div class='pq-tree-icon-container' style='width:",(f+1)*h.indent,"px;'>","<div class='ui-icon ",u?h.leafIcon:p?h.expandIcon+" pq-tree-expand-icon":h.collapseIcon+" pq-tree-expand-icon"," pq-tree-icon' ></div></div>"].join("");c="<div class='"+cls+"'>"+g+s+"</div>"}else c=s;return c}},r.renderCell=function(t){var e=this.that,i=this.options,r=t.rowData,o=t.rowIndx,n=t.rowIndxPage,a=t.column,l=t.colIndx,s=a.dataIndx,d=i.freezeCols,h=i.columnBorders,c="pq-col-indx='"+l+"'",u=!1,f="pq-grid-cell ";"right"==a.align?f+=" pq-align-right":"center"==a.align&&(f+=" pq-align-center"),l==d-1&&h&&(f+=" pq-last-freeze-col");var p=a.cls;p&&(f=f+" "+p);var g=r.pq_cellselect;g&&(u=g[s]),u&&(f+=" pq-cell-select ui-state-highlight");var v;a.render&&(v=a.render.call(e.element[0],{data:e.pdata,dataModel:i.dataModel,rowData:r,cellData:r[s],rowIndxPage:n,rowIndx:o,colIndx:l,column:a,dataIndx:s}));var w=r.pq_cellcls;if(w){var x=w[s];x&&(f+=" "+x)}var I=r.pq_cellattr;if(I){var m=I[s];if(m)for(var _ in m){var b=m[_];"title"==_&&(b=b.replace(/\"/g,"&quot;")),c+=" "+_+'="'+b+'"'}}return["<td class='",f,"' ",c," >",this._renderCell(t,v),"</td>"].join("")},r.refreshRow=function(t,e,i){var r=this.that,o=r.pdata[t],n=r.lastFrozenRow===t,a=o.pq_detail&&o.pq_detail.show;this._generateRow(o,t,e,i,null,n,a)},r._generateRow=function(t,e,i,r,o,n,a){var l="pq-grid-row";n&&(l+=" pq-last-freeze-row"),a&&(l+=" pq-detail-master");var s=this.that,d=this.options,h=d.freezeCols,c=d.numberCell,u=!!d.treeModel.labelIndx,f=d.virtualX,p=s.initH,g=s.finalH,v=this.offset;d.stripeRows&&e/2==parseInt(e/2)&&(l+=" pq-grid-oddRow"),t.pq_rowselect&&(l+=" pq-row-select ui-state-highlight");var w=t.pq_rowcls;null!=w&&(l+=" "+w);var x=t.pq_rowattr,I="";if(x)for(var m in x){var _=x[m];I+=m+'="'+(_=_.replace('"',"&quot;"))+'"'}r.push("<tr pq-row-indx='",e,"' class='",l,"' ",I," >"),c.show&&r.push(["<td class='pq-grid-number-cell ui-state-default'>",o?"&nbsp;":e+1,"</td>"].join(""));for(var b={rowIndx:e+v,rowIndxPage:e,rowData:t},y=0;y<=g;y++){if(y<p&&y>=h&&(f||o)&&(y=p)>g)throw"initH>finalH";var q=i[y];q.hidden||(b.column=q,b.colIndx=y,b.tree=u,r.push(this.renderCell(b)))}return r.push("</tr>"),r};var o={widgetEventPrefix:"pqgrid"};o.options={cancel:"input,textarea,button,select,option,.ui-resizable-handle,div[contenteditable],.pq-draggable",distance:3,collapsible:{on:!0,toggle:!0,collapsed:!1,_collapsed:!1,refreshAfterExpand:!0,css:{zIndex:1e3}},colModel:null,columnBorders:!0,dataModel:{cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{cellBorderWidth:0,pressToEdit:!0,clicksToEdit:1,filterKeys:!0,keyUpDown:!0,reInt:/^([\-]?[1-9][0-9]*|[\-]?[0-9]?)$/,reFloat:/^[\-]?[0-9]*\.?[0-9]*$/,onBlur:"validate",saveKey:t.ui.keyCode.ENTER,onSave:"next",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",warnClass:"pq-cell-blue-tr pq-has-tooltip",validate:!0},editor:{select:!1,type:"textbox"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",_maxColWidth:"100%",_minColWidth:50,minWidth:100,numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},resizable:!1,roundCorners:!0,rowBorders:!0,scrollModel:{pace:"fast",horizontal:!0,autoFit:!1,theme:!1},selectionModel:{fireSelectChange:!0,type:"cell",mode:"block"},swipeModel:{on:!0,speed:50,ratio:.15,repeat:20},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stripeRows:!0,title:"&nbsp;",treeModel:null,virtualX:!1,virtualY:!1,width:"auto",wrap:!0,hwrap:!0},o._regional={strAdd:"Add",strDelete:"Delete",strEdit:"Edit",strLoading:"Loading",strNextResult:"Next Result",strNoRows:"No rows to display.",strNothingFound:"Nothing found",strPrevResult:"Previous Result",strSearch:"Search",strSelectedmatches:"Selected {0} of {1} match(es)"},t.extend(o.options,o._regional),o._destroyResizable=function(){this.element.data("resizable")&&this.element.resizable("destroy")},o._disable=function(){null==this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},o._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},o._destroy=function(){this._destroyResizable(),this._destroyDraggable(),this._mouseDestroy(),this.element.off(this.eventNamespace),t(window).unbind(this.eventNamespace),t(document).unbind(this.eventNamespace),this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()},o.destroy=function(){this._super(),window.clearInterval(this._refreshEditorPosTimer),this.autoResizeTimeout&&clearTimeout(this.autoResizeTimeout);for(var e in this)delete this[e];t.fragments={}},o.decidePanes=function(){this.pqpanes={v:!1,h:!1,vH:!1};var t=this.pqpanes,e=this.options,i=e.virtualX,r=e.virtualXHeader,o=e.virtualY,n="flex"==e.height,a="flex"==e.width,l=e.numberCell,s=e.freezeRows,d=e.freezeCols;!s||n||!d&&!l.show||a?s&&!n?o||(t.h=!0):!d&&!l.show||a||(i||(t.v=!0,t.vH=!0),!1===r&&(t.vH=!0)):(o||(t.h=!0),i||(t.v=!0,t.vH=!0),!1===r&&(t.vH=!0))},o.collapse=function(t){var e=this,i=this.element,r=this.options.collapsible,o=r.$collapse.children("span"),n=function(){o.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n"),i.hasClass("ui-resizable")&&i.resizable("destroy"),e.$toolbar.pqToolbar("disable"),r.collapsed=!0,r._collapsed=!0,r.animating=!1,e._trigger("collapse")};if(t=t||{},r._collapsed)return!1;r.htCapture=i.height(),!1===t.animate?(i.height(23),n()):(r.animating=!0,i.animate({height:"23px"},function(){n()}))},o.expand=function(t){var e=this,i=this.element,r=this.options.collapsible,o=r.htCapture,n=r.$collapse.children("span"),a=function(){r._collapsed=!1,r.collapsed=!1,e._refreshResizable(),r.refreshAfterExpand&&e.refresh(),n.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s"),e.$toolbar.pqToolbar("enable"),r.animating=!1,e._trigger("expand")};if(t=t||{},!1===r._collapsed)return!1;!1===t.animate?(i.height(o),a()):(r.animating=!0,i.animate({height:o},function(){a()}))},o._createCollapse=function(){var e=this,i=this.$top,r=this.options.collapsible;if(!r.$stripe){var o=t(["<div class='pq-slider-icon' style='z-index:5;' >","</div>"].join("")).appendTo(i);r.$stripe=o}r.on?r.$collapse||(r.$collapse=t(["<div style='float:left;' class='pq-collapse'>","<span class='ui-icon ui-icon-circle-triangle-n' style='float:left;'></span>","</div>"].join("")).appendTo(r.$stripe).mouseover(function(e){t(this).addClass("ui-state-hover")}).mouseout(function(e){t(this).removeClass("ui-state-hover")}).click(function(t){r.collapsed?e.expand():e.collapse()})):r.$collapse&&(r.$collapse.remove(),delete r.$collapse),r.collapsed&&!r._collapsed?e.collapse({animate:!1}):!r.collapsed&&r._collapsed&&e.expand({animate:!1}),r.toggle?r.$toggle||(r.$toggle=t(["<div style='float:left;' class='pq-max'>","<span class='ui-icon ui-icon-arrow-4-diag' style='float:left;'></span>","</div>"].join("")).prependTo(r.$stripe).mouseover(function(e){t(this).addClass("ui-state-hover")}).mouseout(function(e){t(this).removeClass("ui-state-hover")}).click(function(t){e.toggle()})):r.$toggle&&(r.$toggle.remove(),delete r.$toggle)},o._create=function(){var e=this;this.decidePanes(),this.setEditorPosTimer(),this.iGenerateView=new i(this),this.iKeyNav=new d(this),this.iRefreshColumn=new u(this),this.iIsValid=new l(this),this.rowHeight=22,this.hidearr=[],this.hidearrHS=[],this.tables=[];e=this;var r=this.options;this.$tbl=null,this._refreshGridWidthAndHeight(),this._calcThisColModel(),this.iSort=new t.paramquery.cSort(this),this.iSort._refreshSorters(),this._initTypeColumns();var o=this.element;o.empty().addClass("pq-grid ui-widget ui-widget-content"+(r.roundCorners?" ui-corner-all":"")).append(["<div class='pq-grid-top ui-widget-header",r.roundCorners?" ui-corner-top":"","'>","<div class='pq-grid-title",r.roundCorners?" ui-corner-top":"","'>&nbsp;</div>","</div>","<div class='pq-grid-inner' >","<div class='pq-header-outer ui-widget-header'>","</div>","<div class='pq-cont-right' >","<div class='pq-cont' tabindex='0'></div>","</div>","</div>","<div class='pq-grid-bottom ui-widget-header",r.roundCorners?" ui-corner-bottom":"","'>","<div class='pq-grid-footer'>&nbsp;</div>","</div>"].join("")),this._trigger("render",null,{dataModel:this.options.dataModel,colModel:this.colModel}),this.$top=t("div.pq-grid-top",o),this.$title=t("div.pq-grid-title",o),r.showTitle||this.$title.css("display","none"),r.collapsible||(r.collapsible={on:!1,collapsed:!1}),r.flexHeight&&(r.height="flex"),r.flexWidth&&(r.width="flex"),this.$toolbar=t("div.pq-grid-toolbar",o),this.$grid_inner=t("div.pq-grid-inner",o),this.$header_o=t("div.pq-header-outer",this.$grid_inner),r.showTop||this.$top.css("display","none"),this.$bottom=t("div.pq-grid-bottom",o),r.showBottom||this.$bottom.css("display","none"),this.$footer=t("div.pq-grid-footer",o),this.$cont_o=t("div.pq-cont-right",this.$grid_inner),this.$cont_fixed=t("div.pq-cont-fixed",this.$grid_inner);var n=this.$cont=t("div.pq-cont",this.$grid_inner);t(window).bind("resize"+e.eventNamespace+" orientationchange"+e.eventNamespace,function(t,i){e._onWindowResize(t,i)}),n.on("click","td.pq-grid-cell",function(i){if(!0!==t.data(i.target,e.widgetName+".preventClickEvent"))return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onClickCell(i):void 0}),n.on("click","tr.pq-grid-row",function(i){if(!0!==t.data(i.target,e.widgetName+".preventClickEvent"))return t(i.target).closest(".pq-grid")[0]==e.element[0]?e._onClickRow(i):void 0}),n.on("contextmenu","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRightClickCell(i)}),n.on("contextmenu","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRightClickRow(i)}),n.on("dblclick","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onDblClickCell(i)}),n.on("dblclick","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onDblClickRow(i)}),n.on("mousedown","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onCellMouseDown(i)}),n.on("mousedown","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRowMouseDown(i)}),n.on("mousedown",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onContMouseDown(i)}),n.on("mouseenter","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onCellMouseEnter(i,t(this))}),n.on("mouseenter","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRowMouseEnter(i,t(this))}),n.on("mouseleave","td.pq-grid-cell",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onCellMouseLeave(i,t(this))}),n.on("mouseleave","tr.pq-grid-row",function(i){if(t(i.target).closest(".pq-grid")[0]==e.element[0])return e._onRowMouseLeave(i,t(this))}),n.bind("mousewheel DOMMouseScroll",function(t){return e._onMouseWheel(t)});this.$hvscroll=t("<div class='pq-hvscroll-square ui-widget-content'></div>").appendTo(this.$grid_inner),this.$vscroll=t("<div class='pq-vscroll'></div>").appendTo(this.$grid_inner),this.prevVScroll=0;var a=r.scrollModel;void 0===a.lastColumn&&r.virtualX&&(a.lastColumn="auto"),this.$vscroll.pqScrollBar({pace:a.pace,theme:a.theme,steps:r.virtualY,direction:"vertical",cur_pos:0,pageDown:function(t,i){e.iKeyNav.pageDown()},pageUp:function(t,i){e.iKeyNav.pageUp()},drag:function(t,i){if(!r.virtualY){var o=i.ratio;e._syncViewWithScrollBarVert(o)}},scroll:function(t,i){if(r.virtualY){e.scrollMode=!0,e.setFlexWHCallback(function(){e.iGenerateView.generateView()});(t.originalEvent&&"drag"==t.originalEvent.type?e._setScrollVNumEles():e._setScrollVNumEles(!0))<=1&&(e._setScrollHLength(),e._setScrollHVLength())}}});this.$hscroll=t("<div class='pq-hscroll'></div>").appendTo(this.$grid_inner),this.$hscroll.pqScrollBar({direction:"horizontal",pace:a.pace,theme:a.theme,steps:r.virtualX,cur_pos:0,drag:function(t,i){r.virtualX||e._syncViewWithScrollBarHor(i.ratio)},scroll:function(t,i){var o=r.virtualX,n=r.virtualXHeader,a=!1!==n;o&&e.refresh({header:a}),!1===n&&e._syncViewWithScrollBarHorHeader(i.cur_pos)}}),o.height(""),this.disableSelection(),window.opera?this.$grid_inner.bind("keypress.pq-grid",{that:this},function(i){t(i.target).closest(".pq-grid")[0]==e.element[0]&&e._onKeyPressDown(i)}):this.$grid_inner.bind("keydown.pq-grid",{that:this},function(i){t(i.target).closest(".pq-grid")[0]==e.element[0]&&e._onKeyPressDown(i)}),this._refreshOptions(),this._refreshTitle(),this.iRows=new t.paramquery.cRows(this),this.iCells=new t.paramquery.cCells(this),this.generateLoading(),this._initPager(),this._refreshResizable(),this._refreshDraggable(),this._mouseInit()},o.toggle=function(){var e,i=this.options,r=i.collapsible,o=this.element,n=t(document.body);if("fixed"==o.css("position")){var a=this.maxim.eleObj,l=this.maxim.docObj;i.height=a.height,i.width=a.width,o.css({position:a.position,left:a.left,top:a.top,margin:a.margin,zIndex:a.zIndex}),n.css({height:l.height,width:l.width,overflow:l.overflow}),t("html").css({overflow:"visible"}),window.scrollTo(l.scrollLeft,l.scrollTop),e="min"}else{a={height:i.height,width:i.width,position:o.css("position"),left:o.css("left"),top:o.css("top"),margin:o.css("margin"),zIndex:o.css("zIndex")};i.height="100%-2",i.width="100%-2",o.css(t.extend({position:"fixed",left:0,top:0,margin:0},r.css));l={height:n.height(),width:n.width(),overflow:n.css("overflow"),scrollLeft:t(window).scrollLeft(),scrollTop:t(window).scrollTop()};t(document.body).css({height:0,width:0,overflow:"hidden"}),t("html").css({overflow:"hidden"}),window.scrollTo(0,0),this.maxim={eleObj:a,docObj:l},e="max"}this._trigger("toggle",null,{state:e}),this._refreshResizable(),this.refresh(),t(window).trigger("resize",{$grid:o,state:e})},o._mouseCapture=function(e){var i=this.options;if(i.virtualX&&i.virtualY)return!1;if(!e.target)return!1;if(t(e.target).closest(".pq-grid")[0]==this.element[0]){if("flex"==i.height&&"flex"==i.width)return!1;var r=i.swipeModel;return!(0==r.on||"touch"==r.on&&!t.support.touch)}return!1},o._saveDims=function(){var e=this.$cont;e.data("offsetWidth",e[0].offsetWidth),e.data("offsetHeight",e[0].offsetHeight);var i=this.$tbl;if(i)for(var r=0;r<i.length;r++){var o=i[r],n=t(o);n.data("offsetHeight",o.offsetHeight),n.data("scrollWidth",o.scrollWidth)}var a=this.$tbl_header;if(a)for(r=0;r<a.length;r++){o=a[r];var l=t(o).parent();l.data("offsetHeight",o.offsetHeight),l.data("scrollWidth",o.scrollWidth)}},o._mousePQUp=function(e){t(document).unbind("mouseup."+this.eventNamespace,this._mousePQUpDelegate),this._trigger("mousePQUp",e,null)},o._mouseDown=function(e){var i=this;return t(e.target).closest(".pq-editor-focus").length?(this._blurEditMode=!0,void window.setTimeout(function(){i._blurEditMode=!1},0)):(this._saveDims(),this._mousePQUpDelegate=function(t){return i._mousePQUp(t)},t(document).bind("mouseup."+this.eventNamespace,this._mousePQUpDelegate),this._super.call(this,e))},o._mouseStart=function(t){return this.blurEditor({force:!0}),!0},o._mouseDrag=function(t){return 0!=this._trigger("mouseDrag",t,null)},o._mouseStop=function(t){return 0!=this._trigger("mouseStop",t,null)},o._refreshGridWidthAndHeight=function(){var e,i,r=this.options,o=(r.width+"").indexOf("%")>-1,n=(r.height+"").indexOf("%")>-1,a=this.element;if(o||n){var l=a.parent();if(!l.length)return;var s,d;l[0]==document.body||"fixed"==a.css("position")?(s=t(window).width(),d=window.innerHeight?window.innerHeight:t(window).height()):(s=l.width(),d=l.height());var h=null,c=function(t){var e=/(-|\+)([0-9]+)/.exec(t);return e&&3==e.length?parseInt(e[1]+e[2]):0},u=o?c(r.width):0,f=n?c(r.height):0;if(0==s){for(;"BODY"!=l[0].tagName.toUpperCase();){var p=l.parent();if(null==p[0]){h=l;break}l=p}if(h){var g=h.css("position"),v=h.css("left"),w=h.css("top");h.css({position:"absolute",left:"-2000",top:"-2000"}).appendTo(t(document.body)),l=a.parent(),o&&(s=l.width()),n&&(d=l.height()),h.css({position:g,left:v,top:w})}}o&&(e=parseInt(r.width)*s/100+u),n&&(i=parseInt(r.height)*d/100+f)}o||(e=r.width),n||(i=r.height),"auto"!=e&&e<r.minWidth&&(e=r.minWidth),i<r.minHeight&&(i=r.minHeight),a.width(e),a.height(i)};var n,a;o._onWindowResize=function(e,i){var r,o,l=this.options,s=this.element,d=s.parent();if(i){var h=i.$grid;if(h&&(h==s||0==s.closest(h).length))return}if(d.length&&(d[0]==document.body||"fixed"==s.css("position")?(r=window.innerHeight?window.innerHeight:t(window).height(),o=t(window).width()):(r=d.height(),o=d.width()),!(null!=n&&r==n&&o==a||(n=r,a=o,t.support.touch&&l.editModel.indices&&t(document.activeElement).is(".pq-editor-focus"))))){var c=this,u=void 0===(u=l.autoSizeInterval)?0:u;this.autoResizeTimeout&&(clearTimeout(this.autoResizeTimeout),delete this.autoResizeTimeout),this.autoResizeTimeout=window.setTimeout(function(){c._refreshAfterResize(),delete c.autoResizeTimeout},u)}},o._onMouseWheel=function(t){this._saveDims();var e=this.options,i=0,r=!1,o=(t=t.originalEvent).wheelDeltaX,n=t.wheelDeltaY,a=t.wheelDelta;if(o&&Math.abs(o)>Math.abs(n)){if("flex"==e.width)return!0;r=!0,i=o/120}else if(a){if("flex"==e.height)return!0;i=a/120}else t.detail&&(i=-1*t.detail/3);var l=r?this.$hscroll:this.$vscroll,s=l.pqScrollBar("option"),d=parseInt(s.cur_pos),h=parseInt(s.num_eles);if(r&&e.virtualX||!r&&e.virtualY){d-(i=i>0?Math[i<1?"ceil":"floor"](i):Math[i<-1?"ceil":"floor"](i))>=0&&(l.pqScrollBar("option","cur_pos",d-i),l.pqScrollBar("scroll"))}else{var c=s.ratio-i/(h-1);c>1?c=1:c<0&&(c=0),l.pqScrollBar("option","ratio",c),l.pqScrollBar("drag")}return!1},o._onDblClickCell=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i}),o=r.rowIndxPage,n=o+this.rowIndxOffset,a=r.colIndx;if(null!=a)return 0!=this._trigger("cellDblClick",e,{$td:i,rowIndxPage:o,rowIndx:n,colIndx:a,column:this.colModel[a],rowData:this.pdata[o]})&&void(this.options.editModel.clicksToEdit>1&&this.isEditableRow({rowIndx:n})&&this.isEditableCell({colIndx:a,rowIndx:n})&&this.editCell({rowIndxPage:o,colIndx:a}))},o._onClickCont=function(t){},o._onClickRow=function(e){var i=t(e.currentTarget),r=parseInt(i.attr("pq-row-indx")),o=r+this.rowIndxOffset;if(!isNaN(r)){this.options;return 0!=this._trigger("rowClick",e,{$tr:i,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]})&&void 0}},o._onRightClickRow=function(e){var i=t(e.currentTarget),r=parseInt(i.attr("pq-row-indx")),o=r+this.rowIndxOffset;if(!isNaN(r)){this.options;return 0!=this._trigger("rowRightClick",e,{$tr:i,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]})&&void 0}},o._onDblClickRow=function(e){var i=t(e.currentTarget),r=parseInt(i.attr("pq-row-indx")),o=r+this.getRowIndxOffset();if(0==this._trigger("rowDblClick",e,{$tr:i,rowIndxPage:r,rowIndx:o,rowData:this.pdata[r]}))return!1},t.paramquery.getValueFromDataType=function(e,i,r){var o;if("date"==i)return o=Date.parse(e),isNaN(o)?"":r?o:e;if("integer"==i)o=parseInt(e);else{if("float"!=i)return"bool"==i?0==(o=t.trim(e).toLowerCase()).length?null:"true"==o||"yes"==o||"1"==o||"false"!=o&&"no"!=o&&"0"!=o&&Boolean(o):t.trim(e);o=parseFloat(e)}return isNaN(o)||null==o?null==e?e:null:o};var l=function(t){this.that=t},s=l.prototype;s._isValidCell=function(e){var i=this.that,r=e.column,o=r.validations;if(!o||!o.length)return{valid:!0};var n=e.value,a=r.dataType,l=function(e){return t.paramquery.getValueFromDataType(e,a,!0)},s=e.rowData;if(!s)throw"rowData required.";for(var d=0;d<o.length;d++){var h=o[d],c=h.on,u=h.type,f=!1,p=h.msg,g=h.value;if(!1!==c){if(null==n&&"function"!=typeof u)f=!1;else if("minLen"==u)n=l(n),g=l(g),n.length>=g&&(f=!0);else if("nonEmpty"==u)null!=n&&""!==n&&(f=!0);else if("maxLen"==u)n=l(n),g=l(g),n.length<=g&&(f=!0);else if("gt"==u)(n=l(n))>(g=l(g))&&(f=!0);else if("gte"==u)(n=l(n))>=(g=l(g))&&(f=!0);else if("lt"==u)(n=l(n))<(g=l(g))&&(f=!0);else if("lte"==u)(n=l(n))<=(g=l(g))&&(f=!0);else if("regexp"==u)new RegExp(g).test(n)&&(f=!0);else if("function"==typeof u){var v={column:r,value:n,rowData:s,msg:p};0==u.call(i.element[0],v)?(f=!1,v.msg!=p&&(p=v.msg)):f=!0}else f=!0;if(!f)return{valid:!1,msg:p,column:r,warn:h.warn,dataIndx:r.dataIndx,validation:h}}}return{valid:!0}},s.isValidCell=function(e){var i=this.that,r=e.rowData,o=e.rowIndx,n=e.value,a=e.valueDef,l=e.column,s=i.options,d=e.allowInvalid,h=l.dataIndx,c=s.validation,u=s.warning,f=s.editModel,p=f.invalidClass,g=f.warnClass,v=document.activeElement;if(e.checkEditable&&0==i.isEditableCell({rowData:r,rowIndx:o,dataIndx:h}))return{valid:!0};var w=this._isValidCell({column:l,value:n,rowData:r}),x=w.valid,I=w.warn,m=w.msg;if(x)i.data({rowData:r,dataIndx:h,data:"pq_valid"})&&(i.removeClass({rowData:r,rowIndx:o,dataIndx:h,cls:g+" "+p}),i.removeData({rowData:r,dataIndx:h,data:"pq_valid"}));else var _=t.extend({},I?u:c,w.validation),b=_.css,y=_.cls,q=_.icon,C=_.style;if(d||I)return x?{valid:!0}:(i.addClass({rowData:r,rowIndx:o,dataIndx:h,cls:I?g:p}),i.data({rowData:r,dataIndx:h,data:{pq_valid:{css:b,icon:q,style:C,msg:m,cls:y}}}),w);if(!x){if(null==(o=null==o?i.getRowIndx({rowData:r}).rowIndx:o))return w;if(a){if(t(v).hasClass("pq-editor-focus")){var D=s.editModel.indices;if(D){var M=D.rowIndx,R=D.dataIndx;if(null!=o&&o!=M)throw"incorrect usage of isValid rowIndx: "+o;if(h!=R)throw"incorrect usage of isValid dataIndx: "+h;i.editCell({rowIndx:M,dataIndx:h})}}}else i.goToPage({rowIndx:o}),i.editCell({rowIndx:o,dataIndx:h});if((P=i.getEditCell())&&P.$cell){($=P.$cell).attr("title",m);try{$.tooltip("destroy")}catch(t){}$.tooltip({position:{my:"left center+5",at:"right center"},content:function(){return(""==q?"":"<span class='ui-icon "+q+" pq-tooltip-icon'></span>")+m},open:function(t,e){if(y&&e.tooltip.addClass(y),C){var i=e.tooltip.attr("style");e.tooltip.attr("style",i+";"+C).css("zIndex",$.zIndex()+5)}b&&e.tooltip.css(b)}}).tooltip("open")}return w}if(a){var P;if((P=i.getEditCell())&&P.$cell){var $;($=P.$cell).removeAttr("title");try{$.tooltip("destroy")}catch(t){}}}return{valid:!0}},o.isValid=function(t){return this.iIsValid.isValid(t)},s.isValid=function(t){var e=this.that,i=(t=t||{}).allowInvalid,r=t.checkEditable;i=null!=i&&i;if(null!=(u=t.dataIndx)){var o=e.columns[u],n=t.rowData||e.getRowData(t),a=t.hasOwnProperty("value"),l=a?t.value:n[u];return(f=this.isValidCell({rowData:n,checkEditable:r,rowIndx:t.rowIndx,value:l,valueDef:a,column:o,allowInvalid:i})).valid||f.warn?{valid:!0}:f}if(null!=t.rowIndx||null!=t.rowIndxPage||null!=t.rowData){n=t.rowData||e.getRowData(t);for(var s=e.colModel,d=[],h=0,c=s.length;h<c;h++){if(!(o=s[h]).hidden){var u,f;l=n[u=o.dataIndx];if(!(f=this.isValidCell({rowData:n,value:l,column:o,rowIndx:t.rowIndx,checkEditable:r,allowInvalid:i})).valid&&!f.warn){if(!i)return f;d.push({rowData:n,dataIndx:u,column:o})}}}return i&&d.length?{cells:d,valid:!1}:{valid:!0}}var p=t.data?t.data:e.options.dataModel.data;d=[];if(!p)return null;for(h=0,c=p.length;h<c;h++){var g;n=p[h];if(!r||(g=this.getRowIndx({rowData:n}).rowIndx,0!=e.isEditableRow({rowData:n,rowIndx:g}))){var v=this.isValid({rowData:n,rowIndx:g,checkEditable:r,allowInvalid:i});if(!1===i){if(!v.valid)return v}else d=d.concat(v.cells)}}return i&&d.length?{cells:d,valid:!1}:{valid:!0}},o.isEditableRow=function(t){var e=this.options.editable;if(null!=e){if("function"==typeof e){var i=t.rowIndx,r=t.rowData||this.getRowData({rowIndx:i});return e.call(this.element[0],{rowData:r,rowIndx:i})}return e}return!0},o.isEditableCell=function(t){var e=t.colIndx,i=t.dataIndx,r=(e=null==e?this.getColIndx({dataIndx:i}):e,this.colModel[e]),o=(i=null==i?r.dataIndx:i,r.editable);if(t.checkVisible&&r.hidden)return!1;if(null!=o){if("function"==typeof o){var n=t.rowIndx,a=t.rowData||this.getRowData(t);return o.call(this.element[0],{rowIndx:n,rowData:a,column:r,dataIndx:i})}return o}return!0},o._getRowPQData=function(t,e,i){return(i=null==i?this.pdata[t]:i)?i[e]:null},o._setRowPQData=function(t,e,i){if(i=null==i?this.pdata[t]:i)for(var r in e)i[r]=e[r]},o._onContMouseDown=function(e){this.blurEditor({blurIfFocus:!0});var i={dataModel:this.options.dataModel};if(!1===this._trigger("contMouseDown",e,i))return!1;var r=t(e.target),o=r.closest(".pq-grid-cell"),n=r.closest(".pq-grid-row");return o.length||n.length||this.$cont.attr("tabindex",0).focus(),!0},o._onCellMouseDown=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i});return r.$td=i,r.dataModel=this.options.dataModel,0!=this._trigger("cellMouseDown",e,r)},o._onRowMouseDown=function(e){var i=t(e.currentTarget),r=this.getRowIndx({$tr:i});return r.$tr=i,r.dataModel=this.options.dataModel,0!=this._trigger("rowMouseDown",e,r)},o._onCellMouseEnter=function(t,e){var i=e,r=this.options,o=this.getCellIndices({$td:i});if(null!=o.rowIndx&&null!=o.colIndx)return!1!==this._trigger("cellMouseEnter",t,o)&&("cell"==r.hoverMode&&this.highlightCell(i),!0)},o._onRowMouseEnter=function(t,e){var i=e,r=this.options,o=this.getRowIndx({$tr:i}),n=o.rowIndxPage;return!1!==this._trigger("rowMouseEnter",t,o)&&("row"==r.hoverMode&&this.highlightRow(n),!0)},o._onCellMouseLeave=function(t,e){var i=e;return"cell"==this.options.hoverMode&&this.unHighlightCell(i),!0},o._onRowMouseLeave=function(t,e){var i=e,r=this.getRowIndx({$tr:i}).rowIndxPage;return"row"==this.options.hoverMode&&this.unHighlightRow(r),!0},o._onCellMouseUp=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i});return r.$td=i,r.dataModel=this.options.dataModel,0!=this._trigger("cellMouseUp",e,r)},o._onRowMouseUp=function(e){var i=t(e.currentTarget),r=this.getRowIndx({$tr:i});return 0!=this._trigger("rowMouseUp",e,r)},o._onClickCell=function(e){var i=this.options,r=this.colModel,o=i.editModel,n=(i.selectionModel,t(e.currentTarget)),a=this.getCellIndices({$td:n}),l=a.rowIndxPage,s=l+this.rowIndxOffset,d=a.colIndx;if(a.rowIndx=s,null!=d){var h=r[d],c=h.dataIndx;if(a.dataIndx=c,a.evt=e,0==this._trigger("cellClick",e,{$td:n,rowIndxPage:l,rowIndx:s,colIndx:d,dataIndx:c,column:h,rowData:this.pdata[l]}))return!1;1==o.clicksToEdit&&this.isEditableRow({rowIndx:s})&&this.isEditableCell({colIndx:d,rowIndx:s})&&this.editCell(a)}},o._onRightClickCell=function(e){var i=t(e.currentTarget),r=this.getCellIndices({$td:i}),o=r.rowIndxPage,n=o+this.rowIndxOffset,a=r.colIndx,l=this.colModel;this.options.DM;if(null!=a){var s=l[a],d=s.dataIndx;return 0!=this._trigger("cellRightClick",e,{$td:i,rowIndxPage:o,rowIndx:n,colIndx:a,dataIndx:d,column:s,rowData:this.pdata[o]})&&void 0}},o.highlightCell=function(t){t.addClass("pq-grid-cell-hover ui-state-hover")},o.unHighlightCell=function(t){t.removeClass("pq-grid-cell-hover ui-state-hover")},o.highlightRow=function(t){if(isNaN(t));else{var e=this.getRow({rowIndxPage:t});e&&e.addClass("pq-grid-row-hover ui-state-hover")}},o.unHighlightRow=function(t){if(isNaN(t));else{var e=this.getRow({rowIndxPage:t});e&&e.removeClass("pq-grid-row-hover ui-state-hover")}},o._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}},o._refreshOptions=function(){this._refreshDataOptions()},o._refreshDataOptions=function(){},o.enableSelection=function(){this.$cont.enableSelection()},o.disableSelection=function(){this.$cont.disableSelection(),this.$header_o.find("tr.pq-grid-title-row").disableSelection()},o._findCellFromEvt=function(e){var i=t(e.target).closest(".pq-grid-cell");if(null==i||0==i.length)return{rowIndxPage:null,colIndx:null,$td:null};var r=this.getCellIndices({$td:i});return r.$td=i,r},o._initPager=function(){var t=this,e={change:function(e,i){t.blurEditor({force:!0});var r=t.options.pageModel;void 0!=i.curPage&&(r.prevPage=r.curPage,r.curPage=i.curPage),void 0!=i.rPP&&(r.rPP=i.rPP),"remote"==r.type?t.remoteRequest({callback:function(){t._onDataAvailable({apply:!0})}}):t.refreshView()},refresh:function(e){t.refreshDataAndView()}};this.options.pageModel.type&&this.$footer.pqPager(e)},o._refreshHideArrHS=function(){for(var t=this.colModel,e=this.hidearrHS,i=this.initH,r=this.finalH,o=parseInt(this.options.freezeCols),n=0;n<o;n++)e[n]=!1;for(n=o;n<i;n++)e[n]=!0;for(n=i;n<=r;n++)e[n]=!1;n=r+1;for(var a=t.length;n<a;n++)e[n]=!0},o.generateLoading=function(){this.$loading&&this.$loading.remove(),this.$loading=t("<div class='pq-loading'></div>").appendTo(this.element),t(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading),this.$loading.find("div.pq-loading-bg").css("opacity",.2)},o._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)},o.showLoading=function(){null==this.showLoadingCounter&&(this.showLoadingCounter=0),this.showLoadingCounter++,this.$loading.show()},o.hideLoading=function(){this.showLoadingCounter>0&&this.showLoadingCounter--,this.showLoadingCounter||this.$loading.hide()},o.refreshDataFromDataModel=function(){this._trigger("beforeRefreshData",null,{});var t=this.options,e=t.dataModel,i=t.pageModel,r=e.data,o=i.type;if(this.rowIndxOffset=0,null==r||0==r.length)return o&&(i.curPage=0,i.totalPages=0,i.totalRecords=0),void(this.pdata=r);if(o&&"local"==o){i.totalRecords=r.length,i.totalPages=Math.ceil(r.length/i.rPP),i.curPage>i.totalPages&&(i.curPage=i.totalPages),i.curPage<1&&i.totalPages>0&&(i.curPage=1);var n=(i.curPage-1)*i.rPP;(l=i.curPage*i.rPP)>r.length&&(l=r.length),this.pdata=r.slice(n,l)}else if("remote"==o){var a=Math.ceil(i.totalRecords/i.rPP);i.totalPages=a,a&&!i.curPage&&(i.curPage=1);var l;(l=i.rPP)>r.length&&(l=r.length),this.pdata=r.slice(0,l)}else t.backwardCompat?this.pdata=r.slice(0):this.pdata=r;"local"!=o&&"remote"!=o||(this.rowIndxOffset=i.rPP*(i.curPage-1))},t.paramquery.filter=function(){var t={begin:{text:"Begins With",TR:!0,string:!0},between:{text:"Between",TR:!0,string:!0,date:!0,number:!0},notbegin:{text:"Does not begin with",TR:!0,string:!0},contain:{text:"Contains",TR:!0,string:!0},notcontain:{text:"Does not contain",TR:!0,string:!0},equal:{text:"Equal To",TR:!0,string:!0,bool:!0},notequal:{text:"Not Equal To",TR:!0,string:!0},empty:{text:"Empty",TR:!1,string:!0,bool:!0},notempty:{text:"Not Empty",TR:!1,string:!0,bool:!0},end:{text:"Ends With",TR:!0,string:!0},notend:{text:"Does not end with",TR:!0,string:!0},less:{text:"Less Than",TR:!0,number:!0,date:!0},lte:{text:"Less than or equal",TR:!0,number:!0,date:!0},range:{TR:!0,string:!0,number:!0,date:!0},regexp:{TR:!0,string:!0,number:!0,date:!0},great:{text:"Great Than",TR:!0,number:!0,date:!0},gte:{text:"Greater than or equal",TR:!0,number:!0,date:!0}};return{conditions:t,getAllConditions:function(){var e=[];for(var i in t)e.push(i);return e}(),getConditions:function(e){var i=[];for(var r in t)t[r][e]&&i.push(r);return i},getTRConditions:function(){var e=[];for(var i in t)t[i].TR&&e.push(i);return e}(),getWTRConditions:function(){var e=[];for(var i in t)t[i].TR||e.push(i);return e}()}}(),t.paramquery.filter.rules={},t.paramquery.filter.rules.en={begin:"Begins With",between:"Between",notbegin:"Does not begin with",contain:"Contains",notcontain:"Does not contain",equal:"Equal To",notequal:"Not Equal To",empty:"Empty",notempty:"Not Empty",end:"Ends With",notend:"Does not end with",less:"Less Than",lte:"Less than or equal",great:"Great Than",gte:"Greater than or equal"},o.getQueryStringSort=function(){var t=this.iSort.sorters,e="",i=this.options,r=i.sql,o=i.stringify;if(r){for(var n=0;n<t.length;n++){var a=t[n],l=a.dataIndx,s="up"==a.dir?"asc":"desc";e+=(n>0?", ":"")+l+" "+s}return e}return t.length?!1===o?t:JSON.stringify(t):""},o.getQueryStringCRUD=function(){return""},o.getQueryStringFilter=function(){var e=this.options,i=e.sql,r=e.stringify,o=e.filterModel,n=o.mode,a=this.colModel,l=this.getFilterData({CM:a,location:"remote"}),s="";if(o&&o.on&&l)if(i){s=[];for(var d=0;d<l.length;d++){var h=l[d],c=h.condition,u=h.dataIndx,f=t.trim(h.value);"contain"===c?s.push(u+" like '%"+f+"%'"):"notcontain"===c?s.push(u+" not like '%"+f+"%'"):"begin"===c?s.push(u+" like '"+f+"%'"):"end"===c?s.push(u+" like '%"+f+"'"):"equal"===c?s.push(u+"='"+f+"'"):"notequal"===c?s.push(u+"!='"+f+"'"):"empty"===c?s.push("isnull("+u+",'')=''"):"notempty"===c?s.push("isnull("+u+",'')!=''"):"less"===c?s.push(u+"<'"+f+"'"):"great"===c&&s.push(u+">'"+f+"'")}s=s.join(" "+n+" ")}else if(l.length){var p={mode:n,data:l};s=!1===r?p:JSON.stringify(p)}else s="";return s},o.remoteRequest=function(e){this.loading&&this.xhr.abort();var i=this,r="",o="",n=this.options,a=!1,l=this.colModel,s=n.dataModel,d=n.filterModel,h=n.pageModel;if("function"==typeof s.getUrl){var c={colModel:l,dataModel:s,groupModel:n.groupModel,pageModel:h,filterModel:d},u=s.getUrl.call(this.element[0],c);u&&u.url&&(r=u.url),u&&u.data&&(o=u.data)}else if("string"==typeof s.url){r=s.url;var f={},p={},g={};if("remote"==s.sorting){var v=this.getQueryStringSort();v&&(f={pq_sort:v})}"remote"==h.type&&(g={pq_curpage:h.curPage,pq_rpp:h.rPP});var w;"local"!=d.type&&(w=this.getQueryStringFilter())&&(a=!0,p={pq_filter:w});var x=s.postData,I=s.postDataOnce;x&&"function"==typeof x&&(x=x.call(this.element[0],{colModel:l,dataModel:s})),o=t.extend({pq_datatype:s.dataType},p,g,f,x,I)}r&&(this.loading=!0,this.showLoading(),this.xhr=t.ajax({url:r,dataType:s.dataType,async:null==s.async||s.async,cache:s.cache,contentType:s.contentType,type:s.method,data:o,beforeSend:function(t,e){if("function"==typeof s.beforeSend)return s.beforeSend.call(i.element[0],t,e)},success:function(t,r,o){if("function"==typeof s.getData){var n=s.getData.call(i.element[0],t,r,o);s.data=n.data,h.type&&"remote"==h.type&&(n.curPage&&(h.curPage=n.curPage),n.totalRecords&&(h.totalRecords=n.totalRecords))}else s.data=t.data,h.type&&"remote"==h.type&&(t.curPage&&(h.curPage=t.curPage),t.totalRecords&&(h.totalRecords=t.totalRecords));i.hideLoading(),i.loading=!1,e&&e.callback&&e.callback(),i._trigger("load",null,{dataModel:s,colModel:l}),a&&i._trigger("filter",null,{type:"remote",dataModel:s,colModel:l,filterModel:d})},error:function(t,e,r){if(i.hideLoading(),i.loading=!1,"function"==typeof s.error)s.error.call(i.element[0],t,e,r);else if("abort"!=r)throw"Error : "+r}}))},o.setFlexWHCallback=function(t){t.call(this);var e=this.options;"flex"==e.height&&this._setGridHeightFromTable(),"flex"==e.width&&this._setGridWidthFromTable()},o._refreshTitle=function(){this.$title.html(this.options.title)},o._destroyDraggable=function(){var t=this.element,e=t.parent(".pq-wrapper");e.length&&e.data("draggable")&&(e.draggable("destroy"),this.$title.removeClass("pq-draggable"),t.unwrap(".pq-wrapper"))},o._refreshDraggable=function(){var t=this.options,e=this.element,i=this.$title;if(t.draggable){i.addClass("pq-draggable");e.parent(".pq-wrapper").length||e.wrap("<div class='pq-wrapper' />"),e.parent(".pq-wrapper").draggable({handle:i})}else this._destroyDraggable()},o._refreshResizable=function(){var e=this,i=this.element,r=this.options,o=(r.width+"").indexOf("%")>-1,n=(r.height+"").indexOf("%")>-1,a="auto"==r.width,l="flex"==r.width,s="flex"==r.height;if(!r.resizable||(s||n)&&(l||o||a))this._destroyResizable();else{var d="e,s,se";s||n?d="e":(l||o||a)&&(d="s");var h=!0;if(i.hasClass("ui-resizable")){d==i.resizable("option","handles")?h=!1:this._destroyResizable()}h&&i.resizable({helper:"ui-state-default",handles:d,minWidth:r.minWidth,minHeight:r.minHeight?r.minHeight:100,delay:0,start:function(e,i){t(i.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},resize:function(t,e){},stop:function(i,o){var n=e.element,a=r.width,l=r.height,s=(a+"").indexOf("%")>-1,d="auto"==a,h="flex"==a,c=!1;(l+"").indexOf("%")>-1||"flex"==l||(c=!0,r.height=n.height()),s||d||h||(c=!0,r.width=n.width()),e.refresh(),n.css("position","relative"),c&&t(window).trigger("resize")}})}},o._refreshAfterResize=function(){var t=this.options,e=t.width,i=t.height,r=-1!=(e+"").indexOf("%"),o="auto"===e,n=-1!=(i+"").indexOf("%");(r||o||n)&&this.refresh()},o.refresh=function(t){this._refresh(t)},o._refreshDataIndices=function(){for(var t="JSON"==this.getDataType(),e={},i={},r={},o=this.colModel,n=o.length,a=0;a<n;a++){var l=o[a],s=l.dataIndx;null==s&&(s=t?"dataIndx_"+a:a,l.dataIndx=s),e[s]=l,i[s]=a;l.validations&&(r[s]=r)}this.columns=e,this.colIndxs=i,this.validations=r},o.refreshView=function(t){null!=this.options.editModel.indices&&this.blurEditor({force:!0}),this.refreshDataFromDataModel(),this.refresh(t)},o._refresh=function(t){var e=(t=t||{}).header,i=t.table,r=this.element;if(r[0].offsetWidth){this.$grid_inner[0].scrollTop=0;var o=this.options;this.decidePanes(),o.collapsible._collapsed=!1;var n=this;this._refreshGridWidthAndHeight(),this.iRefreshColumn.refreshColumnWidths(),this._setScrollHNumEles(),this._bufferObj_calcInitFinalH(),this._refreshHideArrHS(),!1!==e?this._createHeader():this._refreshHeader(),this._refreshHeaderSortIcons(),this._refreshPager(),this._setInnerGridHeight(),this._setRightGridHeight(),r.height(""),this.setFlexWHCallback(function(){!1!==i?n.iGenerateView.generateView():(n._saveDims(),n.iGenerateView.scrollView())}),this._refreshScrollbars(),this._refreshFreezeLine(),this._createCollapse(),o.dataModel.postDataOnce=void 0}},o._refreshScrollbars=function(t){this._setScrollHLength(),this._setScrollVLength(),this._setScrollVNumEles(!0),this._setScrollHLength(),this._setScrollHVLength()},o._setScrollHVLength=function(){var t=this.options;(this.$hscroll.is(":hidden")||"flex"==t.height||"flex"==t.width)&&this.$hvscroll.css("visibility","hidden")},o._refreshPager=function(){var t=this.options,e=t.pageModel,i=this.$footer,r=!!e.type,o=e.rPP,n=e.totalRecords;if(r){var a=t.pageModel;0==i.hasClass("pq-pager")&&this._initPager(),i.pqPager("option",a),n>o&&this.$bottom.css("display","")}else i.hasClass("pq-pager")&&i.pqPager("destroy"),t.showBottom?this.$bottom.css("display",""):this.$bottom.css("display","none")},o.getInstance=function(){return{grid:this}},o._addRowsData=function(t){var e=t.data,i=this.options.dataModel.data,r=t.rowIndx;if(null==i&&(i=[]),null==r)for(var o=0,n=e.length;o<n;o++){var a=e[o];i.push(a)}else{if(!(r<i.length))return!1;for(o=0,n=e.length;o<n;o++){a=e[o];i.splice(r,0,a),r++}}return!0},o.addRows=function(t){return!!this._addRowsData(t)&&(this.refreshDataFromDataModel(),this.refresh(),!0)},o.refreshDataAndView=function(t){var e=this.options.dataModel;if(this.iSort._refreshSorters(),"remote"==e.location){var i=this;this.remoteRequest({callback:function(){i._onDataAvailable(t)}})}else this._onDataAvailable(t)},o.getColIndx=function(t){var e=t.dataIndx;if(void 0===e)throw"dataIndx NA";for(var i=this.colModel,r=0,o=i.length;r<o;r++)if(i[r].dataIndx==e)return r},o.getColumn=function(t){if(null==t.dataIndx)throw"dataIndx N/A";return this.columns[t.dataIndx]},o._onDataAvailable=function(){},o._setOption=function(t,e){var i=this.options;if("height"===t&&"flex"==e){this._super.call(this,t,e);var r=this.$vscroll;e&&r&&r.hasClass("pq-sb-vert")&&(i.virtualY?r.pqScrollBar("option","cur_pos",0):r.pqScrollBar("option","ratio",0))}else if("width"===t&&"flex"==e){this._super.call(this,t,e);var o=this.$hscroll;e&&o&&o.hasClass("pq-sb-horiz")&&(i.virtualX?o.pqScrollBar("option","cur_pos",0):o.pqScrollBar("option","ratio",0))}else"title"==t?(this._super.call(this,t,e),this._refreshTitle()):"roundCorners"==t?(this._super.call(this,t,e),e?(this.element.addClass("ui-corner-all"),this.$top.addClass("ui-corner-top"),this.$bottom.addClass("ui-corner-bottom")):(this.element.removeClass("ui-corner-all"),this.$top.removeClass("ui-corner-top"),this.$bottom.removeClass("ui-corner-bottom"))):"freezeCols"==t?(e=parseInt(e),!isNaN(e)&&e>=0&&e<=this.colModel.length-2&&this._super.call(this,t,e)):"freezeRows"==t?(e=parseInt(e),!isNaN(e)&&e>=0&&this._super.call(this,t,e)):"resizable"==t?(this._super.call(this,t,e),this._refreshResizable()):"draggable"==t?(this._super.call(this,t,e),this._refreshDraggable()):"scrollModel"==t?this._super.call(this,t,e):"dataModel"==t?this._super.call(this,t,e):"pageModel"==t?this._super.call(this,t,e):"selectionModel"===t?this._super.call(this,t,e):"colModel"===t||"columnTemplate"==t?(this._super.call(this,t,e),this._calcThisColModel()):"disabled"===t?(this._super.call(this,t,e),!0===e?this._disable():this._enable()):"numberCell"===t?(this._super.call(this,t,e),this.decidePanes()):"strLoading"===t?(this._super.call(this,t,e),this._refreshLoadingString()):"showTop"===t?(this._super.call(this,t,e),!0===e?this.$top.css("display",""):this.$top.css("display","none")):"showTitle"===t?(this._super.call(this,t,e),!0===e?this.$title.css("display",""):this.$title.css("display","none")):"showToolbar"===t?(this._super.call(this,t,e),!0===e?this.$toolbar.css("display",""):this.$toolbar.css("display","none")):"toolbar"==t?(this._super.call(this,t,e),this.$toolbar.remove(),this._super.call(this,t,e),this._createToolbar()):"collapsible"===t?(this._super.call(this,t,e),this._createCollapse()):"showBottom"===t?(this._super.call(this,t,e),!0===e?this.$bottom.css("display",""):this.$bottom.css("display","none")):this._super.call(this,t,e)},o._setOptions=function(){this._super.apply(this,arguments)},o._generateCellRowOutline=function(){var e=this.options,i=e.editModel;if(this.$div_focus){if(e.debug)throw"this.$div_focus already present assert failed"}else{var r=this.element;i.inline&&(r=this.getCell(i.indices)).css("padding",0).empty(),this.$div_focus=t(["<div class='pq-editor-outer'>","<div class='pq-editor-inner'>","</div>","</div>"].join("")).appendTo(r),this.$div_focus.css("zIndex",r.zIndex()+5);var o=t.extend({all:!0},i.indices),n=this.getCell(o);n.css("height",n.height()),n.empty(),this.refreshEditorPos()}},o._removeCellRowOutline=function(e){if(this.$div_focus){var i=this.$div_focus.find(".pq-editor-focus");if(function(t){t.hasClass("hasDatepicker")&&t.datepicker("hide").datepicker("destroy")}(i),i[0]==document.activeElement){var r=this._blurEditMode;this._blurEditMode=!0,i.blur(),this._blurEditMode=r}this.$div_focus.remove(),delete this.$div_focus;var o=this.options.editModel,n=t.extend({},o.indices);o.indices=null,this.refreshCell(n)}},o.refreshEditorPos=function(){var t=this.options.editModel,e=t.cellBorderWidth,i=this.$div_focus,r=this.getCell(t.indices);if(!r)return!1;var o=r[0].offsetWidth-(e?2*e:1),n=r[0].offsetHeight-(e?2*e:1),a=this.element.offset(),l=r.offset(),s=l.left-a.left-1,d=l.top-a.top-1;i.css({height:n,width:o,borderWidth:e,left:s,top:d})},o.setEditorPosTimer=function(){var t=this,e=this.options;this._refreshEditorPosTimer&&(window.clearInterval(this._refreshEditorPosTimer),this._refreshEditorPosTimer=null),this._refreshEditorPosTimer=window.setInterval(function(){e.editModel.indices&&t.refreshEditorPos()},200)},o._onHeaderCellClick=function(t,e){var i=this.colModel[t],r=this.options,o=(r.dataModel,i.dataIndx);i.dataType;!1!==this._trigger("headerCellClick",e,{column:i,colIndx:t,dataIndx:o})&&r.sortable&&0!=i.sortable&&this.sort({colIndx:t,column:i,dataIndx:o})},o._selectRow=function(t,e){this.selectRow(t,e)},o._findfirstUnhiddenColIndx=function(){for(var t=0;t<this.colModel.length;t++)if(!this.colModel[t].hidden)return t},o.selectRow=function(t){var e=t.evt;if(!e||"keydown"!=e.type&&"keypress"!=e.type){if(0==this.iRows.add(t))return!1}else if(0==this.iRows.replace(t))return!1;return!0},o.get$Tbl=function(e,i){var r=this.$tbl,o=[];if(r&&r.length){var n=this.pqpanes,a=this.options,l=a.freezeRows,s=a.freezeCols;return n.h&&n.v?null==i?e>=l?o.push(r[2],r[3]):o.push(r[0],r[1]):o=i>=s&&e>=l?r[3]:i<s&&e>=l?r[2]:i>=s&&e<l?r[1]:r[0]:o=n.v?null==i?r:i>=s?r[1]:r[0]:n.h&&e>=l?r[1]:r[0],o?t(o):void 0}},o.scrollCell=function(t){this.scrollRow(t),this.scrollColumn(t)},o.scrollY=function(t){this.$vscroll.pqScrollBar("option","cur_pos",t).pqScrollBar("scroll")},o.scrollRow=function(t){var e=this.options;if(!this.pdata||t.rowIndxPage>=this.pdata.length)return!1;e.virtualY?this._scrollRowVirtualY(t):this._scrollRowNonVirtualY(t)},o._scrollRowNonVirtualY=function(t){var e=this.options,i=t.rowIndxPage,r=!!this.iHierarchy,o=t.rowIndx,n=this.$cont.data("offsetHeight")-this._getScollBarHorizontalHeight();if(!((i=null==i?o-this.rowIndxOffset:i)<parseInt(e.freezeRows))){var a=this.get$Tbl(i),l=this.getRow({rowIndxPage:i}),s=l[0];if(s){var d=s.offsetTop+parseInt(a.css("marginTop")),h=s.offsetHeight;if(r){var c=l.next("tr.pq-detail-child");c&&c.length&&(h+=c[0].offsetHeight)}s.offsetTop,a[0].offsetTop;if(s.offsetTop<-1*a[0].offsetTop){var u=-1*s.offsetTop-parseInt(a.css("top"));a.css("marginTop",u),this._syncScrollBarVert()}else if(d+h>=n){u=n-h-s.offsetTop;a.css("marginTop",u),this._syncScrollBarVert()}}}},o._scrollRowVirtualY=function(t){var e=this.options,i=t.rowIndxPage,r=!!this.iHierarchy,o=t.rowIndx,n=this.scrollCurPos,a=(i=null==i?o-this.rowIndxOffset:i,parseInt(e.freezeRows));if(!(i<a)){var l=this._calcCurPosFromRowIndxPage(i);if(null!=l){l<n&&this.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll");var s=this.get$Tbl(i);if(!s||!s.length)return null;var d=(m=s.children("tbody").children("tr[pq-row-indx="+i+"]")).last(),h=d;m.length>1&&(h=m.first());var c=d[0],u=parseInt(s.css("marginTop"));if(void 0==c)this.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll");else{var f=c.offsetTop+c.offsetHeight,p=this.$cont[0].offsetHeight,g=u,v=this._getScollBarHorizontalHeight(),w=h.prev("tr");if(w.hasClass("pq-row-hidden")||w.hasClass("pq-last-freeze-row"))return;if(f>p-v-g){var x,I=f-(p-v-g),m=s.children().children("tr"),_=0,b=0;for(a?0==(x=m.filter("tr.pq-last-freeze-row").last().next()).length&&(x=m.filter("tr.pq-row-hidden").next()):x=m.filter("tr.pq-row-hidden").next();;){if(_+=x[0].offsetHeight,x[0]==d[0])break;if(r&&0!=x.hasClass("pq-detail-child")){if(_>=I)break}else if(b++,_>=I)break;x=x.next()}var y=n+b;y>l&&(y=l);var q=this.$vscroll.pqScrollBar("option","num_eles");q<y+1&&(q=y+1),this.$vscroll.pqScrollBar("option",{num_eles:q,cur_pos:y}).pqScrollBar("scroll")}}}}},o.getTableForVertScroll=function(){var e=this.pqpanes,i=this.$tbl;if(i&&i.length)return e.h&&e.v?i=t([i[2],i[3]]):e.v?i=t([i[0],i[1]]):e.h&&(i=t(i[1])),i},o.getTableForHorScroll=function(){var e=this.pqpanes,i=[],r=this.$tbl;if(r&&r.length){if(e.h&&e.v?i.push(r[1],r[3]):e.v?i.push(r[1]):e.h?i.push(r[0],r[1]):i.push(r[0]),this.tables.length){var o=this.tables[0].$tbl;e.v?i.push(o[1]):i.push(o[0])}return t(i)}},o.getTableHeaderForHorScroll=function(){var e=this.pqpanes,i=this.$tbl_header;if(i&&i.length)return(i=e.vH?t(i[1]):t(i[0])).parent()},o.blurEditor=function(t){if(this.$div_focus){var e=this.$div_focus.find(".pq-editor-focus");if(!t||!t.blurIfFocus)return e.triggerHandler("blur",t);document.activeElement==e[0]&&e.blur()}},o._syncViewWithScrollBarVert=function(t){if(null!=t){var e=this.getTableForVertScroll();if(e&&e.length){var i=this.options;i.editModel.indices&&this.blurEditor({force:!0});var r=e.data("offsetHeight"),o=this.$cont.data("offsetHeight")-this._getScollBarHorizontalHeight(),n=-1*(n=(r-o)*t)-1;if((!r||!o)&&i.debug)throw"_syncViewWithScrollBarVert !tblHt || !contHt";n>-1&&(n=-1),e.css({marginTop:n})}}},o._syncViewWithScrollBarHor=function(t){if(null!=t){var e=this.getTableForHorScroll(),i=this.getTableHeaderForHorScroll();if(e||i){this.options.editModel.indices&&this.blurEditor({force:!0});var r=(e||i).data("scrollWidth"),o=this.$cont.data("offsetWidth")-this._getSBWidth(),n=-1*(n=(r-o)*t);r&&o&&(n>0&&(n=0),e&&e.css("marginLeft",n),i&&i.css("marginLeft",n))}}},o._syncViewWithScrollBarHorHeader=function(t){if(null!=t){var e=this.getTableHeaderForHorScroll();if(e){var i=this.options,r=i.freezeCols;i.editModel.indices&&this.blurEditor({force:!0});var o=e.data("scrollWidth"),n=this.$cont.data("offsetWidth")-this._getSBWidth(),a=-1*(a=c.call(this,r,t+r));o&&n&&(a>0&&(a=0),e.css("marginLeft",a))}}},o._syncScrollBarVert=function(){var t=this.getTableForVertScroll();if(t&&t.length){var e=t.data("offsetHeight")-(this.$cont.data("offsetHeight")-this._getScollBarHorizontalHeight()),i=(-1*parseInt(t.css("marginTop"))-1)/(e-1);i>=0&&i<=1&&this.$vscroll.hasClass("pq-sb-vert")&&this.$vscroll.pqScrollBar("option","ratio",i)}},o._syncScrollBarHor=function(){var t=this.getTableForHorScroll(),e=this.getTableHeaderForHorScroll();if(t||e){var i=t||e,r=i.data("scrollWidth")-(this.$cont.data("offsetWidth")-this._getSBWidth()),o=-1*parseInt(i.css("marginLeft"))/r;o>=0&&o<=1&&this.$hscroll.hasClass("pq-sb-horiz")&&this.$hscroll.pqScrollBar("option","ratio",o)}},o._scrollColumnNonVirtual=function(t){var e=null==(e=t.colIndx)?this.getColIndx({dataIndx:t.dataIndx}):e,i=this.options.freezeCols;if(!(e<i)){var r,o,n=this._calcRightEdgeCol(e).width,a=this._calcRightEdgeCol(e-1).width,l=this._calcRightEdgeCol(i-1).width,s=this._getSBWidth(),d=this.getTableForHorScroll(),h=this.getTableHeaderForHorScroll(),c=this.$cont[0].offsetWidth-s;if(d)r=parseInt(d.css("marginLeft")),o=d[0].offsetLeft;else{if(!h)return;r=parseInt(h.css("marginLeft")),o=h[0].offsetLeft-l}n+r>c?(r=c-n,d&&d.css("marginLeft",r),h&&h.css("marginLeft",r),this._syncScrollBarHor()):a<-1*o&&(r=-1*a+l,d&&d.css("marginLeft",r),h&&h.css("marginLeft",r),this._syncScrollBarHor())}},o._scrollColumnVirtual=function(t){var e=null==(e=t.colIndx)?this.getColIndx({dataIndx:t.dataIndx}):e,i=this.options.freezeCols,r=this._calcRightEdgeCol(e).width,o=this._getSBWidth(),n=this.$cont[0].offsetWidth-o;if(r>n){for(var a=c.call(this,-1,e+1)-n,l=this.colModel,s=l.length,d=0,h=0,u=i;u<s;u++){var f=l[u];if(f.hidden||(d+=f.outerWidth),u==e){h=u-i-this._calcNumHiddenUnFrozens(u);break}if(d>=a){h=u-i-this._calcNumHiddenUnFrozens(u)+1;break}}return this.$hscroll.pqScrollBar("option","cur_pos",h).pqScrollBar("scroll"),!0}if(this.hidearrHS[e]){this.hidearrHS[e]=!1;var p=e-i-this._calcNumHiddenUnFrozens(e);return this.$hscroll.pqScrollBar("option","cur_pos",p).pqScrollBar("scroll"),!0}return!1},o.scrollColumn=function(t){return this.options.virtualX?this._scrollColumnVirtual(t):this._scrollColumnNonVirtual(t)},o.selection=function(t){var e=t.method,i=t.type;return"row"==i?this.iRows[e](t):"cell"==i?this.iCells[e](t):void 0},o._bringPageIntoView=function(t){var e=t.rowIndx,i=this.options.pageModel;if("local"==i.type&&e>=0){var r=i.curPage,o=i.rPP;e>=(r-1)*o&&e<r*o||(i.curPage=Math.ceil((e+1)/o),this.refreshDataFromDataModel(),this.refresh())}},o.goToPage=function(t){var e=this.options.pageModel;if("local"==e.type||"remote"==e.type){var i=t.rowIndx,r=e.rPP,o=null==t.page?Math.ceil((i+1)/r):t.page;o!=e.curPage&&(e.curPage=o,"local"==e.type?(this.refreshDataFromDataModel(),this.refresh()):this.refreshDataAndView())}},o.setSelection=function(t){if(null==t)return this.iRows.removeAll({raiseEvent:!0}),this.iCells.removeAll({raiseEvent:!0}),!1;var e=this.pdata;if(t.rowData){r=this.getRowIndx(t).rowIndx}else{var i=this.rowIndxOffset,r=t.rowIndx,o=t.rowIndxPage;r=null==r?o+i:r}var n=null==t.colIndx&&void 0!==t.dataIndx?this.getColIndx({dataIndx:t.dataIndx}):t.colIndx;t.evt;return!(r<0||n<0||n>=this.colModel.length)&&(null!=e&&0!=e.length&&(t.rowIndx=r,t.colIndx=n,this._bringPageIntoView(t),o=r-this.rowIndxOffset,t.rowIndxPage=o,this.scrollRow({rowIndxPage:o}),null==n?this._selectRow(t):(this.scrollColumn({colIndx:n}),this.selectCell(t))))},o.getColModel=function(){return this.colModel},o.saveEditCell=function(e){var i=this.options,r=i.editModel;if(!r.indices)return null;var o,n=t.extend({},r.indices),a=e?e.evt:null,l=this.rowIndxOffset,s=n.colIndx,d=n.rowIndxPage,h=d+l,c=this.colModel[s],u=c.dataIndx,f=this.pdata[d],p=i.dataModel;if(null==f)return null;if(o=f[u],null!=d){var g=this.getEditCellData();"<br>"==g&&(g=""),null==o&&""===g&&(g=null);var v={rowIndx:h,rowIndxPage:d,dataIndx:u,column:c,newVal:g,value:g,oldVal:o,rowData:f,dataModel:p};if(!1===this._trigger("cellBeforeSave",a,v))return!1;var w={};w[u]=g;if(!1===this.updateRow({row:w,rowIndx:h,refresh:!1,silent:!0,source:"edit",checkEditable:!1}))return!1;this._trigger("cellSave",a,v);return"flex"==i.height?(this._setGridHeightFromTable(),this._fixIEFooterIssue()):e&&this.scrollRow({rowIndxPage:d}),!0}},o._addInvalid=function(t){},o._digestData=function(e){if(!1===this._trigger("beforeValidate",null,e))return!1;var i=this.options,r=i.editModel,o=i.dataModel,n=o.data,a=i.colModel,l=i.pageModel,s=i.historyModel,d=null==(d=e.validate)?r.validate:d,h=l.type,c=null==(c=e.allowInvalid)?r.allowInvalid:c,u=(r.invalidClass,i.trackModel),f=null==(f=e.track)?null==i.track?u.on:i.track:f,p=null==(p=e.history)?s.on:p,g=null==(g=e.checkEditable)||g,v=null==(v=e.checkEditableAdd)?g:v,w=this.columns,x=this.colIndxs,I=e.source,m=this.rowIndxOffset,_=t.paramquery.getValueFromDataType,b=e.rowList,y=b.length;n||(n=i.dataModel.data=[]);for(var q=[],C=0;C<y;C++){var D=(F=b[C]).newRow,M=F.rowData,R=F.type,P=F.checkEditable,$=F.rowIndx,S=F.oldRow;if(null==P&&("update"==R?P=g:"add"==R&&(P=v)),"update"==R){if(!S||!M)throw"assert failed: oldRow and rowData required while update";if(P&&!0!==i.editable&&!1===this.isEditableRow({rowIndx:$,rowData:M}))continue}else if("delete"==R){q.push(F);continue}if("add"==R)for(var T=0,H=a.length;T<H;T++){D[k=(E=a[T]).dataIndx]=D[k]}for(var k in D){var E=w[k],V=x[k];if(E){if(P&&null!=E.editable&&!1===this.isEditableCell({rowIndx:$,colIndx:V,dataIndx:k})){delete D[k];continue}var z=E.dataType,L=_(D[k],z),O=void 0!==(O=M?M[k]:void 0)?_(O,z):void 0;if(D[k]=L,d&&E.validations)if("edit"==I&&!1===c){if(0==(W=this.isValid({dataIndx:k,rowIndx:$,value:L})).valid&&!W.warn)return!1}else{var W,B="add"==R?D:M;!1===(W=this.iIsValid.isValidCell({column:E,rowData:B,allowInvalid:c,value:L})).valid&&(!1!==c||W.warn||delete D[k])}if("update"==R&&L===O){if("edit"==I)return null;delete D[k];continue}}"update"==R&&(S[k]=O)}if(D)if("update"==R)for(var k in D){q.push(F);break}else q.push(F)}if(b=e.rowList=q,!(y=b.length))return!1;p&&(this.iHistory.increment(),this.iHistory.push({rowList:b}));for(C=0;C<y;C++){R=(F=b[C]).type,D=F.newRow,$=F.rowIndx;var F,A=F.rowIndxPage;M=F.rowData;if("update"==R){f&&this.iUCData.update({rowData:M,row:D,refresh:!1});for(var k in D){L=D[k];M[k]=L}}else if("add"==R){if(f&&this.iUCData.add({rowData:D}),null==$&&null==A)n.push(D);else{A=$-m;var N="remote"==h?A:$;n.splice(N,0,D)}"remote"==h&&l.totalRecords++}else if("delete"==R){var j=this.getRowIndx({rowData:M}),U=j.uf;$=j.rowIndx;f&&this.iUCData.delete({rowIndx:$,rowData:M});A=$-m,N="remote"==h?A:$;if(U)o.dataUF.splice(N,1);else{var G=n.splice(N,1);G&&G.length&&"remote"==h&&l.totalRecords--}}}return this._trigger("change",null,e),!0},o._fixTableViewPort=function(){var t=this.element[0];t.scrollTop=0,t.scrollLeft=0;var e=this.$header_o[0];e.scrollLeft=0,e.scrollTop=0,this.iGenerateView.setPanes()},o._fixIEFooterIssue=function(){t(".pq-grid-footer").css({position:"absolute"}),t(".pq-grid-footer").css({position:"relative"})},o.refreshColumn=function(t){var e=this.colModel,i=t.colIndx,r=t.dataIndx,o=(i=null==i?this.getColIndx({dataIndx:r}):i,r=null==r?e[i]:r,this.rowIndxOffset);t.colIndx=i;for(var n=this.initV,a=this.finalV,l=n;l<=a;l++){var s=l;t.rowIndx=s+o,t.rowIndxPage=s,t.colIndx=i,t.column=e[i],t.skip=!0,this.refreshCell(t)}this._fixTableViewPort(),this._refreshScrollbars(),this._trigger("refreshColumn",null,{dataModel:this.options.dataModel,colModel:e,initV:n,finalV:a,colIndx:i,dataIndx:r})},o.refreshCell=function(t){if(this.pdata){var e=this.rowIndxOffset,i=t.skip,r=t.rowIndx,o=t.rowIndxPage,n=(r=t.rowIndx=null==r?o+e:r,o=t.rowIndxPage=null==o?r-e:o,t.dataIndx),a=t.colIndx,l=(a=t.colIndx=null==a?this.getColIndx({dataIndx:n}):a,this.getCell({all:!0,rowIndxPage:o,colIndx:a})),s=t.column,d=this.colModel,h=(s=t.column=s||d[a],this.options.treeModel),c=this.pdata[o];if(c){var u=t;if(u.tree=!!h.labelIndx,u.rowData=c,l&&l.length>0){var f=this.iGenerateView.renderCell(u);l.replaceWith(f),i||(this._fixTableViewPort(),this._refreshScrollbars(),this._trigger("refreshCell",null,{dataModel:this.options.dataModel,colModel:d,rowData:c,rowIndx:r,rowIndxPage:o,colIndx:a,dataIndx:n}))}}}},o.refreshRow=function(e){if(this.pdata){var i=this.rowIndxOffset,r=e.rowIndx,o=e.rowIndxPage,n=(r=null==r?o+i:r,o=null==o?r-i:o,this.getRow({all:!0,rowIndxPage:o})),a=this.colModel,l=this.pdata[o],s=!1,d=document.activeElement;t(d);if((d==n[0]||n.length>1&&d==n[1])&&(s=!0),!l||!n||!n.length)return null;var h=[];this.iGenerateView.refreshRow(o,a,h);var c=h.join("");if(n.replaceWith(c),this._fixTableViewPort(),this._refreshScrollbars(),s){this.getRow({all:!0,rowIndxPage:o}).attr("tabindex",0).focus()}return this._trigger("refreshRow",null,{rowData:l,rowIndx:r,rowIndxPage:o}),!0}},o.quitEditMode=function(t){if(!this._quitEditMode){var e=!1,i=!1,r=!1,o=this.options.editModel,n=o.indices,a=void 0;this._quitEditMode=!0,t&&(e=t.old,i=t.silent,r=t.fireOnly,a=t.evt),n&&(i||e||this._trigger("editorEnd",a,n),r||(this._removeCellRowOutline(t),o.indices=null)),this._quitEditMode=null}},o._fixIE=function(){var t=this.$cont[0];t.scrollLeft=0,t.scrollTop=0},o.getData=function(){return this.pdata},o.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}},o.getViewPortIndx=function(){return{initV:this.initV,finalV:this.finalV,initH:this.initH,finalH:this.finalH}},o.getRowIndxOffset=function(){return this.rowIndxOffset},o.selectCell=function(t){var e=t.evt;if(!e||"keydown"!=e.type&&"keypress"!=e.type){if(!1===this.iCells.add(t))return!1}else if(0==this.iCells.replace(t))return!1;return!0},o.getEditCell=function(){var t=this.options.editModel;if(t.indices){var e=this.getCell(t.indices),i=this.$div_focus.children(".pq-editor-inner");return{$td:e,$cell:i,$editor:i.find(".pq-editor-focus")}}return null},o.editCell=function(t){this.scrollRow(t),this.scrollColumn(t);var e=this.getCell(t);if(e&&e.length)return this._editCell(t)},o.getFirstEditableColIndx=function(t){if(null==t.rowIndx)throw"rowIndx NA";if(!this.isEditableRow(t))return-1;for(var e=this.colModel,i=0;i<e.length;i++)if(t.colIndx=i,this.isEditableCell(t)&&!e[i].hidden)return i;return-1},o.editFirstCellInRow=function(t){var e=this.rowIndxOffset,i=t.rowIndx,r=t.rowIndxPage,o=(i=null==i?r+e:i,r=null==r?i-e:r,this.getFirstEditableColIndx({rowIndx:i}));-1!=o&&this.editCell({rowIndxPage:r,colIndx:o})},o._editCell=function(e){var i=this,r=e.evt,o=this.rowIndxOffset,n=e.rowIndxPage,a=null==(a=e.rowIndx)?n+o:a,l=(n=null==n?a-o:n,e.colIndx),s=e.dataIndx,d=(l=null==l?this.getColIndx({dataIndx:s}):l,this.colModel[l]),h=(s=d.dataIndx,d.editor),c=this.options,u=c.editModel,f=c.editor,p=h?t.extend({},f,h):f,g=i.pdata[n],v=!1;if(!this.pdata||n>=this.pdata.length)return!1;if(u.indices){var w=u.indices;if(w.rowIndxPage==n&&w.colIndx==l){this.refreshEditorPos();var x=this.$div_focus.find(".pq-editor-focus");return window.setTimeout(function(){x.focus()},0),!1}if(!1===this.blurEditor({evt:r}))return!1;this.quitEditMode({evt:r})}u.indices={rowIndxPage:n,rowIndx:a,colIndx:l,column:d,dataIndx:s},this._generateCellRowOutline();var I=this.$div_focus.children(".pq-editor-inner");"right"==d.align?I.addClass("pq-align-right"):"center"==d.align?I.addClass("pq-align-center"):I.addClass("pq-align-left");var m,_,b=g[s],y=p.type,q=null==e.select?p.select:e.select,C=p.init,D="pq-editor-focus "+(p.cls?p.cls:""),M=D+" pq-cell-editor ",R=p.attr?p.attr:"",P=(_=(_=p.style)||"")?"style='"+_+"'":"",$=I.width()-8,S="style='width:"+$+"px;"+_+"'",T=_?"style='"+_+"'":"",H={rowIndx:a,rowIndxPage:n,$cell:I,cellData:b,rowData:g,cls:D,dataIndx:s,column:d};if("function"==typeof y)m=y.call(i.element[0],H);else if("checkbox"==y){var k=p.subtype;m="<input "+(b?"checked='checked'":"")+" class='"+M+"' "+R+" "+T+" type=checkbox name='"+s+"' />",I.html(m);var E=I.children("input");"triple"==k&&(E.pqval({val:b}),I.click(function(e){t(this).children("input").pqval({incr:!0})}))}else if("textarea"==y||"select"==y||"textbox"==y){if("textarea"==y)m="<textarea class='"+M+"' "+R+" "+S+" name='"+s+"' ></textarea>";else if("select"==y){var V;"function"==typeof(V=(V=p.options)||[])&&(V=V.call(i.element[0],{column:d,rowData:g}));var z=[R," class='",M,"' ",S," name='",s,"'"].join("");m=t.paramquery.select({options:V,attr:z,prepend:p.prepend,labelIndx:p.labelIndx,valueIndx:p.valueIndx,groupIndx:p.groupIndx})}else m="<input class='"+M+"' "+R+" "+S+" type=text name='"+s+"' />";t(m).appendTo(I).width($).val(b)}else m="<div contenteditable='true' tabindx='0' "+P+" "+R+" class='pq-editor-default "+D+"'></div>",I.html(m),I.children().html(b),v=!0;"function"==typeof C&&C.call(i.element[0],H);i=this,x=I.children(".pq-editor-focus");var L=u.filterKeys,O=d.editModel;O&&void 0!==O.filterKeys&&(L=O.filterKeys);var W={$cell:I,$editor:x,dataIndx:s,column:d,colIndx:l,rowIndx:a,rowIndxPage:n,rowData:g};if(u.indices=W,x.data({FK:L}).on("click",function(e){t(this).focus()}).on("keydown",function(t){i.iKeyNav._keyDownInEdit(t)}).on("keypress",function(t){return i.iKeyNav._keyPressInEdit(t,{FK:L})}).on("keyup",function(t){return i.iKeyNav._keyUpInEdit(t,{FK:L})}).on("blur",function(e,r){var o=i.options.editModel,n=o.onBlur,a="save"==n,l="validate"==n,s=o.cancelBlurCls,d=!!r&&r.force;if(!i._quitEditMode&&!i._blurEditMode&&o.indices){var h=t(e.target);if(!d){if(!1===i._trigger("editorBlur",e,W))return;if(!n)return;if(s&&h.hasClass(s))return;if(h.hasClass("hasDatepicker")){if(h.datepicker("widget").is(":visible"))return!1}else if(h.hasClass("ui-autocomplete-input")){if(h.autocomplete("widget").is(":visible"))return}else if(h.hasClass("ui-multiselect")){if(t(".ui-multiselect-menu").is(":visible")||t(document.activeElement).closest(".ui-multiselect-menu").length)return}else if(h.hasClass("pq-select-button")&&(t(".pq-select-menu").is(":visible")||t(document.activeElement).closest(".pq-select-menu").length))return}i._blurEditMode=!0;var c=d||a||!l;if(!i.saveEditCell({evt:e,silent:c})&&!d&&l)return i._deleteBlurEditMode(),!1;i.quitEditMode({evt:e}),i._deleteBlurEditMode()}}).on("focus",function(t){i._trigger("editorFocus",t,W)}),i._trigger("editorBegin",r,W),x.focus(),window.setTimeout(function(){if(!1===t(document.activeElement).hasClass("pq-editor-focus")){i.element.find(".pq-editor-focus").focus()}},0),i.element[0].scrollLeft=0,i.element[0].scrollTop=0,q)if(v)try{var B=x[0],F=document.createRange();F.selectNodeContents(B);var A=window.getSelection();A.removeAllRanges(),A.addRange(F)}catch(t){}else x.select()},o._deleteBlurEditMode=function(t){var e=this;t=t||{};e._blurEditMode&&(t.timer?window.setTimeout(function(){delete e._blurEditMode},0):delete e._blurEditMode)},o.getRow=function(t){var e,i=t.rowIndxPage,r=t.rowIndx,o=this.rowIndxOffset,n=(i=null==i?r-o:i,t.all?this.$tbl:this.get$Tbl(i));if(n&&n.length){var a=n.children("tbody");null!=i&&(e=a.children("tr[pq-row-indx="+i+"]")).length>n.length&&(e=e.filter(".pq-detail-master"))}return e},o.getCell=function(t){var e=t.rowIndxPage,i=t.rowIndx,r=(e=null==e?i-this.rowIndxOffset:e,t.colIndx),o=t.dataIndx,n=(r=null==r?this.getColIndx({dataIndx:o}):r,t.all?this.$tbl:this.get$Tbl(e,r));if(void 0!=n){var a;if(0==(a=n.children().children("tr[pq-row-indx="+e+"]").children("td[pq-col-indx="+r+"]")).length)return null}return a},o.getCellHeader=function(e){var i=e.colIndx,r=e.dataIndx,o=(i=null==i?this.getColIndx({dataIndx:r}):i,this.$tbl_header),n=this.options.freezeCols;if(void 0!=o){o.length>1&&(o=t(i>=n?o[1]:o[0]));var a=o.children().children("tr.pq-grid-title-row:last").children("td[pq-col-indx="+i+"]")}return 0==a.length||"hidden"==a[0].style.visibility?null:a},o.getEditorIndices=function(){var e=this.options.editModel.indices;return e?t.extend({},e):null},o.getEditCellData=function(){var e=this.options,i=e.editModel.indices;if(!i)return null;var r,o=i.colIndx,n=i.rowIndxPage,a=i.rowIndx,l=this.colModel[o],s=l.editor,d=e.editor,h=s?t.extend({},d,s):d,c=l.dataIndx,u=this.$div_focus.children(".pq-editor-inner");if("function"==typeof h.getData)r=h.getData.call(this.element[0],{$cell:u,dataIndx:c,rowIndx:a,rowIndxPage:n,column:l});else{var f=h.type;if("checkbox"==f){var p=u.children();r="triple"==h.subtype?p.pqval():!!p.is(":checked")}else if("contenteditable"==f)r=u.children().html();else{if((g=u.find('*[name="'+c+'"]'))&&g.length)r=g.val();else{var g;(g=u.find(".pq-editor-focus"))&&g.length&&(r=g.val())}}}return r},o.getCellIndices=function(t){var e=t.$td;if(null==e||0==e.length||e.closest(".pq-grid")[0]!=this.element[0])return{rowIndxPage:null,colIndx:null};var i,r=e.parent("tr").attr("pq-row-indx");null!=r&&(i=(r=parseInt(r))+this.rowIndxOffset);var o,n=e.attr("pq-col-indx");return null!=n&&(n=parseInt(n),o=this.colModel[n].dataIndx),{rowIndxPage:r,rowIndx:i,colIndx:n,dataIndx:o}},o.getRowsByClass=function(t){var e=this.options,i=e.dataModel,r="remote"==e.pageModel.type,o=this.rowIndxOffset,n=i.data,a=[];if(null==n)return a;for(var l=0,s=n.length;l<s;l++){var d=n[l];if(t.rowData=d,this.hasClass(t)){var h={rowData:d};h.rowIndx=r?l+o:l,a.push(h)}}return a},o.getCellsByClass=function(t){var e=this.options,i=e.dataModel,r="remote"==e.pageModel.type,o=this.rowIndxOffset,n=i.data,a=this.colModel,l=a.length,s=[],d=function(t){for(var e=0;e<l;e++){var i=a[e].dataIndx;if(t.dataIndx=i,this.hasClass(t)){var n={rowData:u,dataIndx:i,colIndx:e};n.rowIndx=r?h+o:h,s.push(n)}}};if(null==n)return s;if(null!=t.rowIndx||null!=t.rowIndxPage||null!=t.rowData)t.rowData=t.rowData||this.getRowData(t),d(t);else for(var h=0,c=n.length;h<c;h++){var u=n[h];t.rowData=u,d(t)}return s},o.data=function(e){var i=e.dataIndx,r=e.data,o=null==r||"string"==typeof r,n=e.rowData||this.getRowData(e);if(!n)return null;if(null==i){var a=n.pq_rowdata;if(o){return null!=a&&(d=null==r?a:a[r]),{data:d}}var l=t.extend(!0,n.pq_rowdata,r);n.pq_rowdata=l}else{var s=n.pq_celldata;if(o){var d;if(null!=s){var h=s[i];d=null==r||null==h?h:h[r]}return{data:d}}s||(n.pq_celldata={});l=t.extend(!0,n.pq_celldata[i],r);n.pq_celldata[i]=l}},o.attr=function(e){var i=e.rowIndx,r=e.dataIndx,o=e.attr,n=null==o||"string"==typeof o,a=this.rowIndxOffset,l=e.refresh,s=e.rowData||this.getRowData(e);if(!s)return null;if(n||!1===l||null!=i||(i=this.getRowIndx({rowData:s}).rowIndx),null==r){var d=s.pq_rowattr;if(n){return null!=d&&(f=null==o?d:d[o]),{attr:f}}var h=t.extend(s.pq_rowattr,o);if(s.pq_rowattr=h,!1!==l&&null!=i){var c=this.getRow({rowIndxPage:i-a});c&&c.attr(h)}}else{var u=s.pq_cellattr;if(n){var f;if(null!=u){var p=u[r];f=null==o||null==p?p:p[o]}return{attr:f}}u||(s.pq_cellattr={});h=t.extend(s.pq_cellattr[r],o);if(s.pq_cellattr[r]=h,!1!==l&&null!=i){var g=this.getCell({rowIndxPage:i-a,dataIndx:r});g&&g.attr(h)}}},o.removeData=function(e){var i,r=e.dataIndx,o="string"==typeof(i=null==(i=e.data)?[]:i)?i.split(" "):i,n=o.length,a=e.rowData||this.getRowData(e);if(a)if(null==r){var l=a.pq_rowdata;if(l){if(n)for(var s=0;s<n;s++){delete l[o[s]]}n&&!t.isEmptyObject(l)||delete a.pq_rowdata}}else{var d=a.pq_celldata;if(d&&d[r]){var h=d[r];if(n)for(s=0;s<n;s++){delete h[o[s]]}n&&!t.isEmptyObject(h)||delete d[r]}}},o.removeAttr=function(e){var i,r=e.rowIndx,o=e.dataIndx,n="string"==typeof(i=null==(i=e.attr)?[]:i)?i.split(" "):i,a=n.length,l=r-this.rowIndxOffset,s=e.refresh,d=e.rowData||this.getRowData(e);if(d)if(!1!==s&&null==r&&(r=this.getRowIndx({rowData:d}).rowIndx),null==o){var h=d.pq_rowattr;if(h){if(a)for(var c=0;c<a;c++){delete h[u=n[c]]}else for(var u in h)n.push(u);a&&!t.isEmptyObject(h)||delete d.pq_rowattr}if(!1!==s&&null!=r&&n.length){i=n.join(" ");var f=this.getRow({rowIndxPage:l});f&&f.removeAttr(i)}}else{var p=d.pq_cellattr;if(p&&p[o]){var g=p[o];if(a)for(c=0;c<a;c++){delete g[u=n[c]]}else for(var u in g)n.push(u);a&&!t.isEmptyObject(g)||delete p[o]}if(!1!==s&&null!=r&&n.length){i=n.join(" ");var v=this.getCell({rowIndxPage:l,dataIndx:o});v&&v.removeAttr(i)}}},t.paramquery.uniqueArray=function(e){for(var i=[],r=t.inArray,o=0,n=e.length;o<n;o++){var a=e[o];-1==r(a,i)&&i.push(a)}return i},o.addClass=function(e){var i=e.rowIndx,r=e.dataIndx,o=t.paramquery.uniqueArray,n=e.cls,a=this.rowIndxOffset,l=e.refresh,s=e.rowData||this.getRowData(e);if(s)if(!1!==l&&null==i&&(i=this.getRowIndx({rowData:s}).rowIndx),null==r){var d=s.pq_rowcls;if(g=d?d+" "+n:n,g=o(g.split(/\s+/)).join(" "),s.pq_rowcls=g,!1!==l&&null!=i){var h=this.getRow({rowIndxPage:i-a});h&&h.addClass(n)}}else{var c=[];"function"!=typeof r.push?c.push(r):c=r;var u=s.pq_cellcls;u||(u=s.pq_cellcls={});for(var f=0,p=c.length;f<p;f++){var g,v=u[r=c[f]];if(g=v?v+" "+n:n,g=o(g.split(/\s+/)).join(" "),u[r]=g,!1!==l&&null!=i){var w=this.getCell({rowIndxPage:i-a,dataIndx:r});w&&w.addClass(n)}}}},o.removeClass=function(t){var e=t.rowIndx,i=this.getRowData(t),r=t.dataIndx,o=t.cls,n=t.refresh;if(i){var a=i.pq_cellcls,l=i.pq_rowcls;if(!1!==n&&null==e&&(e=this.getRowIndx({rowData:i}).rowIndx),null==r){if(l&&(i.pq_rowcls=this._removeClass(l,o),null!=e&&!1!==n)){var s=this.getRow({rowIndx:e});s&&s.removeClass(o)}}else if(a){var d=[];"function"!=typeof r.push?d.push(r):d=r;for(var h=0,c=d.length;h<c;h++){var u=a[r=d[h]];if(u&&(i.pq_cellcls[r]=this._removeClass(u,o),null!=e&&!1!==n)){var f=this.getCell({rowIndx:e,dataIndx:r});f&&f.removeClass(o)}}}}},o.hasClass=function(t){var e,i=t.dataIndx,r=t.cls,o=this.getRowData(t),n=new RegExp("\\b"+r+"\\b");if(o){if(null==i)return!(!(e=o.pq_rowcls)||!n.test(e));var a=o.pq_cellcls;return!!(a&&a[i]&&n.test(a[i]))}return null},o._removeClass=function(t,e){if(t&&e){for(var i=t.split(/\s+/),r=e.split(/\s+/),o=[],n=0,a=i.length;n<a;n++){for(var l=i[n],s=!1,d=0,h=r.length;d<h;d++){if(l===r[d]){s=!0;break}}s||o.push(l)}return o.length>1?o.join(" "):1===o.length?o[0]:null}},o.getRowIndx=function(t){var e=t.$tr,i=t.rowData;if(i){var r=this.options,o=r.dataModel,n="remote"==r.pageModel.type,a=o.data,l=!1,s=o.dataUF,d=!1;if(a)for(var h=0,c=a.length;h<c;h++)if(a[h]==i){d=!0;break}if(!d&&s){l=!0;for(h=0,c=s.length;h<c;h++)if(s[h]==i){d=!0;break}}if(d){var u=this.rowIndxOffset,f=n?h:h-u;return{rowIndxPage:l?void 0:f,uf:l,rowIndx:n?h+u:h}}return{}}if(null==e||0==e.length)return{rowIndxPage:null};return null==(f=e.attr("pq-row-indx"))?{rowIndxPage:null}:(f=parseInt(f),{rowIndxPage:f,rowIndx:f+this.rowIndxOffset})};var d=function(t){this.options=t.options,this.that=t;var e=this,i=t.widgetEventPrefix.toLowerCase(),r=t.eventNamespace;t.element.on(i+"celleditkeyup"+r,function(t,i){return e.filterKeys(t,i)})},h=d.prototype;h._incrRowIndx=function(t,e){for(var i=this.that,r=t,o=(e=null==e?1:e,i.pdata),n=0,a=t+1,l=o.length;a<l;a++){if(!o[a].pq_hidden&&(n++,r=a,n==e))return r}return r},h._decrRowIndx=function(t,e){for(var i=t,r=this.that.pdata,o=(e=null==e?1:e,0),n=t-1;n>=0;n--){if(!r[n].pq_hidden&&(o++,i=n,o==e))return i}return i},o.addColumn=function(t,e){var i=this.options,r=i.colModel,o=i.dataModel.data;r.push(t),this._calcThisColModel();for(var n=0;n<o.length;n++){o[n].push("")}},o.rowNextSelect=function(){var t,e=this.selection({type:"row",method:"getSelection"}),i=this.rowIndxOffset;return e&&e[0]&&(t=e[0].rowIndx-i,t=this.iKeyNav._incrRowIndx(t)),null!=t&&(this.setSelection(null),this._setSelection({rowIndxPage:t})),t},o.rowPrevSelect=function(){var t,e=this.selection({type:"row",method:"getSelection"}),i=this.rowIndxOffset;return e&&e[0]&&(t=e[0].rowIndx-i,t=this.iKeyNav._decrRowIndx(t)),null!=t&&(this.setSelection(null),this.setSelection({rowIndxPage:t})),t},h._incrIndx=function(t,e){var i=this.that,r=i._getLastVisibleRowIndxPage(i.pdata),o=i.colModel,n=o.length;if(null==e)return t==r?null:(t=this._incrRowIndx(t),{rowIndxPage:t});var a;do{if(++e>=n){if(t==r)return null;t=this._incrRowIndx(t),e=0}a=o[e]}while(a&&a.hidden);return{rowIndxPage:t,colIndx:e}},h._decrIndx=function(t,e){var i=this.that,r=i.colModel,o=r.length,n=i._getFirstVisibleRowIndxPage(i.pdata);if(null==e)return t==n?null:(t=this._decrRowIndx(t),{rowIndxPage:t});var a;do{if(--e<0){if(t==n)return null;t=this._decrRowIndx(t),e=o-1}a=r[e]}while(a&&a.hidden);return{rowIndxPage:t,colIndx:e}},h._incrEditIndx=function(t,e){var i,r=this.that,o=r.colModel,n=o.length,a=r.rowIndxOffset,l=r._getLastVisibleRowIndxPage(r.pdata);do{if(++e>=n){if(t==l)return null;do{var s=(t=this._incrRowIndx(t))+a,d=r.isEditableRow({rowIndx:s});if(t==l&&0==d)return null}while(0==d);e=0}i=o[e];s=t+a;var h=r.isEditableCell({rowIndx:s,colIndx:e,checkVisible:!0})}while(i&&(i.hidden||0==h));return{rowIndxPage:t,colIndx:e}},h._decrEditIndx=function(t,e){var i,r=this.that,o=r.colModel,n=o.length,a=r.rowIndxOffset,l=r._getFirstVisibleRowIndxPage(r.pdata);do{if(--e<0){if(t==l)return null;do{var s=(t=this._decrRowIndx(t))+a,d=r.isEditableRow({rowIndx:s});if(t==l&&0==d)return null}while(0==d);e=n-1}i=o[e];s=t+a;var h=r.isEditableCell({rowIndx:s,colIndx:e,checkVisible:!0})}while(i&&(i.hidden||0==h));return{rowIndxPage:t,colIndx:e}},h._incrEditRowIndx=function(t,e){var i=this.that,r=i.rowIndxOffset,o=i._getLastVisibleRowIndxPage(i.pdata);if(t==o)return null;do{var n=(t=this._incrRowIndx(t))+r,a=i.isEditableRow({rowIndx:n}),l=i.isEditableCell({rowIndx:n,colIndx:e}),s=a&&l;if(t==o&&!s)return null}while(!s);return{rowIndxPage:t,colIndx:e}},h._decrEditRowIndx=function(t,e){var i=this.that,r=i.rowIndxOffset,o=i._getFirstVisibleRowIndxPage(i.pdata);if(t==o)return null;do{var n=(t=this._decrRowIndx(t))+r,a=i.isEditableRow({rowIndx:n}),l=i.isEditableCell({rowIndx:n,colIndx:e}),s=a&&l;if(t==o&&!s)return null}while(!s);return{rowIndxPage:t,colIndx:e}},o._onKeyPressDown=function(e){if(t(e.target).closest(".pq-grid-header").length>0)return 0!=this._trigger("headerKeyDown",e,{dataModel:this.options.dataModel});return!1!==this.iKeyNav._bodyKeyPressDown(e)&&(0!=this._trigger("keyDown",e,{dataModel:this.options.dataModel})&&void 0)},h._saveAndMove=function(t,e){if(null==t)return e.preventDefault(),!1;var i=this.that,r=this.options,o=r.selectionModel,n=(r.editModel,i.colModel,t.rowIndxPage),a=t.colIndx;if(i._blurEditMode=!0,!1===i.saveEditCell({evt:e})||!i.pdata)return i.pdata||i.quitEditMode(e),i._deleteBlurEditMode({timer:!0,msg:"_saveAndMove saveEditCell"}),e.preventDefault(),!1;if(i.quitEditMode(e),t.incr){var l;n=(l=e.shiftKey?this._decrEditIndx(n,a):this._incrEditIndx(n,a))?l.rowIndxPage:n,a=l?l.colIndx:a}return"row"==o.type?(i.setSelection(null),i.setSelection({rowIndxPage:n}),i.scrollColumn({colIndx:a})):"cell"==o.type?(i.setSelection(null),i.setSelection({rowIndxPage:n,colIndx:a})):(i.scrollRow({rowIndxPage:n}),i.scrollColumn({colIndx:a})),!1!==t.edit&&i._editCell({rowIndxPage:n,colIndx:a}),i._deleteBlurEditMode({timer:!0,msg:"_saveAndMove"}),e.preventDefault(),!1},h._keyPressInEdit=function(e,i){var r=this.that,o=r.options.editModel.indices,n=(i=i||{}).FK,a=o.column.dataType;if(e.key&&-1!==t.inArray(e.key,["Backspace","Left","Right","Up","Down","Del","Home","End"]))return!0;if(!1===r._trigger("editorKeyPress",e,t.extend({},o)))return!1;if(n&&("float"==a||"integer"==a)){var l="float"==a?"0123456789.-":"0123456789-",s=(s=e.charCode)||e.keyCode,d=String.fromCharCode(s);if(d&&-1==l.indexOf(d))return!1}return!0},h.getValText=function(e){var i=e[0].nodeName.toLowerCase(),r="text";return-1!=t.inArray(i,["input","textarea","select"])&&(r="val"),r},h._keyUpInEdit=function(e,i){var r=this.that,o=r.options,n=(i=i||{}).FK,a=o.editModel,l=a.indices;r._trigger("editorKeyUp",e,t.extend({},l));var s=l.column.dataType;if(n&&("float"==s||"integer"==s)){var d=t(e.target),h="integer"==s?a.reInt:a.reFloat,c=this.getValText(d),u=d.data("oldVal"),f=d[c]();if(0==h.test(f))if(h.test(u))d[c](u);else{var p="float"==s?parseFloat(u):parseInt(u);isNaN(p)?d[c](0):d[c](p)}}},h._keyDownInEdit=function(e){var i=this.that,r=i.options,o=r.editModel.indices;if(o){var n=t(e.target),a=t.ui.keyCode,l=r.selectionModel,s=r.editModel,d=(p=t.extend({},o)).rowIndxPage,h=p.colIndx,c=p.column.editModel,u=c?t.extend({},s,c):s,f=this.getValText(n);if(n.data("oldVal",n[f]()),0==i._trigger("cellEditKeyDown",e,p))return!1;if(0==i._trigger("editorKeyDown",e,p))return!1;if(e.keyCode==a.TAB){var p={rowIndxPage:d,colIndx:h,incr:!0};return this._saveAndMove(p,e)}if(e.keyCode==u.saveKey){return p="next"==u.onSave?{rowIndxPage:d,colIndx:h,incr:!0}:{rowIndxPage:d,colIndx:h,edit:!1},this._saveAndMove(p,e)}if(e.keyCode==a.ESCAPE){if(i.quitEditMode({evt:e}),"cell"==l.type){i.getCell({rowIndxPage:d,colIndx:h}).attr("tabindex",0).focus()}else if("row"==l.type){var g=i.getRow({rowIndxPage:d});t(g[0]).attr("tabindex",0).focus()}return e.preventDefault(),!1}if(e.keyCode==a.PAGE_UP||e.keyCode==a.PAGE_DOWN)return e.preventDefault(),!1;if(u.keyUpDown){if(e.keyCode==a.DOWN){p=this._incrEditRowIndx(d,h);return this._saveAndMove(p,e)}if(e.keyCode==a.UP){p=this._decrEditRowIndx(d,h);return this._saveAndMove(p,e)}}}},h.select=function(t){var e=this.that,i=t.rowIndx,r=t.colIndx,o=e.options.selectionModel,n=t.evt;n.shiftKey&&"single"!=o.mode?"row"==o.type?(e.scrollRow({rowIndx:i}),e.iRows.extendSelection({rowIndx:i,evt:n})):"cell"==o.type&&(e.scrollCell({rowIndx:i,colIndx:r}),e.iCells.extendSelection({rowIndx:i,colIndx:r,evt:n})):e.setSelection({rowIndx:i,colIndx:r,evt:n,setFirst:!0})},h._bodyKeyPressDown=function(e){var i,r,o=this.that,n=o.rowIndxOffset,a=this.options,l=o.colModel,s=a.selectionModel,d=a.editModel,h=e.ctrlKey||e.metaKey,c=t.ui.keyCode,u=e.keyCode;if(d.indices)o.$div_focus.find(".pq-cell-focus").focus();else{if("row"==s.type){if(null==(r=h?o.iRows.getFocusSelection({old:!0}):o.iRows.getFocusSelection({old:!1})))return;var f=(m=r.rowIndx)-n;if(null==m)return;if(0==o._trigger("rowKeyDown",e,{rowData:o.pdata[f],rowIndx:m,rowIndxPage:f}))return!1}else{if("cell"!=s.type)return;if(null==(i=h?o.iCells.getFocusSelection({old:!0}):o.iCells.getFocusSelection({old:!1})))return;f=(m=(v=i).rowIndx)-n;var p=v.dataIndx,g=o.getColIndx({dataIndx:p});if(null==m||null==g)return;if(0==o._trigger("cellKeyDown",e,{rowData:o.pdata[f],rowIndx:m,rowIndxPage:f,colIndx:g,dataIndx:p,column:l[g]}))return!1;if(e.cancelBubble)return}if(u==c.LEFT){return(v=this._decrIndx(f,g))&&(m=v.rowIndxPage+n,this.select({rowIndx:m,colIndx:v.colIndx,evt:e})),void e.preventDefault()}if(u==c.RIGHT){var v;return(v=this._incrIndx(f,g))&&(m=v.rowIndxPage+n,this.select({rowIndx:m,colIndx:v.colIndx,evt:e})),void e.preventDefault()}if(u==c.UP)return null!=(f=this._decrRowIndx(f))&&(m=f+n,this.select({rowIndx:m,colIndx:g,evt:e})),void e.preventDefault();if(u==c.DOWN)return null!=(f=this._incrRowIndx(f))&&(m=f+n,this.select({rowIndx:m,colIndx:g,evt:e})),void e.preventDefault();if(u==c.PAGE_DOWN||u==c.SPACE){var w=this.pageDown(f);return w&&null!=(f=w.rowIndxPage)&&(m=f+n,this.select({rowIndx:m,colIndx:g,evt:e})),void e.preventDefault()}if(u==c.PAGE_UP){var x=this.pageUp(f);return x&&null!=(f=x.rowIndxPage)&&(m=f+n,this.select({rowIndx:m,colIndx:g,evt:e})),void e.preventDefault()}if(u==c.HOME)return"row"==s.type||h?(m=o._getFirstVisibleRowIndxPage(o.pdata)+n,this.select({rowIndx:m,colIndx:g,evt:e})):"cell"==s.type&&(g=o._getFirstVisibleColIndx(),this.select({rowIndx:m,colIndx:g,evt:e})),void e.preventDefault();if(u==c.END)return"row"==s.type||h?(m=o._getLastVisibleRowIndxPage(o.pdata)+n,this.select({rowIndx:m,colIndx:g,evt:e})):"cell"==s.type&&(g=o._getLastVisibleColIndx(),this.select({rowIndx:m,colIndx:g,evt:e})),void e.preventDefault();if(u!=c.ENTER){if(h&&"65"==u)return"row"==s.type&&"single"!=s.mode?o.iRows.selectAll({all:s.all}):"cell"==s.type&&"single"!=s.mode&&o.iCells.selectAll({all:s.all}),void e.preventDefault();if(d.pressToEdit&&u>=32&&u<=127&&!h&&null!=i){if((I=o.getCell({rowIndxPage:f,colIndx:g}))&&I.length>0){m=f+n,_=o.isEditableRow({rowIndx:m}),b=o.isEditableCell({rowIndx:m,colIndx:g});_&&b&&o.editCell({rowIndxPage:f,colIndx:g,select:!0})}}}else{if("row"==s.type){null!=r&&o.editFirstCellInRow({rowIndx:f+n})}else if(null!=i){var I;if((I=o.getCell({rowIndxPage:f,colIndx:g}))&&I.length>0){var m=f+n,_=o.isEditableRow({rowIndx:m}),b=o.isEditableCell({rowIndx:m,colIndx:g});_&&b&&o.editCell({rowIndxPage:f,colIndx:g})}}e.preventDefault()}}},h.incrPageSize=function(){for(var e=this.that,i=e.$tbl,r=i.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),o=e.$cont[0].offsetHeight,n=parseInt(i.css("marginTop")),a=o-e._getScollBarHorizontalHeight()-n,l=r.length-1;l>=0;l--){var s=r[l];if(s.offsetTop<a)break}return{rowIndxPage:e.getRowIndx({$tr:t(s)}).rowIndxPage}},h.pageNonVirtual=function(e,i){var r=this.that,o=r.$cont[0].offsetHeight-r._getScollBarHorizontalHeight(),n=r.getRow({rowIndxPage:e}),a=0,l=0,s=t(n[0])[i]("tr.pq-grid-row"),d=s.length;if(d>0){do{if((a+=s[l].offsetHeight)>=o)break;l++}while(l<d);l=l>0?l-1:l;do{n=t(s[l]);if(null!=(e=r.getRowIndx({$tr:n}).rowIndxPage))break;l--}while(l>=0)}return e},h.pageDown=function(t){var e=this.that,i=e.options,r=e.$vscroll.pqScrollBar("option"),o=r.cur_pos,n=r.num_eles,a=r.ratio;if(i.virtualY){if(o<n-1){t=this.incrPageSize().rowIndxPage;var l=e._calcCurPosFromRowIndxPage(t);if(null==l)return;e.$vscroll.pqScrollBar("option","cur_pos",l).pqScrollBar("scroll")}}else if(null!=t)t=this.pageNonVirtual(t,"nextAll");else if(a<1){var s=e.$cont.data("offsetHeight")-e._getScollBarHorizontalHeight();e.iMouseSelection.updateTableY(-1*s),e._syncScrollBarVert()}return{rowIndxPage:t,curPos:l}},h.pageUp=function(t){var e=this.that,i=e.options,r=e.$vscroll.pqScrollBar("option"),o=r.cur_pos,n=r.ratio;if(i.virtualY){if(o>0){t=this.decrPageSize().rowIndxPage;var a=e._calcCurPosFromRowIndxPage(t);if(null==a)return;e.$vscroll.pqScrollBar("option","cur_pos",a).pqScrollBar("scroll")}}else if(null!=t)t=this.pageNonVirtual(t,"prevAll");else if(n>0){var l=e.$cont[0].offsetHeight-e._getScollBarHorizontalHeight();e.iMouseSelection.updateTableY(l),e._syncScrollBarVert()}return{rowIndxPage:t,curPos:a}},h.decrPageSize=function(){var e=this.that,i=e.$tbl.children("tbody").children("tr.pq-grid-row").not(".pq-group-row,.pq-summary-row"),r=e.options.freezeRows,o=0;if(i.length){var n;if(r?(n=i.filter("tr.pq-last-freeze-row")).length&&(n=n.next()):i.length>=2&&(n=t(i[1])),n&&n.length){(o=(o=e.getRowIndx({$tr:n}).rowIndxPage)-e.pageSize+4)<0&&(o=0)}}return{rowIndxPage:o}},o._calcNumHiddenFrozens=function(){for(var t=0,e=this.options.freezeCols,i=0;i<e;i++)this.colModel[i].hidden&&t++;return t},o._calcNumHiddenUnFrozens=function(t){for(var e=0,i=this.options.freezeCols,r=null!=t?t:this.colModel.length,o=i;o<r;o++)this.colModel[o].hidden&&e++;return e},o._setScrollHLength=function(){if(!this.options.scrollModel.horizontal)return this.$hscroll.css("visibility","hidden"),void this.$hvscroll.css("visibility","hidden");this.$hscroll.css("visibility",""),this.$hvscroll.css("visibility","");var t=this.$cont[0].offsetWidth,e=(this.colModel,this._getSBWidth());0==e?this.$hscroll.css("right",0):this.$hscroll.css("right",""),t-=e,this.$hscroll.pqScrollBar("option","length",t)},o._setScrollHNumEles=function(){var t=this.options,e=t.scrollModel,i=0;"flex"!=t.width&&(i="fullScroll"==e.lastColumn?this.colModel.length-t.freezeCols-this._calcNumHiddenUnFrozens():this.calcColsOutsideCont(this.colModel)+1),this.$hscroll.pqScrollBar("option","num_eles",i)},o.calcColsOutsideCont=function(t){var e=this.options.numberCell,i=this.$tbl?this.$tbl[this.$tbl.length-1]:null,r=i?i.scrollWidth:0,o=this.options.freezeCols,n=this.$cont[0].offsetWidth-this._getSBWidth();r=0,e.show&&(r+=e.outerWidth);for(var a=0;a<t.length;a++){var l=t[a];l.hidden||(r+=l.outerWidth)}var s=0,d=0,h=r;for(h>n&&d++,a=o;a<t.length;a++)if(!(l=t[a]).hidden){if(s+=l.outerWidth,!((h=r-s)>n))break;d++}return d},o._getScollBarHorizontalHeight=function(){var t=17,e=this.$hscroll;return"hidden"!=e.css("visibility")&&0!=this.options.scrollModel.horizontal&&"none"!=e.css("display")||(t=0),t},o._getSBWidth=function(){var t=17,e=this.$vscroll;return null!=this.initV&&"hidden"!=e.css("visibility")&&"flex"!=this.options.height&&"none"!=e.css("display")||(t=0),t},o._setScrollVNumEles=function(e){var i,r,o=this.$vscroll,n=!!this.iHierarchy,a=o.pqScrollBar("option"),l=parseInt(a.num_eles),s=parseInt(a.cur_pos),d=this.options,h=this._getScollBarHorizontalHeight(),c=this.$cont[0].offsetHeight-h+1,u=(d.groupModel?this.dataGM:this.pdata)?this.totalVisibleRows:0,f=0;if(this.$tbl&&this.$tbl.length>0&&(f=(i=this.$tbl[this.$tbl.length-1]).offsetHeight,r=t(i)),f>0&&f>c){for(var p=r.children().children("tr"),g=0,v=0,w=0;w<p.length;w++){var x=p[w];if((g+=x.offsetHeight)>=c){v=n&&t(x).hasClass("pq-detail-child")?--v>1?v-1:1:v>1?v-1:0;break}n?0==t(x).hasClass("pq-detail-child")&&v++:v++}0==v&&(v=p.length-1),l=u-v+1}else l=s+1;return l>u&&(l=u),e?this.$vscroll.pqScrollBar("option","num_eles",l):this.$vscroll.pqScrollBar("setNumEles",l),l},o._getFirstVisibleRowIndxPage=function(t){for(var e=0,i=t.length;e<i;e++){if(!t[e].pq_hidden)return e}},o._getLastVisibleRowIndxPage=function(t){for(var e=t.length-1;e>=0;e--){if(!t[e].pq_hidden)return e}return null},o._getFirstVisibleColIndx=function(){for(var t=this.colModel,e=t.length,i=0;i<e;i++){if(!t[i].hidden)return i}return null},o._getLastVisibleColIndx=function(){for(var t=this.colModel,e=t.length-1;e>=0;e--){if(!t[e].hidden)return e}return null},o.getTotalVisibleColumns=function(){for(var t=this.colModel,e=t.length,i=0,r=0;r<e;r++){t[r].hidden||i++}return i},o._getTotalVisibleRows=function(t,e,i,r){var o=0,n=r?r.length:0,a=e,l=0,s=0,d=null,h=!1,c=!1,u=!!this.iHierarchy,f=this.options.detailModel.offset,p=0,g=u?this.$cont[0].offsetHeight:void 0;if(null==r||0==n)return{initV:d,finalV:d,tvRows:o,lastFrozenRow:d};for(var v=0,w=n>e?e:n;v<w;v++){if(!(I=(x=r[v]).pq_hidden)&&(d=v,o++,u)){if((m=x.pq_detail)&&m.show){(_=m.height||0)>f&&(_=f),p+=_+22}else p+=22}}if(n<e)return{initV:d,finalV:d,tvRows:o,lastFrozenRow:d};i-=o;for(v=e,w=n;v<w;v++){var x,I=(x=r[v]).pq_hidden;if(h?c||(I?l++:s==i?c=!0:(l++,s++)):I?a++:s==t?(h=!0,l=a,s=0):(a++,s++),!I&&(o++,u&&h)){var m;if((m=x.pq_detail)&&m.show){var _;(_=m.height||0)>f&&(_=f),p+=_+22}else p+=22;p>g&&(c=!0)}}return a>=n&&(a=n-1),l<a&&(l=a),{initV:a,finalV:l,tvRows:o,lastFrozenRow:d}},o._setScrollVLength=function(){var t=this.$cont.height(),e=this._getScollBarHorizontalHeight();this.$vscroll.css("bottom",e);var i=t-e;this.$vscroll.pqScrollBar("option","length",i)},o._setInnerGridHeight=function(){var t=this.options;if("flex"!=t.height){var e=this.element.height()-(t.showTop?this.$top[0].offsetHeight:0)-this.$bottom[0].offsetHeight;this.$grid_inner.height(e+"px")}},o._setRightGridHeight=function(){var t=this.options,e=this.$header,i=0;if(e?(i=e[0].offsetHeight,this.$header_o.height(i-2)):this.$header_o.height(0),"flex"!=t.height){this.$vscroll.css("visibility",""),this.$tbl&&this.$tbl.css("marginBottom",0);var r=this.element.height()-this.$header_o[0].offsetHeight-(t.showTop?this.$top[0].offsetHeight:0)-this.$bottom[0].offsetHeight;this.$cont.height(r-0+"px")}},o._setGridHeightFromTable=function(){var t=this._getScollBarHorizontalHeight(),e=this.$tbl;e&&e.length&&(e[0].offsetHeight-1,e.css("marginBottom",t));this.$cont.height(""),this.element.height(""),this.$grid_inner.height(""),this.$vscroll.css("visibility","hidden")},o._setGridWidthFromTable=function(){var t,e=this._getSBWidth();this.$tbl&&this.$tbl[0]&&this.$tbl[0].scrollWidth>0?(t=this.$tbl[0].scrollWidth,this.element.width(t+e+"px")):(t=c.call(this,-1,this.colModel.length),this.element.width(t+"px"))},o._bufferObj_minRowsPerGrid=function(){var t=this.$cont[0].offsetHeight;return Math.ceil(t/this.rowHeight)},o._calcCurPosFromRowIndxPage=function(t){var e=this.options,i=e.groupModel,r=i?this.dataGM:this.pdata,o=e.freezeRows;if(t<o)return 0;for(var n=0,a=o,l=o,s=r.length;l<s;l++){var d=r[l];if(i&&(d.groupSummary||d.groupTitle));else{if(a==t)break;a++}d.pq_hidden||n++}return n>=s?null:n},o._calcCurPosFromColIndx=function(t){var e=this.options,i=(this.pdata,this.colModel),r=e.freezeCols;if(t<r)return 0;for(var o=0,n=r,a=r,l=i.length;a<l;a++){var s=i[a];if(n==t)break;n++;s.hidden||o++}return o>=l?null:o},o._bufferObj_calcInitFinal=function(){var t=this.options,e=t.virtualY,i=t.freezeRows,r="flex"==t.height,o=!!t.groupModel?this.dataGM:this.pdata;t.treeModel;if(null==o||0==o.length){var n=this._getTotalVisibleRows(l,i,s,o);this.totalVisibleRows=n.tvRows,this.initV=n.initV,this.finalV=n.finalV,this.lastFrozenRow=n.lastFrozenRow}else{if(!e){n=this._getTotalVisibleRows(0,i,s,o);return this.lastFrozenRow=n.lastFrozenRow,this.totalVisibleRows=n.tvRows,this.initV=0,void(this.finalV=o.length-1)}var a=this.$vscroll.pqScrollBar("option"),l=parseInt(a.cur_pos);if(isNaN(l)||l<0)throw"cur_pos NA";this.scrollCurPos=l;var s=this._bufferObj_minRowsPerGrid();this.pageSize=s;n=this._getTotalVisibleRows(l,i,s,o);this.totalVisibleRows=n.tvRows,this.initV=n.initV,this.lastFrozenRow=n.lastFrozenRow,this.finalV=r?o.length-1:n.finalV}},o._bufferObj_calcInitFinalH=function(){var t=this.options,e=t.virtualX,i=this.colModel,r=i.length;if(!e)return this.initH=0,void(this.finalH=r-1);!1===t.virtualXHeader&&(this.initHH=0,this.finalHH=r-1);for(var o=parseInt(this.$hscroll.pqScrollBar("option","cur_pos")),n=parseInt(t.freezeCols),a="flex"==t.width,l=n,s=0,d=n;d<r;d++)if(i[d].hidden)l++;else{if(s==o)break;l++,s++}if(l>r-1&&(l=r-1),this.initH=l,a||!e)this.finalH=r-1;else{var h=c.call(this,-1,n),u=this.$cont[0].offsetWidth-this._getSBWidth();for(d=l;d<r;d++){var f=i[d];if(!f.hidden){var p=f.outerWidth;if(!p&&t.debug)throw"outerwidth N/A";if((h+=p)>u)break}}var g=d;g>r-1&&(g=r-1),this.finalH=g}};var c=function(t,e,i){var r=0,o=this.options,n=o.columnBorders?1:0,a=o.numberCell,l=this.colModel;if(-1==t&&(a.show&&(r+=i?parseInt(a.width)+1:a.outerWidth),t=0),i)for(var s=t;s<e;s++){if(!(d=l[s]).hidden){if(!d._width)throw"assert failed";r+=d._width+n}}else for(s=t;s<e;s++){var d;(d=l[s]).hidden||(r+=d.outerWidth)}return r};t.paramquery.pqgrid.calcWidthCols=c,o.calcHeightFrozenRows=function(){var e=this.$tbl,i=0;if(e&&e.length){var r=t(e[0]).find("tr.pq-last-freeze-row");if(r&&r.length){var o=r[0];i=o.offsetTop+o.offsetHeight}else i=0}return i},o._calcRightEdgeCol=function(t){var e=0,i=0,r=this.colModel,o=this.hidearrHS,n=this.options.numberCell;n.show&&(e+=n.outerWidth,i++);for(var a=0;a<=t;a++){var l=r[a];l.hidden||0!=o[a]||(e+=l.outerWidth,i++)}return{width:e,cols:i}},o._refreshFreezeLine=function(){var e=this.options,i=e.numberCell,r=this.$cont_o,o=e.freezeCols;if(this.$freezeLine&&this.$freezeLine.remove(),o){var n=c.call(this,-1,o)-1;if(isNaN(n)||0==n);else if(n>0&&i.show&&n==i.width);else{this.$freezeLine=t("<div class='pq-grid-vert-freezeline' ></div>").appendTo(r);var a=r[0].offsetHeight;this.$freezeLine.css({height:a,left:n})}}},o._getDragHelper=function(e){var i=this.options,r=parseInt(i.freezeCols),o=t(e.currentTarget);this.$cl=t("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner),this.$clleft=t("<div class='pq-grid-drag-bar'></div>").appendTo(this.$grid_inner);var n=parseInt(o.attr("pq-grid-col-indx")),a=this.$grid_inner.outerHeight();this.$cl.height(a),this.$clleft.height(a);var l=t("td[pq-grid-col-indx="+n+"]",this.$header)[0],s=l.offsetLeft;this.pqpanes.vH?n>=r&&(s+=this.$header[1].offsetLeft):s+=this.$header[0].offsetLeft,this.$clleft.css({left:s}),s+=l.offsetWidth,this.$cl.css({left:s})},o._setDragLimits=function(t){if(!(t<0)){var e=this.colModel[t],i=this.options,r=(i.numberCell,this.$header_left);t>=i.freezeCols&&this.pqpanes.vH&&(r=this.$header_right);var o=r.find("td[pq-grid-col-indx='"+t+"']").offset().left+e._minWidth,n=o+e._maxWidth-e._minWidth;r.find("div.pq-grid-col-resize-handle[pq-grid-col-indx="+t+"]").draggable("option","containment",[o,0,n,0])}},o.nestedCols=function(t,e,i){var r=t.length,o=[];null==e&&(e=1);for(var n=e,a=0,l=0,s=0;s<r;s++){var d=t[s];if(!0!==i&&!1!==i||(d.hidden=i),null!=d.colModel&&d.colModel.length>0){var h=this.nestedCols(d.colModel,e+1,d.hidden);o=o.concat(h.colModel),h.colSpan>0?(h.depth>n&&(n=h.depth),d.colSpan=h.colSpan,a+=h.colSpan):(d.colSpan=0,d.hidden=!0),d.childCount=h.childCount,l+=h.childCount}else d.hidden?d.colSpan=0:(d.colSpan=1,a++),d.childCount=0,l++,o.push(d)}return{depth:n,colModel:o,colSpan:a,width:0,childCount:l}},o.getHeadersCells=function(){for(var t=this.options.colModel,e=this.colModel.length,i=this.depth,r=[],o=0;o<i;o++){r[o]=[];for(var n=0,a=0,l=0;l<e;l++){var s;if(0==o)s=t[n];else{var d=r[o-1][l],h=d.colModel;if(null==h||0==h.length)s=d;else{for(var c=l-d.leftPos,u=0,f=0,p=0;p<h.length;p++)if(u+=h[p].childCount>0?h[p].childCount:1,c<u){f=p;break}s=h[f]}}var g=s.childCount?s.childCount:1;l==a?(s.leftPos=l,r[o][l]=s,a+=g,t[n+1]&&n++):r[o][l]=r[o][l-1]}}return this.headerCells=r,r},o.getDataType=function(){var t=this.colModel;if(t&&t[0]){return"string"==typeof t[0].dataIndx?"JSON":"ARRAY"}throw"dataType unknown"},o.assignRowSpan=function(){this.options.colModel;for(var t=this.colModel.length,e=this.headerCells,i=this.depth,r=0;r<t;r++)for(var o=0;o<i;o++){var n=e[o][r];if(!(r>0&&n==e[o][r-1])&&!(o>0&&n==e[o-1][r])){for(var a=1,l=o+1;l<i;l++){n==e[l][r]&&a++}n.rowSpan=a}}return e},o._calcThisColModel=function(){var e=this.options,i=e.columnTemplate,r=e.colModel,o=this.nestedCols(r);this.colModel=o.colModel,this.depth=o.depth;var n=this.colModel,a=n.length;if(i)for(var l=0;l<a;l++){var s=n[l],d=t.extend({},i,s,!0);t.extend(s,d,!0)}this.getHeadersCells(),this.assignRowSpan(),this._refreshDataIndices()};var u=function(t){this.that=t},f=u.prototype;f._computeOuterWidths=function(){for(var t=this.that,e=t.options,i=e.columnBorders?1:0,r=e.numberCell,o=t.colModel,n=(t.outerWidths,o.length),a=0;a<n;a++){var l=o[a];l.outerWidth=l._width+i}r.show&&(r.outerWidth=r.width+1)},f.autoFit=function(){var t=this.that,e=(t.options.columnBorders,t.colModel),i=t.$cont,r=e.length,o=c.call(t,-1,r,!0),n=i[0].offsetWidth-t._getSBWidth();if(o!=n){for(var a,l=o-n,s=[],d=0;d<r;d++){var h=(p=e[d])._percent,u=(p.resizable,p._resized);if(!p.hidden&&!h&&!u){l<0?(v=p._maxWidth-p._width)&&s.push({availWd:-1*v,colIndx:d}):(v=p._width-p._minWidth)&&s.push({availWd:v,colIndx:d})}u&&(a=p,delete p._resized)}s.sort(function(t,e){return t.availWd>e.availWd?1:t.availWd<e.availWd?-1:0});d=0;for(var f=s.length;d<f;d++){var p,g=s[d],v=g.availWd,w=g.colIndx,x=Math.round(l/(f-d)),I=(p=e[w])._width;Math.abs(v)>Math.abs(x)?(m=I-x,l-=x):(m=I-v,l-=v),p.width=p._width=m}if(0!=l&&a){var m;(m=a._width-l)>a._maxWidth?m=a._maxWidth:m<a._minWidth&&(m=a._minWidth),a.width=a._width=m}}},f.autoLastColumn=function(){var t=this.that,e=t.options,i=e.columnBorders?1:0,r=t.colModel,o=r.length,n=e.freezeCols,a=t.$cont[0].offsetWidth-t._getSBWidth()-c.call(t,-1,n,!0),l=!1,s=t._getLastVisibleColIndx();if(null!=s){var d=r[s];if(!d._percent){for(var h,u=d._width,f=d._minWidth,p=d._maxWidth,g=o-1;g>=n;g--){var v=r[g];if(!v.hidden){var w=v._width+i;if((a-=w)<0){l=!0,h=u+a>=f?u+a:u+w+a;break}}}l||(h=u+a),h>p?h=p:h<f&&(h=f),d.width=d._width=h}}},f.numericVal=function(t,e){return(t+"").indexOf("%")>-1?parseInt(t)*e/100:parseInt(t)},f.refreshColumnWidths=function(){var t=this.that,e=t.options,i=e.numberCell,r="flex"==e.width,o=e.columnBorders?1:0,n=t.colModel,a=e.scrollModel,l=a.lastColumn,s=a.autoFit,d=t.$cont,h=n.length,c=t._getSBWidth(),u=e._minColWidth,f=e._maxColWidth;if(d&&d[0].offsetWidth){var p=d[0].offsetWidth,g=0;i.show&&(i.width<i.minWidth&&(i.width=i.minWidth),i.outerWidth=i.width+1,g=i.outerWidth);var v=p-c-g,w=(u=Math.floor(this.numericVal(u,v)),f=Math.ceil(this.numericVal(f,v)),0);if(v<5||isNaN(v)){if(e.debug)throw"availWidth N/A"}else{delete t.percentColumn;for(var x=0;x<h;x++){var I=n[x];if(!I.hidden){var m=I.width,_=(m+"").indexOf("%")>-1||null,b=I.minWidth,y=I.maxWidth;b=b?this.numericVal(b,v):u;if((y=y?this.numericVal(y,v):f)<b&&(y=b),void 0!=m){var q,C=0;!r&&_?(t.percentColumn=!0,I.resizable=!1,I._percent=!0,(w+=(q=this.numericVal(m,v)-o)-(C=Math.floor(q)))>=1&&(C+=1,w-=1)):m&&(C=parseInt(m)),C<b?C=b:C>y&&(C=y),I._width=C}else I._width=b;_||(I.width=I._width),I._minWidth=b,I._maxWidth=y}}d&&0==r&&(s&&this.autoFit(),"auto"==l&&this.autoLastColumn()),this._computeOuterWidths()}}},o._createHeader=function(){var e=this,i=this.options,r=i.hwrap,o=parseInt(i.freezeCols),n=i.numberCell,a=this.colModel,l=this.depth,s=i.virtualX,d=i.virtualXHeader,h=!1===d?e.initHH:e.initH,u=!1===d?e.finalHH:e.finalH,f=this.headerCells,p=(this.hidearrHS,this.$header),g=this.$header_o;if(null==u)throw"finalH required for _createHeader";if(!1===i.showHeader)return p&&p.empty(),void g.css("display","none");g.css("display","");var v="pq-grid-header-table ",w=["<table class='"+(v+=r?"pq-wrap ":"pq-no-wrap ")+"' cellpadding=0 cellspacing=0 >"];if(l>=1){w.push("<tr>"),n.show&&w.push("<td style='width:"+(n.width+1)+"px;' ></td>");for(var x=0;x<=u;x++){if(x<h&&x>=o&&s&&(x=h)>u)throw"initH>finalH";var I=a[x];if(!I.hidden){var m=I.outerWidth;w.push("<td style='width:"+m+"px;' pq-col-indx="+x+"></td>")}}w.push("</tr>")}for(var _=0;_<l;_++){w.push("<tr class='pq-grid-title-row'>"),0==_&&n.show&&w.push(["<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='",l,"'>","<div class='pq-td-div'>",n.title?n.title:"&nbsp;","</div></td>"].join(""));for(x=0;x<=u;x++){if(x<h&&x>=o&&s&&(x=h)>u)throw"initH>finalH";this._createHeaderCell(_,x,f,w,"pq-grid-col ",o,h,l)}w.push("</tr>")}this.ovCreateHeader(w,"pq-grid-col "),w.push("</table>");var b=w.join("");g.empty(),this.pqpanes.vH?g.append(["<span class='pq-grid-header pq-grid-header-left ui-state-default'>",b,"</span>","<span class='pq-grid-header ui-state-default'>",b,"</span>"].join("")):g.append(["<span class='pq-grid-header ui-state-default'>",b,"</span>"].join(""));p=this.$header=t(".pq-grid-header",g);this.$tbl_header=p.children("table");m=c.call(this,-1,o);var y=this.$header_left=t(p[0]);if(this.pqpanes.vH){y=this.$header_left=t(p[0]);var q=this.$header_right=t(p[1]);y.css({width:m,zIndex:10});var C=c.call(this,o,h);q.css({left:-1*C+"px"})}p.click(function(t){return e._onHeaderClick(t)}),this._refreshResizeColumn(h,u,a),this._trigger("refreshHeader",null,null)},o._onHeaderClick=function(e){if(!this.iDragColumns||"stop"==this.iDragColumns.status){var i=t(e.target),r=i.closest(".pq-g-ficon");if(r.length){var o=r.attr("pq-col-indx");return e.stopImmediatePropagation(),this.iHeaderIconSearch.createDOM(o,r,e)}var n=i.closest("td.pq-grid-col");if(n.length){e.stopImmediatePropagation();if(null!=(o=n.attr("pq-grid-col-indx")))return this._onHeaderCellClick(o,e)}}},o._createHeaderCell=function(t,e,i,r,o,n,a,l){var s=i[t][e],d=s.colSpan,h=s.halign,c=s.align,u=(u=s.title)||"";if(!(t>0&&s==i[t-1][e]||e>0&&s==i[t][e-1]||s.hidden)){var f=o;null!=h?f+=" pq-align-"+h:null!=c&&(f+=" pq-align-"+c),e==n-1&&1==l&&(f+=" pq-last-freeze-col"),e<=n-1?f+=" pq-left-col":e>=a&&(f+=" pq-right-col");var p=s.cls;p&&(f=f+" "+p);var g="";null!=s.colModel&&0!=s.colModel.length||(g="pq-grid-col-indx='"+e+"'");var v="pq-row-indx="+t,w="pq-col-indx="+e;r.push(["<td ",g," ",w," ",v," ",""," class='",f,"' rowspan=",s.rowSpan," colspan=",d,">","<div class='pq-td-div'>",u,"<span class='pq-col-sort-icon'>&nbsp;</span></div></td>"].join(""))}},o._refreshHeader=function(){for(var e=this.colModel,i=this.initH,r=this.finalH,o=t("table.pq-grid-header-table tr:first"),n=i;n<=r;n++){var a=o.find("td[pq-col-indx="+n+"]"),l=e[n];a.width(l.outerWidth)}},o.ovCreateHeader=function(){},o._refreshResizeColumn=function(e,i,r){var o=this,n=this.options,a=(n.virtualX,!!n.filterModel.ficon),l=n.numberCell,s=o.$header.height(),d=parseInt(n.freezeCols),h=[],c=[];if(l.show&&l.resizable){var u=o.$header_left.find("td.pq-grid-number-col")[0];v=parseInt(u.offsetLeft)+(u.offsetWidth-10),h.push("<div pq-grid-col-indx='-1' style='left:",v,"px;height:",s,"px;' class='pq-grid-col-resize-handle'>&nbsp;</div>")}for(var f=0;f<=i;f++){if(f<e&&f>=d&&(f=e)>i)throw"initH>finalH";var p=r[f];if(!p.hidden){var g,v,w=p.ficon,x=w||null==w&&a,I=h;(!1!==p.resizable||x)&&(g=o.$header_left,this.pqpanes.vH&&f>=d&&(g=o.$header_right,I=c),u=g.find("td[pq-grid-col-indx="+f+"]")[0],v=parseInt(u.offsetLeft)+(u.offsetWidth-5)),!1!==p.resizable&&I.push("<div pq-grid-col-indx='",f,"' style='left:",v,"px;height:",s,"px;' class='pq-grid-col-resize-handle'>&nbsp;</div>")}}o.$header_left.append(h.join("")),c.length&&o.$header_right.append(c.join(""));var m,_;o.$header.find(".pq-grid-col-resize-handle").draggable({axis:"x",helper:function(e,i){var r=t(e.target),n=parseInt(r.attr("pq-grid-col-indx"));return o._setDragLimits(n),o._getDragHelper(e,i),r},start:function(t,e){m=e.position.left,_=parseInt(o.$cl[0].style.left)},drag:function(t,e){var i=e.position.left-m;o.$cl[0].style.left=_+i+"px"},stop:function(t,e){return o._refreshResizeColumnStop(t,e,r,m)}})},o._refreshResizeColumnStop=function(e,i,r,o){var n=this.options.numberCell;this.$clleft.remove(),this.$cl.remove();var a,l=i.position.left-o,s=t(i.helper),d=parseInt(s.attr("pq-grid-col-indx"));if(-1==d){a=null;var h=(c=parseInt(n.width))+l;n.width=h}else{a=r[d];var c;h=(c=parseInt(a.width))+l;a.width=h,a._resized=!0}this.refresh(),this._trigger("columnResize",e,{colIndx:d,column:a,dataIndx:a?a.dataIndx:null,oldWidth:c,newWidth:a?a.width:n.width})},o._refreshHeaderSortIcons=function(){var t=this.options.dataModel;if(void 0!=t.sortIndx){var e=this.$header;e.find(".pq-grid-col").removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active"),e.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");var i=t.sortIndx,r=this.getColIndx({dataIndx:i}),o="ui-state-active pq-col-sort-"+("up"==t.sortDir?"asc":"desc"),n="ui-icon ui-icon-triangle-1-"+("up"==t.sortDir?"n":"s");e.find(".pq-grid-col[pq-grid-col-indx="+r+"]").addClass(o),e.find(".pq-grid-col[pq-grid-col-indx="+r+"] .pq-col-sort-icon").addClass(n)}},o.createTable=function(t){this.iGenerateView.generateView(t)},t.widget("paramquery._pqGrid",t.ui.mouse,o)}(jQuery),function(t){function e(e){var i=this;this.that=e,this.type="detail",this.refreshComplete=!0,this.detachView=!1;var r=e.widgetEventPrefix.toLowerCase(),o=e.eventNamespace;e.element.on(r+"cellclick"+o,function(t,e){if(i.belongs(t))return i.cellClick(t,e)}),e.element.on(r+"cellkeydown"+o,function(e,r){if(i.belongs(e)&&e.keyCode==t.ui.keyCode.ENTER)return i.cellClick(e,r)}),e.element.on(r+"aftertable"+o,function(t,e){if(i.belongs(t))return i.aftertable(t,e)}),e.element.on(r+"beforetableview"+o,function(t,e){if(i.belongs(t))return i.beforeTableView(t,e)}),e.element.on(r+"beforerefreshdata"+o,function(t,e){if(i.belongs(t))return i.beforeRefreshData(t,e)})}var i=t.paramquery.cClass,r=(t.paramquery.pqgrid.calcWidthCols,{});r.getFocusElement=function(){var e=document.activeElement;if(e){var i=t(e),r=i.closest(".pq-grid");if(r.length)return r[0]==this.element[0]?{$ae:i,$grid:r}:{$ae:i,$childGrid:r}}},r.inViewPort=function(e){var i=this.$cont[0],r=i.offsetHeight-this._getScollBarHorizontalHeight(),o=i.offsetWidth-this._getSBWidth()+1,n=e[0],a=t(n.offsetParent),l=parseInt(a.css("marginTop")),s=parseInt(a.css("marginLeft"));if(r>=n.offsetTop+n.offsetHeight+l){if("TD"!=n.nodeName.toUpperCase())return!0;if(o>=n.offsetLeft+n.offsetWidth+s)return!0}};var o=e.prototype=new i;o.aftertable=function(e,i){var r=this.that,o=r.options.detailModel.init,n=r.pdata;if(this.refreshComplete){this.refreshComplete=!1;for(var a=r.$tbl.children("tbody").children("tr.pq-detail-child"),l=0;l<a.length;l++){var s=a[l],d=t(s),h=n[d.attr("pq-row-indx")],c=h.pq_detail.child;c||"function"==typeof o&&(c=o.call(r.element[0],{rowData:h}),h.pq_detail.child=c);var u=c.find(".pq-header-outer");if(d.children("td.pq-detail-child").append(c),0==u.height())try{c.pqGrid("refresh")}catch(t){}}this.refreshComplete=!0,this.detachView=!1}},o.beforeTableView=function(t,e){this.detachView||this.detachInitView(t,e)},o.beforeRefreshData=function(t,e){this.detachView||this.detachInitView(t,e)},o.detachInitView=function(e,i){var r=this.that,o=r.pdata;if(o&&o.length){for(var n,a,l,s=r.$tbl.children("tbody").children("tr.pq-grid-row"),d=0;d<s.length;d++){var h=s[d],c=t(h),u=c.attr("pq-row-indx"),f=o[u];if(null!=u&&u!=n&&(n=u,f.pq_detail)){if(a=null,l=0,f.pq_detail.child){var p=c.next();if(p.hasClass("pq-detail-child")){var g=p.children("td.pq-detail-child").children();g.length&&(l=g[0].offsetHeight,a=g.detach())}}a&&a.length&&(f.pq_detail.child=a,f.pq_detail.height=l)}}this.detachView=!0}},o.cellClick=function(t,e){var i=this.that,r=e.column,o=e.rowData,n=e.rowIndx,a=this.type;if(r&&r.type===a){null==o.pq_detail?i.rowExpand({rowIndx:n,scrollRow:!0}):!1===o.pq_detail.show?i.rowExpand({rowIndx:n,scrollRow:!0}):i.rowCollapse({rowIndx:n,scrollRow:!0})}},r.rowExpand=function(t){var e=this.getRowData(t),i=this.options.detailModel,r="pq_detail";if(null!=e){if(null==e[r]?e[r]={show:!0}:!1===e[r].show&&(e[r].show=!0),!i.cache){var o=e[r].child;o&&(o.remove(),e[r].child=null,e[r].height=0)}if(this.refresh(),t.scrollRow){var n=t.rowIndx;this.scrollRow({rowIndx:n})}}},r.rowInvalidate=function(t){var e=this.getRowData(t);e.pq_detail.child.remove(),e.pq_detail.child=null},r.rowCollapse=function(t){var e=this.getRowData(t),i=this.options.detailModel,r="pq_detail";if(null!=e&&null!=e[r]&&!0===e[r].show){if(!i.cache){var o=e[r].child;o&&(o.remove(),e[r].child=null,e[r].height=0)}if(e[r].show=!1,this.refresh(),t.scrollRow){var n=t.rowIndx;this.scrollRow({rowIndx:n})}}};var n=function(e){function i(t,i,r){e.filter({data:[{dataIndx:t,value:i,value2:r}]})}this.that=e;var r=this;this.dataHS={};var o=e.widgetEventPrefix.toLowerCase(),n=e.eventNamespace;e.element.on(o+"headerkeydown"+n,function(e,i){if(r.belongs(e)){var o=t(e.originalEvent.target);return!o.hasClass("pq-search-hd-field")||r.onKeyDown(e,i,o)}}),e.element.on(o+"createheader"+n,function(t,e){if(r.belongs(t))return r._onCreateHeader()}),this.changeListener={change:function(t,e){i(e.dataIndx,e.value,e.value2)}},this.keyupListener={keyup:function(t,e){i(e.dataIndx,e.value,e.value2)}},this.clickListener={click:function(t,e){i(e.dataIndx,e.value)}}},a=n.prototype=new i;a.get$Ele=function(e,i){var r=this.that,o=r.options.freezeCols,n=t(r.$tbl_header[0]),a=".pq-search-hd-field[name='"+i+"']",l=t(r.$tbl_header[2==r.$tbl_header.length?1:0]);return e>=o?l.find(a):n.find(a)},a.onKeyDown=function(e,i,r){var o=this.that;if(e.keyCode!==t.ui.keyCode.TAB)return!0;var n=r.attr("name"),a=o.getColIndx({dataIndx:n}),l=o.colModel,s=e.shiftKey;if("between"==(h=l[a]).filter.condition){o.scrollColumn({colIndx:a});var d=this.get$Ele(a,n);if(d[0]==r[0]?s||(u=d[1]):s&&(u=d[0]),u)return u.focus(),e.preventDefault(),!1}for(;;){if(s?a--:a++,a<0||a>=l.length)break;var h,c=(h=l[a]).filter;if(!h.hidden&&c){o.scrollColumn({colIndx:a});n=h.dataIndx;var u=this.get$Ele(a,n);if("between"==c.condition&&(u=t(s?u[1]:u[0])),u)return u.focus(),e.preventDefault(),!1;break}}},a._bindFocus=function(){function e(e){i._fixTableViewPort();var o=t(e.target).attr("name");if(i.scrollColumn({dataIndx:o})){var n=i.getColIndx({dataIndx:o});r.get$Ele(n,o).focus()}}for(var i=this.that,r=this,o=i.$header.find(".pq-grid-header-search"),n=0;n<o.length;n++)t(o[n]).on("focusin",e)},a._onCreateHeader=function(){var e=this.that,i=e.options,r=i.columnBorders;if(i.filterModel.header){this._bindFocus();var o=e.colModel,n=e.initH,a=e.finalH,l=i.freezeCols,s=i.virtualX,d=e.$tbl_header,h=t(d[0]),c=t(d[1]),u="input,select";if(d.length>1){h.find(u).css("visibility","hidden");for(var f=0;f<l;f++){u="*[name='"+(p=o[f]).dataIndx+"']";h.find(u).css("visibility","visible"),c.find(u).css("visibility","hidden")}}for(f=0;f<=a;f++){if(f<n&&f>=l&&s&&(f=n)>a)throw"initH>finalH";var p;if(!(p=o[f]).hidden){var g=p.filter;if(g){var v=p.dataIndx,w=h;f>=l&&d.length>1&&(w=c);var x=w.find("*[name='"+v+"']");if(0!=x.length){var I=g.type,m=g.value,_=g.value2;if("checkbox"==I&&"triple"==g.subtype)x.pqval({val:m});else if("select"==I){x.val(m);var b=this.getWidth(p,r);x.css({width:b})}var y=g.init;y&&y.call(x,{dataIndx:v,column:p});var q=g.listeners;if(q)for(var C=0;C<q.length;C++){var D=q[C];"string"==typeof D&&(D=this[D+"Listener"]);for(var M in D){!function(i,r,o){i.bind(M,function(n){var a=e.getColumn({dataIndx:o}),l=a.filter;return"checkbox"==l.type?m="triple"==l.subtype?i.pqval({incr:!0}):!!i.is(":checked"):"between"==l.condition?(m=t(i[0]).val(),_=t(i[1]).val()):m=i.val(),r.call(this,n,{column:a,dataIndx:o,value:m,value2:_})})}(x,D[M],v)}}}}}}}},a.getWidth=function(t,e){return parseInt(t.width)+(e?1:0)-15},a.createDOM=function(e,i){var r=this.that,o=r.initH,n=r.finalH,a=r.options,l=a.freezeCols,s=a.virtualX,d=r.colModel,h=r.element.zIndex()+5,c=a.columnBorders,u=(this.dataHS,a.numberCell);e.push("<tr class='pq-grid-header-search'>"),u.show&&e.push(["<td pq-grid-col-indx='-1' class='pq-grid-number-col' rowspan='1'>","<div class='pq-grid-header-table-div'>&nbsp;</div></td>"].join(""));for(var f=0;f<=n;f++){if(f<o&&f>=l&&s&&(f=o)>n)throw"initH>finalH";var p=d[f];if(!p.hidden){var g=i,v=p.halign;v||(v=p.align),"right"==v?g+=" pq-align-right":"center"==v&&(g+=" pq-align-center");var w=p.cls;w&&(g=g+" "+w);var x=p.filter;if(x){var I=p.dataIndx,m=x.type,_=x.value,b=x.condition,y=this.getWidth(p,c),q="pq-search-hd-field "+((q=x.cls)||""),C=(C=(C=x.style)||"")+"z-index:"+h+";",D=(D=x.attr)||"",M="";if("between"==b)var R=null!=(R=x.value2)?R:"",P=y/2-9;if("textbox"===m)_=_||"",q+=" ui-corner-all pq-search-txt","between"==b?(M=this._input(I,_,P,q+" pq-from",C,D),M+="-"+this._input(I,R,P,q+" pq-to",C,D)):M=this._input(I,_,y,q,C,D);else if("textarea"===m)_=_||"",q+=" ui-corner-all pq-search-txt","between"==b?(M=this._textarea(I,_,P,q,C,D),M+="-"+this._textarea(I,R,P,q,C,D)):M=this._textarea(I,_,y,q,C,D);else if("select"===m)if(x.cache)M=(M=x.cache).replace(/z-index:\d;/,"z-index:"+h+";");else{var $=x.options;"function"==typeof $&&($=$.call(r.element[0],{column:p,value:_,dataIndx:I,cls:q,style:C,attr:D}));var S=["name='",I,"' class='",q+=" ui-corner-all","' style='width:",y,"px;",C,"' ",D].join("");M=t.paramquery.select({options:$,attr:S,prepend:x.prepend,valueIndx:x.valueIndx,labelIndx:x.labelIndx,groupIndx:x.groupIndx}),x.cache=M}else if("checkbox"==m){M=["<input ",null==_||0==_?"":"checked=checked"," name='",I,"' type=checkbox class='"+q+"' style='"+C+"' "+D+"/>"].join("")}else"string"==typeof m?M=m:"function"==typeof m&&(M=m.call(r.element[0],{width:y,value:_,value2:R,column:p,dataIndx:I,cls:q,attr:D,style:C}));e.push(["<td class='",g,"'><div class='pq-grid-header-table-div' style='padding:0px 2px;' >","",M,"</div></td>"].join(""))}else e.push(["<td class='",g,"'><div class='pq-grid-header-table-div' >","&nbsp;","</div></td>"].join(""))}}e.push("</tr>")},a._input=function(t,e,i,r,o,n){return['<input value="',e,"\" name='",t,"' type=text style='width:",i,"px;"+o+"' class='"+r+"' "+n+" />"].join("")},a._textarea=function(t,e,i,r,o,n){return["<textarea name='",t,"' style='width:",i,"px;"+o+"' class='"+r+"' "+n+" >",e,"</textarea>"].join("")},t.paramquery.select=function(t){var e,i,r=t.attr,o=t.options,n=t.groupIndx,a=t.labelIndx,l=t.valueIndx,s=t.prepend,d=["<select ",r," >"];if(s)for(var h in s)d.push('<option value="',h,'">',s[h],"</option>");if(n){if(o&&o.length){for(var c=0,u=o.length;c<u;c++){if(null!=(g=(p=o[c])[l]))if(e=p[n],i!=e&&(null!=i&&d.push("</optgroup>"),d.push('<optgroup label="',e,'">'),i=e),l!=a){var f=p[a];d.push('<option value="',g,'">',f,"</option>")}else d.push("<option>",g,"</option>")}d.push("</optgroup>")}}else if(o&&o.length)for(c=0,u=o.length;c<u;c++){var p=o[c];if(null!=a&&null!=l){var g;if(null==(g=p[l]))continue;if(a==l)d.push("<option>",g,"</option>");else{f=p[a];d.push('<option value="',g,'">',f,"</option>")}}else if("object"==typeof p)for(var h in p)d.push('<option value="',h,'">',p[h],"</option>");else d.push("<option>",p,"</option>")}return d.push("</select>"),d.join("")},t.fn.pqval=function(t){if(t){if(t.incr){var e=this.data("pq_value");return this.prop("indeterminate",!1),e?(e=!1,this.removeAttr("checked")):!1===e?(e=null,this.prop("indeterminate",!0),this.removeAttr("checked")):(e=!0,this.attr("checked","checked")),this.data("pq_value",e),e}e=t.val;return this.data("pq_value",e),this.prop("indeterminate",!1),null==e?(this.prop("indeterminate",!0),this.removeAttr("checked")):e?this.attr("checked","checked"):this.removeAttr("checked"),this}return this.data("pq_value")};var l={};l._generateTitleRow=function(t,e,i,r){var o=this.that.options.numberCell,n=e.groupTitle,a=t.title,l=e.level,s=e.GMRowIndx,d=(d=(d=t.icon)?d[l]:null)&&d.length&&2==d.length&&"function"==typeof d.push?d:["ui-icon-minus","ui-icon-plus"];if(a&&null!=a[l]){if(!1===a[l])return;n=(n=a[l].replace("{0}",n)).replace("{1}",e.items)}else n=n+" - "+e.items+" item(s)";i.push(["<tr class='pq-group-row pq-grid-row",r?" pq-last-freeze-row":"","' title=\"",e.groupTitle,"\" level='",l,"' GMRowIndx='",s,"'>"].join("")),o.show&&i.push("<td class='pq-grid-number-cell ui-state-default'>&nbsp;</td>");var h=d[0];e.collapsed&&(h=d[1]),i.push("<td class='pq-grid-cell' colSpan='100' >","<div class='pq-td-div' style='margin-left:",16*l,"px;'>","<span class='ui-icon ",h,"'></span>",n,"</div></td>"),i.push("</tr>")},l._generateSummaryRow=function(t,e,i,r){var o="pq-summary-row pq-grid-row"+(r?" pq-last-freeze-row":""),n=this.that,a=n.options,l=a.virtualX,s=n.initH,d=n.finalH,h=a.freezeCols,c=a.numberCell,u=a.columnBorders,f=(a.wrap,this.offset,"<tr class='"+o+"'>");i.push(f),c.show&&i.push(["<td class='pq-grid-number-cell ui-state-default'>","&nbsp;</td>"].join(""));for(var p=0;p<=d;p++){if(p<s&&p>=h&&l&&(p=s)>d)throw"initH>finalH";var g=e[p],v=g.dataIndx;if(!g.hidden){var w="pq-grid-cell ";"right"==g.align?w+=" pq-align-right":"center"==g.align&&(w+=" pq-align-center"),p==h-1&&u&&(w+=" pq-last-freeze-col"),g.cls&&(w=w+" "+g.cls);var x=["<td class='",w,"' style='","","' >",null==t[v]?"&nbsp;":t[v],"</td>"].join("");i.push(x)}}return i.push("</tr>"),i},l._generateDetailRow=function(t,e,i,r,o,n){var a="pq-grid-row pq-detail-child";n&&(a+=" pq-last-freeze-row");var l=this.that.options,s=l.numberCell,d=(i.length,this.offset,"pq-grid-cell ");l.wrap&&!o||(d+="pq-wrap-text "),l.stripeRows&&e/2==parseInt(e/2)&&(a+=" pq-grid-oddRow"),t.pq_rowselect&&(a+=" pq-row-select ui-state-highlight");var h=t.pq_rowcls;return null!=h&&(a+=" "+h),r.push("<tr pq-row-indx='"+e+"' class='"+a+"' >"),s.show&&r.push(["<td class='pq-grid-number-cell ui-state-default'>","&nbsp;</td>"].join("")),r.push("<td class='"+d+" pq-detail-child' colSpan='20'></td>"),r.push("</tr>"),r};var s=function(t){this.that=t},d=s.prototype;d._refreshDataFromDataModel=function(){this._groupData(),this.initcollapsed()},d.bindEvents=function(){var t=this;this.that.$cont.on("click","tr.pq-group-row",function(e){return t.onClickGroupRow(e)})},d.showHideRows=function(t,e,i){for(var r=[],o=this.that.dataGM,n=t,a=o.length;n<a;n++){var l=o[n],s=l;if(s.groupSummary){if(l.level<e)break;l.pq_hidden=i}else if(s.groupTitle){if(l.collapsed&&r.push({indx:n,level:l.level}),l.level<=e)break;l.pq_hidden=i}else l.pq_hidden=i}return r},d.onClickGroupRow=function(e){var i=t(e.currentTarget),r=this.that,o=parseInt(i.attr("level")),n=parseInt(i.attr("GMRowIndx")),a=!0,l=r.dataGM[n];if(l.collapsed?(l.collapsed=!1,a=!1):(l.collapsed=!0,a=!0),a)this.showHideRows(n+1,o,!0);else for(var s=this.showHideRows(n+1,o,!1),d=0;d<s.length;d++){var h=s[d].indx;o=s[d].level;this.showHideRows(h+1,o,!0)}r.refresh()},d.initcollapsed=function(){var t=this.that.dataGM;if(t)for(var e=0,i=t.length;e<i;e++){var r=t[e];if(void 0!==r.groupTitle){var o=r.level;r.collapsed&&this.showHideRows(e+1,o,!0)}}},d.max=function(t,e){var i;return"integer"==e||"float"==e?(i=Math.max.apply(Math,t),"float"===e&&(i=i.toFixed(2))):i="date"==e?(t=t.sort(function(t,e){return t=Date.parse(t),e=Date.parse(e),t-e}))[t.length-1]:(t=t.sort())[t.length-1],i},d.min=function(t,e){var i;return"integer"==e||"float"==e?(i=Math.min.apply(Math,t),"float"===e&&(i=i.toFixed(2))):i="date"==e?(t=t.sort(function(t,e){return t=Date.parse(t),e=Date.parse(e),t-e}))[0]:(t=t.sort())[0],i},d.count=function(t){return t.length},d.sum=function(t,e){var i,r=0;i="float"===e?parseFloat:"integer"===e?parseInt:function(t){return t};for(var o=0,n=t.length;o<n;o++)r+=i(t[o]);return"float"===e&&(r=r.toFixed(2)),r},d._groupData=function(){for(var e=this.that,i=e.pdata,r=e.options,o=r.groupModel,n=r.pageModel,a=e.colModel,l=n.type?(n.curPage-1)*n.rPP:0,s=a.length,d=o.dataIndx,h=d.length,c=o.collapsed,u=[],f=0;f<h;f++){u[f]=!1;for(var p=0;p<s;p++){if(R=(z=a[p]).summary){if((P=R.type)&&"function"==typeof P.push&&P[f]){u[f]=!0;break}}}}if(o&&i&&i.length>0){var g=[],v=[],w=[],x=[],I=[];for(f=0;f<h;f++)x[f]="",w[f]="",I[f]={};for(var m=0,_=i.length;m<=_;m++){var b=i[m],y=!1,q=null;for(f=0;f<h;f++)w[f]=m<_?t.trim(b[d[f]]):"",x[f]!=w[f]&&(y=!0),y&&null==q&&(q=f);if(y){for(var C=0;C<h;C++)x[C]=w[C];if(m>0){for(f=h-1;f>=q;f--)if(u[f]){for(var D=[],M=0;M<s;M++){var R,P;if(P=(R=(z=a[M]).summary)&&R.type?R.type[f]:null){var $=z.dataIndx,S="",T=R.title?R.title[f]:null,H="{0}";"function"==typeof P?S=P(I[f][$],z.dataType):(H=P+": {0}",S=this[P](I[f][$],z.dataType)),T&&(H=T),D[$]=H.replace("{0}",S)}}g.push({groupSummary:!0,level:f,data:D})}for(var k=q;k<h;k++)g[v[k]].items=I[k][a[0].dataIndx].length}if(m==_)break;for(var E=h-1;E>=q;E--)for(var V=0;V<s;V++){var z=a[V];I[E][z.dataIndx]=[]}for(k=q;k<h;k++)g.push({groupTitle:w[k],level:k,GMRowIndx:g.length,collapsed:!(!c||null==c[k])&&c[k]}),v[k]=g.length-1}if(m==_)break;b.rowIndx=m+l,b.pq_hidden=!1,g.push(b);for(var L=0;L<s;L++)for($=(z=a[L]).dataIndx,f=0;f<h;f++)I[f][$].push(b[$])}e.dataGM=g}else e.dataGM=null};var h=function(e){this.that=e,this.$drag_helper=null;var i=e.options.dragColumns,r=i.topIcon,o=i.bottomIcon,n=this;this.status="stop",this.$arrowTop=t("<div class='pq-arrow-down ui-icon "+r+"'></div>").appendTo(e.element),this.$arrowBottom=t("<div class='pq-arrow-up ui-icon "+o+"' ></div>").appendTo(e.element),this.hideArrows(),i&&i.enabled&&e.$header_o.on("mousedown","td.pq-grid-col",function(e,i){if(!t(e.target).is("input,select,textarea")&&!e.pq_composed){n.setDraggables(e,i),e.pq_composed=!0;var r=t.Event("mousedown",e);t(e.target).trigger(r)}})},c=h.prototype;c.showFeedback=function(t,e){var i=this.that,r=t[0],o=r.offsetParent.offsetParent,n=r.offsetLeft+o.offsetLeft+(e?0:r.offsetWidth)-8,a=i.$grid_inner[0].offsetTop+r.offsetTop-16,l=i.$grid_inner[0].offsetTop+i.$header[0].offsetHeight;this.$arrowTop.css({left:n,top:a,display:""}),this.$arrowBottom.css({left:n,top:l,display:""})},c.showArrows=function(){this.$arrowTop.show(),this.$arrowBottom.show()},c.hideArrows=function(){this.$arrowTop.hide(),this.$arrowBottom.hide()},c.updateDragHelper=function(t){var e=this.that.options.dragColumns,i=e.acceptIcon,r=e.rejectIcon,o=this.$drag_helper;o&&(t?(o.children("span.pq-drag-icon").addClass(i).removeClass(r),o.removeClass("ui-state-error")):(o.children("span.pq-drag-icon").removeClass(i).addClass(r),o.addClass("ui-state-error")))},c.setDraggables=function(e,i){var r=t(e.currentTarget),o=this.that,n=o.options.dragColumns.rejectIcon,a=this;r.hasClass("ui-draggable")||o.getHeaderColumnFromTD(r)&&r.draggable({distance:10,cursorAt:{top:-18,left:-10},helper:function(){var e=t(this);a.status="helper",a._setupDroppables(e),o.$header.find(".pq-grid-col-resize-handle").hide();var i=e.attr("pq-col-indx"),r=e.attr("pq-row-indx");e.droppable("destroy");var l=o.headerCells[r][i],s=t("<div class='pq-col-drag-helper ui-widget-content ui-corner-all' ><span class='pq-drag-icon ui-icon "+n+"'></span>"+l.title+"</div>");return a.$drag_helper=s,s[0]},zIndex:"1000",appendTo:o.element,revert:"invalid",drag:function(e,i){a.status="drag";var r=t("td.pq-drop-hover",o.$header);if(r.length>0){a.showArrows(),a.updateDragHelper(!0);var n=r.width();e.clientX-r.offset().left+t(document).scrollLeft()<n/2?(a.leftDrop=!0,a.showFeedback(r,!0)):(a.leftDrop=!1,a.showFeedback(r,!1))}else a.hideArrows(),o.$toolbar.hasClass("pq-drop-hover")?a.updateDragHelper(!0):a.updateDragHelper()},stop:function(t,e){a.status="stop",o.$header.find(".pq-grid-col-resize-handle").show(),a.hideArrows()}})},c._columnIndexOf=function(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]==e)return i;return-1},c._setupDroppables=function(e){var i=this.that,r=(i.options,this),o={hoverClass:"pq-drop-hover ui-state-highlight",tolerance:"pointer",drop:function(e,o){if(!i.dropPending){var n,a,l=parseInt(o.draggable.attr("pq-col-indx")),s=parseInt(o.draggable.attr("pq-row-indx")),d=parseInt(t(this).attr("pq-col-indx")),h=t(this).attr("pq-row-indx"),c=i.options.colModel,u=i.headerCells,f=u[s][l];n=0==s?c:u[s-1][l].colModel,a=0==h?c:u[h-1][d].colModel;var p=u[h][d],g=r._columnIndexOf(n,f),v=n.splice(g,1)[0],w=r._columnIndexOf(a,p),x=r.leftDrop?1:0;a.splice(w+1-x,0,v),i.dropPending=!0,window.setTimeout(function(){i._calcThisColModel(),i.refresh(),i.dropPending=!1},0)}}},n=i.$header_left.find("td.pq-left-col"),a=i.pqpanes.v?i.$header_right.find("td.pq-right-col"):i.$header_left.find("td.pq-right-col");(n=n.add(a)).each(function(e,i){var r=t(i);r.hasClass("ui-droppable")||r.droppable(o)})},r.options={detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check",rejectIcon:"ui-icon-closethick",topIcon:"ui-icon-circle-arrow-s",bottomIcon:"ui-icon-circle-arrow-n"},track:null,treeModel:{collapsed:!0,indent:15,leafIcon:"ui-icon-radio-off",expandIcon:"ui-icon-triangle-1-se",collapseIcon:"ui-icon-triangle-1-e"},filterModel:{on:!0,mode:"AND",header:!1}},r._create=function(){t.extend(t.paramquery.cGenerateView.prototype,l);var e=this;this.options;this.iHistory=new t.paramquery.cHistory(this),this.iGroupView=new s(this),this.iHeaderSearch=new n(this),this.iUCData=new t.paramquery.cUCData(this),this.iMouseSelection=new t.paramquery.cMouseSelection(this),this._super.apply(this),this.iGroupView.bindEvents(),this.iDragColumns=new h(this),this._createToolbar(),this.refreshDataAndView({header:!0}),this.refresh({table:!0});var i=e.widgetEventPrefix.toLowerCase(),r=e.widgetName;e.element.one(i+"load."+r,function(t,i){e.refresh()})},r._createToolbar=function(){var e=this.options,i=e.toolbar;if(i){var r=i,o=(o=r.cls)||"",n=(n=r.style)||"",a=(a=r.attr)||"",l=r.items,s=t("<div class='"+o+"' style='"+n+"' "+a+" ></div>").appendTo(t(".pq-grid-top",this.element));s.pqToolbar({items:l,gridInstance:this}),e.showToolbar||s.css("display","none"),this.$toolbar=s}},r.isLeftOrRight=function(t){this.options;return t>this.freezeCols?"right":"left"},r.ovCreateHeader=function(t,e){this.options.filterModel.header&&this.iHeaderSearch.createDOM(t,e)},r._createHeader=function(){this._super.apply(this),this.options.showHeader&&this._trigger("createHeader")},r.exportExcel=function(e){return e.format="xml",t.paramquery.pqgrid.exportToExcel.call(this,e)},r.exportCsv=function(e){return e.format="csv",t.paramquery.pqgrid.exportToExcel.call(this,e)},r.filter=function(e){var i=this,r=this.options,o=void 0===e.apply||e.apply,n=void 0===e.sort||e.sort,a=r.dataModel,l=r.filterModel;if(void 0!=e)for(var s="replace"==e.oper,d=e.data,h=this.colModel,c=0,u=(h=o?h:t.extend(!0,[],h)).length,f=d.length,p=0;p<u;p++){for(var g=h[p],v=!1,w=0;w<f&&c!=f;w++){var x=d[w];if(x.dataIndx==g.dataIndx){v=!0,c++;var I=g.filter,m=x.condition,_=x.value;if(I?I.on=!0:I=g.filter={on:!0},m&&(I.condition=m),m=I.condition,I.value=_,"between"==m)I.value2=x.value2;else if("range"==m){var b=[];if(_)if("string"==typeof _){var y=I.options,q=_.indexOf('"'),C=_.lastIndexOf('"');if(_=_.substr(q,C+1),_=JSON.parse("["+_+"]"),y)for(var D=0,M=y.length;D<M;D++){var R=y[D];-1!=t.inArray(R,_)&&b.push(R)}else b=_.split(",s*")}else"function"==typeof _.push&&(b=_);I.value=b}break}}s&&!v&&g.filter&&(g.filter.on=!1)}var P={header:!1,apply:o,sort:n,CM:h};if("remote"!=a.location||"local"==l.type)return P.source="filter",i._onDataAvailable(P);this.remoteRequest({apply:o,CM:h,callback:function(){return i._onDataAvailable(P)}})},r._initTypeColumns=function(){for(var i=this.colModel,r=0,o=i.length;r<o;r++){var n=i[r],a=n.type;"checkBoxSelection"===a?new t.paramquery.cCheckBoxColumn(this,n):"detail"===a&&(n.dataIndx="pq_detail",this.iHierarchy=new e(this))}},r.refreshDataFromDataModel=function(){this._super.apply(this);!!this.options.groupModel&&this.iGroupView._refreshDataFromDataModel()};var u=(t.paramquery.cSort=function(t){this.that=t}).prototype;u._refreshSorters=function(e){var i=this.that.options,r=i.dataModel,o=r.sortIndx,n=t.isArray(o),a=i.groupModel,l=a?a.dataIndx:null,s=a?a.dir:null,d=-1,h=[];if(a)for(var c=0;c<l.length;c++){var u=l[c];u==e&&(d=c),h.push({dataIndx:u,dir:s&&s[c]?s[c]:"up"})}if(-1!==d){var f="up"===h[d].dir?"down":"up";h[d].dir=f,s[d]=f}else if(null!=e)if(n){var p=t.inArray(e,r.sortIndx);if(-1!=p)"up"==r.sortDir[p]?r.sortDir[p]="down":1==o.length?r.sortDir[p]="up":(r.sortIndx.splice(p,1),r.sortDir.splice(p,1));else{var g=r.sortIndx.length;r.sortIndx[g]=e,r.sortDir[g]="up"}}else r.sortIndx==e?r.sortDir="up"==r.sortDir?"down":"up":(r.sortIndx=e,r.sortDir="up");if(null!=r.sortIndx)if(n)for(c=0;c<o.length;c++){var v=o[c];-1==this.inSorters(h,v)&&h.push({dataIndx:v,dir:r.sortDir[c]})}else-1==this.inSorters(h,r.sortIndx)&&h.push({dataIndx:r.sortIndx,dir:r.sortDir});this.sorters=h},u.inSorters=function(t,e){for(var i=-1,r=0;r<t.length;r++){if(t[r].dataIndx==e){i=r;break}}return i},u._sortLocalData=function(t){for(var e=this.that,i=(e.options.dataModel,e.colModel),r=this.sorters,o=0;o<r.length;o++){var n=r[o],a=n.dataIndx,l=i[e.getColIndx({dataIndx:a})].dataType;n.dataType=l}return this.__sortLocalData(r,t)},u.__sortLocalData=function(t,e){function i(t,e,i,r){var o=t[i],n=e[i];return o=o?parseInt(o,10):0,n=n?parseInt(n,10):0,(o-n)*r}function r(t,e,i,r){var o=t[i],n=e[i];return o=o?Date.parse(o):0,n=n?Date.parse(n):0,(o-n)*r}function o(t,e,i,r,o){return o(t[i],e[i])*r}function n(t,e,i,r){var o=(t[i]+"").replace(/,/g,""),n=(e[i]+"").replace(/,/g,"");return o=o?parseFloat(o):0,n=n?parseFloat(n):0,(o-n)*r}function a(t,e,i,r){var o=t[i],n=e[i],a=0;return(o=o||"")>(n=n||"")?a=1:o<n&&(a=-1),a*r}function l(t,e,i,r){var o=t[i],n=e[i],a=0;return(o=o?o.toUpperCase():"")>(n=n?n.toUpperCase():"")?a=1:o<n&&(a=-1),a*r}function s(t,e,i,r){var o=t[i],n=e[i],a=0;return o&&!n||!1===o&&null===n?a=1:(n&&!o||!1===n&&null===o)&&(a=-1),a*r}if(null!=e&&0!=e.length)return t&&t.length?(function(){for(var d=[],h=[],c=[],u=t.length,f=0;f<u;f++){var p=t[f],g=p.dataIndx,v="up"==p.dir?1:-1,w=p.dataType;h[f]=g,c[f]=v,d[f]="integer"==w?i:"float"==w?n:"function"==typeof w?function(t){return function(e,i,r,n){return o(e,i,r,n,t)}}(w):"date"==w?r:"stringi"==w?l:"bool"==w?s:a}e=e.sort(function(t,e){for(var i=0,r=0;r<u&&0==(i=d[r](t,e,h[r],c[r]));r++);return i})}(),e):e},r._refreshHeaderSortIcons=function(){this.options.dataModel;var t=this.iSort.sorters,e=(this.colModel,this.$header);if(e){e.find(".pq-grid-col").removeClass("pq-col-sort-asc pq-col-sort-desc ui-state-active"),e.find(".pq-col-sort-icon").removeClass("ui-icon ui-icon-triangle-1-n ui-icon-triangle-1-s");for(var i=0;i<t.length;i++){var r=t[i],o=r.dataIndx,n=this.getColIndx({dataIndx:o}),a=r.dir,l="ui-state-active pq-col-sort-"+("up"==a?"asc":"desc"),s="ui-icon ui-icon-triangle-1-"+("up"==a?"n":"s");e.find(".pq-grid-col[pq-grid-col-indx="+n+"]").addClass(l),e.find(".pq-grid-col[pq-grid-col-indx="+n+"] .pq-col-sort-icon").addClass(s)}}},r.getHeaderColumnFromTD=function(t){var e=t.attr("pq-grid-col-indx");if(null!=e){return this.colModel[e]}},r.getIndxInSorters=function(t){for(var e=this.sorters,i=0,r=e.length;i<r;i++)if(e[i].dataIndx==t)return i;return-1},r.getLargestRowCol=function(t){for(var e,i=0;i<t.length;i++){var r=t[i],o=r.rowIndx;null==e?e=r.rowIndx:o>e&&(e=o),e=r.rowIndx}},r.bringCellToView=function(t){this._bringCellToView(t)},r._setUrl=function(t){this.options.dataModel.getUrl=function(){return{url:this.url+(null!=t?t:"")}}},r.getDataPage=function(){return this.pdata},r.getData=function(t){var e=t.dataIndx,i=e.length,r=t.data,o=this.options.dataModel,n=o.data,a=o.dataUF,l=[],s=function(t){for(var r=0,o=t.length;r<o;r++){for(var n=t[r],a={},s=0;s<i;s++){var d=e[s];a[d]=n[d]}l.push(a)}};r?s(r):(n&&s(n),a&&s(a));for(var d=[],h=0;h<i;h++){var c=e[h],u=this.getColumn({dataIndx:c});d.push({dataIndx:c,dir:"up",dataType:u.dataType})}l=this.iSort.__sortLocalData(d,l);for(var f=[],p=void 0,g=0;g<l.length;g++){var v=l[g],w=JSON.stringify(v);w!==p&&(f.push(v),p=w)}return f},r.getFilterData=function(e){var i=e.CM;if(!i)throw"CM N/A";for(var r=i.length,o=e.location,n=this.options.filterModel.multiple,a=t.paramquery.filter.getAllConditions,l=t.paramquery.filter.getTRConditions,s=[],d=function(e,i,r){return"between"==e?null!=i&&""!==i||null!=r&&""!==r:-1==t.inArray(e,a)||(null!=i&&""!==i||-1==t.inArray(e,l))},h=function(t,e){return"remote"==o?(t=null==t?"":t).toString():f.convert(t,e)},c=0;c<r;c++){var u=i[c],p=u.dataIndx,g=(g=u.dataType)&&"function"!=typeof g?g:"string",v=u.filter;if(n){var w=u.filterModel;if(w&&w.on){for(var x=[],I=w.mode,m=w.filters,_=0;_<m.length;_++){var b=(v=m[_]).value;d(y=v.condition,b)&&(b=h(b,g),x.push({value:b,condition:y}))}s.push({dataIndx:p,mode:I,dataType:g,filters:x})}}else if(v&&v.on){b=v.value;var y,q=v.value2;if(d(y=v.condition,b,q)){if("between"==y)""===b||null==b?(y="lte",b=h(q,g)):""===q||null==q?(y="gte",b=h(b,g)):(b=h(b,g),q=h(q,g));else if("regexp"==y){if("remote"==o)b=b.toString();else if("string"==typeof b)try{var C=(C=v.modifiers)||"gi";b=new RegExp(b,C)}catch(t){b=/.*/}}else if("range"==y){if(null==b)continue;if("string"==typeof b)b=(b=h(b,g)).split(/\s*,\s*/);else if(b&&"function"==typeof b.push){if(0==b.length)continue;_=0;for(var D=(b=b.slice()).length;_<D;_++)b[_]=h(b[_],g)}}else b=h(b,g);s.push({dataIndx:p,value:b,value2:q,condition:y,dataType:g,cbFn:"remote"==o?"":f.conditions[y]})}}}return s};var f=function(t){this.that=t},p=f.prototype;f.conditions={equal:function(t,e){if(t==e)return!0},contain:function(t,e){if(-1!=t.indexOf(e))return!0},notcontain:function(t,e){if(-1==t.indexOf(e))return!0},empty:function(t){if(0==t.length)return!0},notempty:function(t){if(t.length>0)return!0},begin:function(t,e){if(0==t.indexOf(e))return!0},notbegin:function(t,e){if(0!=t.indexOf(e))return!0},end:function(t,e){var i=t.lastIndexOf(e);if(-1!=i&&i+e.length==t.length)return!0},notend:function(t,e){var i=t.lastIndexOf(e);if(-1==i||i+e.length!=t.length)return!0},regexp:function(t,e){if(e.test(t))return e.lastIndex=0,!0},notequal:function(t,e){if(t!=e)return!0},great:function(t,e){if(t>e)return!0},gte:function(t,e){if(t>=e)return!0},between:function(t,e,i){if(t>=e&&t<=i)return!0},range:function(e,i){if(-1!=t.inArray(e,i))return!0},less:function(t,e){if(t<e)return!0},lte:function(t,e){if(t<=e)return!0}},f.convert=function(e,i){return e=null==e?"":e,"string"==i?e=t.trim(e).toUpperCase():"date"==i?e=Date.parse(e):"integer"==i?e=parseInt(e):"float"==i?e=parseFloat(e):"bool"==i&&(e=String(e).toLowerCase()),e},p.isMatchCellSingle=function(t,e){var i=t.dataIndx,r=t.dataType,o=t.value,n=t.value2,a=t.condition,l=t.cbFn,s=e[i];return!!l(s="regexp"==a?null==s?"":s:f.convert(s,r),o,n)},p.isMatchCellMultiple=function(t,e){var i=t.dataIndx,r=t.dataType,o=t.mode,n=t.filters,a=n.length;if(0==a)return!0;for(var l=0;l<a;l++){var s=n[l],d=s.value,h=s.condition,c=e[i],u=this.isMatchRule(c,h,d,r);if("OR"==o&&u)return!0;if("AND"==o&&!u)return!1}return 1===a?u:"AND"==o||"OR"!=o&&void 0},p.isMatchRow=function(t,e,i){if(0==e.length)return!0;for(var r=0;r<e.length;r++){var o=e[r],n=this.isMatchCell(o,t);if("OR"==i&&n)return!0;if("AND"==i&&!n)return!1}return"AND"==i||"OR"!=i&&void 0},r.filterLocalData=function(t){var e=(t=t||{}).apply,i=!1===e?t.CM:this.colModel,r=this.getFilterData({CM:i}),o=this.options,n=o.dataModel,a=n.data,l=n.dataUF,s=[],d=[],h=o.filterModel,c=h.multiple,u=h?h.mode:null,p=new f;if(p.isMatchCell=c?p.isMatchCellMultiple:p.isMatchCellSingle,h.on&&u){if(a)for(var g=0,v=a.length;g<v;g++){var w=a[g];p.isMatchRow(w,r,u)?s.push(w):d.push(w)}if(l)for(g=0,v=l.length;g<v;g++){w=l[g];p.isMatchRow(w,r,u)?s.push(w):d.push(w)}}else{if(a)for(g=0,v=a.length;g<v;g++){w=a[g];s.push(w)}if(l)for(g=0,v=l.length;g<v;g++){w=l[g];s.push(w)}}return e&&(n.data=s,n.dataUF=d,this._trigger("filter",null,{type:"local",dataModel:n,colModel:i,filterModel:h})),{data:s,dataUF:d}},r._onDataAvailable=function(t){t=t||{};var e=this.options,i=t.apply,r=t.source,o=t.sort,n=[],a=e.filterModel,l=e.dataModel,s=l.location;if(!1!==i&&this._trigger("dataAvailable",t.evt,{dataModel:l,source:r}),n=a&&a.on&&("local"==s&&"remote"!=a.type||"remote"==s&&"local"==a.type)?this.filterLocalData(t).data:l.data,l.sorting&&"local"==l.sorting&&!1!==o&&(n=this.iSort._sortLocalData(n)),!1===i)return n;l.data=n,this.refreshView(t)},r.sort=function(t){var e=this,i=this.options,r=t.colIndx,o=i.editModel,n=t.dataIndx,a=t.evt,l=i.dataModel;if(null!=r||null!=n||null!=(n=l.sortIndx)){r=null==r?this.getColIndx({dataIndx:n}):r;var s=this.colModel[r];n=null==n?s.dataIndx:n,0!=e._trigger("beforeSort",a,{dataModel:l,column:s,dataIndx:n})&&(o.indices&&e.blurEditor({force:!0}),this.iSort._refreshSorters(n),"local"==l.sorting?(this.iSort._sortLocalData(l.data),this.refreshView()):"remote"==l.sorting&&this.remoteRequest({callback:function(){e._trigger("sort",a,{dataModel:l,column:s,dataIndx:n}),e._onDataAvailable()}}))}},r._setScrollVLength=function(t){t=this.options.groupModel?this.dataGM:t,this._super.call(this,t)},t.widget("paramquery.pqGrid",t.paramquery._pqGrid,r),t.paramquery.pqGrid.regional={},t.paramquery.pqGrid.regional.en=r._regional}(jQuery),function(t){t.paramquery=null==t.paramquery?{}:t.paramquery,t.paramquery.pqgrid=null==t.paramquery.pqgrid?{}:t.paramquery.pqgrid,t.paramquery.pqgrid.exportToExcel=function(e){var i=this,r=void 0===e.urlPost?e.url:e.urlPost,o=e.url,n=null==e.sheetName?"pqGrid":e.sheetName,a=e.format,l="xml"==a?function(){for(var t=i.colModel,e=t.length,r=i.options.dataModel.data,o=r.length,a=[],l=[],s=0;s<e;s++)!1!==(c=t[s]).copy&&l.push('<Column ss:AutoFitWidth="1"  ss:Width="'+c._width+'" />');l.push("<Row>");for(s=0;s<e;s++)!1!==(c=t[s]).copy&&l.push('<Cell><Data ss:Type="String">'+c.title+"</Data></Cell>");l.push("</Row>"),l=l.join("\n");for(s=0;s<o;s++){var d=r[s];a.push("<Row>");for(var h=0;h<e;h++){var c;if(!1!==(c=t[h]).copy){var u=c.dataIndx;a.push('<Cell><Data ss:Type="String"><![CDATA['+d[u]+"]]></Data></Cell>")}}a.push("</Row>")}a=a.join("\n");return['<?xml version="1.0"?>','<?mso-application progid="Excel.Sheet"?>','<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:o="urn:schemas-microsoft-com:office:office"',' xmlns:x="urn:schemas-microsoft-com:office:excel"',' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"',' xmlns:html="http://www.w3.org/TR/REC-html40">','<Worksheet ss:Name="',n,'">',"<Table>",l,a,"</Table>","</Worksheet>","</Workbook>"].join("\n")}():function(){for(var t=i.colModel,e=t.length,r=i.options.dataModel.data,o=r.length,n=[],a=[],l=[],s=0;s<e;s++)if(!1!==(u=t[s]).copy){var d=u.title.replace(/\"/g,'""');a.push('"'+d+'"')}n.push(a.join(","));for(s=0;s<o;s++){for(var h=r[s],c=0;c<e;c++){var u;if(!1!==(u=t[c]).copy){var f=h[u.dataIndx]+"";f=f.replace(/\"/g,'""'),l.push('"'+f+'"')}}n.push(l.join(",")),l=[]}return n.join("\n")}();t.ajax({url:r,type:"POST",cache:!1,data:{extension:a,excel:l},success:function(e){var i=o+(o.indexOf("?")>0?"&":"?")+"filename="+e;t(document.body).append("<iframe height='0' width='0' frameborder='0'  src="+i+"></iframe>")}})}}(jQuery),function(t){var e=t.paramquery.pqGrid.prototype.options;e.trackModel=e.trackModel||{on:!1,dirtyClass:"pq-cell-dirty"};var i=(t.paramquery.cUCData=function(t){this.that=t,this.udata=[],this.ddata=[],this.adata=[],this.options=t.options;var e=this,i=t.eventNamespace,r=t.widgetEventPrefix.toLowerCase();t.element.on(r+"dataavailable"+i,function(t,i){e.belongs(t)&&"filter"!=i.source&&(e.udata=[],e.ddata=[],e.adata=[])})}).prototype=new t.paramquery.cClass;i.add=function(t){for(var e=this.that,i=this.adata,r=t.rowData,o=this.options.trackModel.dirtyClass,n=e.getRecId({rowData:r}),a=0,l=i.length;a<l;a++){var s=i[a];if(null!=n&&s.recId==n)throw"primary key violation";if(s.rowData==r)throw"same data can't be added twice."}var d=[];for(var h in r)d.push(h);e.removeClass({rowData:r,dataIndx:d,cls:o});t={recId:n,rowData:r};i.push(t)},i.update=function(e){var i=this.that,r=this.options.trackModel.dirtyClass,o=e.rowData||i.getRowData(e),n=i.getRecId({rowData:o}),a=e.dataIndx,l=e.refresh,s=i.columns,d=t.paramquery.getValueFromDataType,h=e.row,c=this.udata,u=c.slice(0),f=!1;if(null!=n){for(var p=0,g=c.length;p<g;p++){var v=c[p],w=v.oldRow;if(v.rowData==o){f=!0;for(var a in h){var x=s[a].dataType,I=d(I=h[a],x),m=d(m=w[a],x);if(w.hasOwnProperty(a)&&m===I){var _={rowData:o,dataIndx:a,refresh:l,cls:r};i.removeClass(_),delete w[a]}else{_={rowData:o,dataIndx:a,refresh:l,cls:r};i.addClass(_),w.hasOwnProperty(a)||(w[a]=o[a])}}t.isEmptyObject(w)&&u.splice(p,1);break}}if(!f){w={};for(var a in h){w[a]=o[a];_={rowData:o,dataIndx:a,refresh:l,cls:r};i.addClass(_)}_={rowData:o,recId:n,oldRow:w};u.push(_)}this.udata=u}},i.delete=function(t){for(var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,n=(i=null==i?r+o:i,r=null==r?i-o:r,"remote"==e.options.pageModel.type?r:i),a=this.adata,l=this.ddata,s=e.getRowData(t),d=0,h=a.length;d<h;d++)if(a[d].rowData==s)return void a.splice(d,1);l.push({indx:n,rowData:s,rowIndx:i})},i.isDirty=function(t){var e=this.that,i=this.udata,r=this.adata,o=this.ddata,n=!1,a=e.getRowData(t);if(a)for(var l=0;l<i.length;l++){if(a==i[l].rowData){n=!0;break}}else(i.length||r.length||o.length)&&(n=!0);return n},i.getChangesValue=function(){this.that;for(var e=this.udata,i=this.adata,r=this.ddata,o={updateList:[],addList:[],deleteList:[]},n=[],a=[],l=[],s=[],d=[],h=0,c=r.length;h<c;h++){var u=r[h].rowData,f={};s.push(u);for(var p in u)0!=p.indexOf("pq_")&&(f[p]=u[p]);d.push(f)}for(h=0;h<e.length;h++){u=e[h].rowData;if(-1==t.inArray(u,s)&&-1==t.inArray(u,n)){f={};for(var p in u)0!=p.indexOf("pq_")&&(f[p]=u[p]);n.push(u),a.push(f)}}for(h=0;h<i.length;h++){u=i[h].rowData,f={};for(var p in u)0!=p.indexOf("pq_")&&(f[p]=u[p]);l.push(f)}return o.updateList=a,o.addList=l,o.deleteList=d,o},i.getChanges=function(){this.that;for(var e=this.udata,i=this.adata,r=this.ddata,o={updateList:[],addList:[],deleteList:[]},n=[],a=[],l=[],s=0,d=r.length;s<d;s++){var h=r[s].rowData;l.push(h)}for(s=0,d=e.length;s<d;s++){h=e[s].rowData;-1==t.inArray(h,l)&&(-1==t.inArray(h,n)&&n.push(h))}for(s=0,d=i.length;s<d;s++){h=i[s].rowData;a.push(h)}return o.updateList=n,o.addList=a,o.deleteList=l,o},i.getChangesRaw=function(){this.that;var t=this.udata,e=this.adata,i=this.ddata,r={updateList:[],addList:[],deleteList:[]};return r.updateList=t,r.addList=e,r.deleteList=i,r},i.commitAdd=function(e,i){for(var r=this.that.colModel,o=r.length,n=this.adata,a=t.inArray,l=n.length,s=t.paramquery.getValueFromDataType,d=[],h=e.length,c=[],u=0;u<h;u++)for(var f=e[u],p=0;p<l;p++){var g=!0;if(-1==a(q=n[p].rowData,c)){for(var v=0;v<o;v++){var w=r[v],x=w.hidden,I=w.dataType,m=w.dataIndx;if(!x&&m!=i){if(s(q[m],I)!==s(f[m],I)){g=!1;break}}}if(g){var _={},b={};_[i]=f[i],b[i]=q[i],d.push({type:"update",rowData:q,oldRow:b,newRow:_}),c.push(q);break}}}var y=[];for(p=0;p<l;p++){var q;-1==a(q=n[p].rowData,c)&&y.push(n[p])}return this.adata=y,d},i.commitUpdate=function(e,i){for(var r=this.that,o=this.options.trackModel.dirtyClass,n=r.colModel,a=n.length,l=this.udata,s=l.length,d=e.length,h=[],c=0;c<s;c++){var u=l[c],f=u.rowData,p=u.oldRow;if(-1==t.inArray(f,h))for(var g=0;g<d;g++){var v=e[g];if(f[i]==v[i]){h.push(f);for(var w=0;w<a;w++)var x=n[w].dataIndx;for(var x in p)r.removeClass({rowData:f,dataIndx:x,cls:o})}}}var I=[];for(c=0;c<s;c++){f=l[c].rowData;-1==t.inArray(f,h)&&I.push(l[c])}return this.udata=I,[]},i.commitDelete=function(e,i){for(var r=this.ddata,o=r.length,n=e.length,a=[],l=0;l<o;l++)for(var s=r[l].rowData,d=0;d<n;d++){var h=e[d];s[i]==h[i]&&a.push(s)}var c=[];for(l=0;l<o;l++){s=r[l].rowData;-1==t.inArray(s,a)&&c.push(r[l])}this.ddata=c},i.commitUpdateAll=function(){for(var t=this.that,e=this.options.trackModel.dirtyClass,i=this.udata,r=0,o=i.length;r<o;r++){var n=i[r],a=n.oldRow,l=n.rowData;for(var s in a)t.removeClass({rowData:l,dataIndx:s,cls:e})}this.udata=[]},i.commitAddAll=function(){this.adata=[]},i.commitDeleteAll=function(){this.ddata=[]},i.commit=function(t){var e=this.that,i=null!=(i=t?t.history:null)&&i,r=[],o=[],n=[],a=e.options.dataModel.recIndx;if(null==t)this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll();else{var l=t.type,s=t.rows;"add"==l?s?o=this.commitAdd(s,a):this.commitAddAll():"update"==l?s?n=this.commitUpdate(s,a):this.commitUpdateAll():"delete"==l&&(s?this.commitDelete(s,a):this.commitDeleteAll())}(r=o.concat(n)).length&&(e._digestData({source:"commit",checkEditable:!1,track:!1,history:i,rowList:r}),e.refreshView())},i.rollbackAdd=function(t,e){for(var i=this.adata,r=[],o=(t.type,0),n=i.length;o<n;o++){var a=i[o].rowData;r.push({type:"delete",rowData:a})}return this.adata=[],r},i.rollbackDelete=function(t,e){for(var i=this.ddata,r=[],o=(t.type,i.length-1);o>=0;o--){var n=i[o],a=(n.indx,n.rowIndx),l=n.rowData;r.push({type:"add",rowIndx:a,newRow:l})}return this.ddata=[],r},i.rollbackUpdate=function(t,e){for(var i=this.that,r=this.options.trackModel.dirtyClass,o=this.udata,n=[],a=0,l=o.length;a<l;a++){var s=o[a],d=s.recId,h=s.rowData,c={},u=s.oldRow;if(null!=d){var f=[];for(var p in u)c[p]=h[p],f.push(p);i.removeClass({rowData:h,dataIndx:f,cls:r,refresh:!1}),n.push({type:"update",rowData:h,newRow:u,oldRow:c})}}return this.udata=[],n},i.rollback=function(t){var e=this.that,i=e.options.dataModel,r=e.options.pageModel,o=!t||null==t.refresh||t.refresh,n=t&&null!=t.type?t.type:null,a=[],l=[],s=[],d=[],h=i.data;null!=n&&"update"!=n||(s=this.rollbackUpdate(r,h)),null!=n&&"delete"!=n||(l=this.rollbackDelete(r,h)),null!=n&&"add"!=n||(d=this.rollbackAdd(r,h)),a=l.concat(d,s),e._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,rowList:a}),o&&e.refreshView()};var r=t.paramquery.pqGrid.prototype;r.getChanges=function(t){if(this.blurEditor({force:!0}),t){var e=t.format;if(e){if("byVal"==e)return this.iUCData.getChangesValue();if("raw"==e)return this.iUCData.getChangesRaw()}}return this.iUCData.getChanges()},r.rollback=function(t){this.blurEditor({force:!0}),this.iUCData.rollback(t)},r.isDirty=function(t){return this.iUCData.isDirty(t)},r.commit=function(t){this.iUCData.commit(t)},r._getRowIndx=function(){var t=this.selection({type:"row",method:"getSelection"});if(!(t&&t.length>0))return null;var e=t[0].rowIndx,i=this.rowIndxOffset,r=this.options.pageModel,o=r.type,n=e-i,a=r.rPP;return o?n>=0&&n<a?e:void 0:e},r.updateRow=function(t){var e=t.rowIndx,i=t.row,r=t.rowData||this.getRowData({rowIndx:e});if(!r)return!1;var o={};for(var n in i)o[n]=r[n];if(!1===this._digestData({source:t.source||"update",history:t.history,checkEditable:t.checkEditable,track:t.track,allowInvalid:t.allowInvalid,rowList:[{newRow:i,oldRow:o,rowData:r,rowIndx:e,type:"update"}]}))return!1;!1!==t.refresh&&this.refreshRow({rowIndx:e})},r.updateElseAdd=function(t){var e=t.rowIndx,i=t.row;null==this.getRowData({rowIndx:e})?(t.rowData=i,this.addRow(t)):this.updateRow(t)},r._fillForm=function(t){var e=this.options.dataModel,i=this.options.pageModel.type,r=e.data,o=this.colModel,n=this.rowIndxOffset,a=null==t.rowIndxPage?t.rowIndx-n:t.rowIndxPage,l=null==t.rowIndx?a+n:t.rowIndx,s=r["remote"==i?a:l];this.rowData=s,this.$crudDialog.dialog("option","title","Edit Record ("+(l+1)+")");for(var d=this.$crudForm,h=0;h<o.length;h++){var c=o[h].dataIndx,u=s[c];d.find("*[name='"+c+"']").val(u)}},r.getRecId=function(t){var e=this.options.dataModel;t.dataIndx=e.recIndx;var i=this.getCellData(t);return null==i?null:i},r.getCellData=function(t){var e=t.rowData||this.getRowData(t),i=t.dataIndx;return e?e[i]:null},r.getRowData=function(t){if(!t)return null;var e=t.rowData;if(null!=e)return e;var i=this.options,r=i.dataModel,o=i.pageModel.type,n=r.recIndx,a=t.recId,l=r.data;if(null==a){var s=t.rowIndx,d=t.rowIndxPage,h=this.rowIndxOffset;s=null!=s?s:d+h,d=null!=d?d:s-h;return f=l?l["remote"==o?d:s]:null}for(var c=0,u=l.length;c<u;c++){var f;if((f=l[c])[n]==a)return f}return null},r.deleteRow=function(t){var e=t.rowIndx,i=t.rowIndxPage,r=this.rowIndxOffset;if(null!=(e=null!=i?i+r:e)){var o=t.rowData||this.getRowData({rowIndx:e});this._digestData({source:t.source||"delete",history:t.history,track:t.track,rowList:[{rowIndx:e,rowData:o,oldRow:o,type:"delete"}]}),!1!==t.refresh&&this.refreshView()}},r.addRow=function(t){var e=t.rowData||t.row,i=t.rowIndx,r=t.rowIndxPage,o=this.rowIndxOffset,n=(i=null!=r?r+o:i,this.options.dataModel),a=n.data;if(null==e)return null;null==a&&(n.data=[],a=n.data);return!1!==this._digestData({source:t.source||"add",history:t.history,track:t.track,checkEditable:t.checkEditable,rowList:[{newRow:e,rowIndx:i,type:"add"}]})&&(!1!==t.refresh&&this.refreshView(),null==i?a.length-1:i)}}(jQuery),function(t){var e={};e.options={items:[],gridInstance:null},e._create=function(){var e=(c=this.options).gridInstance,i=e.colModel,r=c.items,o=this.element;o.closest(".pq-grid");o.addClass("pq-toolbar");for(var n=0,a=r.length;n<a;n++){var l,s=r[n],d=s.type,h=s.icon,c=s.options,u=s.label,f=(b=s.listener)?[b]:s.listeners,p=s.cls,g="ui-corner-all "+(p||""),v=s.style,w=v?'style="'+v+'"':"",x=s.attr,I=x||"";if("textbox"==d)l=t("<input type='text' class='"+g+"' "+I+" "+w+">").appendTo(o);else if("checkbox"==d)l=t("<input type='checkbox' class='"+g+"' "+I+" "+w+">").appendTo(o);else if("separator"==d)t("<span class='pq-separator '"+g+"' "+I+" "+w+"></span>").appendTo(o);else if("button"==d){c=s.options?s.options:{};t.extend(c,{text:!!u,icons:{primary:h}}),l=t("<button type='button' class='"+g+"' "+I+" "+w+">"+u+"</button>").button(c).appendTo(o)}else if("select"==d){"function"==typeof(c=s.options?s.options:[])&&(c=c.call(e.element[0],{colModel:i})),m=t.paramquery.select({options:c,attr:" class='"+g+"' "+I+" "+w,prepend:s.prepend,groupIndx:s.groupIndx,valueIndx:s.valueIndx,labelIndx:s.labelIndx}),l=t(m).appendTo(o)}else if("string"==typeof d)l=t(d).appendTo(o);else if("function"==typeof d){var m=d.call(e.element[0],{colModel:i,cls:g});l=t(m).appendTo(o)}if(f)for(var _=0;_<f.length;_++){var b=f[_];for(var y in b)l.bind(y,b[y])}}},e._destroy=function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},e._disable=function(){null==this.$disable&&(this.$disable=t("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},e._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},e._setOption=function(t,e){"disabled"==t&&(1==e?this._disable():this._enable())},t.widget("paramquery.pqToolbar",e)}(jQuery),function(t){var e=function(){this.focusSelection=null},i=e.prototype;i.triggerSelectChange=function(e){var i=this.that;if(i.options.selectionModel.fireSelectChange){var r=i.iRows.getSelection(),o=i.iCells.getSelection(),n=e.evt,a=e.ui,l={rows:r,cells:o};a=null==a?l:t.extend(l,a),i._trigger("selectChange",n,a)}},i.getOldRowSel=function(){var t,e=this.that;if((t=this.focusSelection)&&this.isSelected(t)){var i=e.getRowIndx(t);return i.rowData=t.rowData,i}},i.getOldCellSel=function(){var t,e=this.that;if((t=this.focusSelection)&&this.isSelected(t)){var i=t.rowData,r=e.getRowIndx({rowData:i});return r.rowData=i,r.dataIndx=t.dataIndx,r}},i.getNewRowSel=function(){var e=this.that,i=document.activeElement?t(document.activeElement):null;if(i&&i.hasClass("pq-grid-row")){if(i.closest(".pq-grid")[0]==e.element[0]){var r=e.getRowIndx({$tr:i});return r.$tr=i,r}}},i.getNewCellSel=function(){var e=this.that,i=document.activeElement?t(document.activeElement):null;if(i&&i.hasClass("pq-grid-cell")){if(i.closest(".pq-grid")[0]==e.element[0]){var r=e.getCellIndices({$td:i});return r.$td=i,r}}},i.getFocusSelection=function(t){return this instanceof r?t&&!0===t.old?this.getOldRowSel():this.getNewRowSel():this instanceof o?t&&!0===t.old?this.getOldCellSel():this.getNewCellSel():void 0},i.getFirstSelection=function(){var t=this.firstSelection;if(t&&this.isSelected(t))return t;this.refresh();var e=this.selection;return e.length?(this.firstSelection=e[0],e[0]):void 0},i.getLastSelection=function(){var t=this.lastSelection;if(t){var e=this.that;return!(t.rowData!=e.getRowData({rowIndx:rowIndx})||!this.isSelected(t))&&t}return null},i.getLastSelectionCurPage=function(){var t=this.lastSelection;if(t&&this.isSelected(t)){var e=t.rowIndx,i=this.that.options.pageModel;if(i.type){var r=i.curPage,o=i.rPP;return Math.ceil((e+1)/o)==r?t:null}return t}return null},i.getSelection=function(){return this.refresh(),this.selection},i.getSelectionCurPage=function(){var t=this.that,e=this.getSelection(),i=[],r=t.options.pageModel;if(r.type){for(var o=r.curPage,n=r.rPP,a=0;a<e.length;a++){var l=e[a],s=l.rowIndx;Math.ceil((s+1)/n)==o&&i.push(l)}return i}return e},i.inViewRow=function(t){var e=this.that,i=this.options,r=i.groupModel,o=e.rowIndxOffset,n=i.freezeRows,a=e.initV,l=e.finalV;if(t<n)return!0;if(r){var s=e.dataGM;if(s&&s.length)for(var d=a;d<=l;d++){var h=s[d].rowIndx-o;if(null!=h&&h==t)return!0}return!1}return t>=a&&t<=l},i.setDirty=function(){};var r=function(t){this.that=t,this.options=t.options,this.selection=[]};t.paramquery.cRows=r;var o=function(t){this.options=t.options,this.that=t,this.selection=[]};t.paramquery.cCells=o;var n=o.prototype=new e,a=r.prototype=new e;a.extendSelection=function(t){var e=this.that,i=t.rowIndx,r=e.options.selectionModel.mode,o=t.evt,n=this.getFirstSelection();if(null!=n){if("single"!=r){var a=n.rowIndx,l=a,s=i;a>i&&(l=i,s=a),this.selectRange({initRowIndx:l,finalRowIndx:s,evt:o}),this.add({rowIndx:i})}}else e.setSelection({rowIndx:i})},a.refresh=function(){this.selection=[];var t=this.that,e=t.options,i=e.dataModel,r="remote"==e.pageModel.type,o=t.rowIndxOffset,n=[],a=i.data;if(a){for(var l=0,s=a.length;l<s;l++){var d=a[l];if(d.pq_rowselect){var h=r?l+o:l;n.push({rowIndx:h,rowData:d})}}this.selection=n}},a.replace=function(t){var e=t.rowIndx,i=null==t.offset?this.that.getRowIndxOffset():t.offset,r=e-i;t.$tr,t.evt;t.offset=i,t.rowIndxPage=r,this.removeAll({raiseEvent:!0}),this.add(t)},a.indexOf=function(t){this.refresh();for(var e=t.rowIndx,i=this.selection,r=0;r<i.length;r++)if(i[r].rowIndx==e)return r;return-1},a.isSelected=function(t){var e=this.that,i=t.rowData||e.getRowData(t);return i?null!=i.pq_rowselect&&i.pq_rowselect:null},a._boundRow=function(t){var e=t.rowIndxPage,i=this.that,r=null==t.$tr?i.getRow({rowIndxPage:e}):t.$tr;return null!=r&&0!=r.length&&(r.addClass("pq-row-select ui-state-highlight"),r)},a.selectRange=function(t){this.that;for(var e=t.initRowIndx,i=t.finalRowIndx,r=t.evt,o=this.getSelection().slice(0),n=[],a=0;a<o.length;a++){var l=o[a];((d=l.rowIndx)<e||d>i)&&n.push({rowIndx:d,rowData:l.rowData})}if(this.remove({rows:n,evt:r}),n=[],e>i){var s=e;e=i,i=s}for(var d=e;d<=i;d++)n.push({rowIndx:d,evt:r});this.add({rows:n,evt:r})},n._addToData=function(t){var e=t.dataIndx,i=this.that.getRowData(t);i.pq_cellselect||(i.pq_cellselect={}),i.pq_cellselect[e]=!0},n.extendSelection=function(t){var e=this.that,i=this.getFirstSelection(),r=t.rowIndx,o=t.colIndx,n=e.options.selectionModel.mode,a=t.evt;if(null!=i){var l=i.rowIndx,s=e.getColIndx({dataIndx:i.dataIndx}),d=l,h=r,c=s,u=o;l>r&&(d=r,h=l),"range"==n?(l>r&&(c=o,u=s),r==l&&o<s&&(c=o,u=s),this.selectRange({initRowIndx:d,initColIndx:c,finalRowIndx:h,finalColIndx:u,evt:a}),this.add({rowIndx:r,colIndx:o})):"block"==n&&(s>o&&(c=o,u=s),this.selectBlock({initRowIndx:d,initColIndx:c,finalRowIndx:h,finalColIndx:u,evt:a}),this.add({rowIndx:r,colIndx:o}))}else e.setSelection({rowIndx:r,colIndx:o})},n._removeFromData=function(t){var e=t.rowData;e&&e.pq_cellselect&&delete e.pq_cellselect[t.dataIndx]},n.removeAll=function(){this.refresh();var t=this.selection.slice(0);this.remove({cells:t}),this.lastSelection=null},a.removeAll=function(t){if(t&&null!=t.page)throw"objP.page not supported in removeAll";var e=this.that,i=!t||null==t.all||t.all;this.refresh();var r=this.selection.slice(0);if(i)this.remove({rows:r}),this.lastSelection=null;else{for(var o=[],n=e.rowIndxOffset,a=e.pdata,l=a?a.length:0,s=0,d=r.length;s<d;s++){var h=r[s],c=h.rowIndx-n;if(c>=0){if(!(c<l))break;o.push(h)}}this.remove({rows:o})}},n.isSelected=function(t){var e=this.that,i=t.rowData||e.getRowData(t),r=t.dataIndx,o=t.colIndx;return null==o&&null==r?null:null==i?null:(r=null==r?e.colModel[o].dataIndx:r,!(!i.pq_cellselect||!i.pq_cellselect[r]))},n.refresh=function(){this.selection=[];var t=this.that,e=t.options.dataModel,i=t.options.pageModel,r=e.data,o=[],n="remote"==i.type,a=t.rowIndxOffset,l=this.that.colModel,s=l.length;if(r){for(var d=[],h=[],c=[],u=0;u<s;u++){var f=l[u],p=f.dataIndx;c[u]=p,d[p]=u,h[p]=f}u=0;for(var g=r.length;u<g;u++){var v=r[u],w=v.pq_cellselect;if(w)for(var x=n?u+a:u,I=0;I<s;I++){w[p=c[I]]&&o.push({rowIndx:x,rowData:v,dataIndx:p,colIndx:I,column:l[I]})}}this.selection=o}},n.replace=function(t){var e=t.rowIndx,i=(t.colIndx,null==t.offset?this.that.getRowIndxOffset():t.offset),r=e-i;t.$td,t.evt;t.rowIndxPage=r,t.offset=i,this.removeAll({raiseEvent:!0}),this.add(t)},n.inViewCell=function(t,e){var i=this.that,r=this.options.freezeCols;return!!this.inViewRow(t)&&(e<r||e>=i.initH&&e<=i.finalH)},n._add=function(t){var e,i=this.that,r=t.rowIndx,o=t.rowIndxPage,n=t.rowData||i.getRowData(t),a=i.rowIndxOffset,l=(r=null==r?o+a:r,o=null==o?r-a:o,t.colIndx),s=t.dataIndx,d=(l=null==l?i.getColIndx({dataIndx:s}):l,i.colModel[l]),h=(s=null==s?d.dataIndx:s,t.evt),c=this.isSelected({rowData:n,dataIndx:s});if(null==c)return!1;var u=this.inViewCell(o,l);if(!1===c){if(u){var f=i.getCell({rowIndxPage:o,colIndx:l});f&&f.addClass("pq-cell-select ui-state-highlight")}this._addToData({rowData:n,dataIndx:s}),!1!==t.trigger&&i._trigger("cellSelect",h,{rowIndx:r,rowIndxPage:o,colIndx:l,dataIndx:s,column:d,rowData:n}),e=!0}return this.lastSelection={rowIndx:r,dataIndx:s,rowData:n},!1!==t.focus&&u&&(f&&f.length||(f=i.getCell({rowIndxPage:o,dataIndx:s})),f&&f.length&&(f.attr("tabindex","0"),f.focus(),i._fixTableViewPort(),this.focusSelection={rowData:n,rowIndx:r,dataIndx:s})),t.setFirst&&(this.firstSelection={rowIndx:r,rowData:n,dataIndx:s}),e?{rowIndx:r,rowData:n,dataIndx:s,colIndx:l,column:d}:void 0},a._add=function(e){var i,r=this.that,o=e.rowIndx,n=e.rowIndxPage,a=r.rowIndxOffset,l=(o=null==o?n+a:o,n=null==n?o-a:n,null==l?r.getRowData(e):l),s=e.$tr,d=e.evt,h=this.isSelected({rowData:l});if(e.rowIndxPage=n,null==h)return!1;var c=this.inViewRow(n);if(!1===h){if(c)s=this._boundRow(e);l.pq_rowselect=!0,!1!==e.trigger&&r._trigger("rowSelect",d,{rowIndx:o,rowIndxPage:n,rowData:l,$tr:s}),i=!0}return this.lastSelection={rowIndx:o,rowData:l},!1!==e.focus&&c&&(s&&s.length||(s=r.getRow({rowIndxPage:n})),s&&((s=t(s[0])).attr("tabindex","0"),s.focus(),r._fixTableViewPort(),this.focusSelection={rowData:l,rowIndx:o})),e.setFirst&&(this.firstSelection={rowIndx:o,rowData:l}),i?{rowIndx:o,rowData:l}:void 0},n.add=function(t){var e=this.that,i=t.evt,r=t.cells,o=!1,n=[];if(r&&"function"==typeof r.push){for(var a=0,l=r.length;a<l;a++){var s=r[a];s.trigger=!1,(o=this._add(s))&&n.push(o)}n.length&&(o=!0,e._trigger("cellSelect",i,{cells:n}))}else o=this._add(t);o&&(e._fixIE(),this.triggerSelectChange({evt:i}))},a.add=function(t){var e=this.that,i=t.evt,r=t.rows,o=!1,n=[];if(r&&"function"==typeof r.push){for(var a=0,l=r.length;a<l;a++){var s=r[a];s.trigger=!1,(o=this._add(s))&&n.push(o)}n.length&&(o=!0,e._trigger("rowSelect",i,{rows:n}))}else o=this._add(t);o&&(e._fixIE(),this.triggerSelectChange({evt:i}))},n._remove=function(t){var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,n=(i=null==i?r+o:i,r=null==r?i-o:r,t.rowData||e.getRowData(t)),a=t.colIndx,l=t.dataIndx,s=(a=null==a?e.getColIndx({dataIndx:l}):a,null==(s=t.column)?e.colModel[a]:s),d=(l=null==l?s.dataIndx:l,t.evt);if(this.isSelected({rowData:n,dataIndx:l})){if(this.inViewCell(r,a)){var h=e.getCell({rowIndxPage:r,colIndx:a,all:!0});h&&(h.removeClass("pq-cell-select ui-state-highlight"),h.removeAttr("tabindex"))}return this._removeFromData({rowData:n,dataIndx:l}),!1!==t.trigger&&e._trigger("cellUnSelect",d,{rowIndx:i,colIndx:a,dataIndx:l,rowData:n}),{rowIndx:i,rowData:n,dataIndx:l,colIndx:a,column:s}}},a._remove=function(t){var e=this.that,i=t.rowIndx,r=t.rowIndxPage,o=e.rowIndxOffset,n=(i=null==i?r+o:i,r=null==r?i-o:r,null==(n=t.rowData)?e.getRowData(t):n),a=t.$tr,l=t.evt;if(this.isSelected({rowData:n})){if(this.inViewRow(r)){(a=e.getRow({rowIndxPage:r}))&&(a.removeClass("pq-row-select ui-state-highlight"),a.removeAttr("tabindex"))}return n.pq_rowselect=!1,!1!==t.trigger&&e._trigger("rowUnSelect",l,{rowIndx:i,rowData:n,$tr:a}),{rowIndx:i,rowData:n}}},n.remove=function(t){var e=t.cells,i=t.evt,r=!1;if(e&&"function"==typeof e.push){for(var o=[],n=0,a=e.length;n<a;n++){var l=e[n];l.trigger=!1,(r=this._remove(l))&&o.push(r)}o.length&&(r=!0,this.that._trigger("cellUnSelect",i,{cells:o}))}else r=this._remove(t);r&&this.triggerSelectChange({evt:i})},a.remove=function(t){var e=t.rows,i=t.evt,r=!1;if(e&&"function"==typeof e.push){for(var o=[],n=0,a=e.length;n<a;n++){var l=e[n];l.trigger=!1,(r=this._remove(l))&&o.push(r)}o.length&&(r=!0,this.that._trigger("rowUnSelect",i,{rows:o}))}else r=this._remove(t);r&&this.triggerSelectChange({evt:i})},n.indexOf=function(t){this.refresh();var e=t.rowIndx,i=this.that,r=null==t.dataIndx?i.colModel[t.colIndx].dataIndx:t.dataIndx;t.dataIndx=r;for(var o=this.selection,n=0;n<o.length;n++){var a=o[n];if(a.rowIndx==e&&a.dataIndx==r)return n}return-1},n.selectAll=function(t){var e=this.that,i=!(!t||!t.all),r=i?this.options.dataModel.data:e.pdata,o=e.rowIndxOffset,n=e.colModel,a=n.length,l=[],s=function(t,e){for(var i=0;i<a;i++){var r=n[i];if(!r.hidden){var o={rowIndx:e,rowData:t,colIndx:i,dataIndx:r.dataIndx,focus:!1};l.push(o)}}};if(r){for(var d=0,h=r.length;d<h;d++)var c=r[d];if(i){var u="remote"==this.options.pageModel.type;for(d=0,h=r.length;d<h;d++){c=r[d];var f=d;u&&(f=d+o),s(c,f)}}else for(d=0,h=r.length;d<h;d++){s(c=r[d],f=d+o)}this.add({cells:l})}},a.selectAll=function(t){var e=this.that,i=!(!t||!t.all),r=i?this.options.dataModel.data:e.pdata,o=[];if(r){if(i)for(var n="remote"==this.options.pageModel.type,a=0,l=r.length;a<l;a++){var s={rowData:r[a],focus:!1};n?s.rowIndxPage=a:s.rowIndx=a,o.push(s)}else for(a=0,l=r.length;a<l;a++){var d=r[a];o.push({rowIndxPage:a,rowData:d,focus:!1})}this.add({rows:o})}},n.selectRange=function(t){for(var e=this.that,i=t.initRowIndx,r=t.initColIndx,o=t.finalRowIndx,n=t.finalColIndx,a=e.colModel,l=a.length,s=this.getSelection().slice(0),d=[],h=0;h<s.length;h++){var c=s[h],u=c.rowIndx,f=c.dataIndx,p=e.getColIndx({dataIndx:f});u<i||u>o?d.push({rowIndx:u,colIndx:p,dataIndx:f}):u==i&&p<r?d.push({rowIndx:u,colIndx:p,dataIndx:f}):u==o&&p>n&&d.push({rowIndx:u,colIndx:p,dataIndx:f})}this.remove({cells:d}),d=[];for(p=0;p<l;p++){var g=a[p];if(!g.hidden){f=g.dataIndx,u=i;do{if(u==i&&p<r);else{if(u==o&&p>n)break;d.push({rowIndx:u,colIndx:p,dataIndx:f,focus:!1})}u++}while(u<=o)}}this.add({cells:d})},n.selectBlock=function(t){for(var e=this.that,i=t.initRowIndx,r=t.initColIndx,o=t.finalRowIndx,n=t.finalColIndx,a=t.evt,l=this.getSelection().slice(0),s=e.colModel,d=[],h=0;h<l.length;h++){var c=l[h],u=c.rowIndx,f=c.dataIndx;(p=e.getColIndx({dataIndx:f}))<r||p>n?d.push({rowIndx:u,colIndx:p,dataIndx:f}):(u<i||u>o)&&d.push({rowIndx:u,colIndx:p,dataIndx:f})}this.remove({cells:d}),d=[];for(var p=r;p<=n;p++){var g=s[p];f=g.dataIndx;if(!g.hidden){u=i;do{d.push({rowIndx:u,colIndx:p,dataIndx:f,focus:!1}),u++}while(u<=o)}}this.add({cells:d,evt:a})}}(jQuery),function(t){var e=(t.paramquery.cCheckBoxColumn=function(t,e){var i=this;this.that=t,this.options=t.options,this.column=e,this.cb=e.cb=e.cb||{all:!1,header:!0},this.dataIndx=e.dataIndx;var r=t.widgetEventPrefix.toLowerCase(),o=t.element,n=t.eventNamespace;o.on(r+"dataavailable"+n,function(t,e){if(i.belongs(t))return i._onDataAvailable(t,e)}),o.on(r+"cellclick"+n,function(t,e){if(i.belongs(t))return i.cellClick(t,e)}),this.cb.reverse&&(o.on(r+"rowselect"+n,function(t,e){if(i.belongs(t))return i.rowSelect(t,e)}),o.on(r+"rowunselect"+n,function(t,e){if(i.belongs(t))return i.rowUnSelect(t,e)})),o.on(r+"cellkeydown"+n,function(t,e){if(i.belongs(t))return i.cellKeyDown(t,e)}),o.on(r+"refresh"+n+" "+r+"refreshrow"+n,function(t,e){if(i.belongs(t))return i.refreshHeader(t,e)})}).prototype=new t.paramquery.cClass;e.hasHeaderChkBox=function(){return this.cb.header},e.setValCBox=function(){if(this.hasHeaderChkBox()){for(var t=this.that,e=this.options,i=this.dataIndx,r=this.cb.all?e.dataModel.data:t.pdata,o=null,n=0,a=0,l=0,s=r.length;l<s;l++){r[l][i]?n++:a++}n==s?o=!0:a==s&&(o=!1),this.$inp.pqval({val:o})}},e.onHeaderClick=function(e){var i=this.that,r=t(e.currentTarget).find("input"),o=this.column,n=o.dataIndx,a=i.getColIndx({dataIndx:n}),l=this.cb.all?i.options.dataModel.data:i.pdata,s={column:o,dataIndx:n,source:"header"},d=!!t(e.target).is("input"),h=r.is(":checked"),c=h;if(d||(c=!h),c){if(!1===i._trigger("beforeCheck",e,s))return!1;d||r.pqval({val:!0});for(var u=0,f=l.length;u<f;u++){l[u][n]=!0}i.$cont.find("td[pq-col-indx="+a+"] input").prop("checked",!0),!1!==i._trigger("check",e,s)&&this.selectAllRows()}else{if(!1===i._trigger("beforeunCheck",e,s))return!1;d||r.pqval({val:!1});for(u=0,f=l.length;u<f;u++){l[u][n]=!1}i.$cont.find("td[pq-col-indx="+a+"] input").prop("checked",!1),!1!==i._trigger("unCheck",e,s)&&this.unSelectAllRows()}},e.refreshHeader=function(t,e){if(this.hasHeaderChkBox()){var i=this.that;if(i.pdata){var r=this,o=i.getCellHeader({dataIndx:this.dataIndx});if(o){o.html("<input type='checkbox'/>");this.$inp=o.find("input");o.click(function(t){return r.onHeaderClick(t)}),this.setValCBox()}}}},e.selectAllRows=function(){var t=this.that,e=this.cb.all;t.iRows.selectAll({all:e})},e.unSelectAllRows=function(){var t=this.that,e=this.cb.all;t.iRows.removeAll({all:e})},e._onDataAvailable=function(){var t=this.that,e=this.options,i=e.dataModel.data,r="remote"==e.pageModel.type?t.rowIndxOffset:0,o=this.column,n=o.dataIndx;if(null!=n&&i){for(var a=[],l=0,s=i.length;l<s;l++){(d=i[l])[n]&&a.push({rowIndx:l+r,rowData:d})}if(!1!==t._trigger("check",null,{rows:a,column:o,dataIndx:n,source:"dataAvailable"}))for(l=0;l<s;l++){var d;(d=i[l])[n]&&(d.pq_rowselect=!0)}}},e.cellClick=function(t,e){if(e.dataIndx===this.dataIndx)return this.raiseEvent(t,e)},e.rowSelect=function(t,e){var i=this.that,r=e.rows,o=e.rowData,n=this._findSelectionIndx();if(r)for(var a=0,l=r.length;a<l;a++){var s=r[a],d=s.rowIndx;(o=s.rowData)[n]=!0,i.refreshCell({rowIndx:d,dataIndx:n})}else o&&(o[n]=!0,d=e.rowIndx,i.refreshCell({rowIndx:d,dataIndx:n}));this.setValCBox()},e.rowUnSelect=function(t,e){var i=this.that,r=e.rows,o=e.rowData,n=this._findSelectionIndx();if(r)for(var a=0,l=r.length;a<l;a++){var s=r[a],d=s.rowIndx;(o=s.rowData)[n]=!1,i.refreshCell({rowIndx:d,dataIndx:n})}else o&&(o[n]=!1,d=e.rowIndx,i.refreshCell({rowIndx:d,dataIndx:n}));this.setValCBox()},e.raiseEvent=function(e,i){var r=this.that,o=i.rowData,n=!!t(e.originalEvent.target).is("input"),a=i.rowIndx,l=i.dataIndx;if(o[l]){if(!1===r._trigger("beforeunCheck",e,i))return!1;if(o[l]=!1,!n){r.getCell(i).find("input").pqval({val:!1})}!1!==r._trigger("unCheck",e,i)&&r.iRows.remove({rowIndx:a})}else{if(!1===r._trigger("beforeCheck",e,i))return!1;if(o[l]=!0,!n){r.getCell(i).find("input").pqval({val:!0})}!1!==r._trigger("check",e,i)&&r.iRows.add({rowIndx:a})}if(this.setValCBox(),!n)return!1},e.cellKeyDown=function(t,e){if((e.dataIndx=this.dataIndx)&&(13==t.keyCode||32==t.keyCode))return this.raiseEvent(t,e)}}(jQuery),function(t){function e(t){this.that=t;var e=this,i=t.element,r=t.widgetEventPrefix.toLowerCase(),o=t.eventNamespace;i.on(r+"contmousedown"+o,function(t,i){if(e.belongs(t))return e._onContMouseDown(t,i)}),i.on(r+"mousedrag"+o,function(t,i){if(e.belongs(t)&&e.swipedown)return e._onMouseDrag(t,i)}),i.on(r+"mousestop"+o,function(t,i){return e._onMouseStop(t,i)}),i.on(r+"mousepqup."+o,function(t,i){return e._onMousePQUp(t,i)}),i.on(r+"rowmousedown"+o,function(t,i){if(e.belongs(t))return e._onRowMouseDown(t,i)}),i.on(r+"cellmousedown"+o,function(t,i){if(e.belongs(t))return e._onCellMouseDown(t,i)}),i.on(r+"beforetableview"+o,function(t,i){if(e.belongs(t))return e._beforeTableView(t,i)}),i.on(r+"refresh"+o,function(t,i){if(e.belongs(t))return e._onRefresh(t,i)}),i.on(r+"cellmouseenter"+o,function(t,i){if(e.belongs(t))return e._onCellMouseEnter(t,i)}),i.on(r+"rowmouseenter"+o,function(t,i){if(e.belongs(t))return e._onRowMouseEnter(t,i)})}t.paramquery.cMouseSelection=e;var i=e.prototype=new t.paramquery.cClass;i._beforeTableView=function(t,e){var i=this.that,r=i.getFocusElement();if(this.lastFocus=null,r&&r.$grid){var o=r.$ae;if(o.hasClass("pq-grid-row")){var n=i.getRowIndx({$tr:o});this.lastFocus=n}else if(o.hasClass("pq-grid-cell")){n=i.getCellIndices({$td:o});this.lastFocus=n}}},i._onRefresh=function(t,e){var i,r=this.that,o=this.lastFocus;o&&(i=null!=o.dataIndx?r.getCell(o):r.getRow(o))&&i.length&&r.inViewPort(i)&&i.attr("tabindex","0").focus()},i._onCellMouseDown=function(t,e){var i=this.that,r=e.rowIndx,o=e.colIndx,n=i.options.selectionModel,a=n.type,l=n.mode;if("cell"==a&&null!=o)return t.shiftKey?(i.iCells.extendSelection({rowIndx:r,colIndx:o,mode:l,evt:t}),t.preventDefault()):(t.ctrlKey||t.metaKey)&&"single"!=l?i.iCells.isSelected({rowIndx:r,colIndx:o})?i.iCells.remove({rowIndx:r,colIndx:o}):i.setSelection({rowIndx:r,colIndx:o}):(this.mousedown={rowIndx:r,colIndx:o},i.setSelection(null),i.setSelection({rowIndx:r,colIndx:o,setFirst:!0})),!0},i._onCellMouseEnter=function(e,i){var r=this.that,o=r.options.selectionModel,n=o.type;t.paramquery,o.mode;if("cell"==n&&this.mousedown){var a=this.mousedown,l=a.r1,s=a.c1,d=i.rowIndx,h=i.colIndx;if(l==d&&s==h)return;if(a.r2==d&&a.c2==h)return;this.mousedown.r2=d,this.mousedown.c2=h,r.scrollCell({rowIndx:d,colIndx:h}),r.iCells.extendSelection({rowIndx:d,colIndx:h,evt:e})}},i._onRowMouseEnter=function(t,e){var i=this.that;if("row"==i.options.selectionModel.type&&this.mousedown){this.mousedown;var r=this.mousedown.r1,o=e.rowIndx;if(r==o)return;if(this.mousedown.r2==o)return;this.mousedown.r2=o,i.scrollRow({rowIndx:o}),i.iRows.extendSelection({rowIndx:o,evt:t})}},i._onRowMouseDown=function(t,e){var i=this.that,r=e.rowIndx,o=i.options.selectionModel,n=o.mode;if("row"==o.type&&null!=r)return t.shiftKey?(i.iRows.extendSelection({rowIndx:r,evt:t}),t.preventDefault()):(t.ctrlKey||t.metaKey)&&"single"!=n?i.iRows.isSelected({rowIndx:r})?i.iRows.remove({rowIndx:r}):i.setSelection({rowIndx:r}):(this.mousedown={r1:r,y1:t.pageY,x1:t.pageX},i.setSelection(null),i.setSelection({rowIndx:r,setFirst:!0})),!0},i._onContMouseDown=function(t,e){return this.that.options.swipeModel.on&&(this._stopSwipe(!0),this.swipedown={x:t.pageX,y:t.pageY}),!0},i._onMousePQUp=function(t,e){this.that;this.mousedown=null},i._stopSwipe=function(t){t&&(this.swipedown=null,this.swipedownPrev=null),window.clearInterval(this.intID),this.intID=null},i._onMouseStop=function(t,e){var i=this,r=this.that;if(this.swipedownPrev){var o=r.options.swipeModel,n=this.swipedownPrev,a=n.ts,l=(new Date).getTime()-a,s=n.x,d=n.y,h=t.pageX,c=t.pageY,u=h-s,f=c-d;if(Math.sqrt(u*u+f*f)/l>o.ratio){var p=0,g=o.repeat;i._stopSwipe(),i.intID=window.setInterval(function(){p+=o.speed,--g<=0&&i._stopSwipe(!0);var t=h+p*u/l,e=c+p*f/l;i._onMouseDrag({pageX:t,pageY:e})},50)}else i.swipedown=null,i.swipedownPrev=null}},i._onMouseDrag=function(e,i){var r=this.that,o=(t.paramquery,r.options);if(this.swipedown){var n=this.swipedown,a=n.x,l=n.y,s=e.pageX,d=e.pageY;this.swipedownPrev={x:a,y:l,ts:(new Date).getTime()},r.$td_edit&&r.quitEditMode({silent:!0}),o.virtualY||(this._scrollVertSmooth(l,d),r._syncScrollBarVert()),o.virtualX||(this._scrollHorSmooth(a,s),r._syncScrollBarHor()),n.x=s,n.y=d}return!0},i.updateTableY=function(t){if(0==t)return!1;var e=this.that,i=e.getTableForVertScroll(),r=e.$cont,o=e._getScollBarHorizontalHeight(),n=r.data("offsetHeight")-o;if(!i||!i.length)return!1;var a=i.data("offsetHeight"),l=parseInt(i.css("marginTop"))+t;if(l>=0)i.css({marginTop:-1});else if(t<0&&n-a-l>0)if(n-i[0].offsetHeight-l>0){var s=n-i[0].offsetHeight;s<0&&i.css({marginTop:s})}else i.css({marginTop:l});else i.css({marginTop:l});return!0},i._scrollVertSmooth=function(t,e){t!=e&&this.updateTableY(e-t)},i._scrollHorSmooth=function(t,e){if(t!=e){var i=this.that,r=e-t,o=i.getTableForHorScroll(),n=i.getTableHeaderForHorScroll(),a=i.$cont,l=i._getSBWidth(),s=a.data("offsetWidth")-l;if(o||n){var d=o||n,h=d.data("scrollWidth"),c=parseInt(d.css("marginLeft"))+r;c>0?(o&&o.css({marginLeft:0}),n&&n.css({marginLeft:0})):s-h-c>0?s-h<=0&&(o&&o.css("marginLeft",s-h),n&&n.css("marginLeft",s-h)):(o&&o.css("marginLeft",c),n&&n.css("marginLeft",c))}}}}(jQuery),function(t){var e=null,i=!1,r="",o=t.paramquery.pqGrid.prototype,n=o.options;o.copy=function(){(e=new a(this)).copy(),e=null},o.paste=function(){(e=new a(this)).paste(),e=null},n.pasteModel=n.pasteModel||{on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"},n.copyModel=n.copyModel||{on:!0,header:!0,zIndex:1e4};var a=function(t,e){var i;this.that=t,e&&e.hasClass("pq-grid-row")?(this.rowIndx=t.getRowIndx({$tr:e}).rowIndx,this.dataIndx=null):e&&e.hasClass("pq-grid-cell")?(i=t.getCellIndices({$td:e}),this.rowIndx=i.rowIndx,this.dataIndx=i.dataIndx):(this.rowIndx=null,this.dataIndx=null)},l=a.prototype;l.createClipBoard=function(){var e=t("#pq-grid-excel-div"),i=this.that.options.copyModel,r=t("#pq-grid-excel");0==r.length&&(e=t("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+i.zIndex+";'/>").appendTo(document.body),(r=t("<textarea id='pq-grid-excel' autocomplete='off'  style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(e)).css({opacity:0})),r.select()},l.destroyClipBoard=function(){var e,i=this.that,r=i.iCells.getFocusSelection({old:!0});r?e=i.getCell({rowIndx:r.rowIndx,dataIndx:r.dataIndx}):(r=i.iRows.getFocusSelection({old:!0}))&&(e=i.getRow({rowIndx:r.rowIndx}));var o=t(window).scrollTop(),n=t(window).scrollLeft();e?e.attr("tabindex",0).focus():i.$cont.focus();var a=t(window).scrollTop(),l=t(window).scrollLeft();o==a&&n==l||window.scrollTo(n,o)},l.clearClipBoard=function(){t("#pq-grid-excel").val("")},l.copy=function(){var e=t("#pq-grid-excel"),i=this.that,o=i.options.copyModel,n=i.colModel,a=n.length,l=[],s=[];if(o.on){for(var d=0,h=(l=i.iRows.getSelection()).length;d<h;d++){for(var c=(w=l[d]).rowData,u=[],f=0;f<a;f++){!1!==(x=n[f]).copy&&u.push(c[x.dataIndx])}var p=u.join("\t");s.push(p)}c=null;var g=null,v=null;for(u=[],d=0,h=(l=i.iCells.getSelection()).length;d<h;d++){g=(w=l[d]).rowIndx,c=w.rowData;var w,x=w.column,I=w.dataIndx;if(!1!==x.copy){if(null!=v&&g!=v){p=u.join("\t");u=[],s.push(p),v=g}else null==v&&(v=g);u.push(c[I])}}s.push(u.join("\t"));p=s.join("\n");e.length&&(e.val(p),e.select()),r=p}},l.paste=function(){var e,i,o=this.that,n=t("#pq-grid-excel"),a=(e=(e=n.length?n.val():r).replace(/\n$/,"")).split("\n"),l=a.length,s=o.colModel,d=o.options.pasteModel,h="row",c=s.length;if(d.on&&0!=e.length&&0!=l){var u={rows:a};if(!1===o._trigger("beforePaste",null,u))return!1;var f,p,g,v,w=d.type,x=o.iRows.getSelectionCurPage();x&&x.length||(h="cell",x=o.iCells.getSelectionCurPage()),x&&x.length?(f=x[0].rowIndx,g=x[x.length-1].rowIndx,"cell"==h&&(p=o.getColIndx({dataIndx:x[0].dataIndx}),v=o.getColIndx({dataIndx:x[x.length-1].dataIndx}))):(f=0,g=0,p=0,v=0);var I,m;"replace"==w?(I=f,"updateElseAdd",m=g-f+1<l?"extend":"repeat"):"append"==w?(I=g+1,m="extend","addRow"):"prepend"==w&&(I=f,m="extend","addRow");for(var _,b,y="extend"==m?l:g-f+1,q=0,C=[],D=0,M=0;M<y;M++){var R=a[q],P=M+I,$="replace"==w?o.getRowData({rowIndx:P}):null,S=$?{}:null,T={};void 0===R&&"repeat"===m&&(R=a[q=0]),q++;var H=R.split("\t");if(!b)if("cell"==h){if(i=H.length,_=v-p+1<H.length?"extend":"repeat",b="extend"==_?i:v-p+1,isNaN(b))throw"lenH NaN. assert failed.";b+p>c&&(b=c-p)}else b=c,p=0;var k=0,E=0,V=0,z=b;for(E=0;E<z;E++){var L=s[E+p],O=H[k],W=L.dataIndx;L.hidden?"extend"==_&&z+p<c&&z++:(void 0===O&&"repeat"===_&&(O=H[k=0]),k++,T[W]=O,S&&(S[W]=$[W]))}if(0==t.isEmptyObject(T)){var B="update";null==$&&(B="add"),C.push({newRow:T,rowIndx:P,rowData:$,oldRow:S,type:B}),D++}}u={rowList:C,source:"paste",allowInvalid:d.allowInvalid,validate:d.validate};o._digestData(u),d.select&&("cell"==h?o.iCells.selectBlock({initRowIndx:I,finalRowIndx:I+D-1,initColIndx:p,finalColIndx:"extend"==_?p+b-1+V:v}):o.iRows.selectRange({initRowIndx:I,finalRowIndx:I+D-1})),o.refreshView();u={rows:a};o._trigger("paste",null,u)}},t(document).unbind(".pqExcel").bind("keydown.pqExcel",function(r){if(r.ctrlKey||r.metaKey){var o=t(r.target);if(!(o.hasClass("pq-grid-row")||o.hasClass("pq-grid-cell")||o.is("#pq-grid-excel")||o.is("div.pq-cont")))return;var n=o.closest(".pq-grid");if(e||o.length&&n.length){if(!e){try{var l=n.pqGrid("getInstance").grid}catch(t){return!0}(e=new a(l,o)).createClipBoard()}if("67"==r.keyCode||"99"==r.keyCode)!0,e.copy();else if("86"==r.keyCode||"118"==r.keyCode)i=!0,e.clearClipBoard(),window.setTimeout(function(){e&&(e.paste(),e.destroyClipBoard(),e=null),i=!1},0);else{var s=t("#pq-grid-excel");if(s.length){document.activeElement==s[0]&&e.that._onKeyPressDown(r)}}}}}).bind("keyup.pqExcel",function(r){var o=r.keyCode;i||!e||r.ctrlKey||r.metaKey||-1==t.inArray(o,[17,91,93,224])||(e.destroyClipBoard(),e=null),!1})}(jQuery),function(t){var e=t.paramquery.pqGrid.prototype.options;e.historyModel=e.historyModel||{on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0};var i=(t.paramquery.cHistory=function(t){var e=this;this.that=t,this.options=t.options,this.records=[],this.counter=0,this.id=0;var i=t.eventNamespace,r=t.widgetEventPrefix.toLowerCase();t.element.on(r+"keydown"+i,function(t,i){if(e.belongs(t))return e._onKeyDown(t,i)}),t.element.on(r+"dataavailable"+i,function(t,i){e.belongs(t)&&"filter"!=i.source&&e.reset()})}).prototype=new t.paramquery.cClass;i._onKeyDown=function(t,e){var i="90",r="89",o=t.ctrlKey||t.metaKey;return o&&t.keyCode==i?(this.undo(),!1):o&&t.keyCode==r?(this.redo(),!1):void 0},i.resetUndo=function(){if(0==this.counter)return!1;this.counter=0;this.that._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})},i.reset=function(){if(0==this.counter&&0==this.records.length)return!1;this.records=[],this.counter=0,this.id=0;this.that._trigger("history",null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})},i.increment=function(){var t=this.records,e=t.length;if(e){var i=t[e-1].id;this.id=i+1}else this.id=0},i.push=function(e){var i=this.canRedo(),r=this.records,o=this.counter;r.length>o&&r.splice(o,r.length-o),r[o]=t.extend({id:this.id},e),this.counter++;var n,a,l=this.that;1==this.counter&&(n=!0),i&&this.counter==r.length&&(a=!1),l._trigger("history",null,{type:"add",canUndo:n,canRedo:a,num_undo:this.counter,num_redo:0})},i.canUndo=function(){return this.counter>0},i.canRedo=function(){return this.counter<this.records.length},i.undo=function(){var t=this.canRedo(),e=this.that,i=this.options.historyModel,r=this.records;if(!(this.counter>0))return!1;this.counter--;for(var o=r[this.counter],n=o.rowList,a=[],l=(o.id,0),s=n.length;l<s;l++){var d=n[l],h=d.newRow,c=d.rowData,u=d.type,f=d.oldRow,p=d.rowIndx;"update"==u?(p=e.getRowIndx({rowData:c}).rowIndx,a.push({type:u,rowIndx:p,rowData:c,oldRow:h,newRow:f})):"add"==u?a.push({type:"delete",rowData:h}):"delete"==u&&a.push({type:"add",rowIndx:p,newRow:c})}e._digestData({history:!1,source:"undo",checkEditable:i.checkEditable,checkEditableAdd:i.checkEditableAdd,allowInvalid:i.allowInvalid,rowList:a});e.refreshView();var g,v;return!1===t&&(g=!0),0==this.counter&&(v=!1),e._trigger("history",null,{canUndo:v,canRedo:g,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0},i.redo=function(){var t=this.canUndo(),e=this.that,i=this.options.historyModel,r=this.counter,o=this.records;if(r==o.length)return!1;for(var n=o[r],a=n.rowList,l=[],s=(n.id,0),d=a.length;s<d;s++){var h=a[s],c=h.newRow,u=h.rowData,f=h.type,p=h.oldRow,g=h.rowIndx;"update"==f?(g=e.getRowIndx({rowData:u}).rowIndx,l.push({type:f,rowIndx:g,rowData:u,oldRow:p,newRow:c})):"add"==f?l.push({type:"add",rowIndx:g,newRow:c}):"delete"==f&&l.push({type:"delete",rowData:u})}e._digestData({history:!1,source:"redo",checkEditable:i.checkEditable,checkEditableAdd:i.checkEditableAdd,allowInvalid:i.allowInvalid,rowList:l});e.refreshView(),this.counter<o.length&&this.counter++;var v,w;return 0==t&&(v=!0),this.counter==this.records.length&&(w=!1),e._trigger("history",null,{canUndo:v,canRedo:w,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0};t.paramquery.pqGrid.prototype.history=function(t){var e=t.method;return this.iHistory[e](t)}}(jQuery),function(t){var e=t.ui.autocomplete.prototype,i=e._renderMenu,r=e._renderItem;e._renderMenu=function(e,r){i.call(this,e,r);var o=this.options.selectItem;if(o&&o.on){var n=void 0===(n=o.cls)?"ui-state-highlight":n,a=this.element.val();a&&n&&t("a",e).filter(function(){return t(this).text()===a}).addClass(n)}},e._renderItem=function(t,e){var i=r.call(this,t,e),o=this.options.highlightText;if(o&&o.on){var n=this.element.val();if(n){var a=new RegExp("("+n+")","i"),l=e.label;if(a.test(l)){var s=void 0===(s=o.style)?"font-weight:bold;":s,d=void 0===(d=o.cls)?"":d;l=l.replace(a,"<span style='"+s+"' class='"+d+"'>$1</span>"),i.find("a").html(l)}}}return i};var o={options:{items:"td.pq-has-tooltip,td[title]",position:{my:"center top",at:"center bottom"},content:function(){var e=t(this),i=e.closest(".pq-grid").pqGrid("getInstance").grid,r=i.getCellIndices({$td:e}),o=r.rowIndx,n=r.dataIndx,a=i.data({rowIndx:o,dataIndx:n,data:"pq_valid"}).data;if(a){var l=a.icon,s=a.msg;s=null!=s?s:"";return(""==l?"":"<span class='ui-icon "+l+" pq-tooltip-icon'></span>")+s}return e.attr("title")}}};o._create=function(){this._superApply();var e=this.element,i=this.eventNamespace;e.on("pqtooltipopen"+i,function(e,i){var r=t(e.target),o=t(e.originalEvent.target);if(o.on("remove",function(t){r.pqTooltip("close",t,!0)}),i.tooltip.css("zIndex",o.zIndex()+5),r.is(".pq-grid")){var n,a=r.pqGrid("getCellIndices",{$td:o}),l=a.rowIndx,s=a.dataIndx;if((n=r.pqGrid("getRowData",{rowIndx:l}))&&(n=n.pq_celldata)&&(n=n[s])&&(n=n.pq_valid)){var d=n,h=d.style,c=d.cls;i.tooltip.addClass(c);var u=i.tooltip.attr("style");i.tooltip.attr("style",u+";"+h)}r.find("div.pq-sb-horiz,div.pq-sb-vert").on("pqscrollbardrag",function(t,e){t.currentTarget=o[0],r.pqTooltip("close",t,!0)})}}),e.on("pqtooltipclose"+i,function(e,i){var r=t(e.target);t(e.originalEvent.target).off("remove"),r.is(".pq-grid")&&r.find("div.pq-sb-horiz,div.pq-sb-vert").off("pqscrollbardrag")})},t.widget("paramquery.pqTooltip",t.ui.tooltip,o)}(jQuery);