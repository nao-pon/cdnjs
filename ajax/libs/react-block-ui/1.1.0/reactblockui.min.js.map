{"version":3,"file":"reactblockui.min.js","sources":["../src/BlockUi.js","../src/Loader.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport DefaultLoader from './Loader';\r\n\r\nconst defaultProps = {\r\n  tag: 'div',\r\n  renderChildren: true,\r\n  loader: DefaultLoader,\r\n};\r\n\r\nclass BlockUi extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.tabbedUpTop = this.tabbedUpTop.bind(this);\r\n    this.tabbedDownTop = this.tabbedDownTop.bind(this);\r\n    this.tabbedUpBottom = this.tabbedUpBottom.bind(this);\r\n    this.tabbedDownBottom = this.tabbedDownBottom.bind(this);\r\n    this.setHelper = this.setRef.bind(this, 'helper');\r\n    this.setBlocker = this.setRef.bind(this, 'blocker');\r\n    this.setTopFocus = this.setRef.bind(this, 'topFocus');\r\n    this.setContainer = this.setRef.bind(this, 'container');\r\n    this.setMessageContainer = this.setRef.bind(this, 'messageContainer');\r\n    this.handleScroll = this.handleScroll.bind(this);\r\n\r\n    this.state = { top: '50%' };\r\n  }\r\n\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    if (nextProps.blocking !== this.props.blocking) {\r\n      if (nextProps.blocking) {\r\n        // blocking started\r\n        if (this.helper && this.helper.parentNode && this.helper.parentNode.contains\r\n          && this.helper.parentNode.contains(document.activeElement)) {\r\n          this.focused = document.activeElement;\r\n          // We cannot just blur to remove focus due to IE bug so we must manually move the focus somewhere else.\r\n          // https://www.tjvantoll.com/2013/08/30/bugs-with-document-activeelement-in-internet-explorer/#blurring-the-body-switches-windows-in-ie9-and-ie10\r\n          if (this.focused && this.focused !== document.body) {\r\n            (window.setImmediate || setTimeout)(() => this.topFocus && this.topFocus.focus());\r\n          }\r\n        }\r\n      } else {\r\n        this.detachListeners();\r\n        const ae = document.activeElement;\r\n        if (this.focused && (!ae || ae === document.body || ae === this.topFocus)) {\r\n          this.focused.focus();\r\n          this.focused = null;\r\n        }\r\n      }\r\n    }\r\n    if (nextProps.keepInView && (nextProps.keepInView !== this.props.keepInView || (nextProps.blocking && nextProps.blocking !== this.props.blocking))) {\r\n      this.attachListeners();\r\n      this.keepInView(nextProps);\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.detachListeners();\r\n  }\r\n\r\n  setRef(name, ref) {\r\n    this[name] = ref;\r\n  }\r\n\r\n  attachListeners() {\r\n    window.addEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  detachListeners() {\r\n    window.removeEventListener('scroll', this.handleScroll);\r\n  }\r\n\r\n  blockingTab(e, withShift = false) {\r\n    // eslint-disable-next-line eqeqeq\r\n    return this.props.blocking && (e.key === 'Tab' || e.keyCode === 9) && e.shiftKey == withShift;\r\n  }\r\n\r\n  tabbedUpTop(e) {\r\n    if (this.blockingTab(e)) {\r\n      this.blocker.focus();\r\n    }\r\n  }\r\n\r\n  tabbedDownTop(e) {\r\n    if (this.blockingTab(e)) {\r\n      e.preventDefault();\r\n      this.blocker.focus();\r\n    }\r\n  }\r\n\r\n  tabbedUpBottom(e) {\r\n    if (this.blockingTab(e, true)) {\r\n      this.topFocus.focus();\r\n    }\r\n  }\r\n\r\n  tabbedDownBottom(e) {\r\n    if (this.blockingTab(e, true)) {\r\n      e.preventDefault();\r\n      this.topFocus.focus();\r\n    }\r\n  }\r\n\r\n  keepInView(props = this.props) {\r\n    if (props.blocking && props.keepInView && this.container) {\r\n      const containerBounds = this.container.getBoundingClientRect();\r\n      const windowHeight = window.innerHeight;\r\n      if (containerBounds.top > windowHeight || containerBounds.bottom < 0) return;\r\n      if (containerBounds.top >= 0 && containerBounds.bottom <= windowHeight) {\r\n        if (this.state.top !== '50%') {\r\n          this.setState({ top: '50%' });\r\n        }\r\n        return;\r\n      }\r\n\r\n      const messageBoundsHeight = this.messageContainer ? this.messageContainer.getBoundingClientRect().height : 0;\r\n      let top = Math.max(Math.min(windowHeight, containerBounds.bottom) - Math.max(containerBounds.top, 0), messageBoundsHeight) / 2;\r\n      if (containerBounds.top < 0) {\r\n        top = Math.min(top - containerBounds.top, containerBounds.height - (messageBoundsHeight / 2));\r\n      }\r\n      if (this.state.top !== top) {\r\n        this.setState({top});\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  handleScroll() {\r\n    this.keepInView();\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      tag: Tag,\r\n      blocking,\r\n      className,\r\n      children,\r\n      message,\r\n      loader: Loader,\r\n      renderChildren,\r\n      keepInView,\r\n      ...attributes\r\n    } = this.props;\r\n\r\n    const classes = blocking ? `block-ui ${className}` : className;\r\n    const renderChilds = !blocking || renderChildren;\r\n\r\n    return (\r\n      <Tag {...attributes} className={classes} aria-busy={blocking} ref={this.setContainer}>\r\n        {blocking &&\r\n        <div tabIndex=\"0\" onKeyUp={this.tabbedUpTop} onKeyDown={this.tabbedDownTop} ref={this.setTopFocus} />}\r\n        {renderChilds && children}\r\n        {blocking &&\r\n        <div className=\"block-ui-container\"\r\n          tabIndex=\"0\"\r\n          ref={this.setBlocker}\r\n          onKeyUp={this.tabbedUpBottom}\r\n          onKeyDown={this.tabbedDownBottom}\r\n        >\r\n          <div className=\"block-ui-overlay\" />\r\n          <div className=\"block-ui-message-container\"\r\n            ref={this.setMessageContainer}\r\n            style={{ top: keepInView ? this.state.top : undefined }}\r\n          >\r\n            <div className=\"block-ui-message\">\r\n              {message}\r\n              {React.isValidElement(Loader) ? Loader : <Loader />}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        }\r\n        <span ref={this.setHelper} />\r\n      </Tag>\r\n    );\r\n  }\r\n}\r\n\r\nBlockUi.propTypes = {\r\n  blocking: PropTypes.bool,\r\n  children: PropTypes.node,\r\n  renderChildren: PropTypes.bool,\r\n  keepInView: PropTypes.bool,\r\n  className: PropTypes.string,\r\n  message: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.node,\r\n  ]),\r\n  loader: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.func,\r\n    PropTypes.node,\r\n  ]),\r\n  tag: PropTypes.oneOfType([\r\n    PropTypes.string,\r\n    PropTypes.func,\r\n  ]),\r\n};\r\nBlockUi.defaultProps = defaultProps;\r\n\r\nexport default BlockUi;\r\n","import React from 'react';\r\n\r\nfunction Loader() {\r\n  return (\r\n    <div className=\"loading-indicator\">\r\n      <span className=\"loading-bullet\">&bull;</span>{' '}\r\n      <span className=\"loading-bullet\">&bull;</span>{' '}\r\n      <span className=\"loading-bullet\">&bull;</span>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Loader;\r\n"],"names":["BlockUi","tabbedUpTop","bind","tabbedDownTop","tabbedUpBottom","tabbedDownBottom","setHelper","setRef","setBlocker","setTopFocus","setContainer","setMessageContainer","handleScroll","state","top","nextProps","blocking","props","helper","parentNode","contains","document","activeElement","focused","body","window","setImmediate","setTimeout","topFocus","focus","detachListeners","ae","keepInView","attachListeners","addEventListener","removeEventListener","withShift","e","key","keyCode","shiftKey","blockingTab","blocker","preventDefault","Math","max","min","container","containerBounds","getBoundingClientRect","windowHeight","innerHeight","bottom","setState","messageBoundsHeight","messageContainer","height","Tag","tag","className","children","message","Loader","loader","renderChildren","attributes","classes","React","ref","tabIndex","onKeyUp","onKeyDown","isValidElement","Component","defaultProps"],"mappings":"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"}