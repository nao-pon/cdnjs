!function(e,t){"use strict";var a={skip:5};e.plugin("vast",function(e){var r=this,n=function(e){var t,a,r;for(a=1;a<arguments.length;a++){t=arguments[a];for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}return e}({},a,e||{});void 0!==r.ads?void 0!==n.url?(r.on("contentupdate",function(){r.vast.getContent(n.url)}),r.on("readyforpreroll",function(){r.vast.preroll()}),r.vast.getContent=function(e){t.client.get(e,function(e){if(e)for(var a=0;a<e.ads.length;a++){var n=e.ads[a];r.vast.companion=void 0;for(var o=0;o<n.creatives.length;o++){var s=n.creatives[o],i=!1,c=!1;if("linear"!==s.type||i)"companion"!==s.type||c||(r.vast.companion=s,c=!0);else if(s.mediaFiles.length){if(r.vast.sources=r.vast.createSourceObjects(s.mediaFiles),!r.vast.sources.length)return void r.trigger("adtimeout");r.vastTracker=new t.tracker(n,s);var v=!1,d=function(){this.vastTracker.load()},l=function(){isNaN(this.vastTracker.assetDuration)&&(this.vastTracker.assetDuration=this.duration()),this.vastTracker.setProgress(this.currentTime())},u=function(){this.vastTracker.setPaused(!1)},p=function(){this.vastTracker.setPaused(!0)},f=function(){t.util.track(n.errorURLTemplates,{ERRORCODE:405}),v=!0,r.trigger("ended")};r.on("canplay",d),r.on("timeupdate",l),r.on("play",u),r.on("pause",p),r.on("error",f),r.one("ended",function(){r.off("canplay",d),r.off("timeupdate",l),r.off("play",u),r.off("pause",p),r.off("error",f),v||this.vastTracker.complete()}),i=!0}}if(r.vastTracker){r.trigger("adsready");break}t.util.track(n.errorURLTemplates,{ERRORCODE:403})}r.vastTracker||r.trigger("adtimeout")})},r.vast.preroll=function(){r.ads.startLinearAdMode(),r.autoplay(!0);var e,a=r.vast.sources;r.src(a),r.vastTracker.clickThroughURLTemplate&&(e=t.util.resolveURLTemplates([r.vastTracker.clickThroughURLTemplate],{CACHEBUSTER:Math.round(1e10*Math.random()),CONTENTPLAYHEAD:r.vastTracker.progressFormated()})[0]);var o=document.createElement("a");o.className="vast-blocker",o.href=e||"#",o.target="_blank",o.onclick=function(){var e=r.vastTracker.clickTrackingURLTemplate;e&&r.vastTracker.trackURLs([e]),r.trigger("adclick")},r.vast.blocker=o,r.el().insertBefore(o,r.controlBar.el());var s=document.createElement("div");s.className="vast-skip-button",n.skip<0&&(s.style.display="none"),r.vast.skipButton=s,r.el().appendChild(s),r.on("timeupdate",r.vast.timeupdate),s.onclick=function(e){if((" "+r.vast.skipButton.className+" ").indexOf(" enabled ")>=0&&r.vast.tearDown(),void 0===Event.prototype.stopPropagation)return!1;e.stopPropagation()},r.one("ended",r.vast.tearDown)},r.vast.tearDown=function(){r.vast.skipButton.parentNode.removeChild(r.vast.skipButton),r.vast.blocker.parentNode.removeChild(r.vast.blocker),r.off("timeupdate",r.vast.timeupdate),r.off("ended",r.vast.tearDown),r.ads.endLinearAdMode()},r.vast.timeupdate=function(e){r.loadingSpinner.el().style.display="none";var t=Math.ceil(n.skip-r.currentTime());t>0?r.vast.skipButton.innerHTML="Skip in "+t+"...":-1===(" "+r.vast.skipButton.className+" ").indexOf(" enabled ")&&(r.vast.skipButton.className+=" enabled",r.vast.skipButton.innerHTML="Skip")},r.vast.createSourceObjects=function(e){var t,a,r={},n=["video/mp4","video/webm","video/ogv"];for(a=0;a<e.length;a++)t=e[a].mimeType,n.indexOf(t)>=0&&(void 0===r[t]&&(r[t]=[]),r[t].push({type:t,src:e[a].fileURL,width:e[a].width,height:e[a].height}));for(var o=[],s=0;s<n.length;s++)if(void 0!==r[t=n[s]])for(a=0;a<r[t].length;a++)o.push(r[t][a]);return o}):r.trigger("adtimeout"):console.log("VAST requires videojs-contrib-ads")})}(window.videojs,window.DMVAST);