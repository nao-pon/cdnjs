!function(t,e){"use strict";var a={skip:5};t.plugin("vast",function(t){var r=this,o=function(t){var e,a,r;for(a=1;a<arguments.length;a++){e=arguments[a];for(r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}return t}({},a,t||{});void 0!==r.ads?void 0!==o.url?(r.on("contentupdate",function(){r.vast.getContent(o.url)}),r.on("readyforpreroll",function(){r.vast.preroll()}),r.vast.getContent=function(t){e.client.get(t,function(t){if(t)for(var a=0;a<t.ads.length;a++){var o=t.ads[a];r.vast.companion=void 0;for(var s=0;s<o.creatives.length;s++){var n=o.creatives[s],i=!1,c=!1;if("linear"!==n.type||i)"companion"!==n.type||c||(r.vast.companion=n,c=!0);else if(n.mediaFiles.length){if(r.vast.sources=r.vast.createSourceObjects(n.mediaFiles),!r.vast.sources.length)return void r.trigger("adtimeout");r.vastTracker=new e.tracker(o,n);var l=!1,v=function(){this.vastTracker.load()},d=function(){isNaN(this.vastTracker.assetDuration)&&(this.vastTracker.assetDuration=this.duration()),this.vastTracker.setProgress(this.currentTime())},u=function(){this.vastTracker.setPaused(!1)},p=function(){this.vastTracker.setPaused(!0)},f=function(){e.util.track(o.errorURLTemplates,{ERRORCODE:405}),l=!0,r.trigger("ended")};r.on("canplay",v),r.on("timeupdate",d),r.on("play",u),r.on("pause",p),r.on("error",f),r.one("ended",function(){r.off("canplay",v),r.off("timeupdate",d),r.off("play",u),r.off("pause",p),r.off("error",f),l||this.vastTracker.complete()}),i=!0}}if(r.vastTracker){r.trigger("adsready");break}e.util.track(o.errorURLTemplates,{ERRORCODE:403})}r.vastTracker||r.trigger("adtimeout")})},r.vast.preroll=function(){r.ads.startLinearAdMode(),r.vast.showControls=r.controls(),r.vast.showControls&&r.controls(!1),r.autoplay(!0);var t,a=r.vast.sources;r.src(a),r.vastTracker.clickThroughURLTemplate&&(t=e.util.resolveURLTemplates([r.vastTracker.clickThroughURLTemplate],{CACHEBUSTER:Math.round(1e10*Math.random()),CONTENTPLAYHEAD:r.vastTracker.progressFormated()})[0]);var s=document.createElement("a");s.className="vast-blocker",s.href=t||"#",s.target="_blank",s.onclick=function(){if(r.paused())return r.play(),!1;var t=r.vastTracker.clickTrackingURLTemplate;t&&r.vastTracker.trackURLs([t]),r.trigger("adclick")},r.vast.blocker=s,r.el().insertBefore(s,r.controlBar.el());var n=document.createElement("div");n.className="vast-skip-button",o.skip<0&&(n.style.display="none"),r.vast.skipButton=n,r.el().appendChild(n),r.on("timeupdate",r.vast.timeupdate),n.onclick=function(t){if((" "+r.vast.skipButton.className+" ").indexOf(" enabled ")>=0&&r.vast.tearDown(),void 0===Event.prototype.stopPropagation)return!1;t.stopPropagation()},r.one("ended",r.vast.tearDown)},r.vast.tearDown=function(){r.vast.skipButton.parentNode.removeChild(r.vast.skipButton),r.vast.blocker.parentNode.removeChild(r.vast.blocker),r.off("timeupdate",r.vast.timeupdate),r.off("ended",r.vast.tearDown),r.ads.endLinearAdMode(),r.vast.showControls&&r.controls(!0)},r.vast.timeupdate=function(t){r.loadingSpinner.el().style.display="none";var e=Math.ceil(o.skip-r.currentTime());e>0?r.vast.skipButton.innerHTML="Skip in "+e+"...":-1===(" "+r.vast.skipButton.className+" ").indexOf(" enabled ")&&(r.vast.skipButton.className+=" enabled",r.vast.skipButton.innerHTML="Skip")},r.vast.createSourceObjects=function(t){var e,a,o,s={},n=r.options().techOrder;for(e=0,a=n.length;e<a;e++){var i=n[e].charAt(0).toUpperCase()+n[e].slice(1);if((o=window.videojs[i])&&o.isSupported())for(var c=0,l=t.length;c<l;c++){var v=t[c],d={type:v.mimeType,src:v.fileURL};o.canPlaySource(d)&&(void 0===s[n[e]]&&(s[n[e]]=[]),s[n[e]].push({type:v.mimeType,src:v.fileURL,width:v.width,height:v.height}))}}var u=[];for(a=0;a<n.length;a++)if(void 0!==s[o=n[a]])for(e=0;e<s[o].length;e++)u.push(s[o][e]);return u}):r.trigger("adtimeout"):console.log("VAST requires videojs-contrib-ads")})}(window.videojs,window.DMVAST);