!function(e,t,r){"use strict";var a={skip:5};t.plugin("vast",function(t){var n=this,o=function(e){var t,r,a;for(r=1;r<arguments.length;r++){t=arguments[r];for(a in t)t.hasOwnProperty(a)&&(e[a]=t[a])}return e}({},a,t||{});return void 0===n.ads?(e.console.error("vast video plugin requires videojs-contrib-ads, vast plugin not initialized"),null):o.url?(n.vast=new function(t,a){return{createSourceObjects:function(r){var a,n,o,s={},i=t.options().techOrder;for(a=0,n=i.length;a<n;a++){var c=i[a].charAt(0).toUpperCase()+i[a].slice(1);if((o=e.videojs[c])&&o.isSupported())for(var l=0,v=r.length;l<v;l++){var u=r[l],d={type:u.mimeType,src:u.fileURL};o.canPlaySource(d)&&(void 0===s[i[a]]&&(s[i[a]]=[]),s[i[a]].push({type:u.mimeType,src:u.fileURL,width:u.width,height:u.height}))}}var p=[];for(n=0;n<i.length;n++)if(void 0!==s[o=i[n]])for(a=0;a<s[o].length;a++)p.push(s[o][a]);return p},getContent:function(){r.client.get(a.url,function(e){if(e)for(var a=0;a<e.ads.length;a++){var n=e.ads[a];t.vast.companion=void 0;for(var o=0;o<n.creatives.length;o++){var s=n.creatives[o],i=!1,c=!1;if("linear"!==s.type||i)"companion"!==s.type||c||(t.vast.companion=s,c=!0);else if(s.mediaFiles.length){if(t.vast.sources=t.vast.createSourceObjects(s.mediaFiles),!t.vast.sources.length)return void t.trigger("adtimeout");t.vastTracker=new r.tracker(n,s);var l=!1,v=function(){this.vastTracker.load()},u=function(){isNaN(this.vastTracker.assetDuration)&&(this.vastTracker.assetDuration=this.duration()),this.vastTracker.setProgress(this.currentTime())},d=function(){this.vastTracker.setPaused(!1)},p=function(){this.vastTracker.setPaused(!0)},f=function(){r.util.track(n.errorURLTemplates,{ERRORCODE:405}),l=!0,t.trigger("ended")};t.on("canplay",v),t.on("timeupdate",u),t.on("play",d),t.on("pause",p),t.on("error",f),t.one("ended",function(){t.off("canplay",v),t.off("timeupdate",u),t.off("play",d),t.off("pause",p),t.off("error",f),l||this.vastTracker.complete()}),i=!0}}if(t.vastTracker){t.trigger("vast-ready");break}r.util.track(n.errorURLTemplates,{ERRORCODE:403})}t.vastTracker||t.trigger("adtimeout")})},preroll:function(){var n;t.ads.startLinearAdMode(),t.vast.showControls=t.controls(),t.vast.showControls&&t.controls(!1),t.src(t.vast.sources),t.vastTracker.clickThroughURLTemplate&&(n=r.util.resolveURLTemplates([t.vastTracker.clickThroughURLTemplate],{CACHEBUSTER:Math.round(1e10*Math.random()),CONTENTPLAYHEAD:t.vastTracker.progressFormated()})[0]);var o=e.document.createElement("a");o.className="vast-blocker",o.href=n||"#",o.target="_blank",o.onclick=function(){if(t.paused())return t.play(),!1;var e=t.vastTracker.clickTrackingURLTemplate;e&&t.vastTracker.trackURLs([e]),t.trigger("adclick")},t.vast.blocker=o,t.el().insertBefore(o,t.controlBar.el());var s=e.document.createElement("div");s.className="vast-skip-button",a.skip<0&&(s.style.display="none"),t.vast.skipButton=s,t.el().appendChild(s),t.on("timeupdate",t.vast.timeupdate),s.onclick=function(r){if((" "+t.vast.skipButton.className+" ").indexOf(" enabled ")>=0&&(t.vastTracker.skip(),t.vast.tearDown()),void 0===e.Event.prototype.stopPropagation)return!1;r.stopPropagation()},t.one("ended",t.vast.tearDown),t.trigger("vast-preroll-ready")},tearDown:function(){t.vast.skipButton.parentNode.removeChild(t.vast.skipButton),t.vast.blocker.parentNode.removeChild(t.vast.blocker),t.off("timeupdate",t.vast.timeupdate),t.off("ended",t.vast.tearDown),t.ads.endLinearAdMode(),t.vast.showControls&&t.controls(!0),t.trigger("vast-preroll-removed")},timeupdate:function(e){t.loadingSpinner.el().style.display="none";var r=Math.ceil(a.skip-t.currentTime());r>0?t.vast.skipButton.innerHTML="Skip in "+r+"...":-1===(" "+t.vast.skipButton.className+" ").indexOf(" enabled ")&&(t.vast.skipButton.className+=" enabled",t.vast.skipButton.innerHTML="Skip")}}}(n,o),n.on("vast-ready",function(){n.trigger("adsready")}),n.on("vast-preroll-ready",function(){n.play()}),n.on("vast-preroll-removed",function(){n.play()}),n.on("contentupdate",function(){n.vast.getContent(o.url)}),n.on("readyforpreroll",function(){n.vast.preroll()}),n.currentSrc()&&n.vast.getContent(o.url),n):(n.trigger("adtimeout"),null)})}(window,videojs,DMVAST);