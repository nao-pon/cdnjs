!function(e){"use strict";var a,o=Array.prototype.slice,t=function(a){this.options=e.extend({},t.defaults,a),this.parser=this.options.parser,this.locale=this.options.locale,this.messageStore=this.options.messageStore,this.languages={},this.init()};t.prototype={init:function(){var a;(a=this).messageStore.init(a.locale),String.locale=a.locale,String.prototype.toLocaleString=function(){var o,t,n,i,l,r;for(i=this.valueOf(),l=a.locale,r=0;l;){n=(o=l.toLowerCase().split("-")).length;do{var s=o.slice(0,n).join("-");a.options.messageLocationResolver&&(t=a.options.messageLocationResolver(s,i))&&!a.messageStore.isLoaded(s,t)&&a.messageStore.load(t,s);var c=a.messageStore.get(s,i);if(c)return c;n--}while(n);if("en"===l)break;l=e.i18n.fallbacks[a.locale]&&e.i18n.fallbacks[a.locale][r]||a.options.fallbackLocale,a.log("Trying fallback locale for "+a.locale+": "+l),r++}return""}},destroy:function(){e.removeData(document,"i18n")},load:function(e,a){this.messageStore.load(e,a)},log:function(){window.console&&e.i18n.debug&&window.console.log.apply(window.console,arguments)},parse:function(a,o){var t=a.toLocaleString();return this.parser.language=e.i18n.languages[e.i18n().locale]||e.i18n.languages.default,""===t&&(t=a),this.parser.parse(t,o)}},e.i18n=function(a,n){var i,l=e.data(document,"i18n"),r="object"==typeof a&&a;return r&&r.locale&&l&&l.locale!==r.locale&&(String.locale=l.locale=r.locale),l||(l=new t(r),e.data(document,"i18n",l)),"string"==typeof a?(i=void 0!==n?o.call(arguments,1):[],l.parse(a,i)):l},e.fn.i18n=function(){var a=e.data(document,"i18n");return String.locale=a.locale,a||(a=new t,e.data(document,"i18n",a)),this.each(function(){var a=e(this);if(a.data("i18n")){var o=a.data("i18n").toLocaleString();""!==o&&a.text(o)}else a.find("[data-i18n]").i18n()})},String.locale=String.locale||e("html").attr("lang"),String.locale||(void 0!==typeof window.navigator?(a=window.navigator,String.locale=a.language||a.userLanguage||""):String.locale=""),e.i18n.languages={},e.i18n.messageStore=e.i18n.messageStore||{},e.i18n.parser={parse:function(e,a){return e.replace(/\$(\d+)/g,function(e,o){var t=parseInt(o,10)-1;return void 0!==a[t]?a[t]:"$"+o})},emitter:{}},e.i18n.debug=!1,t.defaults={locale:String.locale,fallbackLocale:"en",parser:e.i18n.parser,messageStore:e.i18n.messageStore,messageLocationResolver:null},e.I18N=t}(jQuery);