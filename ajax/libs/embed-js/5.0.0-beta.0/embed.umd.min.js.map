{"version":3,"file":"embed.umd.min.js","sources":["../node_modules/just-extend/index.js","../src/utils/string-replace-async.js","../src/utils/dom.js","../src/plugins/highlight.js","../src/plugins/emoji.js","../src/plugins/github.js","../src/plugins/media.js","../src/plugins/youtube.js","../node_modules/just-flatten-it/index.js","../src/utils/noembed-regex.js","../src/plugins/noembed.js","../node_modules/html-escape/index.js","../node_modules/html-linkify/index.js","../src/plugins/url.js","../src/plugins/facebook.js","../src/plugins/instagram.js","../src/embed.js","../node_modules/p-reduce/index.js","../node_modules/p-waterfall/index.js","../node_modules/is-dom/index.js","../node_modules/is-server/index.js","../src/plugins/base.js","../node_modules/regex-emoji/lib/index.js","../node_modules/just-kebab-case/index.js","../src/utils/fetch.js","../node_modules/just-truncate/index.js","../src/utils/with-details-template.js","../node_modules/youtube-regex/index.js","../src/utils/without-detail-template.js","../node_modules/just-pluck-it/index.js","../src/utils/jsonp.js","../src/presets/all.js"],"sourcesContent":["module.exports = extend;\n\n/*\n  var obj = {a: 3, b: 5};\n  extend(obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 4, b: 5, c: 8}\n\n  var obj = {a: 3, b: 5};\n  extend({}, obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 3, b: 5}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push[4];\n  obj; // {a: 3, b: 5, c: [1, 2, 3, 4]}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(true, obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push[4];\n  obj; // {a: 3, b: 5, c: [1, 2, 3]}\n*/\n\nfunction extend(obj1, obj2 /*, [objn]*/) {\n  var args = [].slice.call(arguments);\n  var deep = false;\n  if (typeof args[0] === 'boolean') {\n    deep = args.shift();\n  }\n  var result = args[0];\n  var extenders = args.slice(1);\n  var len = extenders.length;\n  for (var i = 0; i < len; i++) {\n    var extender = extenders[i];\n    for (var key in extender) {\n      // include prototype properties\n      var value = extender[key];\n      if (deep && value && (typeof value == 'object')) {\n        var base = Array.isArray(value) ? [] : {};\n        result[key] = extend(true, result[key] || base, value);\n      } else {\n        result[key] = value;\n      }\n    }\n  }\n  return result;\n}\n","import extend from \"just-extend\"\n\nfunction matchAll(str, re) {\n\tconst matches = []\n\tlet res = re.exec(str)\n\n\twhile (res) {\n\t\tmatches.push(res)\n\n\t\tif (!re.global) {\n\t\t\tbreak\n\t\t}\n\n\t\tres = re.exec(str)\n\t}\n\treturn matches\n}\n\nfunction replaceAll(str, matches) {\n\treturn matches.reverse().reduce(function(res, match) {\n\t\tconst prefix = res.slice(0, match.index)\n\t\tconst postfix = res.slice(match.index + match[0].length)\n\n\t\treturn prefix + match.replacement + postfix\n\t}, str)\n}\n\nfunction assignReplacement(match, replacer) {\n\tconst args = match.concat([match.index, match.input])\n\n\treturn replacer.apply(null, args).then(function(res) {\n\t\treturn extend({}, match, { replacement: res })\n\t})\n}\n\nfunction concurrency(matches, replacer) {\n\tconst promises = matches.map(function(match) {\n\t\treturn assignReplacement(match, replacer)\n\t})\n\n\treturn Promise.all(promises)\n}\n\nfunction processString(str, re, replacer) {\n\tconst matches = matchAll(str, re)\n\tconst processor = concurrency\n\n\treturn processor(matches, replacer).then(function(matches) {\n\t\treturn replaceAll(str, matches)\n\t})\n}\n\nfunction stringReplaceAsync(str, re, replacer) {\n\tre.lastIndex = 0\n\ttry {\n\t\treturn Promise.resolve(processString(str, re, replacer))\n\t} catch (e) {\n\t\treturn Promise.reject(e)\n\t}\n}\n\nexport default stringReplaceAsync\n","import extend from \"just-extend\"\nimport stringReplaceAsync from \"../utils/string-replace-async\"\n\nconst anchorRegex = /<a[^>]*>([^<]+)<\\/a>/gi\n\n/**\n * Returns the matched regex data or whether the text has any matching string\n * @param regex Regex of the matching pattern\n * @param text String which has to be searched\n * @param test Return boolean or matching array\n * @returns {*} Boolean|Array\n */\nfunction isMatchPresent(regex, text, test = false) {\n\treturn test ? regex.test(text) : text.match(regex)\n}\n\n/**\n * Tells wheteher the matching string is present inside an anchor tag\n * @param text\n * @returns {*} Boolean\n */\nfunction isAnchorTagApplied(text) {\n\treturn anchorRegex.test(text)\n}\n\n/**\n * Sort all the saved embeds by the position index they are present in the string.\n * @param embeds\n * @returns {Array.<T>}\n */\nfunction sortEmbeds(embeds) {\n\treturn embeds.sort((a, b) => a.index - b.index)\n}\n\n/**\n * Returns the embed code to be added at the end of original string.\n * @param embeds\n * @returns {string}\n */\nfunction combineEmbedsText(embeds) {\n\treturn sortEmbeds(embeds)\n\t\t.map(({ content }) => content)\n\t\t.join(\" \")\n}\n\n/**\n * Add the embed code at the end of string and return the new string\n * @param text - original string\n * @param _embeds - Array of embed code\n * @returns {string}\n */\nexport function appendEmbedsAtEnd({ result, _embeds }) {\n\treturn `${result} ${combineEmbedsText(_embeds)}`\n}\n\nfunction saveServiceName({ _services }, { name }, match) {\n\tif (!_services.filter(x => x.match === match).length) {\n\t\t_services.push({ name, match })\n\t}\n}\n\nasync function pushEmbedContent(text, options, pluginOptions, index) {\n\tconst { regex } = pluginOptions\n\tawait stringReplaceAsync(text, regex, async (...args) => {\n\t\toptions._embeds.push({\n\t\t\tcontent: await getTemplate(args, options, pluginOptions),\n\t\t\tindex: index || args.find(x => typeof x === \"number\")\n\t\t})\n\t\tsaveServiceName(options, pluginOptions, args[0])\n\t})\n\treturn options\n}\n\n/**\n * Save the embed code into an array that can be added later to the end of original string\n * @param opts\n * @param pluginOptions\n */\nasync function saveEmbedData(opts, pluginOptions) {\n\tconst { regex } = pluginOptions\n\tlet options = extend({}, opts)\n\n\tif (isAnchorTagApplied(options.result)) {\n\t\tawait stringReplaceAsync(\n\t\t\toptions.result,\n\t\t\tanchorRegex,\n\t\t\tasync (match, url, index) => {\n\t\t\t\tif (!isMatchPresent(regex, match, true)) return match\n\t\t\t\tsaveServiceName(options, pluginOptions, match)\n\t\t\t\toptions = await pushEmbedContent(url, options, pluginOptions, index)\n\t\t\t\treturn match\n\t\t\t}\n\t\t)\n\t} else {\n\t\toptions = pushEmbedContent(options.result, options, pluginOptions)\n\t}\n\n\treturn options\n}\n\nfunction getMatch(regex, string) {\n\tregex.lastIndex = 0\n\tconst matches = regex.exec(string)\n\tregex.lastIndex = 0\n\treturn matches\n}\n\nasync function getTemplate(args, options, pluginOptions) {\n\tconst { _process, template } = pluginOptions\n\tlet data\n\tif (_process) {\n\t\tdata = await _process(args, options, pluginOptions)\n\t}\n\treturn template(args, options, pluginOptions, data)\n}\n\nasync function basicReplace(options, pluginOptions) {\n\tconst { result, replaceUrl } = options\n\tconst { regex, _replaceAnyways } = pluginOptions\n\treturn stringReplaceAsync(result, regex, async (...args) => {\n\t\tsaveServiceName(options, pluginOptions, args[0])\n\t\treturn replaceUrl || _replaceAnyways\n\t\t\t? getTemplate(args, options, pluginOptions)\n\t\t\t: `${args[0]} ${await getTemplate(args, options, pluginOptions)}`\n\t})\n}\n\nasync function anchorReplace(options, pluginOptions) {\n\tconst { result, replaceUrl } = options\n\tconst { regex, _replaceAnyways } = pluginOptions\n\n\treturn stringReplaceAsync(result, anchorRegex, async (match, url) => {\n\t\tif (!isMatchPresent(regex, url, true)) {\n\t\t\treturn match\n\t\t}\n\n\t\tif (!(replaceUrl || _replaceAnyways)) {\n\t\t\tconst args = getMatch(regex, url)\n\t\t\tsaveServiceName(options, pluginOptions, args[0])\n\t\t\tconst t = await getTemplate(args, options, pluginOptions)\n\t\t\treturn args ? match + t : match\n\t\t}\n\t\treturn stringReplaceAsync(url, regex, async (...args) => {\n\t\t\tsaveServiceName(options, pluginOptions, args[0])\n\t\t\treturn getTemplate(args, options, pluginOptions)\n\t\t})\n\t})\n}\n\n/**\n * Insert the embed code in the original string.\n * @param options\n * @param pluginOptions\n * @returns options\n */\nexport async function insert(options, pluginOptions) {\n\tconst { result, inlineEmbed } = options\n\tconst { _ignoreAnchorCheck, _ignoreInlineCheck } = pluginOptions\n\n\tif (!inlineEmbed && !_ignoreInlineCheck) {\n\t\treturn saveEmbedData(options, pluginOptions)\n\t}\n\n\tlet output\n\n\toutput = isAnchorTagApplied(result) && !_ignoreAnchorCheck\n\t\t? await anchorReplace(options, pluginOptions)\n\t\t: await basicReplace(options, pluginOptions)\n\n\treturn extend({}, options, {\n\t\tresult: output\n\t})\n}\n","import extend from 'just-extend'\nimport isServer from 'is-server'\nimport base from './base'\n\nconst name = 'highlight'\n\nexport default function highlight(opts) {\n\tconst defaultOptions = {\n\t\tname,\n\t\tregex: /(`{3})(\\s|[a-z]+)\\s*([\\s\\S]*?[^`])\\s*\\1(?!`)/gm,\n\t\tprismjs: isServer() ? require('prismjs') : window.Prism,\n\t\ttemplate(args, options, { prismjs }) {\n\t\t\tconst language = args[2]\n\t\t\tconst code = args[3]\n\t\t\tconst className = `language-${language || 'markup'}`\n\t\t\treturn `<pre class=\"${className}\"><code class=\"${className}\">${prismjs.highlight(code, prismjs.languages[language || 'markup'])}</code></pre>`\n\t\t}\n\t}\n\n\tconst pluginOptions = extend({}, defaultOptions, opts, {\n\t\t_replaceAnyways: true,\n\t\t_ignoreAnchorCheck: true,\n\t\t_ignoreInlineCheck: true\n\t})\n\treturn base(pluginOptions)\n}\n\nhighlight.id = name\n","import extend from 'just-extend'\nimport emojiRegex from \"regex-emoji\"\nimport kebab from 'just-kebab-case'\n\nconst name = \"emoji\"\n\n// You need emoji.css to run with this plugin. Else you need to pass the\n// template suitable to your needs.\nexport default function emoji(opts) {\n\tconst defaultOptions = {\n\t\tname,\n\t\tregex: emojiRegex(),\n\t\ttemplate(emojiName) {\n\t\t\treturn `<span class=\"ec ec-${kebab(emojiName)}\"></span>`\n\t\t}\n\t}\n\n\tconst pluginOptions = extend({}, defaultOptions, opts)\n\treturn {\n\t\ttransform(options) {\n\t\t\treturn Promise.resolve(\n\t\t\t\textend({}, options, {\n\t\t\t\t\tresult: options.result.replace(\n\t\t\t\t\t\tpluginOptions.regex,\n\t\t\t\t\t\t(match, emojiName) => {\n\t\t\t\t\t\t\toptions._services.push({name, match})\n\t\t\t\t\t\t\treturn pluginOptions.template(emojiName, options, pluginOptions)\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t})\n\t\t\t)\n\t\t}\n\t}\n}\n\nemoji.id = name\n","import extend from \"just-extend\"\nimport unfetch from \"../utils/fetch\"\nimport base from \"./base\"\nimport detailsTemplate from '../utils/with-details-template'\n\nconst name = 'github'\n\nasync function _process(args) {\n\tconst [, user, repo] = args\n\n\ttry {\n\t\tconst res = await unfetch(`https://api.github.com/repos/${user}/${repo}`)\n\t\treturn res.json()\n\t} catch (e) {\n\t\treturn {}\n\t}\n}\n\nexport default function github(opts) {\n\tconst defaultOptions = {\n\t\tname,\n\t\tregex: /[^\\.]github.com\\/([\\w\\.\\-]+)\\/([\\w\\.\\-]+[^\\.])/gi,\n\n\t\tasync template(args, options, pluginOptions, { owner, description, html_url, full_name }) {\n\t\t\treturn detailsTemplate({\n\t\t\t\tthumbnail: owner.avatar_url,\n\t\t\t\turl: html_url,\n\t\t\t\tdescription,\n\t\t\t\ttitle: full_name,\n\t\t\t})\n\t\t}\n\t}\n\n\tconst pluginOptions = extend({}, defaultOptions, opts, {\n\t\t_process\n\t})\n\treturn base(pluginOptions)\n}\n\ngithub.id = name\n","import extend from \"just-extend\"\nimport base from \"./base\"\n\nconst name = 'media'\n\nconst image = ['gif', 'jpg', 'jpeg', 'tiff', 'png', 'svg', 'webp']\nconst video = ['ogv', 'webm', 'mp4']\nconst audio = ['wav', 'mp3', 'ogg']\n\nexport default function basicImage(opts) {\n\tconst defaultOptions = {\n\t\tname,\n\t\tregex: new RegExp(`(?:https?)://\\\\S*\\\\.(?:${image.concat(video, audio).join('|')})`, 'gi'),\n\t\ttemplate(args) {\n\t\t\tconst url = args[0]\n\t\t\tconst ext = url.split('.').slice(-1)[0]\n\t\t\tif(image.indexOf(ext) >= 0) {\n\t\t\t\treturn `<img class=\"ejs-embed\" src=\"${url}\"/>`\n\t\t\t} else if (video.indexOf(ext) >= 0) {\n\t\t\t\treturn `<video src=\"${url}\" controls class=\"ejs-video\"></video>`\n\t\t\t} else if (audio.indexOf(ext) >= 0) {\n\t\t\t\treturn `<audio src=\"${url}\" controls class=\"ejs-audio\"></audio>`\n\t\t\t}\n\t\t}\n\t}\n\tconst pluginOptions = extend({}, defaultOptions, opts)\n\treturn base(pluginOptions)\n}\n\nbasicImage.id = name\n","import extend from \"just-extend\"\nimport isDom from \"is-dom\"\nimport ytRegex from 'youtube-regex'\nimport unfetch from \"../utils/fetch\"\nimport withDetailsTemplate from '../utils/with-details-template'\nimport withoutDetailsTemplate from '../utils/without-detail-template'\nimport base from \"./base\"\n\nconst name = 'youtube'\nconst baseUrl = 'https://www.youtube.com/'\n\n\n/**\n * Decorate data into a simpler structure\n * @param data\n * @returns {{title, thumbnail, rawDescription, views: *, likes: *, description: *, url: string, id, host: string}}\n */\nfunction formatData({ snippet, id }) {\n\treturn {\n\t\ttitle: snippet.title,\n\t\tthumbnail: snippet.thumbnails.medium.url,\n\t\tdescription: snippet.description,\n\t\turl: `${baseUrl}watch?v=${id}`,\n\t\tembedUrl: `${baseUrl}embed/${id}`\n\t}\n}\n\n/**\n * Fetch details of a particular youtube video\n * @param id\n * @param gAuthKey\n * @returns {Promise.<*>}\n */\nasync function fetchDetails(id, gAuthKey) {\n\ttry {\n\t\tconst res = await unfetch(\n\t\t\t`https://www.googleapis.com/youtube/v3/videos?id=${id}&key=${gAuthKey}&part=snippet,statistics`\n\t\t)\n\t\tconst data = await res.json()\n\t\treturn data.items[0]\n\t} catch (e) {\n\t\treturn {}\n\t}\n}\n\n/**\n * Function executed when a content is rendered on the client site.\n * @param input\n * @param clickClass\n * @param onVideoShow\n * @param height\n */\nfunction onLoad({ input }, { clickClass, onVideoShow, height }) {\n\tif (!isDom(input)) {\n\t\tthrow new Error(\"input should be a DOM Element.\")\n\t}\n\tlet classes = document.getElementsByClassName(clickClass)\n\tfor (let i = 0; i < classes.length; i++) {\n\t\tclasses[i].onclick = function() {\n\t\t\tlet url = this.getAttribute(\"data-url\")\n\t\t\tonVideoShow(url)\n\t\t\turl += \"?autoplay=1\"\n\t\t\tthis.parentNode.innerHTML = withoutDetailsTemplate(\n\t\t\t\turl,\n\t\t\t\theight,\n\t\t\t\tname\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunction _process(args, options, { gAuthKey, details }) {\n\treturn details && fetchDetails(args[1], gAuthKey)\n}\n\nfunction youtube(opts) {\n\tconst defaultOptions = {\n\t\tname,\n\t\tregex: ytRegex(),\n\t\tgAuthKey: \"\",\n\t\tdetails: true,\n\t\theight: 300,\n\t\tclickClass: \"ejs-video-thumb\",\n\t\tonVideoShow() {},\n\t\t_onLoadInternal(options, pluginOptions) {\n\t\t\tonLoad(options, pluginOptions)\n\t\t},\n\t\tonLoad() {},\n\t\tasync template(args, options, { details, height, clickClass }, data) {\n\t\t\tconst embedUrl = `${baseUrl}embed/${args[1]}`\n\t\t\treturn details\n\t\t\t\t? withDetailsTemplate(formatData(data), clickClass)\n\t\t\t\t: withoutDetailsTemplate(embedUrl, height, name)\n\t\t}\n\t}\n\n\tif (!opts.gAuthKey) {\n\t\tthrow new Error(\"You need to pass google auth key.\")\n\t}\n\n\tconst pluginOptions = extend({}, defaultOptions, opts, {\n\t\t_process\n\t})\n\treturn base(pluginOptions)\n}\n\nyoutube.id = name\n\nexport default youtube\n","module.exports = flatten;\n\n/*\n  flatten([[1, [2, 3]], [[4, 5], 6, 7, [8, 9]]]);\n  // [1, 2, 3, 4, 5, 6, 7, 8, 9]\n*/\n\nfunction flatten(arr) {\n  var result = [];\n  var len = arr.length;\n  for (var i = 0; i < len; i++) {\n    var elem = arr[i];\n    if (Array.isArray(elem)) {\n      result.push.apply(result, flatten(elem));\n    } else {\n      result.push(elem);\n    }\n  }\n  return result;\n}\n","import pluck from \"just-pluck-it\"\nimport flatten from \"just-flatten-it\"\n\nconst regexes = [\n\t{\n\t\tpatterns: [\"https?://soundcloud.com/.*/.[^\\\\s]*\"],\n\t\tname: \"SoundCloud\"\n\t},\n\t{\n\t\tname: \"slideshare\",\n\t\tpatterns: [\n\t\t\t\"https?://www\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\",\n\t\t\t\"https?://fr\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\",\n\t\t\t\"https?://de\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\",\n\t\t\t\"https?://es\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\",\n\t\t\t\"https?://pt\\\\.slideshare\\\\.net/.*/.[^\\\\s]*\"\n\t\t]\n\t},\n\t{\n\t\tname: \"vimeo\",\n\t\tpatterns: [\n\t\t\t\"https?://vimeo\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://vimeo\\\\.com/album/.*/video/.[^\\\\s]*\",\n\t\t\t\"https?://vimeo\\\\.com/channels/.*/.[^\\\\s]*\",\n\t\t\t\"https?://vimeo\\\\.com/groups/.*/videos/.[^\\\\s]*\",\n\t\t\t\"https?://vimeo\\\\.com/ondemand/.*/.[^\\\\s]*\"\n\t\t]\n\t},\n\t{\n\t\tpatterns: [\n\t\t\t\"https?://photos\\\\.app\\\\.net/.*/.[^\\\\s]*\",\n\t\t\t\"https?://live\\\\.amcharts\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://codepen\\\\.io/.[^\\\\s]*\",\n\t\t\t\"https?://codepen\\\\.io/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.collegehumor\\\\.com/video/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.dailymotion\\\\.com/video/.[^\\\\s]*\",\n\t\t\t\"https?://.*\\\\.deviantart\\\\.com/art/.[^\\\\s]*\",\n\t\t\t\"https?://.*\\\\.deviantart\\\\.com/.*#/d.[^\\\\s]*\",\n\t\t\t\"https?://dotsub\\\\.com/view/.[^\\\\s]*\",\n\t\t\t\"https?://.*\\\\.flickr\\\\.com/photos/.[^\\\\s]*\",\n\t\t\t\"https?://flic\\\\.kr/p/.[^\\\\s]*\",\n\t\t\t\"https?://.*\\\\.wikimedia\\\\.org/.*_geograph\\\\.org\\\\.uk_.[^\\\\s]*\",\n\t\t\t\"https?://gfycat\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.gfycat\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://gfycat\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.gfycat\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://giphy\\\\.com/gifs/.[^\\\\s]*\",\n\t\t\t\"https?://media\\\\.giphy\\\\.com/media/.*/giphy\\\\.gif\",\n\t\t\t\"https?://www\\\\.hulu\\\\.com/watch/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.kickstarter\\\\.com/projects/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.mixcloud\\\\.com/.*/.*/\",\n\t\t\t\"https?://reddit\\\\.com/r/.*/comments/.*/.[^\\\\s]*\",\n\t\t\t\"https?://.*\\\\.screen9\\\\.tv/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.scribd\\\\.com/doc/.[^\\\\s]*\",\n\t\t\t\"https?://.*\\\\.smugmug\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://soundcloud\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://play\\\\.soundsgood\\\\.co/playlist/.[^\\\\s]*\",\n\t\t\t\"https?://speakerdeck\\\\.com/.*/.[^\\\\s]*\",\n\t\t\t\"https?://speakerdeck\\\\.com/.*/.[^\\\\s]*\",\n\t\t\t\"https?://ted\\\\.com/talks/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.nytimes\\\\.com/svc/oembed\",\n\t\t\t\"https?://nytimes\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://.*\\\\.nytimes\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://clips\\\\.twitch\\\\.tv/.[^\\\\s]*\",\n\t\t\t\"https?://clips\\\\.twitch\\\\.tv/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.twitch\\\\.tv/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.twitch\\\\.tv/.[^\\\\s]*\",\n\t\t\t\"https?://twitch\\\\.tv/.[^\\\\s]*\",\n\t\t\t\"https?://twitch\\\\.tv/.[^\\\\s]*\",\n\t\t\t\"https?://.*\\\\.ustream\\\\.tv/.[^\\\\s]*\",\n\t\t\t\"https?://.*\\\\.ustream\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://veervr\\\\.tv/videos/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.vevo\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://www\\\\.vevo\\\\.com/.[^\\\\s]*\",\n\t\t\t\"https?://player\\\\.vimeo\\\\.com/video/.[^\\\\s]*\",\n\t\t\t\"https?://vine\\\\.co/v/.[^\\\\s]*\",\n\t\t\t\"https?://vine\\\\.co/v/.[^\\\\s]*\"\n\t\t],\n\t\tname: \"oEmbed\"\n\t},\n\t{\n\t\tname: \"Imgur\",\n\t\tpatterns: [\"https?://imgur\\\\.com/(?:[^\\\\/]+/)?[0-9a-zA-Z]+$\"]\n\t},\n\t{\n\t\tpatterns: [\n\t\t\t\"https?://www\\\\.(dropbox\\\\.com/s/.+\\\\.(?:jpg|png|gif))\",\n\t\t\t\"https?://db\\\\.tt/[a-zA-Z0-9][^\\\\s]+\"\n\t\t],\n\t\tname: \"Dropbox\"\n\t},\n\t// #if IS_CJS\n\t{\n\t\tpatterns: [\n\t\t\t\"https?:\\\\/\\\\/(?:[^\\\\.]+\\\\.)?youtube\\\\.com\\\\/watch\\\\/?\\\\?(?:.+&)?v=([^&][^\\\\s]+)\",\n\t\t\t\"https?://(?:[^\\\\.]+\\\\.)?(?:youtu\\\\.be|youtube\\\\.com/embed)/([a-zA-Z0-9_-][^\\\\s]+)\"\n\t\t],\n\t\tname: \"YouTube\"\n\t},\n\t// #endif\n\t{\n\t\tpatterns: [\n\t\t\t\"https?://(?:www|mobile\\\\.)?twitter\\\\.com/(?:#!/)?([^/]+)/status(?:es)?/(\\\\d+)\"\n\t\t],\n\t\tname: \"Twitter\"\n\t}\n]\n\nexport default function getRegexes(excludeServices = []) {\n\tconst includedRegexes = regexes.filter(\n\t\tr => excludeServices.indexOf(r.name.toLowerCase()) === -1\n\t)\n\tconst patterns = flatten(pluck(includedRegexes, \"patterns\"))\n\treturn new RegExp(patterns.join(\"|\"), \"gi\")\n}\n\n\nexport function isServicePresent (serviceName, text) {\n\tconst service = regexes.filter(r => r.name.toLowerCase() === serviceName)[0]\n\tconst regex = new RegExp(service.patterns.join('|'), 'gi')\n\treturn regex.test(text)\n}\n","import unfetch from \"../utils/fetch\"\nimport extend from \"just-extend\"\nimport isServer from 'is-server'\nimport isDom from 'is-dom'\nimport getRegex, { isServicePresent } from \"../utils/noembed-regex\"\nimport base from \"./base\"\n\nconst name = \"noEmbed\"\n\n/**\n * Fetches the data from the noembed API\n * @param args\n * @returns {Promise.<*>}\n */\nasync function _process(args) {\n\tconst url = args[0]\n\ttry {\n\t\tconst res = await unfetch(`https://noembed.com/embed?url=${url}`)\n\t\treturn await res.json()\n\t} catch (e) {\n\t\treturn {\n\t\t\thtml: url\n\t\t}\n\t}\n}\n\nfunction noEmbed(opts = {}) {\n\tconst defaultOptions = {\n\t\tname,\n\t\t// Regex to be used to identify noembed supported services.\n\t\t// By default it takes from noembed-regex.js\n\t\tregex: null,\n\n\t\t// In case you want to exclude a few services, you can do it here.\n\t\t// It accepts an array of service names in lowercase.\n\t\texclude: [],\n\n\t\ttwttr: !isServer() ? window.twttr : null,\n\n\t\tonLoad() {},\n\n\t\tasync template(args, options, pluginOptions, { html }) {\n\t\t\treturn `<div class=\"ejs-embed\">${html}</div>`\n\t\t},\n\n\t\t_onLoadInternal({ input, result }, { twttr, onLoad }) {\n\t\t\tif (isServicePresent('twitter', result) && twttr && isDom(input)) {\n\t\t\t\ttwttr.widgets.load(input)\n\t\t\t\ttwttr.events.bind(\"loaded\", onLoad)\n\t\t\t}\n\t\t}\n\t}\n\n\tconst pluginOptions = extend({}, defaultOptions, opts, {\n\t\t_process\n\t})\n\n\tif (!opts.regex) {\n\t\tpluginOptions.regex = getRegex(pluginOptions.exclude)\n\t}\n\n\treturn base(pluginOptions)\n}\n\nnoEmbed.id = name\n\nexport default noEmbed\n","\"use strict\";\n\n/* From Twitter's Hogan.js */\n\nvar rAmp = /&/g,\n\trLt = /</g,\n\trGt = />/g,\n\trApos =/\\'/g,\n\trQuot = /\\\"/g,\n\thChars =/[&<>\\\"\\']/;\n\nfunction coerceToString(val) {\n\treturn String((val === null || val === undefined) ? '' : val);\n}\n\nmodule.exports = function(str) {\n\tstr = coerceToString(str);\n\n\treturn hChars.test(str)\n\t\t? str\n\t\t\t.replace(rAmp,'&amp;')\n\t\t\t.replace(rLt,'&lt;')\n\t\t\t.replace(rGt,'&gt;')\n\t\t\t.replace(rApos,'&#39;')\n\t\t\t.replace(rQuot, '&quot;')\n\t\t: str;\n};\n","// Takes plain text and replaces links with HTML anchor elements. Based on\n// https://github.com/thejh/node-linkify\n\"use strict\";\n\n// Link regex\n// See http://daringfireball.net/2010/07/improved_regex_for_matching_urls\nvar rLink = /\\b((?:https?:\\/\\/|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)(?:[^\\s()<>]+|\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\))+(?:\\(([^\\s()<>]+|(\\([^\\s()<>]+\\)))*\\)|[^\\s`!()\\[\\]{};:'\".,<>?«»“”‘’]))/gi;\n\n// Email regex\nvar rEmail = /\\b(([a-zA-Z0-9\\-\\_\\.])+(\\+[a-zA-Z0-9]*)?@[a-zA-Z\\_\\-]+?(\\.[a-zA-Z]{2,6})+)/gim;\n\nvar escape = require(\"html-escape\");\n\nmodule.exports = function(text, options) {\n\tif ( ! options) options = {};\n\n\tvar retval = \"\", cur = 0, match;\n\n\tvar escapeFn = options.escape === false ? function(str) { return str; } : escape;\n\n\twhile (match = rLink.exec(text)) {\n\t\tretval += escapeFn(text.slice(cur, match.index));\n\t\tretval += anchor(match[0], options.attributes);\n\t\tcur = rLink.lastIndex;\n\t}\n\n\tretval += escapeFn(text.slice(cur));\n\tretval = emails(retval, options.attributes);\n\n\treturn retval;\n};\n\n// Return an anchor element for the url\nfunction anchor(url, attrs) {\n\tvar text = escape(url),\n\t\thref = url;\n\n\t// Ensure protocol at beginning of url\n\tif (!/^[a-zA-Z]{1,6}:/.test(href)) {\n\t\thref = 'http://' + href;\n\t}\n\n\tvar attrsString = combine({ href: href }, attrs);\n\n\treturn \"<a \" + attrsString + \">\" + text + \"</a>\";\n}\n\n// combine attrs objects into single string\nfunction combine() {\n\treturn Array.prototype.slice.call(arguments)\n\t\t.map(attributes)\n\t\t.filter(Boolean)\n\t\t.join(\" \");\n}\n\n// Replace emails in text with anchor elements\nfunction emails(text, attrs) {\n\tvar attrsString = attributes(attrs);\n\n\treturn text.replace(rEmail, function(match, email) {\n\t\tvar elAttrs = attributes({ href: \"mailto:\" + email });\n\t\tif (attrsString) {\n\t\t\telAttrs += \" \" + attrsString;\n\t\t}\n\n\t\treturn \"<a \" + elAttrs + \">\" + escape(email) + \"</a>\";\n\t});\n}\n\nfunction attributes(attrs) {\n\tif ( ! attrs) return \"\";\n\treturn Object.keys(attrs).map(function(name) {\n\t\tvar value = attrs[name];\n\t\treturn escape(name) + \"=\\\"\" + escape(value) + \"\\\"\";\n\t}).join(\" \");\n}\n","import extend from \"just-extend\"\nimport linkify from \"html-linkify\"\n\nconst name = \"url\"\n\nexport default function url(opts) {\n\tconst defaultOptions = {\n\t\tattributes: {},\n\n\t\t// setting this to true will mess up characters like \"\n\t\tescape: false\n\t}\n\n\tconst { attributes, escape } = extend({}, defaultOptions, opts)\n\treturn {\n\t\tasync transform(options) {\n\t\t\treturn extend({}, options, {\n\t\t\t\tresult: linkify(options.result, { attributes, escape })\n\t\t\t})\n\t\t}\n\t}\n}\n\nurl.id = name\n","import extend from \"just-extend\"\nimport base from \"./base\"\nimport withoutDetailTemplate from \"../utils/without-detail-template\"\n\nconst name = \"facebook\"\n\nexport default function facebook(opts) {\n\tconst defaultOptions = {\n\t\tname,\n\t\tregex: /(https?:\\/\\/)?www\\.facebook\\.com\\/(?:(videos|posts)\\.php\\?v=\\d+|.*?\\/(videos|posts)\\/\\d+\\/?)/gi,\n\t\theight: 225,\n\t\ttemplate(args, options, { height }) {\n\t\t\tconst url = args[0]\n\t\t\tconst type = url.indexOf(\"/videos/\") < 0 ? \"post\" : \"video\"\n\t\t\treturn withoutDetailTemplate(\n\t\t\t\t`https://www.facebook.com/plugins/${type}.php?href=${url}`,\n\t\t\t\theight,\n\t\t\t\tname\n\t\t\t)\n\t\t}\n\t}\n\n\tconst pluginOptions = extend({}, defaultOptions, opts)\n\treturn base(pluginOptions)\n}\n\nfacebook.id = name\n","import extend from 'just-extend'\nimport base from './base'\n\nconst name = 'instagram'\n\nexport default function instagram (opts) {\n\tconst defaultOptions = {\n\t\tname,\n\t\theight: 440,\n\t\tregex: /((https?:\\/\\/)(www\\.)?instagram.com\\/p\\/[a-zA-Z0-9_\\-\\=]+)(\\/\\?[a-zA-Z0-9_\\-\\=]+)?/gi,\n\t\ttemplate (args, options, {width, height}) {\n\t\t\treturn `<iframe class=\"ejs-embed ejs-instagram\" src=\"${args[1]}/embed\" height=\"${height}\"></iframe>`\n\t\t}\n\t}\n\n\tconst pluginOptions = extend({}, defaultOptions, opts)\n\treturn base(pluginOptions)\n}\n\ninstagram.id = name\n","import extend from 'just-extend'\nimport pWaterfall from 'p-waterfall'\nimport isDom from 'is-dom'\nimport { appendEmbedsAtEnd } from './utils/dom'\n// import * as presets from './presets'\n// import * as plugins from './plugins'\n\nfunction isElementPresent ({ input, target }) {\n\treturn isDom(input) || target && isDom(target)\n}\n\nexport default class EmbedJS {\n\tconstructor (options) {\n\t\tconst defaultOptions = {\n\t\t\tplugins: [],\n\t\t\tpreset: null,\n\t\t\tinlineEmbed: true,\n\t\t\treplaceText: false,\n\t\t\t_embeds: [],\n\t\t\t_services: []\n\t\t}\n\n\t\tlet {input, plugins = [], preset} = options\n\t\tif (!input) {\n\t\t\tthrow new Error('You need to pass input element or string in the options object.')\n\t\t}\n\n\t\tconst inputString = isDom(input) ? input.innerHTML : input\n\n\t\tthis.options = extend({}, defaultOptions, options, {\n\t\t\tresult: inputString,\n\t\t\tplugins: preset ? plugins.concat(preset) : plugins,\n\t\t\tinputString\n\t\t})\n\t}\n\n\ttext () {\n\t\tconst options = this.resetOptions()\n\t\tconst transformers = options.plugins.map(p => p.transform)\n\t\treturn pWaterfall(transformers, options)\n\t}\n\n\tresetOptions() {\n\t\treturn extend({}, this.options, {\n\t\t\t_embeds: []\n\t\t})\n\t}\n\n\tload () {\n\t\tthis.options.plugins.forEach(p => p.onLoad && p.onLoad(this.options))\n\t}\n\n\tasync render () {\n\t\tconst { input, target, inlineEmbed } = this.options\n\t\tif (!isElementPresent(this.options)) {\n\t\t\tthrow new Error('You haven\\'t passed the input as an element.')\n\t\t}\n\n\t\tlet options\n\t\tif (isDom(input) && input.classList.contains('ejs-applied')) {\n\t\t\toptions = this.options\n\t\t} else {\n\t\t\toptions = await this.text()\n\n\t\t\tconst element = target || input\n\t\t\telement.innerHTML = inlineEmbed ? options.result : appendEmbedsAtEnd(options)\n\t\t\telement.classList.add('ejs-applied')\n\t\t}\n\n\t\tthis.load()\n\t\treturn options\n\t}\n\n\tdestroy() {\n\t\tconst { inputString, input, target } = this.options\n\t\tif (!isElementPresent(this.options)) {\n\t\t\tthrow new Error('You haven\\'t passed the input as an element.')\n\t\t}\n\t\tconst element = target || input\n\t\telement.innerHTML = inputString\n\t\telement.classList.remove('ejs-applied')\n\t\treturn this.options\n\t}\n}\n\n// EmbedJS.plugins = plugins\n// EmbedJS.presets = presets\n\n\n","'use strict';\nmodule.exports = (iterable, reducer, initVal) => new Promise((resolve, reject) => {\n\tconst iterator = iterable[Symbol.iterator]();\n\tlet i = 0;\n\n\tconst next = total => {\n\t\tconst el = iterator.next();\n\n\t\tif (el.done) {\n\t\t\tresolve(total);\n\t\t\treturn;\n\t\t}\n\n\t\tPromise.all([total, el.value])\n\t\t\t.then(value => {\n\t\t\t\tnext(reducer(value[0], value[1], i++));\n\t\t\t})\n\t\t\t.catch(reject);\n\t};\n\n\tnext(initVal);\n});\n","'use strict';\nconst pReduce = require('p-reduce');\n\nmodule.exports = (iterable, initVal) => pReduce(iterable, (prev, fn) => fn(prev), initVal);\n","module.exports = isNode\n\nfunction isNode (val) {\n  return (!val || typeof val !== 'object')\n    ? false\n    : (typeof window === 'object' && typeof window.Node === 'object')\n      ? (val instanceof window.Node)\n      : (typeof val.nodeType === 'number') &&\n        (typeof val.nodeName === 'string')\n}\n","/**\n * Export\n */\n\nexports = module.exports = detect;\n\n/**\n * Check if process is running in Node.js\n *\n * @return {Boolean}\n * @api public\n */\n\nfunction detect() {\n  if (typeof process != \"undefined\") return true;\n  return false;\n}","import extend from \"just-extend\"\nimport { insert } from \"../utils/dom\"\n\nexport default opts => {\n\tconst defaultOptions = {\n\t\t_replaceAnyways: false,\n\t\t_ignoreAnchorCheck: false,\n\t\t_ignoreInlineCheck: false,\n\t\tonLoad() {}\n\t}\n\n\tconst pluginOptions = extend({}, defaultOptions, opts)\n\n\tconst { _onLoadInternal, onLoad, regex, template } = pluginOptions\n\n\tif (!regex) {\n\t\tthrow new Error(\"regex not passed.\")\n\t}\n\tif (!template) {\n\t\tthrow new Error(\"template not passed.\")\n\t}\n\n\treturn {\n\t\tasync transform(options) {\n\t\t\treturn extend({}, options, await insert(options, pluginOptions))\n\t\t},\n\n\t\tonLoad(options) {\n\t\t\tif (_onLoadInternal) {\n\t\t\t\t_onLoadInternal(options, pluginOptions)\n\t\t\t}\n\t\t\tif (onLoad) {\n\t\t\t\tonLoad(options, pluginOptions)\n\t\t\t}\n\t\t}\n\t}\n}\n","\"use strict\";\n\n/**\n * emojiRegex\n * Returns the emoji regex value.\n *\n * @name emojiRegex\n * @function\n * @return {RegExp} The emoji regex.\n */\nmodule.exports = function emojiRegex() {\n  return (/:([a-z0-9_\\+\\-]+):/g\n  );\n};","module.exports = kebabCase;\n\n/*\n  kebabCase('the quick brown fox'); // 'the-quick-brown-fox'\n  kebabCase('the-quick-brown-fox'); // 'the-quick-brown-fox'\n  kebabCase('the_quick_brown_fox'); // 'the-quick-brown-fox'\n  kebabCase('theQuickBrownFox'); // 'the-quick-brown-fox'\n  kebabCase('theQuickBrown Fox'); // 'the-quick-brown-fox'\n  kebabCase('thequickbrownfox'); // 'thequickbrownfox'\n  kebabCase('the - quick * brown# fox'); // 'the-quick-brown-fox'\n  kebabCase('theQUICKBrownFox'); // 'the-q-u-i-c-k-brown-fox'\n*/\n\n// any combination of spaces and punctuation characters\n// thanks to http://stackoverflow.com/a/25575009\nvar wordSeparators = /[\\s\\u2000-\\u206F\\u2E00-\\u2E7F\\\\'!\"#$%&()*+,\\-.\\/:;<=>?@\\[\\]^_`{|}~]+/;\nvar capitals = /[A-Z\\u00C0-\\u00D6\\u00D9-\\u00DD]/g;\n\nfunction kebabCase(str) {\n  //replace capitals with space + lower case equivalent for later parsing\n  str = str.replace(capitals, function (match) {\n    return ' ' + (match.toLowerCase() || match);\n  });\n  return str.trim().split(wordSeparators).join('-');\n}\n","import isServer from \"is-server\"\n\nexport default (isServer()\n\t? require(\"node-fetch\")\n\t: window.fetch || window.unfetch)\n","module.exports = truncate;\n\n/*\n  truncate('when shall we three meet again', 9); // 'when s...'\n  truncate('when shall we three meet again', 10, ' (etc)'); // 'when (etc)'\n  truncate('when shall we', 15,); // 'when shall we'\n  truncate('when shall we', 15, '(more)'); // 'when shall we'\n  truncate('when shall we', 7, ' (more)'); // ' (more)'\n*/\n\nfunction truncate(str, length, end) {\n  if ((length == null) || (length >= str.length)) {\n    return str;\n  }\n  if (end == null) {\n    end = '...';\n  }\n  return str.slice(0, Math.max(0, length - end.length)) + end;\n}\n","import truncate from \"just-truncate\"\n\nexport default function(\n\t{ url, title, embedUrl, description, thumbnail },\n\tthumbClassName\n) {\n\treturn `<div class=\"ejs-preview ejs-embed\"><div class=\"ejs-thumb ${thumbClassName}\" data-url=\"${embedUrl}\" style=\"background-image:url(${thumbnail})\"><span>&#9658;</span></div><div class=\"ejs-info\"><h4 class=\"ejs-title\"><a href=\"${url}\">${title}</a></h4><div class=\"ejs-desc\">${truncate(\n\t\tdescription,\n\t\t150\n\t)}</div></div></div>`\n}\n","/**\n * youtube-regex <https://github.com/tunnckoCore/youtube-regex>\n *\n * Copyright (c) 2014 Charlike Mike Reagent, contributors.\n * Released under the MIT license.\n */\n\n'use strict';\n\nmodule.exports = function youtubeRegex() {\n  var regex = /(?:youtube\\.com\\/\\S*(?:(?:\\/e(?:mbed))?\\/|watch\\/?\\?(?:\\S*?&?v\\=))|youtu\\.be\\/)([a-zA-Z0-9_-]{6,11})/g;\n\n  return regex;\n};\n","export default function(embedUrl, height, name) {\n\treturn `<iframe class=\"ejs-embed ejs-${name}\" src=\"${embedUrl}\" frameBorder=\"0\" height=\"${height}\"></iframe>`\n}\n","module.exports = pluck;\n\n/*\n  var arr = [{a:1, b:2}, {a:4, b:3}, {a:2, b:5}];\n  pluck(arr, 'a'); // [1, 4, 2]\n  var obj = {x: {a:1, b:2}, y: {a:4, b:3}, z: {a:2, b:5}];\n  pluck(obj, 'a'); // {x: 1, y: 4, z: 2}\n*/\n\nfunction pluck(collection, propertyName) {\n  if (!collection || typeof collection != 'object') {\n    return new Error('expected first argument to be an object or array');\n  }\n\n  var result, len, i, keys, key;\n  if (Array.isArray(collection)) {\n    result = [];\n    len = collection.length;\n    for (i = 0; i < len; i++) {\n      result.push(collection[i][propertyName]);\n    }\n  } else {\n    result = {};\n    keys = Object.keys(collection);\n    len = keys.length;\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      result[key] = collection[key][propertyName];\n    }\n  }\n  return result;\n}\n","import isServer from \"is-server\"\n\nlet count = 0\n\nfunction jsonP(url) {\n\treturn new Promise(resolve => {\n\t\tconst cb = `__c${count++}`\n\t\tconst param = \"callback\"\n\t\tconst query = `${param}=${cb}`\n\t\tconst script = document.createElement(\"script\")\n\n\t\tconst cleanup = () => {\n\t\t\tdocument.head.removeChild(script)\n\t\t\twindow[cb] = () => {}\n\t\t}\n\n\t\twindow[cb] = data => {\n\t\t\tresolve(data)\n\t\t\tcleanup()\n\t\t}\n\n\t\tscript.src = `${url}&${query}`\n\t\tdocument.head.appendChild(script)\n\t})\n}\n\nlet unfetch\nif (isServer()) {\n\tunfetch = require(\"node-fetch\")\n}\n\nexport default unfetch || jsonP\n","import {\n\thighlight,\n\temoji,\n\tgithub,\n\tnoEmbed,\n\turl,\n\tyoutube,\n\tfacebook,\n\tmedia,\n\tinstagram\n} from \"../plugins\"\nimport extend from \"just-extend\"\n\nexport default function (options) {\n\tconst defaultOptions = {\n\t\texclude: []\n\t}\n\n\tconst presetOptions = extend({}, defaultOptions, options)\n\n\tconst pluginNames = [\n\t\turl,\n\t\temoji,\n\t\tgithub,\n\t\tnoEmbed,\n\t\tyoutube,\n\t\tfacebook,\n\t\thighlight,\n\t\tmedia,\n\t\tinstagram\n\t]\n\tconst plugins = pluginNames.map(plugin => {\n\t\tconst { id } = plugin\n\t\tconst pluginOptions = presetOptions[id]\n\n\t\tif (presetOptions.exclude.indexOf(plugin.id) === -1) {\n\t\t\tif (id === \"youtube\" || id === \"map\") {\n\t\t\t\treturn plugin(\n\t\t\t\t\textend(\n\t\t\t\t\t\t{},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tgAuthKey: options.gAuthKey\n\t\t\t\t\t\t},\n\t\t\t\t\t\tpluginOptions\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t} else if (id === \"noEmbed\") {\n\t\t\t\treturn plugin(\n\t\t\t\t\textend({}, pluginOptions, {\n\t\t\t\t\t\texclude: [\"youtube\"]\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t}\n\t\t\treturn plugin(pluginOptions)\n\t\t}\n\t\treturn null\n\t})\n\n\treturn plugins.filter(plugin => !!plugin)\n}\n"],"names":["extend","obj1","obj2","args","slice","call","arguments","deep","shift","result","extenders","len","length","i","extender","key","value","base","Array","isArray","matchAll","str","re","const","matches","res","exec","push","global","replaceAll","reverse","reduce","match","prefix","index","postfix","replacement","assignReplacement","replacer","concat","input","apply","then","concurrency","promises","map","Promise","all","processString","stringReplaceAsync","lastIndex","resolve","e","reject","isMatchPresent","regex","text","test","isAnchorTagApplied","anchorRegex","sortEmbeds","embeds","sort","a","b","combineEmbedsText","ref","join","appendEmbedsAtEnd","saveServiceName","ref$1","_services","name","filter","x","pushEmbedContent","options","pluginOptions","getTemplate","_embeds","content","$await_7","find","saveEmbedData","opts","url","$await_9","getMatch","string","template","data","_process","$await_11","basicReplace","replaceUrl","_replaceAnyways","$await_12","anchorReplace","t","$await_14","insert","inlineEmbed","_ignoreAnchorCheck","_ignoreInlineCheck","output","$await_17","highlight","defaultOptions","prismjs","isServer","require","window","Prism","language","code","className","languages","emoji","emojiRegex","emojiName","kebab","transform","replace","user","repo","unfetch","$await_2","json","github","owner","description","html_url","full_name","detailsTemplate","thumbnail","avatar_url","title","basicImage","RegExp","image","video","audio","ext","split","indexOf","formatData","snippet","id","thumbnails","medium","baseUrl","embedUrl","fetchDetails","gAuthKey","$await_3","items","onLoad","clickClass","onVideoShow","height","isDom","Error","let","classes","document","getElementsByClassName","onclick","this","getAttribute","parentNode","innerHTML","withoutDetailsTemplate","youtube","ytRegex","details","_onLoadInternal","withDetailsTemplate","flatten","arr","elem","getRegexes","excludeServices","includedRegexes","regexes","r","toLowerCase","patterns","pluck","isServicePresent","serviceName","service","html","noEmbed","exclude","twttr","widgets","load","events","bind","getRegex","coerceToString","val","String","undefined","anchor","attrs","escape","href","combine","prototype","attributes","Boolean","emails","attrsString","rEmail","email","elAttrs","Object","keys","linkify","facebook","type","withoutDetailTemplate","instagram","isElementPresent","target","module","iterable","reducer","initVal","iterator","Symbol","next","total","el","done","catch","pReduce","prev","fn","Node","nodeType","nodeName","process","$await_1","capitals","trim","wordSeparators","fetch","end","Math","max","thumbClassName","truncate","collection","propertyName","rAmp","rLt","rGt","rApos","rQuot","hChars","rLink","retval","cur","escapeFn","presetOptions","media","plugin","EmbedJS","preset","inputString","plugins","resetOptions","transformers","p","pWaterfall","forEach","render","classList","contains","add","destroy","element","remove"],"mappings":"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"}