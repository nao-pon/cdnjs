"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),Sticky=function(){function t(e){_classCallCheck(this,t),this.selector=e,this.vp=this.getViewportSize(),this.scrollTop=this.getScrollTopPosition(),this.initialize()}return _createClass(t,[{key:"initialize",value:function(){var t=this;this.elements=document.querySelectorAll(this.selector);var e=setInterval(function(){if("interactive"===document.readyState||"complete"===document.readyState){for(var i=0,o=t.elements.length;i<o;i++)t.activate(t.elements[i]);clearInterval(e)}},100)}},{key:"activate",value:function(t){var e=this;t.sticky={},t.sticky.marginTop=t.getAttribute("data-margin-top")?parseInt(t.getAttribute("data-margin-top")):0,t.sticky.rect=this.getRect(t),"img"===t.tagName.toLowerCase()&&(t.onload=function(){return t.sticky.rect=e.getRect(t)}),t.sticky.container=this.getContainer(t),t.sticky.container.rect=this.getRect(t.sticky.container),window.addEventListener("resize",function(){e.vp=e.getViewportSize(),e.updateRect(t),e.setPosition(t)}),window.addEventListener("scroll",function(){return e.scrollTop=e.getScrollTopPosition()}),window.addEventListener("scroll",function(){return e.setPosition(t)}),this.setPosition(t)}},{key:"getRect",value:function(t){var e=this.getTopLeftPosition(t);return e.offsetLeft=t.offsetLeft,e.width=t.offsetWidth,e.height=t.offsetHeight,e}},{key:"updateRect",value:function(t){this.removeStyle(t,["position","width","top","left","right","bottom"]),t.sticky.rect=this.getRect(t),t.sticky.container.rect=this.getRect(t.sticky.container)}},{key:"getTopLeftPosition",value:function(t){var e=0,i=0;do e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.offsetParent;while(t);return{top:e,left:i}}},{key:"getContainer",value:function(t){for(var e=t;"string"!=typeof e.getAttribute("data-sticky-container")&&e!==document.documentElement;)e=e.parentNode;return e}},{key:"getViewportSize",value:function(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}}},{key:"getScrollTopPosition",value:function(){return(window.pageYOffset||document.scrollTop)-(document.clientTop||0)||0}},{key:"setPosition",value:function(t){this.vp.height<t.sticky.rect.height||(this.removeStyle(t,["position","width","top","left","right","bottom"]),this.scrollTop>t.sticky.rect.top-t.sticky.marginTop?(this.addStyle(t,{position:"fixed",width:t.sticky.rect.width+"px",left:t.sticky.rect.left+"px",right:"auto",bottom:"auto"}),this.scrollTop+t.sticky.rect.height+t.sticky.marginTop>t.sticky.container.rect.top+t.sticky.container.rect.height?this.addStyle(t,{top:t.sticky.container.rect.top+t.sticky.container.rect.height-(this.scrollTop+t.sticky.rect.height)+"px"}):this.addStyle(t,{top:t.sticky.marginTop+"px"})):this.removeStyle(t,["position","width","top","left","right","bottom"]))}},{key:"update",value:function(){for(var t=0,e=this.elements.length;t<e;t++)this.updateRect(this.elements[t]),this.setPosition(this.elements[t])}},{key:"addStyle",value:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t.style[i]=e[i])}},{key:"removeStyle",value:function(t,e){for(var i=0,o=e.length;i<o;i++)t.style[e[i]]=null}}]),t}();