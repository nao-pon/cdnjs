function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Sticky=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,t),this.selector=e,this.elements=[],this.version="1.1.1",this.vp=this.getViewportSize(),this.scrollTop=this.getScrollTopPosition(),this.options={marginTop:i.marginTop||0,stickyFor:i.stickFor||0,stickyClass:i.stickyClass||null},this.run()}return t.prototype.run=function(){var t=this,e=setInterval(function(){if("interactive"===document.readyState||"complete"===document.readyState){clearInterval(e);var i=document.querySelectorAll(t.selector);t.forEach(i,function(e){return t.renderElement(e)})}},10)},t.prototype.renderElement=function(t){var e=this;t.sticky={},t.sticky.active=!1,t.sticky.marginTop=parseInt(t.getAttribute("data-margin-top"))||this.options.marginTop,t.sticky.stickyFor=parseInt(t.getAttribute("data-sticky-for"))||this.options.stickyFor,t.sticky.stickyClass=t.getAttribute("data-sticky-class")||this.options.stickyClass,t.sticky.container=this.getStickyContainer(t),t.sticky.container.rect=this.getRectangle(t.sticky.container),t.sticky.rect=this.getRectangle(t),"img"===t.tagName.toLowerCase&&(t.onload=function(){return t.sticky.rect=e.getRectangle(t)}),this.activate(t)},t.prototype.activate=function(t){t.sticky.stickyFor<this.vp.width&&!t.sticky.active&&(t.sticky.active=!0),this.addStyle(t,{"-webkit-transform":"translate3d(0, 0, 0)","-ms-transform":"translate3d(0, 0, 0)",transform:"translate3d(0, 0, 0)","-webkit-perspective":1e3,"-ms-perspective":1e3,perspective:1e3,"-webkit-backface-visibility":"hidden","backface-visibility":"hidden"}),this.elements.push(t),this.initResizeEvents(t),this.initScrollEvents(t)},t.prototype.initResizeEvents=function(t){var e=this;t.sticky.resizeListener=function(){return e.onResizeEvents(t)},window.addEventListener("resize",t.sticky.resizeListener)},t.prototype.onResizeEvents=function(t){this.vp=this.getViewportSize(),t.sticky.rect=this.getRectangle(t),t.sticky.container.rect=this.getRectangle(t.sticky.container),t.sticky.stickyFor<this.vp.width&&!t.sticky.active?t.sticky.active=!0:t.sticky.stickyFor>=this.vp.width&&t.sticky.active&&(t.sticky.active=!1),this.setPosition(t)},t.prototype.initScrollEvents=function(t){var e=this;t.sticky.scrollListener=function(){return e.onScrollEvents(t)},window.addEventListener("scroll",t.sticky.scrollListener)},t.prototype.onScrollEvents=function(t){this.scrollTop=this.getScrollTopPosition(),t.sticky.active&&this.setPosition(t)},t.prototype.setPosition=function(t){this.removeStyle(t,["position","width","top","left"]),this.vp.height<t.sticky.rect.height||!t.sticky.active||(t.sticky.rect.width||(t.sticky.rect=this.getRectangle(t)),this.scrollTop>t.sticky.rect.top-t.sticky.marginTop?(this.addStyle(t,{position:"fixed",width:t.sticky.rect.width+"px",left:t.sticky.rect.left+"px"}),this.scrollTop+t.sticky.rect.height+t.sticky.marginTop>t.sticky.container.rect.top+t.sticky.container.rect.height?(t.sticky.stickyClass&&t.classList.remove(t.sticky.stickyClass),this.addStyle(t,{top:t.sticky.container.rect.top+t.sticky.container.rect.height-(this.scrollTop+t.sticky.rect.height)+"px"})):(t.sticky.stickyClass&&t.classList.add(t.sticky.stickyClass),this.addStyle(t,{top:t.sticky.marginTop+"px"}))):(t.sticky.stickyClass&&t.classList.remove(t.sticky.stickyClass),this.removeStyle(t,["position","width","top","left"])))},t.prototype.update=function(){var t=this;this.forEach(this.elements,function(e){e.sticky.rect=t.getRectangle(e),e.sticky.container.rect=t.getRectangle(e.sticky.container),t.setPosition(e)})},t.prototype.getStickyContainer=function(t){for(var e=t;!e.hasAttribute("data-sticky-container")&&e!==document.querySelector("body");)e=e.parentNode;return e},t.prototype.getRectangle=function(t){this.removeStyle(t,["position","width","top","left"]);var e=0,i=0,s=0,o=0;s=t.offsetWidth,o=t.offsetHeight;do e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.offsetParent;while(t);return{top:e,left:i,width:s,height:o}},t.prototype.getViewportSize=function(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}},t.prototype.getScrollTopPosition=function(){return(window.pageYOffset||document.scrollTop)-(document.clientTop||0)||0},t.prototype.forEach=function(t,e){for(var i=0,s=t.length;i<s;i++)e(t[i])},t.prototype.addStyle=function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t.style[i]=e[i])},t.prototype.removeStyle=function(t,e){this.forEach(e,function(e){t.style[e]=""})},t}();!function(t,e){"undefined"!=typeof exports?module.exports=e:"function"==typeof define&&define.amd?define([],e):t.Sticky=e}(this,Sticky);