"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},Sticky=function(t){var e=this;e.selector=t,e.vp=e.getViewportSize(),e.scrollTop=e.getScrollTopPosition(),e.initialize()};Sticky.prototype={initialize:function(){var t=this;this.elements=document.querySelectorAll(this.selector);var e=setInterval(function(){if("interactive"===document.readyState||"complete"===document.readyState){for(var i=0,o=t.elements.length;i<o;i++)t.activate(t.elements[i]);clearInterval(e)}},100)},activate:function(t){var e=this;t.sticky={},t.sticky.marginTop=t.getAttribute("data-margin-top")?parseInt(t.getAttribute("data-margin-top")):0,t.sticky.rect=this.getRect(t),"img"===t.tagName.toLowerCase()&&(t.onload=function(){return t.sticky.rect=e.getRect(t)}),t.sticky.container=this.getContainer(t),t.sticky.container.rect=this.getRect(t.sticky.container),window.addEventListener("resize",function(){e.vp=e.getViewportSize(),e.updateRect(t),e.setPosition(t)}),window.addEventListener("scroll",function(){return e.scrollTop=e.getScrollTopPosition()}),window.addEventListener("scroll",function(){return e.setPosition(t)}),this.setPosition(t)},getRect:function(t){var e=this.getTopLeftPosition(t);return e.width=t.offsetWidth,e.height=t.offsetHeight,e},updateRect:function(t){this.removeStyle(t,["position","width","top","left"]),t.sticky.rect=this.getRect(t),t.sticky.container.rect=this.getRect(t.sticky.container)},getTopLeftPosition:function(t){var e=0,i=0;do e+=t.offsetTop||0,i+=t.offsetLeft||0,t=t.offsetParent;while(t);return{top:e,left:i}},getContainer:function(t){for(var e=t;"string"!=typeof e.getAttribute("data-sticky-container")&&e!==document.documentElement;)e=e.parentNode;return e},getViewportSize:function(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}},getScrollTopPosition:function(){return(window.pageYOffset||document.scrollTop)-(document.clientTop||0)||0},setPosition:function(t){this.vp.height<t.sticky.rect.height||(this.removeStyle(t,["position","width","top","left"]),this.scrollTop>t.sticky.rect.top-t.sticky.marginTop?(this.addStyle(t,{position:"fixed",width:t.sticky.rect.width+"px",left:t.sticky.rect.left+"px"}),this.scrollTop+t.sticky.rect.height+t.sticky.marginTop>t.sticky.container.rect.top+t.sticky.container.rect.height?this.addStyle(t,{top:t.sticky.container.rect.top+t.sticky.container.rect.height-(this.scrollTop+t.sticky.rect.height)+"px"}):this.addStyle(t,{top:t.sticky.marginTop+"px"})):this.removeStyle(t,["position","width","top","left"]))},update:function(){for(var t=0,e=this.elements.length;t<e;t++)this.updateRect(this.elements[t]),this.setPosition(this.elements[t])},addStyle:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t.style[i]=e[i])},removeStyle:function(t,e){for(var i=0,o=e.length;i<o;i++)t.style[e[i]]=null}},"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)&&(module.exports=exports=Sticky);