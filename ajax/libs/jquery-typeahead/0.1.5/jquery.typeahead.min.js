!function(e,t,n,a){e.Typeahead={source:{}},"function"!=typeof Object.preventExtensions&&(Object.preventExtensions=function(e){return e});var o={input:null,minLength:2,maxItem:8,order:null,position:"any",list:!1,group:!1,filter:!1,backdrop:!1,jStorage:!1,ttl:36e5,compression:!1,containerClass:"typeahead-search-container",fieldClass:"typeahead-search-field",groupClass:"typeahead-search-group",resultClass:"typeahead-search-result",backdropClass:"typeahead-search-backdrop",source:null,callback:{onInit:null,onMouseEnter:null,onMouseLeave:null,onClick:null},debug:!1},r={order:["asc","desc"],position:["any","start"],group:[!0,!1],jStorage:[!0,!1],compression:[!0,!1],debug:[!0,!1]},i={filter:"typeahead-filter",dropdown:"typeahead-dropdown"},s=function(a,s){function l(){n.jStorage&&s.jStorage||s.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"options.jStorage",message:"WARNING - It is strongly recommended to have $.jStorage available and the option activated to store the results"});for(var t in s)if(s.hasOwnProperty(t))if("source"===t)for(var i in s[t])s[t].hasOwnProperty(i)&&(s[t][i]instanceof Object&&"data"!==i||(i="list",s[t]={list:s[t]}));else r[t]&&-1===n.inArray(s[t],r[t])&&(s.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"{"+t+":"+JSON.stringify(s[t])+"}",message:"WARNING - Unsupported option: "+t}),delete s[t]);s=n.extend(!0,Object.preventExtensions(n.extend(!0,{},o)),s)}function c(){S(s.callback.onInit,[a]),s.debug&&e.Debug.log({node:a.selector,function:"delegateTypeahead()",arguments:JSON.stringify(s),message:"OK - Typeahead activated on "+a.selector});var t=["focus.typeahead","keyup.typeahead","keypress.typeahead","keydown.typeahead"];n("html").on("click.typeahead",function(){d()}),n(a).parents("."+s.containerClass).on("click.typeahead",function(e){e.stopPropagation()}),n(a).on(t.join(" "),function(e){"focus"!==e.type||y||f();var t=this,o=s.filter&&n(a).parents("."+s.containerClass).find("."+i.filter).text();o&&o.toLowerCase()===s.filter.toLowerCase()&&(o=null),setTimeout(function(){if(!y||n(t).val()===h)return!1;h=n(t).val().toLowerCase().trim(),d(),h.length>=s.minLength&&""!==h&&(u(o),p())},0,e,t)})}function u(e){if(""===h)return!1;for(var t in m)if(!e||t===e)for(var a in m[t]){if(v.length>=s.maxItem)break;if(m[t][a].display&&-1!==m[t][a].display.toLowerCase().indexOf(h)&&("any"===s.position||0===m[t][a].display.toLowerCase().indexOf(h))){if(s.source[t].ignore&&-1!==n.inArray(m[t][a].display,s.source[t].ignore))continue;m[t][a].list=t,v.push(m[t][a])}}s.order&&v.sort(O("display",s.group?!("asc"===s.order):!("asc"!==s.order),function(e){return e.toUpperCase()}))}function p(){if(0!==v.length){var e,t=n("<div/>",{class:s.resultClass,html:n("<ul/>",{html:function(){for(var t in v)!function(t,o){s.group&&!n(o).find('li[data-search-group="'+t.list+'"]')[0]&&n(o).append(n("<li/>",{class:s.groupClass,html:n("<a/>",{html:t.list}),"data-search-group":t.list})),e=t.display.match(new RegExp(h,"i"));var r=n("<li/>",{html:n("<a/>",{href:"javascript:;","data-list":t.list,html:t.display.replace(new RegExp(h,"i"),"<strong>"+e[0]+"</strong>")+(s.list?"<small>"+t.list+"</small>":""),click:function(e){e.preventDefault(),n(a).val(t.display).focus(),h=t.display,d(),S(s.callback.onClick,[a,this,t])},mouseenter:function(){S(s.callback.onMouseEnter,[a,this,t])},mouseleave:function(){S(s.callback.onMouseLeave,[a,this,t])}})});s.group?n(r).insertAfter(n(o).find('li[data-search-group="'+t.list+'"]')):n(o).append(r)}(v[t],this)}})});n(a).parents("."+s.containerClass).addClass("result").append(t)}if(s.backdrop){var o=n.extend({opacity:.6,filter:"alpha(opacity=60)",position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1040,"background-color":"#000"},s.backdrop);n(a).parents("."+s.containerClass).addClass("backdrop").css({"z-index":o["z-index"]+1,position:"relative"}),n("<div/>",{class:s.backdropClass,css:o,click:function(){d()}}).insertAfter(n(a).parents("."+s.containerClass))}}function d(){v=[];var e=n(a).parents("."+s.containerClass);s.filter&&e.removeClass("filter").find("."+i.dropdown).hide(),e.removeClass("result").find("."+s.resultClass).remove(),e.removeClass("backdrop").removeAttr("style").siblings("."+s.backdropClass).remove()}function f(){var t=s.source;if(0===j)for(var o in t)t.hasOwnProperty(o)&&++j;for(var r in t)if(t.hasOwnProperty(r))if(m[r]&&m[r]!==[])C++;else if(s.jStorage&&n.jStorage&&(m[r]=n.jStorage.get(a.selector+":"+r),m[r]))s.compression&&"object"==typeof LZString&&(m[r]=JSON.parse(LZString.decompress(m[r]))),C++;else{if(m[r]=[],t[r].data&&t[r].data instanceof Array){for(var i in t[r].data){if(t[r].data[i]instanceof Object)break;t[r].data[i]={display:t[r].data[i]}}if(m[r]=m[r].concat(t[r].data),!t[r].url){x(r),C++;continue}}if(t[r].url){var l=t[r].url instanceof Array&&t[r].url[0]||t[r].url,c=t[r].url instanceof Array&&t[r].url[1]||null;/https?:\/\//.test(l)&&-1===l.indexOf(e.location.host)?w.fetch(l.replace("{callback}",encodeURIComponent(b)),function(e){}):n.ajax({async:!0,url:l,ajaxList:r,ajaxPath:c}).done(function(e){k(e,this.ajaxList,this.ajaxPath),++C===j&&(y=!0,console.log("ALL LIST FETCHED (done ajax)"))}).fail(function(e){++C===j&&(y=!0,console.log("ALL LIST FETCHED (fail ajax)"))})}}C===j&&(y=!0,console.log("ALL LIST FETCHED (regular function)"))}function g(){if(!s.filter)return!1;n("<span/>",{class:"list",html:function(){n(this).append(n("<button/>",{type:"button",html:"<span class='"+i.filter+"'>"+s.filter+"</span> <span class='caret'></span>",click:function(){n(this).parents("."+s.containerClass).addClass("filter").find("."+i.dropdown).show()}})),n(this).append(n("<ul/>",{class:i.dropdown,html:function(){for(var e in s.source)!function(e,t){var o=n("<li/>",{html:n("<a/>",{href:"javascript:;",html:e,click:function(t){t.preventDefault(),n(a).parents("."+s.containerClass).find("."+i.filter).text(e),n(a).parents("."+s.containerClass).find("."+i.dropdown).hide(),d(),u(e),p()}})});n(t).append(o)}(e,this);n(this).append(n("<li/>",{class:"divider"})),n(this).append(n("<li/>",{html:n("<a/>",{href:"javascript:;",html:s.filter,click:function(e){e.preventDefault(),n(this).parents("."+s.containerClass).find("."+i.filter).text(n(this).text()),n(a).parents("."+s.containerClass).find("."+i.dropdown).hide(),d(),u(),p()}})}))}}))}}).insertAfter(n(a).parents("."+s.containerClass).find(".query"))}var h="",y=!1,m={},v=[],b="window.Typeahead.source['"+a.selector+"'].populate",C=0,j=0,k=function(e,t,n){var a=!0;if(n)for(var o=n.split("."),r=0;r<o.length;){if(void 0===e){a=!1;break}e=e[o[r++]]}if(a){for(var i in e){if(e[i]instanceof Object)break;e[i]={display:e[i]}}m[t]=m[t].concat(e),x(t)}},x=function(e){if(!s.jStorage||!n.jStorage)return!1;var t=m[e];s.compression&&"object"==typeof LZString&&(t=LZString.compress(JSON.stringify(t))),n.jStorage.set(a.selector+":"+e,t,{TTL:s.ttl})},O=function(e,t,n){var a=n?function(t){return n(t[e])}:function(t){return t[e]};return t=[-1,1][+!!t],function(e,n){return e=a(e),n=a(n),t*((e>n)-(n>e))}},S=function(t,o){if(!t)return!1;var r;if("function"==typeof t)r=t;else if("string"==typeof t||t instanceof Array){r=e,"string"==typeof t&&(t=[t,[]]);for(var i=t[0].split("."),l=t[1],c=!0,u=0;u<i.length;){if(void 0===r){c=!1;break}r=r[i[u++]]}if(!c||"function"!=typeof r)return s.debug&&e.Debug.log({node:a.selector,function:"_executeCallback()",arguments:JSON.stringify(t),message:'WARNING - Invalid callback function"'}),!1}return r.apply(this,n.merge(l||[],o||[])),!0},w={fetch:function(n,a){var o=encodeURIComponent(b);e[o]=this.evalJSONP(a),n=n.replace("="+b,"="+o);var r=t.createElement("SCRIPT");r.src=n,t.getElementsByTagName("HEAD")[0].appendChild(r)},evalJSONP:function(e){return function(t){var n=!1;if("string"==typeof t)try{n=JSON.parse(t)}catch(e){}else n=JSON.parse(JSON.stringify(t));if(!n)throw"JSONP call returned invalid or empty JSON";e(n)}}};return this.__construct=(l(),c(),g(),void(e.Debug&&e.Debug.print())),{populate:function(t){if(!t||!t.list)return s.debug&&e.Debug.log({node:a.selector,function:"populate()",message:'ERROR - Empty data or Missing {data.list} parameter"'}),e.Debug.print(),!1;var n=t.list||"list",o=s.source[n].url instanceof Array?s.source[n].url[1]:null;k(t,n,o),++C===j&&(y=!0,console.log("ALL LIST FETCHED"))}}};n.fn.typeahead=n.typeahead=function(e){return l.typeahead(this,e)};var l={typeahead:function(t,a){if(!a||!a.source)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:"",message:"Missing source option - Typeahead dropped"}),void e.Debug.print();if("function"==typeof t){if(!a.input)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:"",message:'Undefined property "options.input - Typeahead dropped'}),void e.Debug.print();if(!(t=n(a.input))[0]||t.length>1)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:JSON.stringify(a.input),message:"Unable to find jQuery input element OR more than 1 input is found - Typeahead dropped"}),void e.Debug.print()}else if(void 0===t[0]||t.length>1)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:'$("'+t.selector+'").typeahead()',message:"Unable to find jQuery input element OR more than 1 input is found - Typeahead dropped"}),void e.Debug.print();return t.each(function(){e.Typeahead.source[t.selector]=new s(t,a)})}};e.Debug={table:{},log:function(e){if(!e.message||"string"!=typeof e.message)return!1;this.table[e.message]=n.extend(Object.preventExtensions({node:"",function:"",arguments:""}),e)},print:function(){if(n.isEmptyObject(this.table))return!1;void 0!==console.group||void 0!==console.table?(console.groupCollapsed("--- jQuery Typeahead Debug ---"),console.table?console.table(this.table):n.each(this.table,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()):console.log("Debug is not available on your current browser, try the most recent version of Chrome or Firefox."),this.table={}}}}(window,document,window.jQuery);