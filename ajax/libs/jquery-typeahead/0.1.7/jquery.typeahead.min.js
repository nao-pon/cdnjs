!function(e,t,n,a){e.Typeahead={source:{}},"function"!=typeof Object.preventExtensions&&(Object.preventExtensions=function(e){return e});var r={input:null,minLength:2,maxItem:8,order:null,position:"any",list:!1,group:!1,filter:!1,backdrop:!1,jStorage:!1,ttl:36e5,compression:!1,containerClass:"typeahead-search-container",fieldClass:"typeahead-search-field",groupClass:"typeahead-search-group",resultClass:"typeahead-search-result",backdropClass:"typeahead-search-backdrop",source:null,callback:{onInit:null,onMouseEnter:null,onMouseLeave:null,onClick:null},debug:!1},o={order:["asc","desc"],position:["any","start"],group:[!0,!1],jStorage:[!0,!1],compression:[!0,!1],debug:[!0,!1]},s={query:"typeahead-query",filter:"typeahead-filter",button:"typeahead-button",filterValue:"typeahead-filter-value",dropdown:"typeahead-dropdown"},i=function(a,i){function l(){n.jStorage&&i.jStorage||i.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"options.jStorage",message:"WARNING - It is strongly recommended to have $.jStorage available and the option activated to store the results"});for(var t in i)if(i.hasOwnProperty(t))if("source"===t){"{}"===JSON.stringify(i[t])&&i.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"{options.source}",message:"ERROR - source.list.url or source.list.data is Required"});for(var s in i[t])i[t].hasOwnProperty(s)&&(i[t][s]instanceof Object&&"data"!==s||(s="list",i[t]={list:i[t]}),i[t][s].url||i[t][s].data||r.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"{options.source}",message:"ERROR - source.list.url or source.list.data is Required"}))}else o[t]&&-1===n.inArray(i[t],o[t])&&(i.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"{"+t+":"+JSON.stringify(i[t])+"}",message:"WARNING - Unsupported option: "+t}),delete i[t]);i=n.extend(!0,Object.preventExtensions(n.extend(!0,{},r)),i)}function c(){D(i.callback.onInit,[a]),i.debug&&e.Debug.log({node:a.selector,function:"delegateTypeahead()",arguments:JSON.stringify(i),message:"OK - Typeahead activated on "+a.selector});var t=".typeahead.input",r=["focus"+t,"keyup"+t];n("html").on("click"+t,function(e){f()}),n(a).parents("."+i.containerClass).on("click"+t,function(e){e.stopPropagation(),i.filter&&n(a).parents("."+i.containerClass).find("."+s.dropdown).hide()}),n(a).on(r.join(" "),function(e){if(e.keyCode&&-1!==n.inArray(e.keyCode,[38,39,40]))p(e);else if("focus"!==e.type||null!==y){var t=i.filter&&n(a).parents("."+i.containerClass).find("."+s.filterValue).text();if(t&&t.toLowerCase()===i.filter.toLowerCase()&&(t=null),!y||n(this).val()===v)return!1;v=n(this).val().toLowerCase().trim(),f(),v.length>=i.minLength&&""!==v&&(u(t),d())}else g()})}function u(e){if(""===v)return!1;for(var t in m)if(!e||t===e)for(var a in m[t]){if(b.length>=i.maxItem)break;if(m[t][a].display&&-1!==m[t][a].display.toLowerCase().indexOf(v)&&("any"===i.position||0===m[t][a].display.toLowerCase().indexOf(v))){if(i.source[t].ignore&&-1!==n.inArray(m[t][a].display,i.source[t].ignore))continue;m[t][a].list=t,b.push(m[t][a])}}i.order&&b.sort(S("display",i.group?!("asc"===i.order):!("asc"!==i.order),function(e){return e.toUpperCase()}))}function d(){if(0!==b.length){var e,t=n("<div/>",{class:i.resultClass,html:n("<ul/>",{html:function(){for(var t in b)!function(t,r){i.group&&!n(r).find('li[data-search-group="'+t.list+'"]')[0]&&n(r).append(n("<li/>",{class:i.groupClass,html:n("<a/>",{html:t.list}),"data-search-group":t.list})),e=t.display.match(new RegExp(v,"i"));var o=n("<li/>",{html:n("<a/>",{href:"javascript:;","data-list":t.list,html:t.display.replace(new RegExp(v,"i"),"<strong>"+e[0]+"</strong>")+(i.list?"<small>"+t.list+"</small>":""),click:function(e){e.preventDefault(),n(a).val(t.display).focus(),v=t.display,f(),D(i.callback.onClick,[a,this,t])},mouseenter:function(){n(this).parents("."+i.resultClass).find(".active").removeClass("active"),D(i.callback.onMouseEnter,[a,this,t])},mouseleave:function(){D(i.callback.onMouseLeave,[a,this,t])}}),mouseenter:function(){n(this).siblings("li.active").removeClass("active"),n(this).addClass("active")}});i.group?n(o).insertAfter(n(r).find('li[data-search-group="'+t.list+'"]')):n(r).append(o)}(b[t],this)}})});n(a).parents("."+i.containerClass).addClass("result").append(t)}if(i.backdrop&&""!==v){var r=n.extend({opacity:.6,filter:"alpha(opacity=60)",position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1040,"background-color":"#000"},i.backdrop);n(a).parents("."+i.containerClass).addClass("backdrop").css({"z-index":r["z-index"]+1,position:"relative"}),n("<div/>",{class:i.backdropClass,css:r,click:function(){f()}}).insertAfter(n(a).parents("."+i.containerClass))}}function p(e){if(0===b.length)return!1;var t=n(a).parents("."+i.containerClass).find("."+i.resultClass).find("li:not([data-search-group])"),r=t.siblings(".active");if(r.removeClass("active"),40===e.keyCode)e.preventDefault(),r[0]?r.next().addClass("active"):n(t[0]).addClass("active");else if(38===e.keyCode)e.preventDefault(),r[0]?r.prev().addClass("active"):n(t[b.length-1]).addClass("active");else if(39===e.keyCode)return void f();if(i.group){var o=t.siblings(".active");o.attr("data-search-group")&&(o.removeClass("active"),40===e.keyCode?o.next().addClass("active"):38===e.keyCode&&o.prev().addClass("active"))}n(a).val(t.filter(".active").clone().find("small").remove().end().text().toLowerCase()||v)}function f(){b=[];var e=n(a).parents("."+i.containerClass);i.filter&&e.removeClass("filter").find("."+s.dropdown).hide(),e.removeClass("result").find("."+i.resultClass).remove(),e.removeClass("backdrop").removeAttr("style").siblings("."+i.backdropClass).remove()}function g(){function t(){++k===O&&(y=!0)}if(y=!1,0===O)for(var r in i.source)i.source.hasOwnProperty(r)&&++O;for(var o in i.source)if(i.source.hasOwnProperty(o))if(m[o]&&0!==m[o].length)t();else if(i.jStorage&&n.jStorage&&(m[o]=n.jStorage.get(a.selector+":"+o),m[o]))i.compression&&"object"==typeof LZString&&(m[o]=JSON.parse(LZString.decompress(m[o]))),t();else{if(m[o]=[],i.source[o].data&&i.source[o].data instanceof Array){for(var s in i.source[o].data){if(i.source[o].data[s]instanceof Object)break;i.source[o].data[s]={display:i.source[o].data[s]}}if(m[o]=m[o].concat(i.source[o].data),!i.source[o].url){j(o),t();continue}}if(i.source[o].url){var l=i.source[o].url instanceof Array&&i.source[o].url[0]||i.source[o].url,c=i.source[o].url instanceof Array&&i.source[o].url[1]||null;if(/https?:\/\//.test(l)&&-1===l.indexOf(e.location.host)){if(-1===l.indexOf("{callback}")){i.debug&&e.Debug.log({node:a.selector,function:"generate()",arguments:"url",message:'ERROR - Missing {callback} string inside url, " + list + " skipped.'}),t();continue}w.fetch(l.replace("{callback}",encodeURIComponent(C)),function(e){})}else n.ajax({async:!0,url:l,ajaxList:o,ajaxPath:c}).done(function(e){x(e,this.ajaxList,this.ajaxPath),t()}).fail(function(n){i.debug&&e.Debug.log({node:a.selector,function:"generate()",arguments:"{source: "+this.ajaxList+"}",message:"ERROR - Ajax request failed."}),t()})}}}function h(){function e(e){n(a).parents("."+i.containerClass).find("."+s.filterValue).text(e||i.filter),n(a).parents("."+i.containerClass).find("."+s.dropdown).hide(),f(),u(e),d(),n(a).focus()}if(!i.filter)return!1;n("<span/>",{class:s.filter,html:function(){n(this).append(n("<button/>",{type:"button",html:"<span class='"+s.filterValue+"'>"+i.filter+"</span> <span class='caret'></span>",click:function(e){e.stopPropagation();var t=n(this).parents("."+i.containerClass),a=t.find("."+s.dropdown);a.is(":visible")?(t.removeClass("filter"),a.hide()):(t.addClass("filter"),a.show())}})),n(this).append(n("<ul/>",{class:s.dropdown,html:function(){for(var t in i.source)!function(t,a){var r=n("<li/>",{html:n("<a/>",{href:"javascript:;",html:t,click:function(n){n.preventDefault(),e(t)}})});n(a).append(r)}(t,this);n(this).append(n("<li/>",{class:"divider"})),n(this).append(n("<li/>",{html:n("<a/>",{href:"javascript:;",html:i.filter,click:function(t){t.preventDefault(),e()}})}))}}))}}).insertAfter(n(a).parents("."+i.containerClass).find("."+s.query))}var v="",y=null,m=[],b=[],C="window.Typeahead.source['"+a.selector+"'].populate",k=0,O=0,x=function(e,t,n){var a=!0;if(n)for(var r=n.split("."),o=0;o<r.length;){if(void 0===e){a=!1;break}e=e[r[o++]]}if(a){for(var s in e){if(e[s]instanceof Object)break;e[s]={display:e[s]}}m[t]=m[t].concat(e),j(t)}},j=function(e){if(!i.jStorage||!n.jStorage)return!1;var t=m[e];i.compression&&"object"==typeof LZString&&(t=LZString.compress(JSON.stringify(t))),n.jStorage.set(a.selector+":"+e,t,{TTL:i.ttl})},S=function(e,t,n){var a=n?function(t){return n(t[e])}:function(t){return t[e]};return t=[-1,1][+!!t],function(e,n){return e=a(e),n=a(n),t*((e>n)-(n>e))}},D=function(t,r){if(!t)return!1;var o;if("function"==typeof t)o=t;else if("string"==typeof t||t instanceof Array){o=e,"string"==typeof t&&(t=[t,[]]);for(var s=t[0].split("."),l=t[1],c=!0,u=0;u<s.length;){if(void 0===o){c=!1;break}o=o[s[u++]]}if(!c||"function"!=typeof o)return i.debug&&e.Debug.log({node:a.selector,function:"_executeCallback()",arguments:JSON.stringify(t),message:'WARNING - Invalid callback function"'}),!1}return o.apply(this,n.merge(l||[],r||[])),!0},w={fetch:function(n,a){var r=encodeURIComponent(C);e[r]=this.evalJSONP(a),n=n.replace("="+C,"="+r);var o=t.createElement("SCRIPT");o.src=n,t.getElementsByTagName("HEAD")[0].appendChild(o)},evalJSONP:function(e){return function(t){var n=!1;if("string"==typeof t)try{n=JSON.parse(t)}catch(e){}else n=JSON.parse(JSON.stringify(t));if(!n)throw"JSONP call returned invalid or empty JSON";e(n)}}};return this.__construct=(l(),c(),h(),void(e.Debug&&e.Debug.print())),{populate:function(t){if(!t||!t.list)return i.debug&&e.Debug.log({node:a.selector,function:"populate()",message:'ERROR - Empty data or Missing {data.list} parameter"'}),e.Debug.print(),!1;var n=t.list||"list",r=i.source[n].url instanceof Array?i.source[n].url[1]:null;x(t,n,r),++k===O&&(y=!0,console.log("ALL LIST FETCHED"))}}};n.fn.typeahead=n.typeahead=function(e){return l.typeahead(this,e)};var l={typeahead:function(t,a){if(!a||!a.source)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:"",message:"Missing source option - Typeahead dropped"}),void e.Debug.print();if("function"==typeof t){if(!a.input)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:"",message:'Undefined property "options.input - Typeahead dropped'}),void e.Debug.print();if(!(t=n(a.input))[0]||t.length>1)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:JSON.stringify(a.input),message:"Unable to find jQuery input element OR more than 1 input is found - Typeahead dropped"}),void e.Debug.print()}else if(void 0===t[0]||t.length>1)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:'$("'+t.selector+'").typeahead()',message:"Unable to find jQuery input element OR more than 1 input is found - Typeahead dropped"}),void e.Debug.print();return t.each(function(){e.Typeahead.source[t.selector]=new i(t,a)})}};e.Debug={table:{},log:function(e){if(!e.message||"string"!=typeof e.message)return!1;this.table[e.message]=n.extend(Object.preventExtensions({node:"",function:"",arguments:""}),e)},print:function(){if(n.isEmptyObject(this.table))return!1;void 0!==console.group||void 0!==console.table?(console.groupCollapsed("--- jQuery Typeahead Debug ---"),console.table?console.table(this.table):n.each(this.table,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()):console.log("Debug is not available on your current browser, try the most recent version of Chrome or Firefox."),this.table={}}}}(window,document,window.jQuery);