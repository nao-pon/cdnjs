!function(e,t,n,a){e.Typeahead={source:{}},"function"!=typeof Object.preventExtensions&&(Object.preventExtensions=function(e){return e});var o={input:null,minLength:2,maxItem:8,order:null,position:"any",list:!1,group:!1,filter:!1,backdrop:!1,jStorage:!1,ttl:36e5,compression:!1,containerClass:"typeahead-search-container",fieldClass:"typeahead-search-field",groupClass:"typeahead-search-group",resultClass:"typeahead-search-result",backdropClass:"typeahead-search-backdrop",source:null,callback:{onInit:null,onMouseEnter:null,onMouseLeave:null,onClick:null},debug:!1},r={order:["asc","desc"],position:["any","start"],group:[!0,!1],jStorage:[!0,!1],compression:[!0,!1],debug:[!0,!1]},i={filter:"typeahead-filter",dropdown:"typeahead-dropdown"},s=function(a,s){function l(){n.jStorage&&s.jStorage||s.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"options.jStorage",message:"WARNING - It is strongly recommended to have $.jStorage available and the option activated to store the results"});for(var t in s)if(s.hasOwnProperty(t))if("source"===t){"{}"===JSON.stringify(s[t])&&s.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"{options.source}",message:"ERROR - source.list.url or source.list.data is Required"});for(var i in s[t])s[t].hasOwnProperty(i)&&(s[t][i]instanceof Object&&"data"!==i||(i="list",s[t]={list:s[t]}),s[t][i].url||s[t][i].data||o.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"{options.source}",message:"ERROR - source.list.url or source.list.data is Required"}))}else r[t]&&-1===n.inArray(s[t],r[t])&&(s.debug&&e.Debug.log({node:a.selector,function:"extendOptions()",arguments:"{"+t+":"+JSON.stringify(s[t])+"}",message:"WARNING - Unsupported option: "+t}),delete s[t]);s=n.extend(!0,Object.preventExtensions(n.extend(!0,{},o)),s)}function c(){D(s.callback.onInit,[a]),s.debug&&e.Debug.log({node:a.selector,function:"delegateTypeahead()",arguments:JSON.stringify(s),message:"OK - Typeahead activated on "+a.selector});var t=["filter.typeahead","focus.typeahead","keydown.typeahead"];n("html").on("click.typeahead",function(){f()}),n(a).parents("."+s.containerClass).on("click.typeahead",function(e){e.stopPropagation()}),n(a).on(t.join(" "),function(e){if(e.keyCode&&-1!==n.inArray(e.keyCode,[38,39,40]))p(e);else{"focus"!==e.type||y||g();var t=this,o=s.filter&&n(a).parents("."+s.containerClass).find("."+i.filter).text();o&&o.toLowerCase()===s.filter.toLowerCase()&&(o=null),setTimeout(function(){if(!y||n(t).val()===v)return!1;v=n(t).val().toLowerCase().trim(),f(),v.length>=s.minLength&&""!==v&&(u(o),d())},0,e,t)}})}function u(e){if(""===v)return!1;for(var t in m)if(!e||t===e)for(var a in m[t]){if(b.length>=s.maxItem)break;if(m[t][a].display&&-1!==m[t][a].display.toLowerCase().indexOf(v)&&("any"===s.position||0===m[t][a].display.toLowerCase().indexOf(v))){if(s.source[t].ignore&&-1!==n.inArray(m[t][a].display,s.source[t].ignore))continue;m[t][a].list=t,b.push(m[t][a])}}s.order&&b.sort(S("display",s.group?!("asc"===s.order):!("asc"!==s.order),function(e){return e.toUpperCase()}))}function d(){if(0!==b.length){var e,t=n("<div/>",{class:s.resultClass,html:n("<ul/>",{html:function(){for(var t in b)!function(t,o){s.group&&!n(o).find('li[data-search-group="'+t.list+'"]')[0]&&n(o).append(n("<li/>",{class:s.groupClass,html:n("<a/>",{html:t.list}),"data-search-group":t.list})),e=t.display.match(new RegExp(v,"i"));var r=n("<li/>",{html:n("<a/>",{href:"javascript:;","data-list":t.list,html:t.display.replace(new RegExp(v,"i"),"<strong>"+e[0]+"</strong>")+(s.list?"<small>"+t.list+"</small>":""),click:function(e){e.preventDefault(),n(a).val(t.display).focus(),v=t.display,f(),D(s.callback.onClick,[a,this,t])},mouseenter:function(){n(this).parents("."+s.resultClass).find(".active").removeClass("active"),D(s.callback.onMouseEnter,[a,this,t])},mouseleave:function(){D(s.callback.onMouseLeave,[a,this,t])}}),mouseenter:function(){n(this).siblings("li.active").removeClass("active"),n(this).addClass("active")}});s.group?n(r).insertAfter(n(o).find('li[data-search-group="'+t.list+'"]')):n(o).append(r)}(b[t],this)}})});n(a).parents("."+s.containerClass).addClass("result").append(t)}if(s.backdrop&&""!==v){var o=n.extend({opacity:.6,filter:"alpha(opacity=60)",position:"fixed",top:0,right:0,bottom:0,left:0,"z-index":1040,"background-color":"#000"},s.backdrop);n(a).parents("."+s.containerClass).addClass("backdrop").css({"z-index":o["z-index"]+1,position:"relative"}),n("<div/>",{class:s.backdropClass,css:o,click:function(){f()}}).insertAfter(n(a).parents("."+s.containerClass))}}function p(e){if(0===b.length)return!1;var t=n(a).parents("."+s.containerClass).find("."+s.resultClass).find("li:not([data-search-group])"),o=t.siblings(".active");if(o.removeClass("active"),40===e.keyCode)e.preventDefault(),o[0]?o.next().addClass("active"):n(t[0]).addClass("active");else if(38===e.keyCode)e.preventDefault(),o[0]?o.prev().addClass("active"):n(t[b.length-1]).addClass("active");else if(39===e.keyCode)return void f();if(s.group){var r=t.siblings(".active");r.attr("data-search-group")&&(r.removeClass("active"),40===e.keyCode?r.next().addClass("active"):38===e.keyCode&&r.prev().addClass("active"))}n(a).val(t.siblings(".active").text().toLowerCase()||v)}function f(){b=[];var e=n(a).parents("."+s.containerClass);s.filter&&e.removeClass("filter").find("."+i.dropdown).hide(),e.removeClass("result").find("."+s.resultClass).remove(),e.removeClass("backdrop").removeAttr("style").siblings("."+s.backdropClass).remove()}function g(){var t=s.source;if(0===O)for(var o in t)t.hasOwnProperty(o)&&++O;for(var r in t)if(t.hasOwnProperty(r))if(m[r]&&m[r]!==[])k++;else if(s.jStorage&&n.jStorage&&(m[r]=n.jStorage.get(a.selector+":"+r),m[r]))s.compression&&"object"==typeof LZString&&(m[r]=JSON.parse(LZString.decompress(m[r]))),k++;else{if(m[r]=[],t[r].data&&t[r].data instanceof Array){for(var i in t[r].data){if(t[r].data[i]instanceof Object)break;t[r].data[i]={display:t[r].data[i]}}if(m[r]=m[r].concat(t[r].data),!t[r].url){j(r),k++;continue}}if(t[r].url){var l=t[r].url instanceof Array&&t[r].url[0]||t[r].url,c=t[r].url instanceof Array&&t[r].url[1]||null;if(/https?:\/\//.test(l)&&-1===l.indexOf(e.location.host)){if(-1===l.indexOf("{callback}")){s.debug&&e.Debug.log({node:a.selector,function:"generateList()",arguments:"url",message:'ERROR - Missing {callback} string inside url, " + list + " skipped.'}),k++;continue}L.fetch(l.replace("{callback}",encodeURIComponent(C)),function(e){})}else n.ajax({async:!0,url:l,ajaxList:r,ajaxPath:c}).done(function(e){x(e,this.ajaxList,this.ajaxPath),++k===O&&(y=!0,console.log("ALL LIST FETCHED (done ajax)"))}).fail(function(e){++k===O&&(y=!0,console.log("ALL LIST FETCHED (fail ajax)"))})}}k===O&&(y=!0,console.log("ALL LIST FETCHED (regular function)"))}function h(){function e(e){n(a).parents("."+s.containerClass).find("."+i.filter).text(e||s.filter),n(a).parents("."+s.containerClass).find("."+i.dropdown).hide(),f(),u(e),d(),n(a).focus()}if(!s.filter)return!1;n("<span/>",{class:"list",html:function(){n(this).append(n("<button/>",{type:"button",html:"<span class='"+i.filter+"'>"+s.filter+"</span> <span class='caret'></span>",click:function(){n(this).parents("."+s.containerClass).addClass("filter").find("."+i.dropdown).show()}})),n(this).append(n("<ul/>",{class:i.dropdown,html:function(){for(var t in s.source)!function(t,a){var o=n("<li/>",{html:n("<a/>",{href:"javascript:;",html:t,click:function(n){n.preventDefault(),e(t)}})});n(a).append(o)}(t,this);n(this).append(n("<li/>",{class:"divider"})),n(this).append(n("<li/>",{html:n("<a/>",{href:"javascript:;",html:s.filter,click:function(t){t.preventDefault(),e()}})}))}}))}}).insertAfter(n(a).parents("."+s.containerClass).find(".query"))}var v="",y=!1,m={},b=[],C="window.Typeahead.source['"+a.selector+"'].populate",k=0,O=0,x=function(e,t,n){var a=!0;if(n)for(var o=n.split("."),r=0;r<o.length;){if(void 0===e){a=!1;break}e=e[o[r++]]}if(a){for(var i in e){if(e[i]instanceof Object)break;e[i]={display:e[i]}}m[t]=m[t].concat(e),j(t)}},j=function(e){if(!s.jStorage||!n.jStorage)return!1;var t=m[e];s.compression&&"object"==typeof LZString&&(t=LZString.compress(JSON.stringify(t))),n.jStorage.set(a.selector+":"+e,t,{TTL:s.ttl})},S=function(e,t,n){var a=n?function(t){return n(t[e])}:function(t){return t[e]};return t=[-1,1][+!!t],function(e,n){return e=a(e),n=a(n),t*((e>n)-(n>e))}},D=function(t,o){if(!t)return!1;var r;if("function"==typeof t)r=t;else if("string"==typeof t||t instanceof Array){r=e,"string"==typeof t&&(t=[t,[]]);for(var i=t[0].split("."),l=t[1],c=!0,u=0;u<i.length;){if(void 0===r){c=!1;break}r=r[i[u++]]}if(!c||"function"!=typeof r)return s.debug&&e.Debug.log({node:a.selector,function:"_executeCallback()",arguments:JSON.stringify(t),message:'WARNING - Invalid callback function"'}),!1}return r.apply(this,n.merge(l||[],o||[])),!0},L={fetch:function(n,a){var o=encodeURIComponent(C);e[o]=this.evalJSONP(a),n=n.replace("="+C,"="+o);var r=t.createElement("SCRIPT");r.src=n,t.getElementsByTagName("HEAD")[0].appendChild(r)},evalJSONP:function(e){return function(t){var n=!1;if("string"==typeof t)try{n=JSON.parse(t)}catch(e){}else n=JSON.parse(JSON.stringify(t));if(!n)throw"JSONP call returned invalid or empty JSON";e(n)}}};return this.__construct=(l(),c(),h(),void(e.Debug&&e.Debug.print())),{populate:function(t){if(!t||!t.list)return s.debug&&e.Debug.log({node:a.selector,function:"populate()",message:'ERROR - Empty data or Missing {data.list} parameter"'}),e.Debug.print(),!1;var n=t.list||"list",o=s.source[n].url instanceof Array?s.source[n].url[1]:null;x(t,n,o),++k===O&&(y=!0,console.log("ALL LIST FETCHED"))}}};n.fn.typeahead=n.typeahead=function(e){return l.typeahead(this,e)};var l={typeahead:function(t,a){if(!a||!a.source)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:"",message:"Missing source option - Typeahead dropped"}),void e.Debug.print();if("function"==typeof t){if(!a.input)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:"",message:'Undefined property "options.input - Typeahead dropped'}),void e.Debug.print();if(!(t=n(a.input))[0]||t.length>1)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:JSON.stringify(a.input),message:"Unable to find jQuery input element OR more than 1 input is found - Typeahead dropped"}),void e.Debug.print()}else if(void 0===t[0]||t.length>1)return e.Debug.log({node:t.selector,function:"$.typeahead()",arguments:'$("'+t.selector+'").typeahead()',message:"Unable to find jQuery input element OR more than 1 input is found - Typeahead dropped"}),void e.Debug.print();return t.each(function(){e.Typeahead.source[t.selector]=new s(t,a)})}};e.Debug={table:{},log:function(e){if(!e.message||"string"!=typeof e.message)return!1;this.table[e.message]=n.extend(Object.preventExtensions({node:"",function:"",arguments:""}),e)},print:function(){if(n.isEmptyObject(this.table))return!1;void 0!==console.group||void 0!==console.table?(console.groupCollapsed("--- jQuery Typeahead Debug ---"),console.table?console.table(this.table):n.each(this.table,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()):console.log("Debug is not available on your current browser, try the most recent version of Chrome or Firefox."),this.table={}}}}(window,document,window.jQuery);