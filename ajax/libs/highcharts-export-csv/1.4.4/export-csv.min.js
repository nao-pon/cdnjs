!function(t){"object"==typeof module&&module.exports?module.exports=t:t(Highcharts)}(function(t){"use strict";var e=t.each,o=t.pick,n=t.seriesTypes,i=void 0!==document.createElement("a").download;function a(e,o,n,a,r){var s,c,l,p=((e.options.exporting||{}).csv||{}).url||"http://www.highcharts.com/studies/csv-export/download.php";l=e.options.exporting.filename?e.options.exporting.filename:e.title?e.title.textStr.replace(/ /g,"-").toLowerCase():"chart",window.Blob&&window.navigator.msSaveOrOpenBlob?(c=new Blob([a]),window.navigator.msSaveOrOpenBlob(c,l+"."+n)):i?((s=document.createElement("a")).href=o,s.target="_blank",s.download=l+"."+n,document.body.appendChild(s),s.click(),s.remove()):t.post(p,{data:a,type:r,extension:n})}t.setOptions({lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",viewData:"View data table"}}),t.Chart.prototype.getDataRows=function(){var n,i,a,r,s=(this.options.exporting||{}).csv||{},c=this.xAxis[0],l={},p=[],x=[],m=s.dateFormat||"%Y-%m-%d %H:%M:%S",d=s.columnHeaderFormatter||function(e,o,n){return e instanceof t.Axis?e.options.title&&e.options.title.text||(e.isDatetimeAxis?"DateTime":"Category"):e.name+(n>1?" ("+o+")":"")};i=0,e(this.series,function(t){var n,a=t.options.keys||t.pointArrayMap||["y"],r=a.length,s=t.requireSorting,c={};if(e(a,function(e){c[e]=t[e+"Axis"]&&t[e+"Axis"].categories||[]}),!1!==t.options.includeInCSVExport&&!1!==t.visible){for(n=0;n<r;)x.push(d(t,a[n],a.length)),n+=1;e(t.points,function(e,p){var x,m,d=s?e.x:p;for(n=0,l[d]||(l[d]=[]),l[d].x=e.x,t.xAxis&&"name"!==t.exportKey||(l[d].name=e.name);n<r;)m=e[x=a[n]],l[d][i+n]=o(c[x][m],m),n+=1}),i+=n}});for(a in l)l.hasOwnProperty(a)&&p.push(l[a]);return p.sort(function(t,e){return t.x-e.x}),r=d(c),n=[[r].concat(x)],e(p,function(e){var i=e.name;i||(c.isDatetimeAxis?(e.x instanceof Date&&(e.x=e.x.getTime()),i=t.dateFormat(m,e.x)):i=c.categories?o(c.names[e.x],c.categories[e.x],e.x):e.x),e.unshift(i),n.push(e)}),n},t.Chart.prototype.getCSV=function(t){var o="",n=this.getDataRows(),i=(this.options.exporting||{}).csv||{},a=i.itemDelimiter||",",r=i.lineDelimiter||"\n";return e(n,function(e,i){for(var s="",c=e.length,l=t?1.1.toLocaleString()[1]:".";c--;)"string"==typeof(s=e[c])&&(s='"'+s+'"'),"number"==typeof s&&","===l&&(s=s.toString().replace(".",",")),e[c]=s;o+=e.join(a),i<n.length-1&&(o+=r)}),o},t.Chart.prototype.getTable=function(t){var o="<table>",n=this.getDataRows();return e(n,function(e,n){var i,a,r=n?"td":"th",s=t?1.1.toLocaleString()[1]:".";for(o+="<tr>",a=0;a<e.length;a+=1)"number"==typeof(i=e[a])?(i=i.toString(),","===s&&(i=i.replace(".",s)),o+="<"+r+' class="number">'+i+"</"+r+">"):o+="<"+r+">"+(void 0===i?"":i)+"</"+r+">";o+="</tr>"}),o+="</table>"},t.Chart.prototype.downloadCSV=function(){var t=this.getCSV(!0);a(this,"data:text/csv,\ufeff"+t.replace(/\n/g,"%0A"),"csv",t,"text/csv")},t.Chart.prototype.downloadXLS=function(){var t,e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";a(this,"data:application/vnd.ms-excel;base64,"+(t=e,window.btoa(unescape(encodeURIComponent(t)))),"xls",e,"application/vnd.ms-excel")},t.Chart.prototype.viewData=function(){if(!this.insertedTable){var t=document.createElement("div");t.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(t,this.renderTo.nextSibling),t.innerHTML=this.getTable(),this.insertedTable=!0}},t.getOptions().exporting&&t.getOptions().exporting.buttons.contextButton.menuItems.push({textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},{textKey:"viewData",onclick:function(){this.viewData()}}),n.map&&(n.map.prototype.exportKey="name"),n.mapbubble&&(n.mapbubble.prototype.exportKey="name")});