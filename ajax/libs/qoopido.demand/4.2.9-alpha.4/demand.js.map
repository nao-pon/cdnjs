{"version":3,"sources":["demand.js"],"names":["global","setTimeout","clearTimeout","demand","provide","queue","processor","document","options","settings","version","cache","timeout","pattern","modules","handler","DEMAND_ID","MODULE_PREFIX","MODULE_PREFIX_ABSTRACT","MODULE_PREFIX_HANDLER","MODULE_PREFIX_PLUGIN","MODULE_PREFIX_FUNCTION","MODULE_PREFIX_VALIDATOR","MOCK_PREFIX","NULL","UNDEFINED","undefined","FALSE","TRUE","STRING_UNDEFINED","STRING_STRING","STRING_OBJECT","STRING_FUNCTION","STRING_NUMBER","FUNCTION_EMPTY","EVENT_PRE_CONFIGURE","EVENT_PREFIX","EVENT_POST_CONFIGURE","EVENT_POSTFIX","EVENT_CACHE","EVENT_CACHE_MISS","EVENT_CACHE_EXCEED","EVENT_PRE_RESOLVE","EVENT_POST_RESOLVE","EVENT_PRE_REQUEST","EVENT_POST_REQUEST","EVENT_PRE_PROCESS","EVENT_POST_PROCESS","EVENT_QUEUE_ENQUEUE","EVENT_QUEUE","ERROR_LOAD","ERROR_RESOLVE","arrayPrototype","Array","prototype","arrayPrototypeSlice","slice","arrayPrototypeConcat","concat","object","Object","objectPrototypeToString","toString","objectCreate","create","objectDefineProperty","defineProperty","objectGetOwnPropertyNames","getOwnPropertyNames","objectGetOwnPropertyDescriptor","getOwnPropertyDescriptor","linkElement","createElement","ClassDescriptor","value","writable","configurable","enumerable","__proto__","validatorIsTypeOf","type","validatorIsObject","validatorIsPositive","isFinite","Math","floor","validatorIsInstanceOf","module","functionIterate","source","callback","context","property","properties","keys","i","call","strPrototype","objectDefine","name","this","functionExtends","names","constructor","e","TypeError","Function","define","storage","element","fallback","hasSetImmediate","functionMerge","mergeProperties","targetPropertyIsObject","targetProperty","length","target","arguments","functionUuid","regex","RegExp","randomize","character","r","random","replace","functionDefer","fn","MutationObserver","observe","attributes","setAttribute","addEventListener","event","data","uuid","postMessage","onreadystatechange","parentNode","removeChild","body","appendChild","setImmediate","functionToArray","arrayLikeObject","start","end","singletonEvent","TYPE_ON","regexMatchEvent","listener","addListener","events","pointer","split","shift","test","on","after","push","filter","Event","emit","parameter","item","apply","functionGetTimestamp","Date","regexMatchRegex","functionEscapeRegex","functionResolveUrl","url","href","regexIsAbsoluteUri","regexIsAbsolutePath","regexMatchSourcemap","regexMatchBaseUrl","regexMatchInternal","regexMatchParameter","functionResolvePath","uri","path","functionResolveId","match","singletonCache","STORAGE_PREFIX","STORAGE_SUFFIX_STATE","regexMatchState","regexMatchProperties","supportsLocalStorage","localStorage","exception","supportsRemainingSpace","enabled","dependency","indexOf","weight","state","getKey","key","getItem","setKey","getState","matches","setState","join","id","Cache","clear","expired","bind","then","cacheDispose","set","get","lifetime","invalid","resolve","spaceBefore","remainingSpace","Error","error","ClassDependency","all","ClassWeakmap","WeakMap","prefix","getEntry","entry","delete","has","ClassPledge","PLEDGE_PENDING","PLEDGE_RESOLVED","PLEDGE_REJECTED","pledge","index","resolved","count","check","rejected","total","dfd","reject","executor","handle","result","catch","always","alwaysListener","resolveListener","rejectListener","defer","isPending","isResolved","isRejected","self","pledges","race","ClassRegistry","remove","ClassFailure","message","stack","traverse","depth","indention","registry","placeholder","setProperty","addPending","addResolved","addRejected","register","mock","enqueue","isInternal","node","querySelector","list","pending","ClassPattern","regexMatchTrailingSlash","location","process","current","ClassXhr","XMLHttpRequest","XDomainRequest","xhr","boundCheckState","readyState","abort","ontimeout","onerror","onabort","status","onprogress","onload","responseText","getResponseHeader","open","send","validatorIsArray","functionHash","input","charCodeAt","AbstractUuid","updateCacheSettings","updatePatternSettings","updateModuleSettings","temp","dependencies","configure","base","min","max","regexMatchEmptySearch","response","validate","load","search","onPostRequest","EVENT_CACHE_HIT","onPreRequest","onPreProcess","isFunction","definition","console","/demand","ClassQueue","dequeue","extends","ClassProcessor","functionResolveSourcemaps","replacement","exec","protocol","host","pathname","abstractHandler","handlerModule","getElementsByTagName","regexMatchType","HandlerModule","script","async","text","handlerBundle","updateDependencies","HandlerBundle","getType","handlerComponent","HandlerComponent","container","innerHTML","firstElementChild","getAttribute","textContent","pluginGenie","matchPattern","addPattern","resolveBundles","JSON","stringify","bundle","configuration","/demand/handler/bundle","generateConfiguration","bundles","assignModule","main","parent"],"mappings":"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","file":"demand.js","sourcesContent":["/* global\n\tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n\tMODULE_PREFIX, MODULE_PREFIX_HANDLER, MODULE_PREFIX_VALIDATOR, MODULE_PREFIX_PLUGIN, MODULE_PREFIX_FUNCTION, MODULE_PREFIX_ABSTRACT, STRING_STRING, STRING_FUNCTION, TRUE,\n\tvalidatorIsTypeOf, validatorIsArray, validatorIsObject, validatorIsInstanceOf,\n\tfunctionResolveUrl, functionResolveSourcemaps, functionMerge, functionIterate, functionDefer, functionHash, functionUuid,\n\tAbstractUuid, abstractHandler,\n\tClassDependency, ClassQueue, ClassProcessor, ClassPledge, ClassXhr, ClassFailure, ClassDescriptor, ClassWeakmap,\n\thandlerModule, handlerBundle, handlerComponent,\n \tpluginGenie\n*/\n\n/*eslint no-unused-vars: [2, { \"vars\": \"local\", \"args\": \"none\" }]*/\n(function(global, setTimeout, clearTimeout) {\n    'use strict';\n\n    /* eslint-disable no-unused-vars */\n    var document = global.document,\n        options = 'demand' in global && global.demand,\n        settings = {\n            version: '1.0.0',\n            cache: {},\n            timeout: 8000,\n            pattern: {},\n            modules: {},\n            handler: 'module'\n        },\n        demand, provide, queue, processor;\n\n    // include inheritance\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tTRUE,\n    \tobjectCreate, objectDefineProperty, objectGetOwnPropertyNames, objectGetOwnPropertyDescriptor,\n    \tClassDescriptor\n    */\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    var DEMAND_ID = 'demand',\n        PROVIDE_ID = 'provide',\n        PATH_ID = 'path',\n        MODULE_PREFIX = '/' + DEMAND_ID + '/',\n        MODULE_PREFIX_ABSTRACT = MODULE_PREFIX + 'abstract/',\n        MODULE_PREFIX_HANDLER = MODULE_PREFIX + 'handler/',\n        MODULE_PREFIX_PLUGIN = MODULE_PREFIX + 'plugin/',\n        MODULE_PREFIX_FUNCTION = MODULE_PREFIX + 'function/',\n        MODULE_PREFIX_VALIDATOR = MODULE_PREFIX + 'validator/',\n        MOCK_PREFIX = 'mock:',\n        NULL = null,\n        UNDEFINED = undefined,\n        FALSE = false,\n        TRUE = true,\n        STRING_UNDEFINED = 'undefined',\n        STRING_STRING = 'string',\n        STRING_BOOLEAN = 'boolean',\n        STRING_OBJECT = 'object',\n        STRING_FUNCTION = 'function',\n        STRING_NUMBER = 'number',\n        FUNCTION_EMPTY = function() {},\n        EVENT_PREFIX = 'pre',\n        EVENT_POSTFIX = 'post',\n        EVENT_CONFIGURE = 'Configure',\n        EVENT_PRE_CONFIGURE = EVENT_PREFIX + EVENT_CONFIGURE,\n        EVENT_POST_CONFIGURE = EVENT_POSTFIX + EVENT_CONFIGURE,\n        EVENT_CACHE = 'cache',\n        EVENT_CACHE_MISS = EVENT_CACHE + 'Miss',\n        EVENT_CACHE_HIT = EVENT_CACHE + 'Hit',\n        EVENT_CACHE_CLEAR = EVENT_CACHE + 'Clear',\n        EVENT_CACHE_EXCEED = EVENT_CACHE + 'Exceed',\n        EVENT_PRE_CACHE = EVENT_PREFIX + 'Cache',\n        EVENT_POST_CACHE = EVENT_POSTFIX + 'Cache',\n        EVENT_RESOLVE = 'Resolve',\n        EVENT_PRE_RESOLVE = EVENT_PREFIX + EVENT_RESOLVE,\n        EVENT_POST_RESOLVE = EVENT_POSTFIX + EVENT_RESOLVE,\n        EVENT_REQUEST = 'Request',\n        EVENT_PRE_REQUEST = EVENT_PREFIX + EVENT_REQUEST,\n        EVENT_POST_REQUEST = EVENT_POSTFIX + EVENT_REQUEST,\n        EVENT_PROCESS = 'Process',\n        EVENT_PRE_PROCESS = EVENT_PREFIX + EVENT_PROCESS,\n        EVENT_POST_PROCESS = EVENT_POSTFIX + EVENT_PROCESS,\n        EVENT_QUEUE = 'queue',\n        EVENT_QUEUE_ENQUEUE = EVENT_QUEUE + 'Enqueue',\n        EVENT_QUEUE_DEQUEUE = EVENT_QUEUE + 'Dequeue',\n        ERROR_LOAD = 'error loading',\n        ERROR_PROVIDE = 'error providing',\n        ERROR_RESOLVE = 'error resolving',\n        ERROR_PROVIDE_ANONYMOUS = 'unspecified anonymous provide';\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    var arrayPrototype = Array.prototype,\n        arrayPrototypeSlice = arrayPrototype.slice,\n        arrayPrototypeConcat = arrayPrototype.concat,\n        object = Object,\n        objectPrototype = object.prototype,\n        objectPrototypeToString = objectPrototype.toString,\n        objectCreate = object.create,\n        objectDefineProperty = object.defineProperty,\n        objectGetOwnPropertyNames = object.getOwnPropertyNames,\n        objectGetOwnPropertyDescriptor = object.getOwnPropertyDescriptor,\n        linkElement = document.createElement('a');\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tNULL\n    */\n\n    //=require constants.js\n\n    function ClassDescriptor(value, writable, configurable, enumerable) {\n        return {\n            __proto__: NULL,\n            value: value,\n            enumerable: !!enumerable,\n            configurable: !!configurable,\n            writable: !!writable\n        };\n    }\n\n\n    (function(strPrototype) {\n        function objectDefine(name, value, writable, configurable, enumerable) {\n            objectDefineProperty(this, name, new ClassDescriptor(value, writable, configurable, enumerable));\n        }\n\n        function functionExtends(source) {\n            var self = this,\n                prototype = self[strPrototype],\n                names = objectGetOwnPropertyNames(prototype),\n                properties = {\n                    constructor: new ClassDescriptor(self, TRUE, TRUE)\n                },\n                i = 0,\n                property;\n\n            for (;\n                (property = names[i]) && !properties[property]; i++) {\n                properties[property] = objectGetOwnPropertyDescriptor(prototype, property);\n            }\n\n            try {\n                self[strPrototype] = objectCreate(source[strPrototype] || source, properties);\n            } catch (e) {\n                // ES6 class prototypes are readonly at least in Chrome\n                // (and assignment throws an error in strict mode) ...\n            }\n\n            // ... which is handled here\n            if (self[strPrototype] === prototype) {\n                throw new TypeError('Unable to extend, prototype is not writable');\n            }\n\n            return self;\n        }\n\n        objectDefine.call(Object.prototype, 'define', objectDefine);\n        objectDefine.call(global.Object.prototype, 'define', objectDefine);\n        Function.prototype.define('extends', functionExtends);\n        global.Function.prototype.define('extends', functionExtends);\n    }('prototype'));\n\n\n    // include main components\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_BOOLEAN, STRING_STRING, EVENT_PRE_RESOLVE, EVENT_POST_RESOLVE, EVENT_PRE_CONFIGURE, EVENT_POST_CONFIGURE, EVENT_CACHE_MISS, EVENT_CACHE_HIT, EVENT_PRE_REQUEST, EVENT_POST_REQUEST, EVENT_PRE_PROCESS, EVENT_POST_PROCESS, NULL, FALSE,\n    \tvalidatorIsTypeOf, validatorIsObject, validatorIsPositive, validatorIsInstanceOf,\n    \tfunctionIterate, functionMerge, functionDefer, functionToArray,\n    \tClassPledge, ClassDependency, ClassPattern, ClassLoader,\n    \tsingletonEvent, singletonCache\n    */\n\n    //=require constants.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    /**\n     * isTypeOf\n     *\n     * Check whether a given object is of specified type\n     *\n     * @param object\n     * @param {string} type\n     *\n     * @return {boolean}\n     */\n\n    function validatorIsTypeOf(object, type) {\n        return typeof object === type;\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_OBJECT,\n    \tvalidatorIsTypeOf\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n\n    /**\n     * isObject\n     *\n     * Check whether a given object is of type object\n     *\n     * @param object\n     *\n     * @return {boolean}\n     */\n\n    function validatorIsObject(object) {\n        return object && validatorIsTypeOf(object, STRING_OBJECT);\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_NUMBER,\n    \tvalidatorIsTypeOf\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n\n    /**\n     * isPositive\n     *\n     * Check whether a given value is a positive integer\n     *\n     * @param value\n     *\n     * @return {boolean}\n     */\n\n    function validatorIsPositive(value) {\n        return validatorIsTypeOf(value, STRING_NUMBER) && isFinite(value) && Math.floor(value) === value && value >= 0;\n    }\n\n    /**\n     * isInstanceOf\n     *\n     * Check whether a given object is an instance of specified type\n     *\n     * @param object\n     * @param module\n     *\n     * @return {boolean}\n     */\n    function validatorIsInstanceOf(object, module) {\n        return object instanceof module;\n    }\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tUNDEFINED, FALSE,\n    \tobject\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n\n    /**\n     * iterate\n     *\n     * Iterate over enumerable & own properties of a given\n     * object and pass current property as well as its value\n     * to a callback function\n     *\n     * @param {object} object\n     * @param {function} callback\n     * @param context\n     *\n     * @return mixed\n     */\n\n    function functionIterate(source, callback, context) {\n        var properties = object.keys(source),\n            i = 0,\n            property;\n\n        for (;\n            (property = properties[i]) !== UNDEFINED; i++) {\n            if (callback.call(context, property, source[property]) === FALSE) {\n                break;\n            }\n        }\n\n        return context;\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tUNDEFINED,\n    \tvalidatorIsObject,\n    \tfunctionIterate\n    */\n\n    //=require constants.js\n    //=require validator/isObject.js\n    //=require function/iterate.js\n\n    /**\n     * merge\n     *\n     * Merge two or more objects into the first one passed in\n     *\n     * @param {...object} object\n     *\n     * @return {object}\n     */\n    var functionMerge = (function() {\n        function mergeProperties(property, value) {\n            var targetProperty = this[property],\n                targetPropertyIsObject;\n\n            if (value !== UNDEFINED) {\n                if (validatorIsObject(value)) {\n                    targetPropertyIsObject = validatorIsObject(targetProperty);\n\n                    if (value.length !== UNDEFINED) {\n                        targetProperty = (targetPropertyIsObject && targetProperty.length !== UNDEFINED) ? targetProperty : [];\n                    } else {\n                        targetProperty = (targetPropertyIsObject && targetProperty.length === UNDEFINED) ? targetProperty : {};\n                    }\n\n                    this[property] = functionMerge(targetProperty, value);\n                } else {\n                    this[property] = value;\n                }\n            }\n        }\n\n        return function functionMerge() {\n            var target = arguments[0],\n                i = 1,\n                properties;\n\n            for (;\n                (properties = arguments[i]) !== UNDEFINED; i++) {\n                functionIterate(properties, mergeProperties, target);\n            }\n\n            return target;\n        };\n    }());\n\n    /**\n     * Based on setAsap:\n     *   Repo:    https://github.com/taylorhakes/setAsap\n     *   License: https://github.com/taylorhakes/setAsap/blob/master/LICENSE\n     */\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tNULL, TRUE, FALSE,\n    \tfunctionUuid\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    var functionUuid = (function() {\n        var regex = new RegExp('[xy]', 'g');\n\n        function randomize(character) {\n            var r = Math.random() * 16 | 0;\n\n            return ((character === 'x') ? r : (r & 0x3 | 0x8)).toString(16);\n        }\n\n        return function functionUuid() {\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(regex, randomize);\n        };\n    }());\n\n\n    /**\n     * defer\n     *\n     * delay function execution like setImmediate does\n     *\n     * @param {function} function\n     */\n    var functionDefer = (function() {\n        var hasSetImmediate = 'setImmediate' in global,\n            element, fallback;\n\n        if ('MutationObserver' in global) {\n            return function functionDefer(fn) {\n                element = document.createElement('div');\n\n                new MutationObserver(function() {\n                        fn();\n                    })\n                    .observe(element, {\n                        attributes: TRUE\n                    });\n\n                element.setAttribute('i', '1');\n            };\n        }\n\n        if (!hasSetImmediate && 'postMessage' in global && !('importScripts' in global) && 'addEventListener' in global) {\n            return (function() {\n                var storage = {};\n\n                function onMessage(event) {\n                    var fn;\n\n                    if (event.source === global && event.data && (fn = storage[event.data])) {\n                        fn();\n\n                        delete storage[event.data];\n                    }\n                }\n\n                global.addEventListener('message', onMessage, FALSE);\n\n                return function functionDefer(fn) {\n                    var uuid = functionUuid();\n\n                    storage[uuid] = fn;\n\n                    global.postMessage(uuid, '*');\n                };\n            }());\n        }\n\n        if (!hasSetImmediate && 'onreadystatechange' in (element = document.createElement('script'))) {\n            return function functionDefer(fn) {\n                element.onreadystatechange = function onreadystatechange() {\n                    element.onreadystatechange = NULL;\n                    element.parentNode.removeChild(element);\n\n                    fn();\n                };\n\n                document.body.appendChild(element);\n            };\n        }\n\n        fallback = hasSetImmediate ? setImmediate : setTimeout; // eslint-disable-line no-undef\n\n        return function functionDefer(fn) {\n            fallback(fn);\n        };\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tarrayPrototypeSlice\n    */\n\n    //=require shortcuts.js\n\n    function functionToArray(arrayLikeObject, start, end) {\n        return arrayPrototypeSlice.call(arrayLikeObject, start, end);\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tNULL, STRING_STRING, STRING_FUNCTION, EVENT_POST_CONFIGURE,\n    \tvalidatorIsTypeOf,\n    \tfunctionToArray\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n    //=require function/toArray.js\n\n    var singletonEvent = (function() {\n        var TYPE_ON = 'on',\n            TYPE_AFTER = 'after',\n            regexMatchEvent = /^cache(Miss|Hit|Clear|Exceed)|queue(En|De)queue|(pre|post)(Resolve|Configure|Request|Process|Cache)$/,\n            listener = {};\n\n        function addListener(type, events, callback) {\n            var event, pointer;\n\n            if (validatorIsTypeOf(events, STRING_STRING) && validatorIsTypeOf(callback, STRING_FUNCTION)) {\n                events = events.split(' ');\n\n                while (event = events.shift()) {\n                    event = event.split(':');\n\n                    if (regexMatchEvent.test(event[0])) {\n                        (listener[event[0]] || (listener[event[0]] = {\n                            on: [],\n                            after: []\n                        }))[type].push({\n                            callback: callback,\n                            filter: event[1]\n                        });\n\n                        if (type === TYPE_ON && event[0] === EVENT_POST_CONFIGURE && (pointer = settings.modules[event[1]])) {\n                            callback(pointer);\n                        }\n                    }\n                }\n            }\n        }\n\n        function Event() {}\n\n        Event.prototype = {\n            emit: function(event, filter) {\n                var pointer = listener[event],\n                    parameter, i, item;\n\n                if (pointer) {\n                    parameter = functionToArray(arguments, 2);\n\n                    for (i = 0;\n                        (item = pointer[TYPE_ON][i]); i++) {\n                        if (!item.filter || item.filter === filter) {\n                            item.callback.apply(NULL, parameter);\n                        }\n                    }\n\n                    for (i = 0;\n                        (item = pointer[TYPE_AFTER][i]); i++) {\n                        if (!item.filter || item.filter === filter) {\n                            item.callback.apply(NULL, parameter);\n                        }\n                    }\n                }\n\n                return this;\n            },\n            on: function(events, callback) {\n                addListener(TYPE_ON, events, callback);\n\n                return this;\n            },\n            after: function(events, callback) {\n                addListener(TYPE_AFTER, events, callback);\n\n                return this;\n            }\n        };\n\n        return new Event();\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, FUNCTION_EMPTY, EVENT_POST_REQUEST, EVENT_POST_PROCESS, EVENT_CACHE_HIT, EVENT_CACHE_MISS, EVENT_CACHE_EXCEED, EVENT_CACHE_CLEAR, EVENT_PRE_CACHE, EVENT_PRE_CACHE, EVENT_POST_CACHE, STRING_STRING, NULL, FALSE, TRUE,\n    \tvalidatorIsTypeOf,\n    \tfunctionGetTimestamp, functionEscapeRegex, functionIterate, functionDefer, functionResolveId, functionToArray,\n    \tClassDependency,\n    \tsingletonEvent\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    function functionGetTimestamp() {\n        return +new Date();\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    var functionEscapeRegex = (function() {\n        var regexMatchRegex = /[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g; // eslint-disable-line no-useless-escape\n\n        return function functionEscapeRegex(value) {\n            return value.replace(regexMatchRegex, '\\\\$&');\n        };\n    }());\n\n    //=require function/iterate.js\n    //=require function/defer.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tregexMatchParameter,\n    \tfunctionResolvePath\n    */\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, PROVIDE_ID, PATH_ID,\n    \tfunctionEscapeRegex, functionResolveUrl\n    */\n\n    //=require constants.js\n    //=require function/escapeRegex.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tlinkElement\n    */\n\n    //=require shortcuts.js\n\n    function functionResolveUrl(url) {\n        linkElement.href = url;\n\n        return linkElement.href;\n    }\n\n\n    var regexIsAbsoluteUri = /^(http(s?):)?\\/\\//i,\n        regexIsAbsolutePath = /^\\//,\n        regexMatchSourcemap = /((?:\\/\\/|\\/\\*)#)\\s*(sourceMappingURL)\\s*=\\s*(?!(?:http[s]?:)?\\/\\/)(.+?)\\.map(?:\\s+)?(\\*\\/)?/g,\n        regexMatchBaseUrl = new RegExp('^' + functionEscapeRegex(functionResolveUrl('/'))),\n        regexMatchInternal = new RegExp('^' + DEMAND_ID + '|' + PROVIDE_ID + '|' + PATH_ID + '$'),\n        regexMatchParameter = /^(mock:)?([+-])?((?:[-\\w]+\\/?)+)?(?:@(.+?))?(?:#(\\d+))?!/;\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tregexMatchParameter, regexMatchBaseUrl, regexIsAbsolutePath, regexIsAbsoluteUri,\n    \tfunctionResolveUrl\n    */\n\n    //=require variables.js\n    //=require function/resolveUrl.js\n\n    function functionResolvePath(uri, context) {\n        var path = uri.replace(regexMatchParameter, '');\n\n        if (!regexIsAbsolutePath.test(path) && !regexIsAbsoluteUri.test(path)) {\n            path = '/' + functionResolveUrl(((context && functionResolveUrl(context + '/../')) || '/') + path).replace(regexMatchBaseUrl, '');\n        }\n\n        return path;\n    }\n\n\n    function functionResolveId(uri, context) {\n        var parameter = uri.match(regexMatchParameter);\n\n        return ((parameter && parameter[1]) ? 'mock:' : '') + ((parameter && parameter[3]) || settings.handler) + '!' + functionResolvePath(uri, context);\n    }\n\n    //=require function/toArray.js\n    //=require singleton/event.js\n\n    var singletonCache = (function() {\n        var STORAGE_PREFIX = '[' + DEMAND_ID + ']',\n            STORAGE_SUFFIX_STATE = '[state]',\n            STORAGE_SUFFIX_VALUE = '[value]',\n            regexMatchState = new RegExp('^' + functionEscapeRegex(STORAGE_PREFIX) + '\\\\[(.+?)\\\\]' + functionEscapeRegex(STORAGE_SUFFIX_STATE) + '$'),\n            regexMatchProperties = /^(.+?),(\\d+),(\\d*),(.+?),(\\d+)$/,\n            supportsLocalStorage = (function() {\n                try {\n                    return 'localStorage' in global && global.localStorage;\n                } catch (exception) {\n                    return FALSE;\n                }\n            }()),\n            localStorage = supportsLocalStorage ? global.localStorage : NULL,\n            supportsRemainingSpace = supportsLocalStorage && 'remainingSpace' in localStorage,\n            storage = {},\n            cache;\n\n        singletonEvent\n            .on(EVENT_CACHE_MISS, function(dependency) {\n                functionDefer(function() {\n                    cache.clear(dependency.id);\n                });\n            })\n            .on(EVENT_CACHE_EXCEED, function(dependency) {\n                demand('-!/' + DEMAND_ID + '/cache/dispose').then(function(cacheDispose) {\n                    functionDefer(function() {\n                        cacheDispose(dependency.source.length);\n\n                        cache.set(dependency);\n                    });\n                });\n            })\n            .on(EVENT_POST_REQUEST, function(dependency) {\n                if (dependency.source && enabled(dependency)) {\n                    storage[dependency.id] = TRUE;\n                }\n            })\n            .after(EVENT_POST_PROCESS, function(dependency) {\n                if (storage[dependency.id]) {\n                    functionDefer(function() {\n                        cache.set(dependency);\n                    });\n                }\n            });\n\n        function enabled(dependency) {\n            var match;\n\n            if (dependency.cache !== NULL) {\n                return dependency.cache;\n            }\n\n            functionIterate(settings.cache, function(property, value) {\n                if (dependency.path.indexOf(property) === 0 && (!match || value.weight > match.weight)) {\n                    match = value;\n                }\n            });\n\n            return match ? match.state : FALSE;\n        }\n\n        function getKey(key) {\n            return localStorage.getItem(key);\n        }\n\n        function setKey(key, value) {\n            localStorage[value ? 'setItem' : 'removeItem'](key, value);\n        }\n\n        function getState(key) {\n            var state = getKey(key),\n                matches;\n\n            if (state && (matches = state.match(regexMatchProperties))) {\n                return functionToArray(matches, 1);\n            }\n        }\n\n        function setState(key, state) {\n            state[4] = functionGetTimestamp();\n\n            setKey(key, state.join(','));\n        }\n\n        function emit(event, dependency, state) {\n            singletonEvent.emit(event, dependency.id, dependency, state);\n        }\n\n        function Cache() {\n            functionDefer(this.clear.expired.bind(this.clear));\n        }\n\n        Cache.prototype = {\n            get: supportsLocalStorage ? function(dependency) {\n                var id, state;\n\n                if (enabled(dependency)) {\n                    id = STORAGE_PREFIX + '[' + dependency.id + ']';\n                    state = getState(id + STORAGE_SUFFIX_STATE);\n\n                    if (!state) {\n                        return;\n                    }\n\n                    if (state[0] !== dependency.version || (state[2] && dependency.lifetime && state[2] <= functionGetTimestamp())) {\n                        dependency.invalid = true;\n\n                        return;\n                    }\n\n                    dependency.source = getKey(id + STORAGE_SUFFIX_VALUE);\n\n                    functionDefer(function() {\n                        setState(id + STORAGE_SUFFIX_STATE, state);\n                    });\n\n                    return TRUE;\n                }\n            } : FUNCTION_EMPTY,\n            resolve: supportsLocalStorage ? function(dependency) {\n                var self = this;\n\n                if (self.get(dependency)) {\n                    emit(EVENT_CACHE_HIT, dependency);\n                } else {\n                    emit(EVENT_CACHE_MISS, dependency);\n                }\n            } : function(dependency) {\n                emit(EVENT_CACHE_MISS, dependency);\n            },\n            set: supportsLocalStorage ? function(dependency) {\n                var state, id, spaceBefore;\n\n                if (enabled(dependency)) {\n                    state = [dependency.version, dependency.source.length, dependency.lifetime ? functionGetTimestamp() + dependency.lifetime : NULL, demand.version];\n                    id = STORAGE_PREFIX + '[' + dependency.id + ']';\n\n                    emit(EVENT_PRE_CACHE, dependency, state);\n\n                    try {\n                        spaceBefore = supportsRemainingSpace ? localStorage.remainingSpace : NULL;\n\n                        setKey(id + STORAGE_SUFFIX_VALUE, dependency.source);\n                        setState(id + STORAGE_SUFFIX_STATE, state);\n\n                        // strict equality check with \"===\" is required due to spaceBefore might be \"0\"\n                        if (spaceBefore !== NULL && localStorage.remainingSpace === spaceBefore) {\n                            throw new Error();\n                        }\n\n                        emit(EVENT_POST_CACHE, dependency, state);\n                    } catch (error) {\n                        emit(EVENT_CACHE_EXCEED, dependency);\n                    }\n                }\n            } : FUNCTION_EMPTY,\n            clear: supportsLocalStorage ? function(path) {\n                var id = functionResolveId(path),\n                    key = STORAGE_PREFIX + '[' + id + ']';\n\n                if (getKey(key + STORAGE_SUFFIX_STATE)) {\n                    setKey(key + STORAGE_SUFFIX_STATE);\n                    setKey(key + STORAGE_SUFFIX_VALUE);\n\n                    emit(EVENT_CACHE_CLEAR, ClassDependency.get(id) || new ClassDependency(id, NULL, FALSE));\n                }\n            } : function() {}\n        };\n\n        Cache.prototype.clear.all = supportsLocalStorage ? function() {\n            var match;\n\n            functionIterate(localStorage, function(property) {\n                match = property.match(regexMatchState);\n\n                match && this(match[1]);\n            }, this);\n        } : FUNCTION_EMPTY;\n\n        Cache.prototype.clear.expired = supportsLocalStorage ? function() {\n            var match, state;\n\n            functionIterate(localStorage, function(property) {\n                match = property.match(regexMatchState);\n\n                if (match) {\n                    state = getState(STORAGE_PREFIX + '[' + match[1] + ']' + STORAGE_SUFFIX_STATE);\n\n                    if (state && state[2] > 0 && state[2] <= functionGetTimestamp()) {\n                        this(match[1]);\n                    }\n                }\n            }, this);\n        } : FUNCTION_EMPTY;\n\n        return (cache = new Cache());\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n     \tFUNCTION_EMPTY, NULL,\n    \tarrayPrototypeConcat,\n    \tfunctionDefer, functionToArray,\n    \tClassWeakmap\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    //=require function/defer.js\n    //=require function/toArray.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tfunctionUuid,\n    */\n\n    //=require function/uuid.js\n\n    var ClassWeakmap = 'WeakMap' in global ? global.WeakMap : (function() {\n        var prefix = 'weakmap-';\n\n        function getEntry(context, key) {\n            var entry;\n\n            if ((entry = key[context.id]) && entry[0] === key) {\n                return entry;\n            }\n        }\n\n        function ClassWeakmap() {\n            this.define('id', prefix + functionUuid());\n        }\n\n        ClassWeakmap.prototype = {\n            set: function(key, value) {\n                var entry = getEntry(this, key);\n\n                if (entry) {\n                    entry[1] = value;\n                } else {\n                    key.define(this.id, [key, value]);\n                }\n\n                return this;\n            },\n            get: function(key) {\n                var entry = getEntry(this, key);\n\n                if (entry) {\n                    return entry[1];\n                }\n            },\n            delete: function(key) {\n                var entry = getEntry(this, key);\n\n                if (entry) {\n                    entry.length = 0;\n\n                    delete key[this.id];\n                }\n            },\n            has: function(key) {\n                return !!getEntry(this, key);\n            }\n        };\n\n        return ClassWeakmap;\n    }());\n\n\n    var ClassPledge = (function() {\n        var PLEDGE_PENDING = 'pending',\n            PLEDGE_RESOLVED = 'resolved',\n            PLEDGE_REJECTED = 'rejected',\n            storage = new ClassWeakmap();\n\n        function resolve() {\n            storage.get(this).handle(PLEDGE_RESOLVED, arguments);\n        }\n\n        function reject() {\n            storage.get(this).handle(PLEDGE_REJECTED, arguments);\n        }\n\n        function handle(state, parameter) {\n            var properties = storage.get(this),\n                pointer, result;\n\n            if (properties.state === PLEDGE_PENDING) {\n                properties.state = state;\n                properties.value = parameter;\n            }\n\n            while (pointer = properties[properties.state].shift()) {\n                result = pointer.handler.apply(NULL, properties.value);\n\n                if (result && typeof result.then === 'function') {\n                    result.then(pointer.dfd.resolve, pointer.dfd.reject);\n                } else {\n                    pointer.dfd[properties.state === PLEDGE_RESOLVED ? 'resolve' : 'reject'].apply(NULL, properties.value);\n                }\n            }\n\n            properties[PLEDGE_RESOLVED].length = 0;\n            properties[PLEDGE_REJECTED].length = 0;\n        }\n\n        function observe(pledge, index, properties) {\n            pledge.then(\n                function() {\n                    properties.resolved[index] = functionToArray(arguments);\n\n                    properties.count++;\n\n                    check(properties);\n                },\n                function() {\n                    properties.rejected.push(functionToArray(arguments));\n\n                    check(properties);\n                }\n            );\n        }\n\n        function check(properties) {\n            if (properties.count === properties.total) {\n                properties.dfd.resolve.apply(NULL, arrayPrototypeConcat.apply([], properties.resolved));\n            } else if (properties.rejected.length + properties.count === properties.total) {\n                properties.dfd.reject.apply(NULL, arrayPrototypeConcat.apply([], properties.rejected));\n            }\n        }\n\n        function ClassPledge(executor) {\n            var self = this;\n\n            storage.set(this, {\n                state: PLEDGE_PENDING,\n                handle: handle.bind(self),\n                value: NULL,\n                resolved: [],\n                rejected: [],\n                count: 0\n            });\n\n            executor(resolve.bind(self), reject.bind(self));\n\n            return self;\n        }\n\n        ClassPledge.prototype = {\n            'catch': function(listener) {\n                return this.then(FUNCTION_EMPTY, listener);\n            },\n            always: function(alwaysListener) {\n                return this.then(alwaysListener, alwaysListener);\n            },\n            then: function(resolveListener, rejectListener) {\n                var properties = storage.get(this),\n                    dfd = ClassPledge.defer();\n\n                resolveListener && properties[PLEDGE_RESOLVED].push({\n                    handler: resolveListener,\n                    dfd: dfd\n                });\n                rejectListener && properties[PLEDGE_REJECTED].push({\n                    handler: rejectListener,\n                    dfd: dfd\n                });\n\n                if (properties.state !== PLEDGE_PENDING) {\n                    functionDefer(properties.handle);\n                }\n\n                return dfd.pledge;\n            },\n            isPending: function() {\n                return storage.get(this).state === PLEDGE_PENDING;\n            },\n            isResolved: function() {\n                return storage.get(this).state === PLEDGE_RESOLVED;\n            },\n            isRejected: function() {\n                return storage.get(this).state === PLEDGE_REJECTED;\n            }\n        };\n\n        ClassPledge.defer = function() {\n            var self = {};\n\n            self.pledge = new ClassPledge(function(resolveListener, rejectListener) {\n                self.resolve = resolveListener;\n                self.reject = rejectListener;\n            });\n\n            return self;\n        };\n\n        ClassPledge.all = function(pledges) {\n            var dfd = ClassPledge.defer(),\n                properties, i = 0,\n                pledge;\n\n            if (pledges.length) {\n                properties = {\n                    dfd: dfd,\n                    resolved: [],\n                    rejected: [],\n                    total: pledges.length,\n                    count: 0\n                };\n\n                for (; pledge = pledges[i]; i++) {\n                    observe(pledge, i, properties)\n                }\n            } else {\n                dfd.resolve();\n            }\n\n            return dfd.pledge;\n        };\n\n        ClassPledge.race = function(pledges) {\n            var dfd = ClassPledge.defer(),\n                i = 0,\n                pledge;\n\n            for (; pledge = pledges[i]; i++) {\n                pledge.then(dfd.resolve, dfd.reject);\n            }\n\n            if (!pledges.length) {\n                dfd.resolve();\n            }\n\n            return dfd.pledge;\n        };\n\n        return ClassPledge;\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, MODULE_PREFIX_HANDLER, ERROR_LOAD, DEMAND_ID, PROVIDE_ID, PATH_ID, MOCK_PREFIX, NULL, TRUE, FALSE,\n    \tobject,\n    \tregexMatchInternal, regexMatchParameter,\n    \tvalidatorIsPositive,\n    \tfunctionResolvePath, functionResolveId, functionResolveUrl, functionIterate, functionToArray,\n    \tClassRegistry, ClassPledge, ClassFailure,\n    \tsingletonCache\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    //=require variables.js\n    //=require validator/isPositive.js\n    //=require function/resolvePath.js\n    //=require function/resolveId.js\n    //=require function/resolveUrl.js\n    //=require function/iterate.js\n    //=require function/toArray.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tClassWeakmap\n    */\n\n    //=require class/weakmap.js\n\n    var ClassRegistry = (function() {\n        var storage = new ClassWeakmap();\n\n        function ClassRegistry() {\n            storage.set(this, {});\n        }\n\n        ClassRegistry.prototype = {\n            get: function(key) {\n                return key ? storage.get(this)[key] : storage.get(this);\n            },\n            set: function(key, value) {\n                storage.get(this)[key] = value;\n            },\n            remove: function(key) {\n                delete storage.get(this)[key];\n            }\n        };\n\n        return ClassRegistry;\n    }());\n\n    //=require class/pledge.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID,\n    \tfunctionToArray\n    */\n\n    //=require constants.js\n    //=require function/toArray.js\n\n    function ClassFailure(message, module, stack) {\n        var self = this;\n\n        self.message = message;\n\n        module && (self.module = module);\n        stack && (self.stack = functionToArray(stack));\n\n        return self;\n    }\n\n    ClassFailure.prototype = {\n        /* only for reference\n         message: NULL,\n         module:  NULL,\n         stack:   NULL,\n         */\n        toString: function() {\n            var self = this,\n                result = DEMAND_ID + ': ' + self.message + ' ' + (self.module ? '\"' + self.module + '\"' : '');\n\n            if (self.stack) {\n                result = ClassFailure.traverse(self.stack, result, 1);\n            }\n\n            return result;\n        }\n    };\n\n    ClassFailure.traverse = function(stack, value, depth) {\n        var indention = new Array(depth + 1).join(' '),\n            i = 0,\n            item;\n\n        for (; item = stack[i]; i++) {\n            value += '\\n' + indention + '> ' + item.message + ' ' + (item.module ? '\"' + item.module + '\"' : '');\n\n            if (item.stack) {\n                value = ClassFailure.traverse(item.stack, value, depth + 1);\n            }\n        }\n\n        return value;\n    };\n\n    //=require singleton/cache.js\n\n    var ClassDependency = (function() {\n        var PREFIX_INTERNAL = 'internal!',\n            registry = new ClassRegistry(),\n            placeholder = [];\n\n        function setProperty(property, value) {\n            this[property] = value;\n        }\n\n        function addPending(id, dependency) {\n            if (dependency.pledge.isPending()) {\n                this.push(id);\n            }\n        }\n\n        function addResolved(id, dependency) {\n            if (dependency.pledge.isResolved()) {\n                this.push(id);\n            }\n        }\n\n        function addRejected(id, dependency) {\n            if (dependency.pledge.isRejected()) {\n                this.push(id);\n            }\n        }\n\n        function ClassDependency(uri, context, register) {\n            var self = this,\n                parameter = uri.match(regexMatchParameter) || placeholder;\n\n            self.path = functionResolvePath(uri, context);\n            self.mock = parameter[1] ? TRUE : FALSE;\n            self.cache = parameter[2] ? parameter[1] === '+' : NULL;\n            self.type = parameter[3] || settings.handler;\n            self.version = parameter[4] || settings.version;\n            self.lifetime = (parameter[5] && parameter[5] * 1000) || settings.lifetime;\n            self.id = (self.mock ? MOCK_PREFIX : '') + self.type + '!' + self.path;\n            self.uri = (self.mock ? MOCK_PREFIX : '') + self.type + '@' + self.version + (validatorIsPositive(self.lifetime) && self.lifetime > 0 ? '#' + self.lifetime : '') + '!' + self.path;\n            self.dfd = ClassPledge.defer();\n            self.pledge = self.dfd.pledge;\n            self.invalid = false;\n\n            self.pledge.then(function() {\n                self.value = functionToArray(arguments);\n            });\n\n            (register !== FALSE) && registry.set(self.id, self);\n\n            return self;\n        }\n\n        ClassDependency.prototype = {\n            enqueue: true // handled by handler\n            /* only for reference\n\t\t\t \tpath:     NULL,\n\t\t\t \tmock:     NULL,\n\t\t\t\tcache:    NULL,\n\t\t\t\ttype:     NULL,\n\t\t\t\tversion:  NULL,\n\t\t\t\tlifetime: NULL,\n\t\t\t \tid:       NULL,\n\t\t\t \turi:      NULL,\n\t\t\t\tdfd:      NULL,\n\t\t\t\tpledge:   NULL,\n\t\t\t\tvalue:    NULL,\n\t\t\t\thandler:  NULL, // set by Dependency.resolve\n\t\t\t \tsource:   NULL, // set by Cache or Loader\n\t\t\t \turl:      NULL // optional, set by Loader\n\t\t\t\t*/\n        };\n\n        ClassDependency.get = function(uri, context) {\n            return registry.get(functionResolveId(uri, context));\n        };\n\n        ClassDependency.resolve = function(uri, context) {\n            var isInternal = context && regexMatchInternal.test(uri),\n                dependency = isInternal ? this.get(PREFIX_INTERNAL + context + '/' + uri) : this.get(uri, context),\n                value;\n\n            if (!dependency) {\n                if (isInternal) {\n                    dependency = new ClassDependency(PREFIX_INTERNAL + context + '/' + uri);\n\n                    switch (uri) {\n                        case DEMAND_ID:\n                            value = (function() {\n                                return functionIterate(demand, setProperty, demand.bind(context));\n                            }());\n\n                            break;\n                        case PROVIDE_ID:\n                            value = provide.bind(context);\n\n                            break;\n                        case PATH_ID:\n                            value = context;\n\n                            break;\n                    }\n\n                    dependency.dfd.resolve(value);\n                } else {\n                    dependency = new ClassDependency(uri, context);\n\n                    demand(MODULE_PREFIX_HANDLER + dependency.type)\n                        .then(\n                            function(handler) {\n                                dependency.handler = handler;\n\n                                if (dependency.mock) {\n                                    dependency.dfd.resolve(handler);\n                                } else {\n                                    singletonCache.resolve(dependency);\n                                }\n                            },\n                            function() {\n                                dependency.dfd.reject(new ClassFailure(ERROR_LOAD + ' (handler)', self.id));\n                            }\n                        )\n                }\n            }\n\n            return dependency;\n        };\n\n        ClassDependency.remove = function(uri, context, cache) {\n            var id = functionResolveId(uri, context),\n                node = document.querySelector('[' + DEMAND_ID + '-id=\"' + id + '\"]');\n\n            registry.remove(id);\n            registry.remove(MOCK_PREFIX + id);\n\n            node && node.parentNode.removeChild(node);\n\n            (cache !== FALSE) && singletonCache.clear(id);\n        };\n\n        ClassDependency.list = {\n            all: function() {\n                return object.keys(registry.get());\n            },\n            pending: function() {\n                return functionIterate(registry.get(), addPending, []);\n            },\n            resolved: function() {\n                return functionIterate(registry.get(), addResolved, []);\n            },\n            rejected: function() {\n                return functionIterate(registry.get(), addRejected, []);\n            }\n        };\n\n        return ClassDependency;\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tfunctionResolveUrl, functionEscapeRegex, functionIterate\n    */\n\n    //=require function/resolveUrl.js\n    //=require function/escapeRegex.js\n    //=require function/iterate.js\n\n    var ClassPattern = (function() {\n        var regexMatchTrailingSlash = /(.+)\\/$/;\n\n        function setProperty(property, value) {\n            this[property] = {\n                url: functionResolveUrl(value).replace(regexMatchTrailingSlash, '$1'),\n                match: new RegExp('^' + functionEscapeRegex(value))\n            };\n        }\n\n        function ClassPattern(pattern, url) {\n            var self = this;\n\n            self.weight = pattern.length;\n            self.match = new RegExp('^' + functionEscapeRegex(pattern));\n            self.location = [].concat(url);\n\n            functionIterate(self.location, setProperty, self.location);\n        }\n\n        ClassPattern.prototype = {\n            /* only for reference\n             weight:   0,\n             match:    NULL,\n             location: NULL,\n             */\n            matches: function(path) {\n                return this.match.test(path);\n            },\n            process: function(path, index) {\n                var current = this.location[index];\n\n                if (current) {\n                    return path.replace(this.match, current.url);\n                }\n            }\n        };\n\n        return ClassPattern;\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, EVENT_PRE_REQUEST, EVENT_POST_REQUEST, ERROR_LOAD,\n    \tregexIsAbsoluteUri,\n    \tlinkElement,\n    \tfunctionIterate, functionResolveUrl, functionGetTimestamp,\n    \tClassXhr, ClassFailure,\n    \tsingletonEvent\n    */\n\n    //=require constants.js\n    //=require variables.js\n    //=require shortcuts.js\n    //=require function/resolveUrl.js\n    //=require function/iterate.js\n    //=require singleton/event.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tTRUE,\n    \tregexMatchBaseUrl,\n    \tClassPledge\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    //=require variables.js\n    //=require class/pledge.js\n\n    var ClassXhr = (function(XMLHttpRequest) {\n        var XDomainRequest = 'XDomainRequest' in global && global.XDomainRequest || XMLHttpRequest;\n\n        function checkState() {\n            if (this.readyState < 4) {\n                this.abort();\n            }\n        }\n\n        return function ClassXhr(url) {\n            var dfd = ClassPledge.defer(),\n                xhr = regexMatchBaseUrl.test(url) ? new XMLHttpRequest() : new XDomainRequest(),\n                boundCheckState = checkState.bind(xhr),\n                timeout = settings.timeout,\n                pointer;\n\n            xhr.ontimeout = xhr.onerror = xhr.onabort = function() {\n                dfd.reject(xhr.status);\n            };\n            xhr.onprogress = xhr.onreadystatechange = function() {\n                clearTimeout(pointer);\n\n                pointer = setTimeout(boundCheckState, timeout);\n            };\n            xhr.onload = function() {\n                pointer = clearTimeout(pointer);\n\n                if (!('status' in xhr) || xhr.status === 200) {\n                    dfd.resolve(xhr.responseText, xhr.getResponseHeader && xhr.getResponseHeader('content-type'));\n                } else {\n                    dfd.reject(xhr.status);\n                }\n            };\n\n            xhr.open('GET', url, TRUE);\n            xhr.send();\n\n            pointer = setTimeout(boundCheckState, timeout);\n\n            return dfd.pledge;\n        };\n    }(XMLHttpRequest));\n\n    //=require class/failure.js\n\n    function ClassLoader(dependency) {\n        var regexMatchEmptySearch = /^(?:\\?|)$/,\n            pattern;\n\n        function resolve(response, type) {\n            if (!type || !dependency.handler.validate || dependency.handler.validate(type)) {\n                dependency.source = response;\n\n                singletonEvent.emit(EVENT_POST_REQUEST, dependency.type, dependency);\n            } else {\n                dependency.dfd.reject(new ClassFailure(ERROR_LOAD + ' (content-type)', dependency.id));\n            }\n        }\n\n        function reject(status) {\n            dependency.dfd.reject(new ClassFailure(ERROR_LOAD + (status ? ' (status)' : ''), dependency.id));\n        }\n\n        function load(location) {\n            location = location || 0;\n            dependency.url = document.createElement('a');\n\n            dependency.url.href = pattern ? functionResolveUrl(pattern.process(dependency.path, location)) : dependency.path;\n\n            if (dependency.invalid) {\n                dependency.url.search += ((regexMatchEmptySearch.test(dependency.url.search)) ? '' : '&') + functionGetTimestamp();\n            }\n\n            singletonEvent.emit(EVENT_PRE_REQUEST, dependency.type, dependency);\n\n            new ClassXhr(dependency.url).then(\n                resolve,\n                (\n                    pattern ?\n                    function() {\n                        location++;\n\n                        if (pattern.location[location]) {\n                            load(location);\n                        } else {\n                            reject();\n                        }\n                    } :\n                    reject\n                )\n            );\n        }\n\n        if (!regexIsAbsoluteUri.test(dependency.path)) {\n            functionIterate(settings.pattern, function(property, value) {\n                value.matches(dependency.path) && (!pattern || pattern.weight < value.weight) && (pattern = value);\n            });\n        }\n\n        load();\n    }\n\n\n    demand = (function() {\n        function updateCacheSettings(property, value) {\n            this[property] = {\n                weight: property.length,\n                state: value\n            };\n        }\n\n        function updatePatternSettings(property, value) {\n            property !== 'base' && (this[property] = new ClassPattern(property, value));\n        }\n\n        function updateModuleSettings(property, value) {\n            var temp = this[property] = this[property] || {};\n\n            singletonEvent.emit(EVENT_PRE_CONFIGURE, property, temp);\n\n            functionMerge(temp, value);\n\n            singletonEvent.emit(EVENT_POST_CONFIGURE, property, temp);\n        }\n\n        function demand() {\n            var dependencies = functionToArray(arguments),\n                context = this !== global ? this : NULL,\n                i = 0,\n                uri, dfd, result;\n\n            singletonEvent.emit(EVENT_PRE_RESOLVE, NULL, dependencies, context);\n\n            for (;\n                (uri = dependencies[i]); i++) {\n                if (validatorIsTypeOf(uri, STRING_STRING)) {\n                    dependencies[i] = ClassDependency.resolve(uri, context).pledge;\n                } else {\n                    dependencies[i] = (dfd = ClassPledge.defer()).pledge;\n\n                    dfd.resolve(uri);\n                }\n            }\n\n            if (dependencies.length > 1) {\n                result = ClassPledge.all(dependencies);\n            } else {\n                result = dependencies[0];\n            }\n\n            return result.always(function() {\n                singletonEvent.emit(EVENT_POST_RESOLVE, NULL, dependencies, context);\n            });\n        }\n\n        demand.configure = function(options) {\n            var cache = options.cache,\n                version = options.version,\n                timeout = options.timeout,\n                lifetime = options.lifetime,\n                base = options.base,\n                pattern = options.pattern,\n                modules = options.modules,\n                pointer = settings.modules;\n\n            if (validatorIsTypeOf(cache, STRING_BOOLEAN)) {\n                settings.cache[''] = {\n                    weight: 0,\n                    state: cache\n                };\n            } else if (validatorIsObject(cache)) {\n                functionIterate(cache, updateCacheSettings, settings.cache);\n            }\n\n            if (validatorIsTypeOf(version, STRING_STRING)) {\n                settings.version = version;\n            }\n\n            if (validatorIsPositive(timeout)) {\n                settings.timeout = Math.min(Math.max(timeout, 2), 12) * 1000;\n            }\n\n            if (validatorIsPositive(lifetime) && lifetime > 0) {\n                settings.lifetime = lifetime * 1000;\n            }\n\n            if (validatorIsTypeOf(base, STRING_STRING) && base !== '') {\n                settings.pattern.base = new ClassPattern('', base);\n            }\n\n            if (validatorIsObject(pattern)) {\n                functionIterate(pattern, updatePatternSettings, settings.pattern);\n            }\n\n            if (validatorIsObject(modules)) {\n                functionIterate(modules, updateModuleSettings, pointer);\n            }\n\n            return demand;\n        };\n\n        demand.version = '{{gulp:package.version}}';\n        demand.on = singletonEvent.on.bind(demand);\n        demand.get = function(uri, context) {\n            var dependency = ClassDependency.get(uri, context);\n            return dependency && dependency.value;\n        };\n        demand.list = ClassDependency.list;\n        demand.remove = ClassDependency.remove;\n        demand.cache = {\n            clear: singletonCache.clear\n        };\n\n        singletonEvent\n            .after(EVENT_CACHE_MISS, function(dependency) {\n                new ClassLoader(dependency);\n            })\n            .after(EVENT_POST_REQUEST, function(dependency) {\n                var pointer = dependency.handler.onPostRequest;\n\n                pointer && pointer(dependency);\n            })\n            .after(EVENT_CACHE_HIT + ' ' + EVENT_POST_REQUEST, function(dependency) {\n                singletonEvent.emit(EVENT_PRE_PROCESS, dependency.id, dependency);\n            })\n            .after(EVENT_PRE_REQUEST, function(dependency) {\n                var pointer = dependency.handler.onPreRequest;\n\n                pointer && pointer(dependency);\n            })\n            .after(EVENT_PRE_PROCESS, function(dependency) {\n                var pointer = dependency.handler.onPreProcess;\n\n                pointer && pointer(dependency);\n\n                dependency.pledge.then(function() {\n                    singletonEvent.emit(EVENT_POST_PROCESS, dependency.id, dependency);\n                });\n\n                if (dependency.enqueue === true) {\n                    queue.enqueue(dependency);\n                } else if (validatorIsInstanceOf(dependency.enqueue, ClassPledge)) {\n                    dependency.enqueue.then(function() {\n                        queue.enqueue(dependency);\n                    });\n                }\n            });\n\n        return demand;\n    }())\n\n    global.define('demand', demand);\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_STRING, STRING_UNDEFINED, STRING_FUNCTION, ERROR_PROVIDE, ERROR_PROVIDE_ANONYMOUS, NULL,\n    \tvalidatorIsTypeOf, validatorIsArray,\n    \tClassDependency, ClassFailure\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tobjectPrototypeToString\n    */\n\n    //=require shortcuts.js\n\n    /**\n     * isArray\n     *\n     * Check whether a given value is of type array\n     *\n     * @param value\n     *\n     * @return {boolean}\n     */\n\n    function validatorIsArray(value) {\n        return objectPrototypeToString.call(value) === '[object Array]';\n    }\n\n    //=require class/dependency.js\n    //=require class/failure.js\n\n    provide = function provide() {\n        var uri = validatorIsTypeOf(arguments[0], STRING_STRING) ? arguments[0] : NULL,\n            context = this !== global ? this : NULL,\n            dependencies = validatorIsArray(arguments[uri ? 1 : 0]) ? arguments[uri ? 1 : 0] : NULL,\n            definition = dependencies ? arguments[uri ? 2 : 1] : arguments[uri ? 1 : 0],\n            module, isFunction;\n\n        if (!uri && processor.current) {\n            module = processor.current;\n            uri = module.uri;\n\n            processor.process();\n        }\n\n        if (uri) {\n            module = module || new ClassDependency(uri, context);\n            isFunction = validatorIsTypeOf(definition, STRING_FUNCTION);\n\n            if (dependencies) {\n                demand\n                    .apply(module.path, dependencies)\n                    .then(\n                        function() {\n                            module.dfd.resolve(isFunction ? definition.apply(NULL, arguments) : definition);\n                        },\n                        function() {\n                            module.dfd.reject(new ClassFailure(ERROR_PROVIDE, module.id, arguments));\n                        }\n                    );\n            } else {\n                module.dfd.resolve(isFunction ? definition() : definition);\n            }\n\n            return module.dfd.pledge;\n        } else {\n            !validatorIsTypeOf(console, STRING_UNDEFINED) && console.error(new ClassFailure(ERROR_PROVIDE_ANONYMOUS)); // eslint-disable-line no-console\n        }\n    }\n\n    global.define('provide', provide);\n\n\n    // process initial configuration\n    demand.configure({\n        cache: TRUE,\n        base: '/',\n        pattern: {\n            '/demand': functionResolveUrl(((options && options.url) || location.href) + '/../').slice(0, -1)\n        }\n    });\n    options && options.settings && demand.configure(options.settings);\n\n    // include additional components\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    /**\n     * hash\n     *\n     * Generate a hash for a given string\n     *\n     * @param {string} input\n     *\n     * @return {number}\n     */\n    function functionHash(input) {\n        var value = 5381,\n            i = input.length;\n\n        while (i) {\n            value = (value * 33) ^ input.charCodeAt(--i);\n        }\n\n        return value >>> 0;\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tEVENT_QUEUE_ENQUEUE, EVENT_QUEUE_DEQUEUE,\n    \tfunctionToArray,\n    \tsingletonEvent,\n    \tClassWeakmap,\n    \tAbstractUuid\n    */\n\n    //=require constants.js\n    //=require function/toArray.js\n    //=require singleton/event.js\n    //=require class/weakmap.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_UNDEFINED,\n    \tvalidatorIsTypeOf,\n    \tfunctionUuid,\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    //=require validator/isTypeOf.js\n    //=require function/uuid.js\n\n    function AbstractUuid() {\n        if (validatorIsTypeOf(this.uuid, STRING_UNDEFINED)) {\n            this.define('uuid', functionUuid());\n        }\n\n        return this;\n    }\n\n\n    var ClassQueue = (function() {\n        var storage = new ClassWeakmap();\n\n        function ClassQueue() {\n            var self = AbstractUuid.call(this);\n\n            storage.set(self, []);\n\n            return self;\n        }\n\n        ClassQueue.prototype = {\n            enqueue: function() {\n                storage.set(this, storage.get(this).concat(functionToArray(arguments)));\n\n                singletonEvent.emit(EVENT_QUEUE_ENQUEUE, this.uuid);\n            },\n            dequeue: function() {\n                singletonEvent.emit(EVENT_QUEUE_DEQUEUE, this.uuid);\n\n                return storage.get(this).shift();\n            },\n            get current() {\n                return storage.get(this)[0];\n            },\n            get length() {\n                return storage.get(this).length;\n            }\n        };\n\n        return ClassQueue.extends(AbstractUuid);\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tEVENT_QUEUE_ENQUEUE, NULL,\n    \tsingletonEvent,\n    \tClassWeakmap\n    */\n\n    //=require constants.js\n    //=require class/weakmap.js\n\n    var ClassProcessor = (function() {\n        var storage = new ClassWeakmap();\n\n        function ClassProcessor(queue) {\n            var self = this,\n                properties = {\n                    queue: queue,\n                    current: NULL\n                };\n\n            storage.set(self, properties);\n\n            demand\n                .on(EVENT_QUEUE_ENQUEUE + ':' + queue.uuid, function() {\n                    !properties.current && self.process();\n                });\n        }\n\n        ClassProcessor.prototype = {\n            process: function() {\n                var properties = storage.get(this),\n                    current;\n\n                if (properties.queue.length) {\n                    current = properties.current = properties.queue.dequeue();\n\n                    if (!current.pledge.isRejected()) {\n                        current.handler.process && current.handler.process(current);\n\n                        return;\n                    }\n                }\n\n                properties.current = NULL;\n            },\n            get current() {\n                return storage.get(this).current;\n            }\n        };\n\n        return ClassProcessor;\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, EVENT_PRE_REQUEST, EVENT_POST_REQUEST, TRUE,\n    \tfunctionResolveSourcemaps,\n    \tabstractHandler\n    */\n\n    //=require constants.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tregexMatchSourcemap, regexIsAbsoluteUri\n    \tlinkElement\n    */\n\n    //=require variables.js\n    //=require shortcuts.js\n\n    function functionResolveSourcemaps(url, source) {\n        var match, replacement;\n\n        while (match = regexMatchSourcemap.exec(source)) {\n            linkElement.href = url;\n\n            if (regexIsAbsoluteUri.test(match[2])) {\n                replacement = linkElement.protocol + '//' + linkElement.host + match[3];\n            } else {\n                linkElement.pathname += '/../' + match[3];\n\n                replacement = linkElement.protocol + '//' + linkElement.host + linkElement.pathname;\n            }\n\n            source = source.replace(match[0], match[1] + ' ' + match[2] + '=' + replacement + '.map' + (match[4] ? ' ' + match[4] : ''));\n        }\n\n        return source;\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tNULL\n    */\n\n    //=require constants.js\n\n    function abstractHandler() {\n\n    }\n\n    abstractHandler.prototype = {\n        validate: NULL,\n        onPreRequest: NULL,\n        onPostRequest: NULL,\n        onPreProcess: NULL,\n        process: NULL\n    };\n\n\n    var handlerModule = (function() {\n        var suffix = '.js',\n            target = document.getElementsByTagName('head')[0],\n            regexMatchType = /^(application|text)\\/(x-)?javascript/;\n\n        function HandlerModule() {}\n\n        HandlerModule.prototype = {\n            validate: function(type) {\n                return regexMatchType.test(type);\n            },\n            onPreRequest: function(dependency) {\n                var pathname = dependency.url.pathname;\n\n                dependency.url.pathname = pathname.slice(-suffix.length) !== suffix ? pathname + suffix : pathname;\n            },\n            onPostRequest: function(dependency) {\n                dependency.source = functionResolveSourcemaps(dependency.url, dependency.source);\n            },\n            process: function(dependency) {\n                var script;\n\n                if (dependency.source) {\n                    script = document.createElement('script');\n                    script.async = TRUE;\n                    script.text = dependency.source;\n\n                    script.setAttribute(DEMAND_ID + '-id', dependency.id);\n\n                    target.appendChild(script);\n                }\n            }\n        };\n\n        return new(HandlerModule.extends(abstractHandler));\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tMODULE_PREFIX_HANDLER, EVENT_POST_CONFIGURE, ERROR_RESOLVE, MOCK_PREFIX, STRING_STRING, FALSE, TRUE,\n    \tregexMatchParameter, regexMatchSourcemap,\n    \tvalidatorIsTypeOf, validatorIsObject,\n    \tfunctionIterate, functionResolveId,\n    \tabstractHandler,\n    \tClassDependency, ClassPledge, ClassFailure,\n    \thandlerModule\n    */\n\n    //=require constants.js\n    //=require variables.js\n    //=require validator/isTypeOf.js\n    //=require validator/isObject.js\n    //=require function/iterate.js\n    //=require function/resolveId.js\n    //=require abstract/handler.js\n    //=require class/dependency.js\n    //=require class/pledge.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID,\n    \tfunctionToArray\n    */\n\n    //=require constants.js\n    //=require function/toArray.js\n\n    function ClassFailure(message, module, stack) {\n        var self = this;\n\n        self.message = message;\n\n        module && (self.module = module);\n        stack && (self.stack = functionToArray(stack));\n\n        return self;\n    }\n\n    ClassFailure.prototype = {\n        /* only for reference\n         message: NULL,\n         module:  NULL,\n         stack:   NULL,\n         */\n        toString: function() {\n            var self = this,\n                result = DEMAND_ID + ': ' + self.message + ' ' + (self.module ? '\"' + self.module + '\"' : '');\n\n            if (self.stack) {\n                result = ClassFailure.traverse(self.stack, result, 1);\n            }\n\n            return result;\n        }\n    };\n\n    ClassFailure.traverse = function(stack, value, depth) {\n        var indention = new Array(depth + 1).join(' '),\n            i = 0,\n            item;\n\n        for (; item = stack[i]; i++) {\n            value += '\\n' + indention + '> ' + item.message + ' ' + (item.module ? '\"' + item.module + '\"' : '');\n\n            if (item.stack) {\n                value = ClassFailure.traverse(item.stack, value, depth + 1);\n            }\n        }\n\n        return value;\n    };\n\n    //=require handler/module.js\n\n    var handlerBundle = (function() {\n        var path = MODULE_PREFIX_HANDLER + 'bundle',\n            settings = {};\n\n        demand\n            .on(EVENT_POST_CONFIGURE + ':' + path, function(options) {\n                if (validatorIsObject(options)) {\n                    settings = options;\n\n                    functionIterate(settings, updateDependencies);\n                }\n            });\n\n        function updateDependencies(uri, dependencies) {\n            var i, dependency;\n\n            for (i = 0;\n                (dependency = dependencies[i]); i++) {\n                if (validatorIsTypeOf(dependency, STRING_STRING)) {\n                    dependencies[i] = functionResolveId(dependency);\n                }\n            }\n        }\n\n        function getType(dependencies) {\n            var type, i = 0,\n                temp;\n\n            for (;\n                (temp = dependencies[i]); i++) {\n                temp = temp.match(regexMatchParameter);\n                temp = (temp && temp[3]) || settings.handler;\n\n                if (type) {\n                    if (temp !== type) {\n                        return FALSE;\n                    }\n                } else {\n                    type = temp;\n                }\n            }\n\n            return type;\n        }\n\n        function HandlerBundle() {}\n\n        HandlerBundle.prototype = {\n            validate: handlerModule.validate,\n            onPreProcess: function(dependency) {\n                var source = dependency.source,\n                    dfd = dependency.dfd,\n                    dependencies = settings[dependency.path],\n                    type, match, pledges, temp, i;\n\n                dependency.enqueue = FALSE;\n\n                function reject() {\n                    dfd.reject(new ClassFailure(ERROR_RESOLVE, dependency.id, arguments));\n                }\n\n                if (dependencies && (type = getType(dependencies))) {\n                    while (match = regexMatchSourcemap.exec(source)) {\n                        source = source.replace(match[0], '');\n                    }\n\n                    dependency.source = source;\n                    pledges = [];\n\n                    for (i = 0;\n                        (temp = dependencies[i]); i++) {\n                        pledges.push(ClassDependency.resolve(MOCK_PREFIX + temp).pledge);\n                    }\n\n                    ClassPledge.all(pledges).then(\n                        function() {\n                            pledges.length = 0;\n\n                            for (i = 0;\n                                (temp = dependencies[i]); i++) {\n                                temp = dependencies[i] = ClassDependency.get(temp) || new ClassDependency(temp);\n                                temp.handler = arguments[i];\n\n                                pledges.push(temp.pledge);\n                            }\n\n                            if (type === 'module') {\n                                queue.enqueue.apply(queue, dependencies);\n                                handlerModule.process(dependency);\n                            } else {\n                                handlerModule.process(dependency);\n                                queue.enqueue.apply(queue, dependencies);\n                            }\n\n                            ClassPledge.all(pledges).then(dfd.resolve, reject);\n                        },\n                        reject\n                    );\n                } else {\n                    reject();\n                }\n            }\n        };\n\n        return new(HandlerBundle.extends(abstractHandler));\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tFALSE, EVENT_POST_REQUEST, ERROR_RESOLVE,\n    \tfunctionResolveSourcemaps,\n    \tabstractHandler,\n    \tClassDependency, ClassPledge, ClassFailure\n    */\n\n    //=require constants.js\n    //=require function/resolveSourcemaps.js\n    //=require abstract/handler.js\n    //=require class/dependency.js\n    //=require class/pledge.js\n    //=require class/Failure.js\n\n    var handlerComponent = (function() {\n        var suffix = '.html',\n            regexMatchType = /^text\\/.+$/;\n\n        function HandlerComponent() {}\n\n        HandlerComponent.prototype = {\n            validate: function(type) {\n                return regexMatchType.test(type);\n            },\n            onPreRequest: function(dependency) {\n                var pathname = dependency.url.pathname;\n\n                dependency.url.pathname = pathname.slice(-suffix.length) !== suffix ? pathname + suffix : pathname;\n            },\n            onPostRequest: function(dependency) {\n                dependency.source = functionResolveSourcemaps(dependency.url, dependency.source);\n            },\n            onPreProcess: function(dependency) {\n                var context = dependency.path,\n                    dfd = dependency.dfd,\n                    container = document.createElement('body'),\n                    modules = [],\n                    pledges = [],\n                    node, handler, path, uri;\n\n                dependency.enqueue = FALSE;\n                container.innerHTML = dependency.source;\n\n                function reject() {\n                    dfd.reject(new ClassFailure(ERROR_RESOLVE, dependency.id, arguments));\n                }\n\n                while (node = container.firstElementChild) {\n                    if (handler = node.getAttribute('type')) {\n                        path = node.getAttribute('path');\n                        uri = handler + '!' + context + (path ? '/' + path : '');\n\n                        node.parentNode.removeChild(node);\n                        modules.push({\n                            source: node.textContent,\n                            uri: uri\n                        });\n                        pledges.push(ClassDependency.resolve('mock:' + uri).pledge);\n                    }\n                }\n\n                ClassPledge.all(pledges).then(\n                    function() {\n                        var i = 0,\n                            module, dependency;\n\n                        pledges.length = 0;\n\n                        for (;\n                            (module = modules[i]); i++) {\n                            dependency = ClassDependency.get(module.uri) || new ClassDependency(module.uri);\n                            dependency.source = functionResolveSourcemaps(dependency.url, module.source);\n                            dependency.handler = arguments[i];\n\n                            pledges.push(dependency.pledge);\n\n                            queue.enqueue(dependency);\n                        }\n\n                        ClassPledge.all(pledges).then(dfd.resolve, reject);\n                    },\n                    reject\n                );\n            }\n        };\n\n        return new(HandlerComponent.extends(abstractHandler));\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tMODULE_PREFIX_PLUGIN, MODULE_PREFIX_HANDLER, EVENT_POST_CONFIGURE, EVENT_PRE_RESOLVE, STRING_STRING, ERROR_RESOLVE, FALSE, TRUE,\n    \tregexMatchInternal,\n    \tvalidatorIsObject, validatorIsTypeOf,\n    \tfunctionIterate, functionHash,\n    \tClassDependency, ClassFailure,\n    \tsingletonCache\n    */\n\n    //=require constants.js\n    //=require variables.js\n    //=require validator/isTypeOf.js\n    //=require validator/isObject.js\n    //=require function/iterate.js\n    //=require function/hash.js\n    //=require class/dependency.js\n    //=require class/failure.js\n    //=require singleton/cache.js\n\n    var pluginGenie = (function() {\n        var path = MODULE_PREFIX_PLUGIN + 'genie',\n            pattern = [];\n\n        function matchPattern(path) {\n            var i = 0,\n                pointer, match;\n\n            for (;\n                (pointer = pattern[i]); i++) {\n                if (path.indexOf(pointer.prefix) === 0 && (!match || pointer.weight > match.weight)) {\n                    match = pointer;\n                }\n            }\n\n            return match;\n        }\n\n        function generateConfiguration(bundle) {\n            var matches = bundle.matches,\n                configuration = {\n                    pattern: {},\n                    modules: {\n                        '/demand/handler/bundle': {}\n                    }\n                },\n                i = 0,\n                pointer, dependency;\n\n            configuration.pattern[bundle.id] = bundle.fn(matches);\n            configuration.modules[MODULE_PREFIX_HANDLER + 'bundle'][bundle.id] = pointer = [];\n\n            for (;\n                (dependency = matches[i]); i++) {\n                pointer.push(dependency.path);\n            }\n\n            return configuration;\n        }\n\n        function resolveDependencies() {\n            var i = 0,\n                dependency;\n\n            for (;\n                (dependency = this[i]); i++) {\n                dependency.dfd.resolve(arguments[i]);\n            }\n        }\n\n        function rejectDependencies() {\n            var i = 0,\n                dependency;\n\n            for (;\n                (dependency = this[i]); i++) {\n                dependency.dfd.reject(new ClassFailure(ERROR_RESOLVE, dependency.id));\n            }\n        }\n\n        function addPattern(property, value) {\n            pattern.push({\n                prefix: property,\n                weight: property.length,\n                fn: value\n            });\n        }\n\n        function resolveBundles(property, value) {\n            var matches = value.matches,\n                i = 0,\n                dependency;\n\n            if (matches.length > 1) {\n                value.id = path + '/' + functionHash(JSON.stringify(value.matches));\n\n                for (;\n                    (dependency = matches[i]); i++) {\n                    matches[i] = new ClassDependency(dependency.uri);\n                }\n\n                demand.configure(generateConfiguration(value));\n                demand('bundle!' + value.id)\n                    .then(\n                        resolveDependencies.bind(matches),\n                        rejectDependencies.bind(matches)\n                    );\n            }\n        }\n\n        demand\n            .on(EVENT_POST_CONFIGURE + ':' + path, function(options) {\n                if (validatorIsObject(options)) {\n                    pattern.length = 0;\n\n                    functionIterate(options, addPattern);\n                }\n            })\n            .on(EVENT_PRE_RESOLVE, function(dependencies, context) {\n                var bundles = {},\n                    i = 0,\n                    dependency, pattern;\n\n                for (;\n                    (dependency = dependencies[i]); i++) {\n                    if (validatorIsTypeOf(dependency, STRING_STRING) && !regexMatchInternal.test(dependency) && !ClassDependency.get(dependency, context)) {\n                        dependency = new ClassDependency(dependency, context, FALSE);\n\n                        if (dependency.type === 'module' && (pattern = matchPattern(dependency.path)) && !singletonCache.get(dependency)) {\n                            (bundles[pattern.prefix] || (bundles[pattern.prefix] = {\n                                fn: pattern.fn,\n                                matches: []\n                            })).matches.push(dependency);\n                        }\n                    }\n                }\n\n                functionIterate(bundles, resolveBundles);\n            });\n\n        return TRUE;\n    }());\n\n\n    // initialize\n    queue = new ClassQueue();\n    processor = new ClassProcessor(queue);\n\n    function assignModule(id, module) {\n        provide(id, function() {\n            return module;\n        });\n    }\n\n    assignModule(MODULE_PREFIX_ABSTRACT + 'uuid', AbstractUuid);\n    assignModule(MODULE_PREFIX_ABSTRACT + 'handler', abstractHandler);\n    assignModule(MODULE_PREFIX_HANDLER + 'module', handlerModule);\n    assignModule(MODULE_PREFIX_HANDLER + 'bundle', handlerBundle);\n    assignModule(MODULE_PREFIX_HANDLER + 'component', handlerComponent);\n    assignModule(MODULE_PREFIX_PLUGIN + 'genie', pluginGenie);\n    assignModule(MODULE_PREFIX_VALIDATOR + 'isTypeOf', validatorIsTypeOf);\n    assignModule(MODULE_PREFIX_VALIDATOR + 'isArray', validatorIsArray);\n    assignModule(MODULE_PREFIX_VALIDATOR + 'isObject', validatorIsObject);\n    assignModule(MODULE_PREFIX_VALIDATOR + 'isInstanceOf', validatorIsInstanceOf);\n    assignModule(MODULE_PREFIX_FUNCTION + 'resolveUrl', functionResolveUrl);\n    assignModule(MODULE_PREFIX_FUNCTION + 'resolveSourcemaps', functionResolveSourcemaps);\n    assignModule(MODULE_PREFIX_FUNCTION + 'merge', functionMerge);\n    assignModule(MODULE_PREFIX_FUNCTION + 'iterate', functionIterate);\n    assignModule(MODULE_PREFIX_FUNCTION + 'hash', functionHash);\n    assignModule(MODULE_PREFIX_FUNCTION + 'defer', functionDefer);\n    assignModule(MODULE_PREFIX_FUNCTION + 'uuid', functionUuid);\n    assignModule(MODULE_PREFIX + 'weakmap', ClassWeakmap);\n    assignModule(MODULE_PREFIX + 'descriptor', ClassDescriptor);\n    assignModule(MODULE_PREFIX + 'pledge', ClassPledge);\n    assignModule(MODULE_PREFIX + 'queue', ClassQueue);\n    assignModule(MODULE_PREFIX + 'xhr', ClassXhr);\n    assignModule(MODULE_PREFIX + 'failure', ClassFailure);\n\n    if (options && options.main) {\n        switch (typeof options.main) {\n            case STRING_STRING:\n                demand(options.main);\n\n                break;\n            case STRING_FUNCTION:\n                provide('main', options.main());\n\n                break;\n        }\n    }\n}(this.name === 'demand-loader' ? parent : this, setTimeout, clearTimeout));"]}