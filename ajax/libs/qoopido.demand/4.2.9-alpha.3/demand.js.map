{"version":3,"sources":["demand.js"],"names":["global","setTimeout","clearTimeout","demand","provide","queue","processor","document","options","settings","version","cache","timeout","pattern","modules","handler","DEMAND_ID","MODULE_PREFIX","MODULE_PREFIX_ABSTRACT","MODULE_PREFIX_HANDLER","MODULE_PREFIX_PLUGIN","MODULE_PREFIX_FUNCTION","MODULE_PREFIX_VALIDATOR","MOCK_PREFIX","NULL","UNDEFINED","undefined","FALSE","TRUE","STRING_UNDEFINED","STRING_STRING","STRING_OBJECT","STRING_FUNCTION","STRING_NUMBER","FUNCTION_EMPTY","EVENT_PRE_CONFIGURE","EVENT_PREFIX","EVENT_POST_CONFIGURE","EVENT_POSTFIX","EVENT_CACHE","EVENT_CACHE_MISS","EVENT_CACHE_EXCEED","EVENT_PRE_RESOLVE","EVENT_POST_RESOLVE","EVENT_PRE_REQUEST","EVENT_POST_REQUEST","EVENT_PRE_PROCESS","EVENT_POST_PROCESS","EVENT_QUEUE_ENQUEUE","EVENT_QUEUE","ERROR_LOAD","ERROR_RESOLVE","arrayPrototype","Array","prototype","arrayPrototypeSlice","slice","arrayPrototypeConcat","concat","object","Object","objectPrototypeToString","toString","objectCreate","create","objectDefineProperty","defineProperty","objectGetOwnPropertyNames","getOwnPropertyNames","objectGetOwnPropertyDescriptor","getOwnPropertyDescriptor","linkElement","createElement","ClassDescriptor","value","writable","configurable","enumerable","__proto__","validatorIsTypeOf","type","validatorIsObject","validatorIsPositive","isFinite","Math","floor","validatorIsInstanceOf","module","functionIterate","source","callback","context","property","properties","keys","i","call","strPrototype","objectDefine","name","this","Function","define","names","constructor","e","TypeError","storage","element","fallback","hasSetImmediate","functionMerge","mergeProperties","targetPropertyIsObject","targetProperty","length","target","arguments","functionUuid","regex","RegExp","randomize","character","r","random","replace","functionDefer","fn","MutationObserver","observe","attributes","setAttribute","addEventListener","event","data","uuid","postMessage","onreadystatechange","parentNode","removeChild","body","appendChild","setImmediate","functionToArray","arrayLikeObject","start","end","singletonEvent","TYPE_ON","regexMatchEvent","listener","addListener","events","pointer","split","shift","test","on","after","push","filter","Event","emit","parameter","item","apply","functionGetTimestamp","Date","regexMatchRegex","functionEscapeRegex","functionResolveUrl","url","href","regexIsAbsoluteUri","regexIsAbsolutePath","regexMatchSourcemap","regexMatchBaseUrl","regexMatchInternal","regexMatchParameter","functionResolvePath","uri","path","functionResolveId","match","singletonCache","STORAGE_PREFIX","STORAGE_SUFFIX_STATE","regexMatchState","regexMatchProperties","supportsLocalStorage","localStorage","exception","supportsRemainingSpace","enabled","dependency","indexOf","weight","state","getKey","key","getItem","setKey","getState","matches","setState","join","id","Cache","clear","expired","bind","then","cacheDispose","set","get","lifetime","invalid","resolve","spaceBefore","remainingSpace","Error","error","ClassDependency","all","ClassWeakmap","WeakMap","prefix","getEntry","entry","delete","has","ClassPledge","PLEDGE_PENDING","PLEDGE_RESOLVED","PLEDGE_REJECTED","pledge","index","resolved","count","check","rejected","total","dfd","reject","executor","handle","result","catch","always","alwaysListener","resolveListener","rejectListener","defer","isPending","isResolved","isRejected","self","pledges","race","ClassRegistry","remove","ClassFailure","message","stack","traverse","depth","indention","registry","placeholder","setProperty","addPending","addResolved","addRejected","register","mock","enqueue","isInternal","node","querySelector","list","pending","ClassPattern","regexMatchTrailingSlash","location","process","current","ClassXhr","XMLHttpRequest","XDomainRequest","xhr","boundCheckState","readyState","abort","ontimeout","onerror","onabort","status","onprogress","onload","responseText","getResponseHeader","open","send","validatorIsArray","functionHash","input","charCodeAt","AbstractUuid","updateCacheSettings","updatePatternSettings","updateModuleSettings","temp","dependencies","configure","base","min","max","regexMatchEmptySearch","response","validate","load","search","onPostRequest","EVENT_CACHE_HIT","onPreRequest","onPreProcess","isFunction","definition","console","/demand","ClassQueue","dequeue","extends","ClassProcessor","functionResolveSourcemaps","replacement","exec","protocol","host","pathname","abstractHandler","handlerModule","getElementsByTagName","regexMatchType","HandlerModule","script","async","text","handlerBundle","updateDependencies","HandlerBundle","getType","handlerComponent","HandlerComponent","container","innerHTML","firstElementChild","getAttribute","textContent","pluginGenie","matchPattern","addPattern","resolveBundles","JSON","stringify","bundle","configuration","/demand/handler/bundle","generateConfiguration","bundles","assignModule","main","parent"],"mappings":"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","file":"demand.js","sourcesContent":["/* global\n\tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n\tMODULE_PREFIX, MODULE_PREFIX_HANDLER, MODULE_PREFIX_VALIDATOR, MODULE_PREFIX_PLUGIN, MODULE_PREFIX_FUNCTION, MODULE_PREFIX_ABSTRACT, STRING_STRING, STRING_FUNCTION, TRUE,\n\tvalidatorIsTypeOf, validatorIsArray, validatorIsObject, validatorIsInstanceOf,\n\tfunctionResolveUrl, functionResolveSourcemaps, functionMerge, functionIterate, functionDefer, functionHash, functionUuid,\n\tAbstractUuid, abstractHandler,\n\tClassDependency, ClassQueue, ClassProcessor, ClassPledge, ClassXhr, ClassFailure, ClassDescriptor, ClassWeakmap,\n\thandlerModule, handlerBundle, handlerComponent,\n \tpluginGenie\n*/\n\n/*eslint no-unused-vars: [2, { \"vars\": \"local\", \"args\": \"none\" }]*/\n(function(global, setTimeout, clearTimeout) {\n    'use strict';\n\n    /* eslint-disable no-unused-vars */\n    var document = global.document,\n        options = 'demand' in global && global.demand,\n        settings = {\n            version: '1.0.0',\n            cache: {},\n            timeout: 8000,\n            pattern: {},\n            modules: {},\n            handler: 'module'\n        },\n        demand, provide, queue, processor;\n\n    // include inheritance\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tTRUE,\n    \tobjectCreate, objectDefineProperty, objectGetOwnPropertyNames, objectGetOwnPropertyDescriptor,\n    \tClassDescriptor\n    */\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    var DEMAND_ID = 'demand',\n        PROVIDE_ID = 'provide',\n        PATH_ID = 'path',\n        MODULE_PREFIX = '/' + DEMAND_ID + '/',\n        MODULE_PREFIX_ABSTRACT = MODULE_PREFIX + 'abstract/',\n        MODULE_PREFIX_HANDLER = MODULE_PREFIX + 'handler/',\n        MODULE_PREFIX_PLUGIN = MODULE_PREFIX + 'plugin/',\n        MODULE_PREFIX_FUNCTION = MODULE_PREFIX + 'function/',\n        MODULE_PREFIX_VALIDATOR = MODULE_PREFIX + 'validator/',\n        MOCK_PREFIX = 'mock:',\n        NULL = null,\n        UNDEFINED = undefined,\n        FALSE = false,\n        TRUE = true,\n        STRING_UNDEFINED = 'undefined',\n        STRING_STRING = 'string',\n        STRING_BOOLEAN = 'boolean',\n        STRING_OBJECT = 'object',\n        STRING_FUNCTION = 'function',\n        STRING_NUMBER = 'number',\n        FUNCTION_EMPTY = function() {},\n        EVENT_PREFIX = 'pre',\n        EVENT_POSTFIX = 'post',\n        EVENT_CONFIGURE = 'Configure',\n        EVENT_PRE_CONFIGURE = EVENT_PREFIX + EVENT_CONFIGURE,\n        EVENT_POST_CONFIGURE = EVENT_POSTFIX + EVENT_CONFIGURE,\n        EVENT_CACHE = 'cache',\n        EVENT_CACHE_MISS = EVENT_CACHE + 'Miss',\n        EVENT_CACHE_HIT = EVENT_CACHE + 'Hit',\n        EVENT_CACHE_CLEAR = EVENT_CACHE + 'Clear',\n        EVENT_CACHE_EXCEED = EVENT_CACHE + 'Exceed',\n        EVENT_PRE_CACHE = EVENT_PREFIX + 'Cache',\n        EVENT_POST_CACHE = EVENT_POSTFIX + 'Cache',\n        EVENT_RESOLVE = 'Resolve',\n        EVENT_PRE_RESOLVE = EVENT_PREFIX + EVENT_RESOLVE,\n        EVENT_POST_RESOLVE = EVENT_POSTFIX + EVENT_RESOLVE,\n        EVENT_REQUEST = 'Request',\n        EVENT_PRE_REQUEST = EVENT_PREFIX + EVENT_REQUEST,\n        EVENT_POST_REQUEST = EVENT_POSTFIX + EVENT_REQUEST,\n        EVENT_PROCESS = 'Process',\n        EVENT_PRE_PROCESS = EVENT_PREFIX + EVENT_PROCESS,\n        EVENT_POST_PROCESS = EVENT_POSTFIX + EVENT_PROCESS,\n        EVENT_QUEUE = 'queue',\n        EVENT_QUEUE_ENQUEUE = EVENT_QUEUE + 'Enqueue',\n        EVENT_QUEUE_DEQUEUE = EVENT_QUEUE + 'Dequeue',\n        ERROR_LOAD = 'error loading',\n        ERROR_PROVIDE = 'error providing',\n        ERROR_RESOLVE = 'error resolving',\n        ERROR_PROVIDE_ANONYMOUS = 'unspecified anonymous provide';\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    var arrayPrototype = Array.prototype,\n        arrayPrototypeSlice = arrayPrototype.slice,\n        arrayPrototypeConcat = arrayPrototype.concat,\n        object = Object,\n        objectPrototype = object.prototype,\n        objectPrototypeToString = objectPrototype.toString,\n        objectCreate = object.create,\n        objectDefineProperty = object.defineProperty,\n        objectGetOwnPropertyNames = object.getOwnPropertyNames,\n        objectGetOwnPropertyDescriptor = object.getOwnPropertyDescriptor,\n        linkElement = document.createElement('a');\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tNULL\n    */\n\n    //=require constants.js\n\n    function ClassDescriptor(value, writable, configurable, enumerable) {\n        return {\n            __proto__: NULL,\n            value: value,\n            enumerable: !!enumerable,\n            configurable: !!configurable,\n            writable: !!writable\n        };\n    }\n\n\n    (function(strPrototype) {\n        function objectDefine(name, value, writable, configurable, enumerable) {\n            objectDefineProperty(this, name, new ClassDescriptor(value, writable, configurable, enumerable));\n        }\n\n        function functionExtends(source) {\n            var self = this,\n                prototype = self[strPrototype],\n                names = objectGetOwnPropertyNames(prototype),\n                properties = {\n                    constructor: new ClassDescriptor(self, TRUE, TRUE)\n                },\n                i = 0,\n                property;\n\n            for (;\n                (property = names[i]) && !properties[property]; i++) {\n                properties[property] = objectGetOwnPropertyDescriptor(prototype, property);\n            }\n\n            try {\n                self[strPrototype] = objectCreate(source[strPrototype] || source, properties);\n            } catch (e) {\n                // ES6 class prototypes are readonly at least in Chrome\n                // (and assignment throws an error in strict mode) ...\n            }\n\n            // ... which is handled here\n            if (self[strPrototype] === prototype) {\n                throw new TypeError('Unable to extend, prototype is not writable');\n            }\n\n            return self;\n        }\n\n        objectDefine.call(global.Object.prototype, 'define', objectDefine);\n        global.Function.prototype.define('extends', functionExtends);\n    }('prototype'));\n\n\n    // include main components\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_BOOLEAN, STRING_STRING, EVENT_PRE_RESOLVE, EVENT_POST_RESOLVE, EVENT_PRE_CONFIGURE, EVENT_POST_CONFIGURE, EVENT_CACHE_MISS, EVENT_CACHE_HIT, EVENT_PRE_REQUEST, EVENT_POST_REQUEST, EVENT_PRE_PROCESS, EVENT_POST_PROCESS, NULL, FALSE,\n    \tvalidatorIsTypeOf, validatorIsObject, validatorIsPositive, validatorIsInstanceOf,\n    \tfunctionIterate, functionMerge, functionDefer, functionToArray,\n    \tClassPledge, ClassDependency, ClassPattern, ClassLoader,\n    \tsingletonEvent, singletonCache\n    */\n\n    //=require constants.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    /**\n     * isTypeOf\n     *\n     * Check whether a given object is of specified type\n     *\n     * @param object\n     * @param {string} type\n     *\n     * @return {boolean}\n     */\n\n    function validatorIsTypeOf(object, type) {\n        return typeof object === type;\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_OBJECT,\n    \tvalidatorIsTypeOf\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n\n    /**\n     * isObject\n     *\n     * Check whether a given object is of type object\n     *\n     * @param object\n     *\n     * @return {boolean}\n     */\n\n    function validatorIsObject(object) {\n        return object && validatorIsTypeOf(object, STRING_OBJECT);\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_NUMBER,\n    \tvalidatorIsTypeOf\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n\n    /**\n     * isPositive\n     *\n     * Check whether a given value is a positive integer\n     *\n     * @param value\n     *\n     * @return {boolean}\n     */\n\n    function validatorIsPositive(value) {\n        return validatorIsTypeOf(value, STRING_NUMBER) && isFinite(value) && Math.floor(value) === value && value >= 0;\n    }\n\n    /**\n     * isInstanceOf\n     *\n     * Check whether a given object is an instance of specified type\n     *\n     * @param object\n     * @param module\n     *\n     * @return {boolean}\n     */\n    function validatorIsInstanceOf(object, module) {\n        return object instanceof module;\n    }\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tUNDEFINED, FALSE,\n    \tobject\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n\n    /**\n     * iterate\n     *\n     * Iterate over enumerable & own properties of a given\n     * object and pass current property as well as its value\n     * to a callback function\n     *\n     * @param {object} object\n     * @param {function} callback\n     * @param context\n     *\n     * @return mixed\n     */\n\n    function functionIterate(source, callback, context) {\n        var properties = object.keys(source),\n            i = 0,\n            property;\n\n        for (;\n            (property = properties[i]) !== UNDEFINED; i++) {\n            if (callback.call(context, property, source[property]) === FALSE) {\n                break;\n            }\n        }\n\n        return context;\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tUNDEFINED,\n    \tvalidatorIsObject,\n    \tfunctionIterate\n    */\n\n    //=require constants.js\n    //=require validator/isObject.js\n    //=require function/iterate.js\n\n    /**\n     * merge\n     *\n     * Merge two or more objects into the first one passed in\n     *\n     * @param {...object} object\n     *\n     * @return {object}\n     */\n    var functionMerge = (function() {\n        function mergeProperties(property, value) {\n            var targetProperty = this[property],\n                targetPropertyIsObject;\n\n            if (value !== UNDEFINED) {\n                if (validatorIsObject(value)) {\n                    targetPropertyIsObject = validatorIsObject(targetProperty);\n\n                    if (value.length !== UNDEFINED) {\n                        targetProperty = (targetPropertyIsObject && targetProperty.length !== UNDEFINED) ? targetProperty : [];\n                    } else {\n                        targetProperty = (targetPropertyIsObject && targetProperty.length === UNDEFINED) ? targetProperty : {};\n                    }\n\n                    this[property] = functionMerge(targetProperty, value);\n                } else {\n                    this[property] = value;\n                }\n            }\n        }\n\n        return function functionMerge() {\n            var target = arguments[0],\n                i = 1,\n                properties;\n\n            for (;\n                (properties = arguments[i]) !== UNDEFINED; i++) {\n                functionIterate(properties, mergeProperties, target);\n            }\n\n            return target;\n        };\n    }());\n\n    /**\n     * Based on setAsap:\n     *   Repo:    https://github.com/taylorhakes/setAsap\n     *   License: https://github.com/taylorhakes/setAsap/blob/master/LICENSE\n     */\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tNULL, TRUE, FALSE,\n    \tfunctionUuid\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    var functionUuid = (function() {\n        var regex = new RegExp('[xy]', 'g');\n\n        function randomize(character) {\n            var r = Math.random() * 16 | 0;\n\n            return ((character === 'x') ? r : (r & 0x3 | 0x8)).toString(16);\n        }\n\n        return function functionUuid() {\n            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(regex, randomize);\n        };\n    }());\n\n\n    /**\n     * defer\n     *\n     * delay function execution like setImmediate does\n     *\n     * @param {function} function\n     */\n    var functionDefer = (function() {\n        var hasSetImmediate = 'setImmediate' in global,\n            element, fallback;\n\n        if ('MutationObserver' in global) {\n            return function functionDefer(fn) {\n                element = document.createElement('div');\n\n                new MutationObserver(function() {\n                        fn();\n                    })\n                    .observe(element, {\n                        attributes: TRUE\n                    });\n\n                element.setAttribute('i', '1');\n            };\n        }\n\n        if (!hasSetImmediate && 'postMessage' in global && !('importScripts' in global) && 'addEventListener' in global) {\n            return (function() {\n                var storage = {};\n\n                function onMessage(event) {\n                    var fn;\n\n                    if (event.source === global && event.data && (fn = storage[event.data])) {\n                        fn();\n\n                        delete storage[event.data];\n                    }\n                }\n\n                global.addEventListener('message', onMessage, FALSE);\n\n                return function functionDefer(fn) {\n                    var uuid = functionUuid();\n\n                    storage[uuid] = fn;\n\n                    global.postMessage(uuid, '*');\n                };\n            }());\n        }\n\n        if (!hasSetImmediate && 'onreadystatechange' in (element = document.createElement('script'))) {\n            return function functionDefer(fn) {\n                element.onreadystatechange = function onreadystatechange() {\n                    element.onreadystatechange = NULL;\n                    element.parentNode.removeChild(element);\n\n                    fn();\n                };\n\n                document.body.appendChild(element);\n            };\n        }\n\n        fallback = hasSetImmediate ? setImmediate : setTimeout; // eslint-disable-line no-undef\n\n        return function functionDefer(fn) {\n            fallback(fn);\n        };\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tarrayPrototypeSlice\n    */\n\n    //=require shortcuts.js\n\n    function functionToArray(arrayLikeObject, start, end) {\n        return arrayPrototypeSlice.call(arrayLikeObject, start, end);\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tNULL, STRING_STRING, STRING_FUNCTION, EVENT_POST_CONFIGURE,\n    \tvalidatorIsTypeOf,\n    \tfunctionToArray\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n    //=require function/toArray.js\n\n    var singletonEvent = (function() {\n        var TYPE_ON = 'on',\n            TYPE_AFTER = 'after',\n            regexMatchEvent = /^cache(Miss|Hit|Clear|Exceed)|queue(En|De)queue|(pre|post)(Resolve|Configure|Request|Process|Cache)$/,\n            listener = {};\n\n        function addListener(type, events, callback) {\n            var event, pointer;\n\n            if (validatorIsTypeOf(events, STRING_STRING) && validatorIsTypeOf(callback, STRING_FUNCTION)) {\n                events = events.split(' ');\n\n                while (event = events.shift()) {\n                    event = event.split(':');\n\n                    if (regexMatchEvent.test(event[0])) {\n                        (listener[event[0]] || (listener[event[0]] = {\n                            on: [],\n                            after: []\n                        }))[type].push({\n                            callback: callback,\n                            filter: event[1]\n                        });\n\n                        if (type === TYPE_ON && event[0] === EVENT_POST_CONFIGURE && (pointer = settings.modules[event[1]])) {\n                            callback(pointer);\n                        }\n                    }\n                }\n            }\n        }\n\n        function Event() {}\n\n        Event.prototype = {\n            emit: function(event, filter) {\n                var pointer = listener[event],\n                    parameter, i, item;\n\n                if (pointer) {\n                    parameter = functionToArray(arguments, 2);\n\n                    for (i = 0;\n                        (item = pointer[TYPE_ON][i]); i++) {\n                        if (!item.filter || item.filter === filter) {\n                            item.callback.apply(NULL, parameter);\n                        }\n                    }\n\n                    for (i = 0;\n                        (item = pointer[TYPE_AFTER][i]); i++) {\n                        if (!item.filter || item.filter === filter) {\n                            item.callback.apply(NULL, parameter);\n                        }\n                    }\n                }\n\n                return this;\n            },\n            on: function(events, callback) {\n                addListener(TYPE_ON, events, callback);\n\n                return this;\n            },\n            after: function(events, callback) {\n                addListener(TYPE_AFTER, events, callback);\n\n                return this;\n            }\n        };\n\n        return new Event();\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, FUNCTION_EMPTY, EVENT_POST_REQUEST, EVENT_POST_PROCESS, EVENT_CACHE_HIT, EVENT_CACHE_MISS, EVENT_CACHE_EXCEED, EVENT_CACHE_CLEAR, EVENT_PRE_CACHE, EVENT_PRE_CACHE, EVENT_POST_CACHE, STRING_STRING, NULL, FALSE, TRUE,\n    \tvalidatorIsTypeOf,\n    \tfunctionGetTimestamp, functionEscapeRegex, functionIterate, functionDefer, functionResolveId, functionToArray,\n    \tClassDependency,\n    \tsingletonEvent\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    function functionGetTimestamp() {\n        return +new Date();\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    var functionEscapeRegex = (function() {\n        var regexMatchRegex = /[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g; // eslint-disable-line no-useless-escape\n\n        return function functionEscapeRegex(value) {\n            return value.replace(regexMatchRegex, '\\\\$&');\n        };\n    }());\n\n    //=require function/iterate.js\n    //=require function/defer.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tregexMatchParameter,\n    \tfunctionResolvePath\n    */\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, PROVIDE_ID, PATH_ID,\n    \tfunctionEscapeRegex, functionResolveUrl\n    */\n\n    //=require constants.js\n    //=require function/escapeRegex.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tlinkElement\n    */\n\n    //=require shortcuts.js\n\n    function functionResolveUrl(url) {\n        linkElement.href = url;\n\n        return linkElement.href;\n    }\n\n\n    var regexIsAbsoluteUri = /^(http(s?):)?\\/\\//i,\n        regexIsAbsolutePath = /^\\//,\n        regexMatchSourcemap = /((?:\\/\\/|\\/\\*)#)\\s*(sourceMappingURL)\\s*=\\s*(?!(?:http[s]?:)?\\/\\/)(.+?)\\.map(?:\\s+)?(\\*\\/)?/g,\n        regexMatchBaseUrl = new RegExp('^' + functionEscapeRegex(functionResolveUrl('/'))),\n        regexMatchInternal = new RegExp('^' + DEMAND_ID + '|' + PROVIDE_ID + '|' + PATH_ID + '$'),\n        regexMatchParameter = /^(mock:)?([+-])?((?:[-\\w]+\\/?)+)?(?:@(.+?))?(?:#(\\d+))?!/;\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tregexMatchParameter, regexMatchBaseUrl, regexIsAbsolutePath, regexIsAbsoluteUri,\n    \tfunctionResolveUrl\n    */\n\n    //=require variables.js\n    //=require function/resolveUrl.js\n\n    function functionResolvePath(uri, context) {\n        var path = uri.replace(regexMatchParameter, '');\n\n        if (!regexIsAbsolutePath.test(path) && !regexIsAbsoluteUri.test(path)) {\n            path = '/' + functionResolveUrl(((context && functionResolveUrl(context + '/../')) || '/') + path).replace(regexMatchBaseUrl, '');\n        }\n\n        return path;\n    }\n\n\n    function functionResolveId(uri, context) {\n        var parameter = uri.match(regexMatchParameter);\n\n        return ((parameter && parameter[1]) ? 'mock:' : '') + ((parameter && parameter[3]) || settings.handler) + '!' + functionResolvePath(uri, context);\n    }\n\n    //=require function/toArray.js\n    //=require singleton/event.js\n\n    var singletonCache = (function() {\n        var STORAGE_PREFIX = '[' + DEMAND_ID + ']',\n            STORAGE_SUFFIX_STATE = '[state]',\n            STORAGE_SUFFIX_VALUE = '[value]',\n            regexMatchState = new RegExp('^' + functionEscapeRegex(STORAGE_PREFIX) + '\\\\[(.+?)\\\\]' + functionEscapeRegex(STORAGE_SUFFIX_STATE) + '$'),\n            regexMatchProperties = /^(.+?),(\\d+),(\\d*),(.+?),(\\d+)$/,\n            supportsLocalStorage = (function() {\n                try {\n                    return 'localStorage' in global && global.localStorage;\n                } catch (exception) {\n                    return FALSE;\n                }\n            }()),\n            localStorage = supportsLocalStorage ? global.localStorage : NULL,\n            supportsRemainingSpace = supportsLocalStorage && 'remainingSpace' in localStorage,\n            storage = {},\n            cache;\n\n        singletonEvent\n            .on(EVENT_CACHE_MISS, function(dependency) {\n                functionDefer(function() {\n                    cache.clear(dependency.id);\n                });\n            })\n            .on(EVENT_CACHE_EXCEED, function(dependency) {\n                demand('-!/' + DEMAND_ID + '/cache/dispose').then(function(cacheDispose) {\n                    functionDefer(function() {\n                        cacheDispose(dependency.source.length);\n\n                        cache.set(dependency);\n                    });\n                });\n            })\n            .on(EVENT_POST_REQUEST, function(dependency) {\n                if (dependency.source && enabled(dependency)) {\n                    storage[dependency.id] = TRUE;\n                }\n            })\n            .after(EVENT_POST_PROCESS, function(dependency) {\n                if (storage[dependency.id]) {\n                    functionDefer(function() {\n                        cache.set(dependency);\n                    });\n                }\n            });\n\n        function enabled(dependency) {\n            var match;\n\n            if (dependency.cache !== NULL) {\n                return dependency.cache;\n            }\n\n            functionIterate(settings.cache, function(property, value) {\n                if (dependency.path.indexOf(property) === 0 && (!match || value.weight > match.weight)) {\n                    match = value;\n                }\n            });\n\n            return match ? match.state : FALSE;\n        }\n\n        function getKey(key) {\n            return localStorage.getItem(key);\n        }\n\n        function setKey(key, value) {\n            localStorage[value ? 'setItem' : 'removeItem'](key, value);\n        }\n\n        function getState(key) {\n            var state = getKey(key),\n                matches;\n\n            if (state && (matches = state.match(regexMatchProperties))) {\n                return functionToArray(matches, 1);\n            }\n        }\n\n        function setState(key, state) {\n            state[4] = functionGetTimestamp();\n\n            setKey(key, state.join(','));\n        }\n\n        function emit(event, dependency, state) {\n            singletonEvent.emit(event, dependency.id, dependency, state);\n        }\n\n        function Cache() {\n            functionDefer(this.clear.expired.bind(this.clear));\n        }\n\n        Cache.prototype = {\n            get: supportsLocalStorage ? function(dependency) {\n                var id, state;\n\n                if (enabled(dependency)) {\n                    id = STORAGE_PREFIX + '[' + dependency.id + ']';\n                    state = getState(id + STORAGE_SUFFIX_STATE);\n\n                    if (!state) {\n                        return;\n                    }\n\n                    if (state[0] !== dependency.version || (state[2] && dependency.lifetime && state[2] <= functionGetTimestamp())) {\n                        dependency.invalid = true;\n\n                        return;\n                    }\n\n                    dependency.source = getKey(id + STORAGE_SUFFIX_VALUE);\n\n                    functionDefer(function() {\n                        setState(id + STORAGE_SUFFIX_STATE, state);\n                    });\n\n                    return TRUE;\n                }\n            } : FUNCTION_EMPTY,\n            resolve: supportsLocalStorage ? function(dependency) {\n                var self = this;\n\n                if (self.get(dependency)) {\n                    emit(EVENT_CACHE_HIT, dependency);\n                } else {\n                    emit(EVENT_CACHE_MISS, dependency);\n                }\n            } : function(dependency) {\n                emit(EVENT_CACHE_MISS, dependency);\n            },\n            set: supportsLocalStorage ? function(dependency) {\n                var state, id, spaceBefore;\n\n                if (enabled(dependency)) {\n                    state = [dependency.version, dependency.source.length, dependency.lifetime ? functionGetTimestamp() + dependency.lifetime : NULL, demand.version];\n                    id = STORAGE_PREFIX + '[' + dependency.id + ']';\n\n                    emit(EVENT_PRE_CACHE, dependency, state);\n\n                    try {\n                        spaceBefore = supportsRemainingSpace ? localStorage.remainingSpace : NULL;\n\n                        setKey(id + STORAGE_SUFFIX_VALUE, dependency.source);\n                        setState(id + STORAGE_SUFFIX_STATE, state);\n\n                        // strict equality check with \"===\" is required due to spaceBefore might be \"0\"\n                        if (spaceBefore !== NULL && localStorage.remainingSpace === spaceBefore) {\n                            throw new Error();\n                        }\n\n                        emit(EVENT_POST_CACHE, dependency, state);\n                    } catch (error) {\n                        emit(EVENT_CACHE_EXCEED, dependency);\n                    }\n                }\n            } : FUNCTION_EMPTY,\n            clear: supportsLocalStorage ? function(path) {\n                var id = functionResolveId(path),\n                    key = STORAGE_PREFIX + '[' + id + ']';\n\n                if (getKey(key + STORAGE_SUFFIX_STATE)) {\n                    setKey(key + STORAGE_SUFFIX_STATE);\n                    setKey(key + STORAGE_SUFFIX_VALUE);\n\n                    emit(EVENT_CACHE_CLEAR, ClassDependency.get(id) || new ClassDependency(id, NULL, FALSE));\n                }\n            } : function() {}\n        };\n\n        Cache.prototype.clear.all = supportsLocalStorage ? function() {\n            var match;\n\n            functionIterate(localStorage, function(property) {\n                match = property.match(regexMatchState);\n\n                match && this(match[1]);\n            }, this);\n        } : FUNCTION_EMPTY;\n\n        Cache.prototype.clear.expired = supportsLocalStorage ? function() {\n            var match, state;\n\n            functionIterate(localStorage, function(property) {\n                match = property.match(regexMatchState);\n\n                if (match) {\n                    state = getState(STORAGE_PREFIX + '[' + match[1] + ']' + STORAGE_SUFFIX_STATE);\n\n                    if (state && state[2] > 0 && state[2] <= functionGetTimestamp()) {\n                        this(match[1]);\n                    }\n                }\n            }, this);\n        } : FUNCTION_EMPTY;\n\n        return (cache = new Cache());\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n     \tFUNCTION_EMPTY, NULL,\n    \tarrayPrototypeConcat,\n    \tfunctionDefer, functionToArray,\n    \tClassWeakmap\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    //=require function/defer.js\n    //=require function/toArray.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tfunctionUuid,\n    */\n\n    //=require function/uuid.js\n\n    var ClassWeakmap = 'WeakMap' in global ? global.WeakMap : (function() {\n        var prefix = 'weakmap-';\n\n        function getEntry(context, key) {\n            var entry;\n\n            if ((entry = key[context.id]) && entry[0] === key) {\n                return entry;\n            }\n        }\n\n        function ClassWeakmap() {\n            this.define('id', prefix + functionUuid());\n        }\n\n        ClassWeakmap.prototype = {\n            set: function(key, value) {\n                var entry = getEntry(this, key);\n\n                if (entry) {\n                    entry[1] = value;\n                } else {\n                    key.define(this.id, [key, value]);\n                }\n\n                return this;\n            },\n            get: function(key) {\n                var entry = getEntry(this, key);\n\n                if (entry) {\n                    return entry[1];\n                }\n            },\n            delete: function(key) {\n                var entry = getEntry(this, key);\n\n                if (entry) {\n                    entry.length = 0;\n\n                    delete key[this.id];\n                }\n            },\n            has: function(key) {\n                return !!getEntry(this, key);\n            }\n        };\n\n        return ClassWeakmap;\n    }());\n\n\n    var ClassPledge = (function() {\n        var PLEDGE_PENDING = 'pending',\n            PLEDGE_RESOLVED = 'resolved',\n            PLEDGE_REJECTED = 'rejected',\n            storage = new ClassWeakmap();\n\n        function resolve() {\n            storage.get(this).handle(PLEDGE_RESOLVED, arguments);\n        }\n\n        function reject() {\n            storage.get(this).handle(PLEDGE_REJECTED, arguments);\n        }\n\n        function handle(state, parameter) {\n            var properties = storage.get(this),\n                pointer, result;\n\n            if (properties.state === PLEDGE_PENDING) {\n                properties.state = state;\n                properties.value = parameter;\n            }\n\n            while (pointer = properties[properties.state].shift()) {\n                result = pointer.handler.apply(NULL, properties.value);\n\n                if (result && typeof result.then === 'function') {\n                    result.then(pointer.dfd.resolve, pointer.dfd.reject);\n                } else {\n                    pointer.dfd[properties.state === PLEDGE_RESOLVED ? 'resolve' : 'reject'].apply(NULL, properties.value);\n                }\n            }\n\n            properties[PLEDGE_RESOLVED].length = 0;\n            properties[PLEDGE_REJECTED].length = 0;\n        }\n\n        function observe(pledge, index, properties) {\n            pledge.then(\n                function() {\n                    properties.resolved[index] = functionToArray(arguments);\n\n                    properties.count++;\n\n                    check(properties);\n                },\n                function() {\n                    properties.rejected.push(functionToArray(arguments));\n\n                    check(properties);\n                }\n            );\n        }\n\n        function check(properties) {\n            if (properties.count === properties.total) {\n                properties.dfd.resolve.apply(NULL, arrayPrototypeConcat.apply([], properties.resolved));\n            } else if (properties.rejected.length + properties.count === properties.total) {\n                properties.dfd.reject.apply(NULL, arrayPrototypeConcat.apply([], properties.rejected));\n            }\n        }\n\n        function ClassPledge(executor) {\n            var self = this;\n\n            storage.set(this, {\n                state: PLEDGE_PENDING,\n                handle: handle.bind(self),\n                value: NULL,\n                resolved: [],\n                rejected: [],\n                count: 0\n            });\n\n            executor(resolve.bind(self), reject.bind(self));\n\n            return self;\n        }\n\n        ClassPledge.prototype = {\n            'catch': function(listener) {\n                return this.then(FUNCTION_EMPTY, listener);\n            },\n            always: function(alwaysListener) {\n                return this.then(alwaysListener, alwaysListener);\n            },\n            then: function(resolveListener, rejectListener) {\n                var properties = storage.get(this),\n                    dfd = ClassPledge.defer();\n\n                resolveListener && properties[PLEDGE_RESOLVED].push({\n                    handler: resolveListener,\n                    dfd: dfd\n                });\n                rejectListener && properties[PLEDGE_REJECTED].push({\n                    handler: rejectListener,\n                    dfd: dfd\n                });\n\n                if (properties.state !== PLEDGE_PENDING) {\n                    functionDefer(properties.handle);\n                }\n\n                return dfd.pledge;\n            },\n            isPending: function() {\n                return storage.get(this).state === PLEDGE_PENDING;\n            },\n            isResolved: function() {\n                return storage.get(this).state === PLEDGE_RESOLVED;\n            },\n            isRejected: function() {\n                return storage.get(this).state === PLEDGE_REJECTED;\n            }\n        };\n\n        ClassPledge.defer = function() {\n            var self = {};\n\n            self.pledge = new ClassPledge(function(resolveListener, rejectListener) {\n                self.resolve = resolveListener;\n                self.reject = rejectListener;\n            });\n\n            return self;\n        };\n\n        ClassPledge.all = function(pledges) {\n            var dfd = ClassPledge.defer(),\n                properties, i = 0,\n                pledge;\n\n            if (pledges.length) {\n                properties = {\n                    dfd: dfd,\n                    resolved: [],\n                    rejected: [],\n                    total: pledges.length,\n                    count: 0\n                };\n\n                for (; pledge = pledges[i]; i++) {\n                    observe(pledge, i, properties)\n                }\n            } else {\n                dfd.resolve();\n            }\n\n            return dfd.pledge;\n        };\n\n        ClassPledge.race = function(pledges) {\n            var dfd = ClassPledge.defer(),\n                i = 0,\n                pledge;\n\n            for (; pledge = pledges[i]; i++) {\n                pledge.then(dfd.resolve, dfd.reject);\n            }\n\n            if (!pledges.length) {\n                dfd.resolve();\n            }\n\n            return dfd.pledge;\n        };\n\n        return ClassPledge;\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, MODULE_PREFIX_HANDLER, ERROR_LOAD, DEMAND_ID, PROVIDE_ID, PATH_ID, MOCK_PREFIX, NULL, TRUE, FALSE,\n    \tobject,\n    \tregexMatchInternal, regexMatchParameter,\n    \tvalidatorIsPositive,\n    \tfunctionResolvePath, functionResolveId, functionResolveUrl, functionIterate, functionToArray,\n    \tClassRegistry, ClassPledge, ClassFailure,\n    \tsingletonCache\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    //=require variables.js\n    //=require validator/isPositive.js\n    //=require function/resolvePath.js\n    //=require function/resolveId.js\n    //=require function/resolveUrl.js\n    //=require function/iterate.js\n    //=require function/toArray.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tClassWeakmap\n    */\n\n    //=require class/weakmap.js\n\n    var ClassRegistry = (function() {\n        var storage = new ClassWeakmap();\n\n        function ClassRegistry() {\n            storage.set(this, {});\n        }\n\n        ClassRegistry.prototype = {\n            get: function(key) {\n                return key ? storage.get(this)[key] : storage.get(this);\n            },\n            set: function(key, value) {\n                storage.get(this)[key] = value;\n            },\n            remove: function(key) {\n                delete storage.get(this)[key];\n            }\n        };\n\n        return ClassRegistry;\n    }());\n\n    //=require class/pledge.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID,\n    \tfunctionToArray\n    */\n\n    //=require constants.js\n    //=require function/toArray.js\n\n    function ClassFailure(message, module, stack) {\n        var self = this;\n\n        self.message = message;\n\n        module && (self.module = module);\n        stack && (self.stack = functionToArray(stack));\n\n        return self;\n    }\n\n    ClassFailure.prototype = {\n        /* only for reference\n         message: NULL,\n         module:  NULL,\n         stack:   NULL,\n         */\n        toString: function() {\n            var self = this,\n                result = DEMAND_ID + ': ' + self.message + ' ' + (self.module ? '\"' + self.module + '\"' : '');\n\n            if (self.stack) {\n                result = ClassFailure.traverse(self.stack, result, 1);\n            }\n\n            return result;\n        }\n    };\n\n    ClassFailure.traverse = function(stack, value, depth) {\n        var indention = new Array(depth + 1).join(' '),\n            i = 0,\n            item;\n\n        for (; item = stack[i]; i++) {\n            value += '\\n' + indention + '> ' + item.message + ' ' + (item.module ? '\"' + item.module + '\"' : '');\n\n            if (item.stack) {\n                value = ClassFailure.traverse(item.stack, value, depth + 1);\n            }\n        }\n\n        return value;\n    };\n\n    //=require singleton/cache.js\n\n    var ClassDependency = (function() {\n        var PREFIX_INTERNAL = 'internal!',\n            registry = new ClassRegistry(),\n            placeholder = [];\n\n        function setProperty(property, value) {\n            this[property] = value;\n        }\n\n        function addPending(id, dependency) {\n            if (dependency.pledge.isPending()) {\n                this.push(id);\n            }\n        }\n\n        function addResolved(id, dependency) {\n            if (dependency.pledge.isResolved()) {\n                this.push(id);\n            }\n        }\n\n        function addRejected(id, dependency) {\n            if (dependency.pledge.isRejected()) {\n                this.push(id);\n            }\n        }\n\n        function ClassDependency(uri, context, register) {\n            var self = this,\n                parameter = uri.match(regexMatchParameter) || placeholder;\n\n            self.path = functionResolvePath(uri, context);\n            self.mock = parameter[1] ? TRUE : FALSE;\n            self.cache = parameter[2] ? parameter[1] === '+' : NULL;\n            self.type = parameter[3] || settings.handler;\n            self.version = parameter[4] || settings.version;\n            self.lifetime = (parameter[5] && parameter[5] * 1000) || settings.lifetime;\n            self.id = (self.mock ? MOCK_PREFIX : '') + self.type + '!' + self.path;\n            self.uri = (self.mock ? MOCK_PREFIX : '') + self.type + '@' + self.version + (validatorIsPositive(self.lifetime) && self.lifetime > 0 ? '#' + self.lifetime : '') + '!' + self.path;\n            self.dfd = ClassPledge.defer();\n            self.pledge = self.dfd.pledge;\n            self.invalid = false;\n\n            self.pledge.then(function() {\n                self.value = functionToArray(arguments);\n            });\n\n            (register !== FALSE) && registry.set(self.id, self);\n\n            return self;\n        }\n\n        ClassDependency.prototype = {\n            enqueue: true // handled by handler\n            /* only for reference\n\t\t\t \tpath:     NULL,\n\t\t\t \tmock:     NULL,\n\t\t\t\tcache:    NULL,\n\t\t\t\ttype:     NULL,\n\t\t\t\tversion:  NULL,\n\t\t\t\tlifetime: NULL,\n\t\t\t \tid:       NULL,\n\t\t\t \turi:      NULL,\n\t\t\t\tdfd:      NULL,\n\t\t\t\tpledge:   NULL,\n\t\t\t\tvalue:    NULL,\n\t\t\t\thandler:  NULL, // set by Dependency.resolve\n\t\t\t \tsource:   NULL, // set by Cache or Loader\n\t\t\t \turl:      NULL // optional, set by Loader\n\t\t\t\t*/\n        };\n\n        ClassDependency.get = function(uri, context) {\n            return registry.get(functionResolveId(uri, context));\n        };\n\n        ClassDependency.resolve = function(uri, context) {\n            var isInternal = context && regexMatchInternal.test(uri),\n                dependency = isInternal ? this.get(PREFIX_INTERNAL + context + '/' + uri) : this.get(uri, context),\n                value;\n\n            if (!dependency) {\n                if (isInternal) {\n                    dependency = new ClassDependency(PREFIX_INTERNAL + context + '/' + uri);\n\n                    switch (uri) {\n                        case DEMAND_ID:\n                            value = (function() {\n                                return functionIterate(demand, setProperty, demand.bind(context));\n                            }());\n\n                            break;\n                        case PROVIDE_ID:\n                            value = provide.bind(context);\n\n                            break;\n                        case PATH_ID:\n                            value = context;\n\n                            break;\n                    }\n\n                    dependency.dfd.resolve(value);\n                } else {\n                    dependency = new ClassDependency(uri, context);\n\n                    demand(MODULE_PREFIX_HANDLER + dependency.type)\n                        .then(\n                            function(handler) {\n                                dependency.handler = handler;\n\n                                if (dependency.mock) {\n                                    dependency.dfd.resolve(handler);\n                                } else {\n                                    singletonCache.resolve(dependency);\n                                }\n                            },\n                            function() {\n                                dependency.dfd.reject(new ClassFailure(ERROR_LOAD + ' (handler)', self.id));\n                            }\n                        )\n                }\n            }\n\n            return dependency;\n        };\n\n        ClassDependency.remove = function(uri, context, cache) {\n            var id = functionResolveId(uri, context),\n                node = document.querySelector('[' + DEMAND_ID + '-id=\"' + id + '\"]');\n\n            registry.remove(id);\n            registry.remove(MOCK_PREFIX + id);\n\n            node && node.parentNode.removeChild(node);\n\n            (cache !== FALSE) && singletonCache.clear(id);\n        };\n\n        ClassDependency.list = {\n            all: function() {\n                return object.keys(registry.get());\n            },\n            pending: function() {\n                return functionIterate(registry.get(), addPending, []);\n            },\n            resolved: function() {\n                return functionIterate(registry.get(), addResolved, []);\n            },\n            rejected: function() {\n                return functionIterate(registry.get(), addRejected, []);\n            }\n        };\n\n        return ClassDependency;\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tfunctionResolveUrl, functionEscapeRegex, functionIterate\n    */\n\n    //=require function/resolveUrl.js\n    //=require function/escapeRegex.js\n    //=require function/iterate.js\n\n    var ClassPattern = (function() {\n        var regexMatchTrailingSlash = /(.+)\\/$/;\n\n        function setProperty(property, value) {\n            this[property] = {\n                url: functionResolveUrl(value).replace(regexMatchTrailingSlash, '$1'),\n                match: new RegExp('^' + functionEscapeRegex(value))\n            };\n        }\n\n        function ClassPattern(pattern, url) {\n            var self = this;\n\n            self.weight = pattern.length;\n            self.match = new RegExp('^' + functionEscapeRegex(pattern));\n            self.location = [].concat(url);\n\n            functionIterate(self.location, setProperty, self.location);\n        }\n\n        ClassPattern.prototype = {\n            /* only for reference\n             weight:   0,\n             match:    NULL,\n             location: NULL,\n             */\n            matches: function(path) {\n                return this.match.test(path);\n            },\n            process: function(path, index) {\n                var current = this.location[index];\n\n                if (current) {\n                    return path.replace(this.match, current.url);\n                }\n            }\n        };\n\n        return ClassPattern;\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, EVENT_PRE_REQUEST, EVENT_POST_REQUEST, ERROR_LOAD,\n    \tregexIsAbsoluteUri,\n    \tlinkElement,\n    \tfunctionIterate, functionResolveUrl, functionGetTimestamp,\n    \tClassXhr, ClassFailure,\n    \tsingletonEvent\n    */\n\n    //=require constants.js\n    //=require variables.js\n    //=require shortcuts.js\n    //=require function/resolveUrl.js\n    //=require function/iterate.js\n    //=require singleton/event.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tTRUE,\n    \tregexMatchBaseUrl,\n    \tClassPledge\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    //=require variables.js\n    //=require class/pledge.js\n\n    var ClassXhr = (function(XMLHttpRequest) {\n        var XDomainRequest = 'XDomainRequest' in global && global.XDomainRequest || XMLHttpRequest;\n\n        function checkState() {\n            if (this.readyState < 4) {\n                this.abort();\n            }\n        }\n\n        return function ClassXhr(url) {\n            var dfd = ClassPledge.defer(),\n                xhr = regexMatchBaseUrl.test(url) ? new XMLHttpRequest() : new XDomainRequest(),\n                boundCheckState = checkState.bind(xhr),\n                timeout = settings.timeout,\n                pointer;\n\n            xhr.ontimeout = xhr.onerror = xhr.onabort = function() {\n                dfd.reject(xhr.status);\n            };\n            xhr.onprogress = xhr.onreadystatechange = function() {\n                clearTimeout(pointer);\n\n                pointer = setTimeout(boundCheckState, timeout);\n            };\n            xhr.onload = function() {\n                pointer = clearTimeout(pointer);\n\n                if (!('status' in xhr) || xhr.status === 200) {\n                    dfd.resolve(xhr.responseText, xhr.getResponseHeader && xhr.getResponseHeader('content-type'));\n                } else {\n                    dfd.reject(xhr.status);\n                }\n            };\n\n            xhr.open('GET', url, TRUE);\n            xhr.send();\n\n            pointer = setTimeout(boundCheckState, timeout);\n\n            return dfd.pledge;\n        };\n    }(XMLHttpRequest));\n\n    //=require class/failure.js\n\n    function ClassLoader(dependency) {\n        var regexMatchEmptySearch = /^(?:\\?|)$/,\n            pattern;\n\n        function resolve(response, type) {\n            if (!type || !dependency.handler.validate || dependency.handler.validate(type)) {\n                dependency.source = response;\n\n                singletonEvent.emit(EVENT_POST_REQUEST, dependency.type, dependency);\n            } else {\n                dependency.dfd.reject(new ClassFailure(ERROR_LOAD + ' (content-type)', dependency.id));\n            }\n        }\n\n        function reject(status) {\n            dependency.dfd.reject(new ClassFailure(ERROR_LOAD + (status ? ' (status)' : ''), dependency.id));\n        }\n\n        function load(location) {\n            location = location || 0;\n            dependency.url = document.createElement('a');\n\n            dependency.url.href = pattern ? functionResolveUrl(pattern.process(dependency.path, location)) : dependency.path;\n\n            if (dependency.invalid) {\n                dependency.url.search += ((regexMatchEmptySearch.test(dependency.url.search)) ? '' : '&') + functionGetTimestamp();\n            }\n\n            singletonEvent.emit(EVENT_PRE_REQUEST, dependency.type, dependency);\n\n            new ClassXhr(dependency.url).then(\n                resolve,\n                (\n                    pattern ?\n                    function() {\n                        location++;\n\n                        if (pattern.location[location]) {\n                            load(location);\n                        } else {\n                            reject();\n                        }\n                    } :\n                    reject\n                )\n            );\n        }\n\n        if (!regexIsAbsoluteUri.test(dependency.path)) {\n            functionIterate(settings.pattern, function(property, value) {\n                value.matches(dependency.path) && (!pattern || pattern.weight < value.weight) && (pattern = value);\n            });\n        }\n\n        load();\n    }\n\n\n    demand = (function() {\n        function updateCacheSettings(property, value) {\n            this[property] = {\n                weight: property.length,\n                state: value\n            };\n        }\n\n        function updatePatternSettings(property, value) {\n            property !== 'base' && (this[property] = new ClassPattern(property, value));\n        }\n\n        function updateModuleSettings(property, value) {\n            var temp = this[property] = this[property] || {};\n\n            singletonEvent.emit(EVENT_PRE_CONFIGURE, property, temp);\n\n            functionMerge(temp, value);\n\n            singletonEvent.emit(EVENT_POST_CONFIGURE, property, temp);\n        }\n\n        function demand() {\n            var dependencies = functionToArray(arguments),\n                context = this !== global ? this : NULL,\n                i = 0,\n                uri, dfd, result;\n\n            singletonEvent.emit(EVENT_PRE_RESOLVE, NULL, dependencies, context);\n\n            for (;\n                (uri = dependencies[i]); i++) {\n                if (validatorIsTypeOf(uri, STRING_STRING)) {\n                    dependencies[i] = ClassDependency.resolve(uri, context).pledge;\n                } else {\n                    dependencies[i] = (dfd = ClassPledge.defer()).pledge;\n\n                    dfd.resolve(uri);\n                }\n            }\n\n            if (dependencies.length > 1) {\n                result = ClassPledge.all(dependencies);\n            } else {\n                result = dependencies[0];\n            }\n\n            return result.always(function() {\n                singletonEvent.emit(EVENT_POST_RESOLVE, NULL, dependencies, context);\n            });\n        }\n\n        demand.configure = function(options) {\n            var cache = options.cache,\n                version = options.version,\n                timeout = options.timeout,\n                lifetime = options.lifetime,\n                base = options.base,\n                pattern = options.pattern,\n                modules = options.modules,\n                pointer = settings.modules;\n\n            if (validatorIsTypeOf(cache, STRING_BOOLEAN)) {\n                settings.cache[''] = {\n                    weight: 0,\n                    state: cache\n                };\n            } else if (validatorIsObject(cache)) {\n                functionIterate(cache, updateCacheSettings, settings.cache);\n            }\n\n            if (validatorIsTypeOf(version, STRING_STRING)) {\n                settings.version = version;\n            }\n\n            if (validatorIsPositive(timeout)) {\n                settings.timeout = Math.min(Math.max(timeout, 2), 12) * 1000;\n            }\n\n            if (validatorIsPositive(lifetime) && lifetime > 0) {\n                settings.lifetime = lifetime * 1000;\n            }\n\n            if (validatorIsTypeOf(base, STRING_STRING) && base !== '') {\n                settings.pattern.base = new ClassPattern('', base);\n            }\n\n            if (validatorIsObject(pattern)) {\n                functionIterate(pattern, updatePatternSettings, settings.pattern);\n            }\n\n            if (validatorIsObject(modules)) {\n                functionIterate(modules, updateModuleSettings, pointer);\n            }\n\n            return demand;\n        };\n\n        demand.version = '{{gulp:package.version}}';\n        demand.on = singletonEvent.on.bind(demand);\n        demand.get = function(uri, context) {\n            var dependency = ClassDependency.get(uri, context);\n            return dependency && dependency.value;\n        };\n        demand.list = ClassDependency.list;\n        demand.remove = ClassDependency.remove;\n        demand.cache = {\n            clear: singletonCache.clear\n        };\n\n        singletonEvent\n            .after(EVENT_CACHE_MISS, function(dependency) {\n                new ClassLoader(dependency);\n            })\n            .after(EVENT_POST_REQUEST, function(dependency) {\n                var pointer = dependency.handler.onPostRequest;\n\n                pointer && pointer(dependency);\n            })\n            .after(EVENT_CACHE_HIT + ' ' + EVENT_POST_REQUEST, function(dependency) {\n                singletonEvent.emit(EVENT_PRE_PROCESS, dependency.id, dependency);\n            })\n            .after(EVENT_PRE_REQUEST, function(dependency) {\n                var pointer = dependency.handler.onPreRequest;\n\n                pointer && pointer(dependency);\n            })\n            .after(EVENT_PRE_PROCESS, function(dependency) {\n                var pointer = dependency.handler.onPreProcess;\n\n                pointer && pointer(dependency);\n\n                dependency.pledge.then(function() {\n                    singletonEvent.emit(EVENT_POST_PROCESS, dependency.id, dependency);\n                });\n\n                if (dependency.enqueue === true) {\n                    queue.enqueue(dependency);\n                } else if (validatorIsInstanceOf(dependency.enqueue, ClassPledge)) {\n                    dependency.enqueue.then(function() {\n                        queue.enqueue(dependency);\n                    });\n                }\n            });\n\n        return demand;\n    }())\n\n    global.define('demand', demand);\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_STRING, STRING_UNDEFINED, STRING_FUNCTION, ERROR_PROVIDE, ERROR_PROVIDE_ANONYMOUS, NULL,\n    \tvalidatorIsTypeOf, validatorIsArray,\n    \tClassDependency, ClassFailure\n    */\n\n    //=require constants.js\n    //=require validator/isTypeOf.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tobjectPrototypeToString\n    */\n\n    //=require shortcuts.js\n\n    /**\n     * isArray\n     *\n     * Check whether a given value is of type array\n     *\n     * @param value\n     *\n     * @return {boolean}\n     */\n\n    function validatorIsArray(value) {\n        return objectPrototypeToString.call(value) === '[object Array]';\n    }\n\n    //=require class/dependency.js\n    //=require class/failure.js\n\n    provide = function provide() {\n        var uri = validatorIsTypeOf(arguments[0], STRING_STRING) ? arguments[0] : NULL,\n            context = this !== global ? this : NULL,\n            dependencies = validatorIsArray(arguments[uri ? 1 : 0]) ? arguments[uri ? 1 : 0] : NULL,\n            definition = dependencies ? arguments[uri ? 2 : 1] : arguments[uri ? 1 : 0],\n            module, isFunction;\n\n        if (!uri && processor.current) {\n            module = processor.current;\n            uri = module.uri;\n\n            processor.process();\n        }\n\n        if (uri) {\n            module = module || new ClassDependency(uri, context);\n            isFunction = validatorIsTypeOf(definition, STRING_FUNCTION);\n\n            if (dependencies) {\n                demand\n                    .apply(module.path, dependencies)\n                    .then(\n                        function() {\n                            module.dfd.resolve(isFunction ? definition.apply(NULL, arguments) : definition);\n                        },\n                        function() {\n                            module.dfd.reject(new ClassFailure(ERROR_PROVIDE, module.id, arguments));\n                        }\n                    );\n            } else {\n                module.dfd.resolve(isFunction ? definition() : definition);\n            }\n\n            return module.dfd.pledge;\n        } else {\n            !validatorIsTypeOf(console, STRING_UNDEFINED) && console.error(new ClassFailure(ERROR_PROVIDE_ANONYMOUS)); // eslint-disable-line no-console\n        }\n    }\n\n    global.define('provide', provide);\n\n\n    // process initial configuration\n    demand.configure({\n        cache: TRUE,\n        base: '/',\n        pattern: {\n            '/demand': functionResolveUrl(((options && options.url) || location.href) + '/../').slice(0, -1)\n        }\n    });\n    options && options.settings && demand.configure(options.settings);\n\n    // include additional components\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout\n    */\n\n    /**\n     * hash\n     *\n     * Generate a hash for a given string\n     *\n     * @param {string} input\n     *\n     * @return {number}\n     */\n    function functionHash(input) {\n        var value = 5381,\n            i = input.length;\n\n        while (i) {\n            value = (value * 33) ^ input.charCodeAt(--i);\n        }\n\n        return value >>> 0;\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tEVENT_QUEUE_ENQUEUE, EVENT_QUEUE_DEQUEUE,\n    \tfunctionToArray,\n    \tsingletonEvent,\n    \tClassWeakmap,\n    \tAbstractUuid\n    */\n\n    //=require constants.js\n    //=require function/toArray.js\n    //=require singleton/event.js\n    //=require class/weakmap.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tSTRING_UNDEFINED,\n    \tvalidatorIsTypeOf,\n    \tfunctionUuid,\n    */\n\n    //=require constants.js\n    //=require shortcuts.js\n    //=require validator/isTypeOf.js\n    //=require function/uuid.js\n\n    function AbstractUuid() {\n        if (validatorIsTypeOf(this.uuid, STRING_UNDEFINED)) {\n            this.define('uuid', functionUuid());\n        }\n\n        return this;\n    }\n\n\n    var ClassQueue = (function() {\n        var storage = new ClassWeakmap();\n\n        function ClassQueue() {\n            var self = AbstractUuid.call(this);\n\n            storage.set(self, []);\n\n            return self;\n        }\n\n        ClassQueue.prototype = {\n            enqueue: function() {\n                storage.set(this, storage.get(this).concat(functionToArray(arguments)));\n\n                singletonEvent.emit(EVENT_QUEUE_ENQUEUE, this.uuid);\n            },\n            dequeue: function() {\n                singletonEvent.emit(EVENT_QUEUE_DEQUEUE, this.uuid);\n\n                return storage.get(this).shift();\n            },\n            get current() {\n                return storage.get(this)[0];\n            },\n            get length() {\n                return storage.get(this).length;\n            }\n        };\n\n        return ClassQueue.extends(AbstractUuid);\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tEVENT_QUEUE_ENQUEUE, NULL,\n    \tsingletonEvent,\n    \tClassWeakmap\n    */\n\n    //=require constants.js\n    //=require class/weakmap.js\n\n    var ClassProcessor = (function() {\n        var storage = new ClassWeakmap();\n\n        function ClassProcessor(queue) {\n            var self = this,\n                properties = {\n                    queue: queue,\n                    current: NULL\n                };\n\n            storage.set(self, properties);\n\n            demand\n                .on(EVENT_QUEUE_ENQUEUE + ':' + queue.uuid, function() {\n                    !properties.current && self.process();\n                });\n        }\n\n        ClassProcessor.prototype = {\n            process: function() {\n                var properties = storage.get(this),\n                    current;\n\n                if (properties.queue.length) {\n                    current = properties.current = properties.queue.dequeue();\n\n                    if (!current.pledge.isRejected()) {\n                        current.handler.process && current.handler.process(current);\n\n                        return;\n                    }\n                }\n\n                properties.current = NULL;\n            },\n            get current() {\n                return storage.get(this).current;\n            }\n        };\n\n        return ClassProcessor;\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID, EVENT_PRE_REQUEST, EVENT_POST_REQUEST, TRUE,\n    \tfunctionResolveSourcemaps,\n    \tabstractHandler\n    */\n\n    //=require constants.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tregexMatchSourcemap, regexIsAbsoluteUri\n    \tlinkElement\n    */\n\n    //=require variables.js\n    //=require shortcuts.js\n\n    function functionResolveSourcemaps(url, source) {\n        var match, replacement;\n\n        while (match = regexMatchSourcemap.exec(source)) {\n            linkElement.href = url;\n\n            if (regexIsAbsoluteUri.test(match[2])) {\n                replacement = linkElement.protocol + '//' + linkElement.host + match[3];\n            } else {\n                linkElement.pathname += '/../' + match[3];\n\n                replacement = linkElement.protocol + '//' + linkElement.host + linkElement.pathname;\n            }\n\n            source = source.replace(match[0], match[1] + ' ' + match[2] + '=' + replacement + '.map' + (match[4] ? ' ' + match[4] : ''));\n        }\n\n        return source;\n    }\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tNULL\n    */\n\n    //=require constants.js\n\n    function abstractHandler() {\n\n    }\n\n    abstractHandler.prototype = {\n        validate: NULL,\n        onPreRequest: NULL,\n        onPostRequest: NULL,\n        onPreProcess: NULL,\n        process: NULL\n    };\n\n\n    var handlerModule = (function() {\n        var suffix = '.js',\n            target = document.getElementsByTagName('head')[0],\n            regexMatchType = /^(application|text)\\/(x-)?javascript/;\n\n        function HandlerModule() {}\n\n        HandlerModule.prototype = {\n            validate: function(type) {\n                return regexMatchType.test(type);\n            },\n            onPreRequest: function(dependency) {\n                var pathname = dependency.url.pathname;\n\n                dependency.url.pathname = pathname.slice(-suffix.length) !== suffix ? pathname + suffix : pathname;\n            },\n            onPostRequest: function(dependency) {\n                dependency.source = functionResolveSourcemaps(dependency.url, dependency.source);\n            },\n            process: function(dependency) {\n                var script;\n\n                if (dependency.source) {\n                    script = document.createElement('script');\n                    script.async = TRUE;\n                    script.text = dependency.source;\n\n                    script.setAttribute(DEMAND_ID + '-id', dependency.id);\n\n                    target.appendChild(script);\n                }\n            }\n        };\n\n        return new(HandlerModule.extends(abstractHandler));\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tMODULE_PREFIX_HANDLER, EVENT_POST_CONFIGURE, ERROR_RESOLVE, MOCK_PREFIX, STRING_STRING, FALSE, TRUE,\n    \tregexMatchParameter, regexMatchSourcemap,\n    \tvalidatorIsTypeOf, validatorIsObject,\n    \tfunctionIterate, functionResolveId,\n    \tabstractHandler,\n    \tClassDependency, ClassPledge, ClassFailure,\n    \thandlerModule\n    */\n\n    //=require constants.js\n    //=require variables.js\n    //=require validator/isTypeOf.js\n    //=require validator/isObject.js\n    //=require function/iterate.js\n    //=require function/resolveId.js\n    //=require abstract/handler.js\n    //=require class/dependency.js\n    //=require class/pledge.js\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tDEMAND_ID,\n    \tfunctionToArray\n    */\n\n    //=require constants.js\n    //=require function/toArray.js\n\n    function ClassFailure(message, module, stack) {\n        var self = this;\n\n        self.message = message;\n\n        module && (self.module = module);\n        stack && (self.stack = functionToArray(stack));\n\n        return self;\n    }\n\n    ClassFailure.prototype = {\n        /* only for reference\n         message: NULL,\n         module:  NULL,\n         stack:   NULL,\n         */\n        toString: function() {\n            var self = this,\n                result = DEMAND_ID + ': ' + self.message + ' ' + (self.module ? '\"' + self.module + '\"' : '');\n\n            if (self.stack) {\n                result = ClassFailure.traverse(self.stack, result, 1);\n            }\n\n            return result;\n        }\n    };\n\n    ClassFailure.traverse = function(stack, value, depth) {\n        var indention = new Array(depth + 1).join(' '),\n            i = 0,\n            item;\n\n        for (; item = stack[i]; i++) {\n            value += '\\n' + indention + '> ' + item.message + ' ' + (item.module ? '\"' + item.module + '\"' : '');\n\n            if (item.stack) {\n                value = ClassFailure.traverse(item.stack, value, depth + 1);\n            }\n        }\n\n        return value;\n    };\n\n    //=require handler/module.js\n\n    var handlerBundle = (function() {\n        var path = MODULE_PREFIX_HANDLER + 'bundle',\n            settings = {};\n\n        demand\n            .on(EVENT_POST_CONFIGURE + ':' + path, function(options) {\n                if (validatorIsObject(options)) {\n                    settings = options;\n\n                    functionIterate(settings, updateDependencies);\n                }\n            });\n\n        function updateDependencies(uri, dependencies) {\n            var i, dependency;\n\n            for (i = 0;\n                (dependency = dependencies[i]); i++) {\n                if (validatorIsTypeOf(dependency, STRING_STRING)) {\n                    dependencies[i] = functionResolveId(dependency);\n                }\n            }\n        }\n\n        function getType(dependencies) {\n            var type, i = 0,\n                temp;\n\n            for (;\n                (temp = dependencies[i]); i++) {\n                temp = temp.match(regexMatchParameter);\n                temp = (temp && temp[3]) || settings.handler;\n\n                if (type) {\n                    if (temp !== type) {\n                        return FALSE;\n                    }\n                } else {\n                    type = temp;\n                }\n            }\n\n            return type;\n        }\n\n        function HandlerBundle() {}\n\n        HandlerBundle.prototype = {\n            validate: handlerModule.validate,\n            onPreProcess: function(dependency) {\n                var source = dependency.source,\n                    dfd = dependency.dfd,\n                    dependencies = settings[dependency.path],\n                    type, match, pledges, temp, i;\n\n                dependency.enqueue = FALSE;\n\n                function reject() {\n                    dfd.reject(new ClassFailure(ERROR_RESOLVE, dependency.id, arguments));\n                }\n\n                if (dependencies && (type = getType(dependencies))) {\n                    while (match = regexMatchSourcemap.exec(source)) {\n                        source = source.replace(match[0], '');\n                    }\n\n                    dependency.source = source;\n                    pledges = [];\n\n                    for (i = 0;\n                        (temp = dependencies[i]); i++) {\n                        pledges.push(ClassDependency.resolve(MOCK_PREFIX + temp).pledge);\n                    }\n\n                    ClassPledge.all(pledges).then(\n                        function() {\n                            pledges.length = 0;\n\n                            for (i = 0;\n                                (temp = dependencies[i]); i++) {\n                                temp = dependencies[i] = ClassDependency.get(temp) || new ClassDependency(temp);\n                                temp.handler = arguments[i];\n\n                                pledges.push(temp.pledge);\n                            }\n\n                            if (type === 'module') {\n                                queue.enqueue.apply(queue, dependencies);\n                                handlerModule.process(dependency);\n                            } else {\n                                handlerModule.process(dependency);\n                                queue.enqueue.apply(queue, dependencies);\n                            }\n\n                            ClassPledge.all(pledges).then(dfd.resolve, reject);\n                        },\n                        reject\n                    );\n                } else {\n                    reject();\n                }\n            }\n        };\n\n        return new(HandlerBundle.extends(abstractHandler));\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tFALSE, EVENT_POST_REQUEST, ERROR_RESOLVE,\n    \tfunctionResolveSourcemaps,\n    \tabstractHandler,\n    \tClassDependency, ClassPledge, ClassFailure\n    */\n\n    //=require constants.js\n    //=require function/resolveSourcemaps.js\n    //=require abstract/handler.js\n    //=require class/dependency.js\n    //=require class/pledge.js\n    //=require class/Failure.js\n\n    var handlerComponent = (function() {\n        var suffix = '.html',\n            regexMatchType = /^text\\/.+$/;\n\n        function HandlerComponent() {}\n\n        HandlerComponent.prototype = {\n            validate: function(type) {\n                return regexMatchType.test(type);\n            },\n            onPreRequest: function(dependency) {\n                var pathname = dependency.url.pathname;\n\n                dependency.url.pathname = pathname.slice(-suffix.length) !== suffix ? pathname + suffix : pathname;\n            },\n            onPostRequest: function(dependency) {\n                dependency.source = functionResolveSourcemaps(dependency.url, dependency.source);\n            },\n            onPreProcess: function(dependency) {\n                var context = dependency.path,\n                    dfd = dependency.dfd,\n                    container = document.createElement('body'),\n                    modules = [],\n                    pledges = [],\n                    node, handler, path, uri;\n\n                dependency.enqueue = FALSE;\n                container.innerHTML = dependency.source;\n\n                function reject() {\n                    dfd.reject(new ClassFailure(ERROR_RESOLVE, dependency.id, arguments));\n                }\n\n                while (node = container.firstElementChild) {\n                    if (handler = node.getAttribute('type')) {\n                        path = node.getAttribute('path');\n                        uri = handler + '!' + context + (path ? '/' + path : '');\n\n                        node.parentNode.removeChild(node);\n                        modules.push({\n                            source: node.textContent,\n                            uri: uri\n                        });\n                        pledges.push(ClassDependency.resolve('mock:' + uri).pledge);\n                    }\n                }\n\n                ClassPledge.all(pledges).then(\n                    function() {\n                        var i = 0,\n                            module, dependency;\n\n                        pledges.length = 0;\n\n                        for (;\n                            (module = modules[i]); i++) {\n                            dependency = ClassDependency.get(module.uri) || new ClassDependency(module.uri);\n                            dependency.source = functionResolveSourcemaps(dependency.url, module.source);\n                            dependency.handler = arguments[i];\n\n                            pledges.push(dependency.pledge);\n\n                            queue.enqueue(dependency);\n                        }\n\n                        ClassPledge.all(pledges).then(dfd.resolve, reject);\n                    },\n                    reject\n                );\n            }\n        };\n\n        return new(HandlerComponent.extends(abstractHandler));\n    }());\n\n    /* global\n    \tglobal, document, demand, provide, queue, processor, settings, setTimeout, clearTimeout,\n    \tMODULE_PREFIX_PLUGIN, MODULE_PREFIX_HANDLER, EVENT_POST_CONFIGURE, EVENT_PRE_RESOLVE, STRING_STRING, ERROR_RESOLVE, FALSE, TRUE,\n    \tregexMatchInternal,\n    \tvalidatorIsObject, validatorIsTypeOf,\n    \tfunctionIterate, functionHash,\n    \tClassDependency, ClassFailure,\n    \tsingletonCache\n    */\n\n    //=require constants.js\n    //=require variables.js\n    //=require validator/isTypeOf.js\n    //=require validator/isObject.js\n    //=require function/iterate.js\n    //=require function/hash.js\n    //=require class/dependency.js\n    //=require class/failure.js\n    //=require singleton/cache.js\n\n    var pluginGenie = (function() {\n        var path = MODULE_PREFIX_PLUGIN + 'genie',\n            pattern = [];\n\n        function matchPattern(path) {\n            var i = 0,\n                pointer, match;\n\n            for (;\n                (pointer = pattern[i]); i++) {\n                if (path.indexOf(pointer.prefix) === 0 && (!match || pointer.weight > match.weight)) {\n                    match = pointer;\n                }\n            }\n\n            return match;\n        }\n\n        function generateConfiguration(bundle) {\n            var matches = bundle.matches,\n                configuration = {\n                    pattern: {},\n                    modules: {\n                        '/demand/handler/bundle': {}\n                    }\n                },\n                i = 0,\n                pointer, dependency;\n\n            configuration.pattern[bundle.id] = bundle.fn(matches);\n            configuration.modules[MODULE_PREFIX_HANDLER + 'bundle'][bundle.id] = pointer = [];\n\n            for (;\n                (dependency = matches[i]); i++) {\n                pointer.push(dependency.path);\n            }\n\n            return configuration;\n        }\n\n        function resolveDependencies() {\n            var i = 0,\n                dependency;\n\n            for (;\n                (dependency = this[i]); i++) {\n                dependency.dfd.resolve(arguments[i]);\n            }\n        }\n\n        function rejectDependencies() {\n            var i = 0,\n                dependency;\n\n            for (;\n                (dependency = this[i]); i++) {\n                dependency.dfd.reject(new ClassFailure(ERROR_RESOLVE, dependency.id));\n            }\n        }\n\n        function addPattern(property, value) {\n            pattern.push({\n                prefix: property,\n                weight: property.length,\n                fn: value\n            });\n        }\n\n        function resolveBundles(property, value) {\n            var matches = value.matches,\n                i = 0,\n                dependency;\n\n            if (matches.length > 1) {\n                value.id = path + '/' + functionHash(JSON.stringify(value.matches));\n\n                for (;\n                    (dependency = matches[i]); i++) {\n                    matches[i] = new ClassDependency(dependency.uri);\n                }\n\n                demand.configure(generateConfiguration(value));\n                demand('bundle!' + value.id)\n                    .then(\n                        resolveDependencies.bind(matches),\n                        rejectDependencies.bind(matches)\n                    );\n            }\n        }\n\n        demand\n            .on(EVENT_POST_CONFIGURE + ':' + path, function(options) {\n                if (validatorIsObject(options)) {\n                    pattern.length = 0;\n\n                    functionIterate(options, addPattern);\n                }\n            })\n            .on(EVENT_PRE_RESOLVE, function(dependencies, context) {\n                var bundles = {},\n                    i = 0,\n                    dependency, pattern;\n\n                for (;\n                    (dependency = dependencies[i]); i++) {\n                    if (validatorIsTypeOf(dependency, STRING_STRING) && !regexMatchInternal.test(dependency) && !ClassDependency.get(dependency, context)) {\n                        dependency = new ClassDependency(dependency, context, FALSE);\n\n                        if (dependency.type === 'module' && (pattern = matchPattern(dependency.path)) && !singletonCache.get(dependency)) {\n                            (bundles[pattern.prefix] || (bundles[pattern.prefix] = {\n                                fn: pattern.fn,\n                                matches: []\n                            })).matches.push(dependency);\n                        }\n                    }\n                }\n\n                functionIterate(bundles, resolveBundles);\n            });\n\n        return TRUE;\n    }());\n\n\n    // initialize\n    queue = new ClassQueue();\n    processor = new ClassProcessor(queue);\n\n    function assignModule(id, module) {\n        provide(id, function() {\n            return module;\n        });\n    }\n\n    assignModule(MODULE_PREFIX_ABSTRACT + 'uuid', AbstractUuid);\n    assignModule(MODULE_PREFIX_ABSTRACT + 'handler', abstractHandler);\n    assignModule(MODULE_PREFIX_HANDLER + 'module', handlerModule);\n    assignModule(MODULE_PREFIX_HANDLER + 'bundle', handlerBundle);\n    assignModule(MODULE_PREFIX_HANDLER + 'component', handlerComponent);\n    assignModule(MODULE_PREFIX_PLUGIN + 'genie', pluginGenie);\n    assignModule(MODULE_PREFIX_VALIDATOR + 'isTypeOf', validatorIsTypeOf);\n    assignModule(MODULE_PREFIX_VALIDATOR + 'isArray', validatorIsArray);\n    assignModule(MODULE_PREFIX_VALIDATOR + 'isObject', validatorIsObject);\n    assignModule(MODULE_PREFIX_VALIDATOR + 'isInstanceOf', validatorIsInstanceOf);\n    assignModule(MODULE_PREFIX_FUNCTION + 'resolveUrl', functionResolveUrl);\n    assignModule(MODULE_PREFIX_FUNCTION + 'resolveSourcemaps', functionResolveSourcemaps);\n    assignModule(MODULE_PREFIX_FUNCTION + 'merge', functionMerge);\n    assignModule(MODULE_PREFIX_FUNCTION + 'iterate', functionIterate);\n    assignModule(MODULE_PREFIX_FUNCTION + 'hash', functionHash);\n    assignModule(MODULE_PREFIX_FUNCTION + 'defer', functionDefer);\n    assignModule(MODULE_PREFIX_FUNCTION + 'uuid', functionUuid);\n    assignModule(MODULE_PREFIX + 'weakmap', ClassWeakmap);\n    assignModule(MODULE_PREFIX + 'descriptor', ClassDescriptor);\n    assignModule(MODULE_PREFIX + 'pledge', ClassPledge);\n    assignModule(MODULE_PREFIX + 'queue', ClassQueue);\n    assignModule(MODULE_PREFIX + 'xhr', ClassXhr);\n    assignModule(MODULE_PREFIX + 'failure', ClassFailure);\n\n    if (options && options.main) {\n        switch (typeof options.main) {\n            case STRING_STRING:\n                demand(options.main);\n\n                break;\n            case STRING_FUNCTION:\n                provide('main', options.main());\n\n                break;\n        }\n    }\n}(this.name === 'demand-loader' ? parent : this, setTimeout, clearTimeout));"]}