{"version":3,"sources":["cache/dispose.js"],"names":["localStorage","provide","functionIterate","PREFIX","SUFFIX","regexMatchState","RegExp","regexMatchProperties","getState","key","matches","state","getItem","match","Array","prototype","slice","call","getKey","id","filterStates","property","this","push","compareAccess","a","b","demand","clear","path","size","states","sort","length","shift"],"mappings":";CAAC,SAASA,GACN,aA2EAC,SAAS,4BAzET,SAAoBC,GAChB,IAAIC,EAAS,SACTC,EAAS,QACTC,EAAkB,IAAIC,OAAO,OAASH,EAAS,oBAAsBC,EAAS,QAC9EG,EAAuB,kCAE3B,SAASC,EAASC,GACd,IACIC,EADAC,EAAQX,EAAaY,QAAQH,GAGjC,GAAIE,IAAUD,EAAUC,EAAME,MAAMN,IAChC,OAAOO,MAAMC,UAAUC,MAAMC,KAAKP,EAAS,GAInD,SAASQ,EAAOC,GACZ,MAAO,IAAMhB,EAAS,KAAOgB,EAAK,KAAOf,EAAS,IAgBtD,SAASgB,EAAaC,GAClB,IACIV,EADAE,EAAQQ,EAASR,MAAMR,GAGvBQ,KACAF,EAAQH,EAASU,EAAOL,EAAM,MACxB,GAAKA,EAAM,GAEjBS,KAAKC,KAAKZ,IAIlB,SAASa,EAAcC,EAAGC,GACtB,OAAID,EAAE,GAAKC,EAAE,IACD,EAGRD,EAAE,GAAKC,EAAE,GACF,EAGJ,EAGX,OArCAxB,EAAgBF,EAAc,SAASqB,GACnC,IAAIR,EAAQQ,EAASR,MAAMR,GAGvBQ,IACQL,EAASU,EAAOL,EAAM,KAEnB,IACPc,OAAOC,MAAMC,KAAKhB,EAAM,OA6B7B,SAAsBiB,GACzB,IACInB,EADAoB,KAOJ,IAJA7B,EAAgBF,EAAcoB,EAAcW,GAE5CA,EAAOC,KAAKR,GAELM,EAAO,GAAKC,EAAOE,QAEtBH,IADAnB,EAAQoB,EAAOG,SACD,GAEdP,OAAOC,MAAMC,KAAKlB,EAAM,OAvExC,CA6EEX","file":"dispose.js","sourcesContent":["(function(localStorage) {\n    'use strict';\n\n    function definition(functionIterate) {\n        var PREFIX = 'demand',\n            SUFFIX = 'state',\n            regexMatchState = new RegExp('^\\\\[' + PREFIX + '\\\\]\\\\[(.+?)\\\\]\\\\[' + SUFFIX + '\\\\]$'),\n            regexMatchProperties = /^(.+?),(\\d+),(\\d*),(.+?),(\\d+)$/;\n\n        function getState(key) {\n            var state = localStorage.getItem(key),\n                matches;\n\n            if (state && (matches = state.match(regexMatchProperties))) {\n                return Array.prototype.slice.call(matches, 1);\n            }\n        }\n\n        function getKey(id) {\n            return '[' + PREFIX + '][' + id + '][' + SUFFIX + ']';\n        }\n\n        functionIterate(localStorage, function(property) {\n            var match = property.match(regexMatchState),\n                state;\n\n            if (match) {\n                state = getState(getKey(match[1]));\n\n                if (!state[4]) {\n                    demand.clear.path(match[1]);\n                }\n            }\n        });\n\n        function filterStates(property) {\n            var match = property.match(regexMatchState),\n                state;\n\n            if (match) {\n                state = getState(getKey(match[1]));\n                state[5] = match[1];\n\n                this.push(state);\n            }\n        }\n\n        function compareAccess(a, b) {\n            if (a[4] < b[4]) {\n                return -1;\n            }\n\n            if (a[4] > b[4]) {\n                return 1;\n            }\n\n            return 0;\n        }\n\n        return function cacheDispose(size) {\n            var states = [],\n                state;\n\n            functionIterate(localStorage, filterStates, states);\n\n            states.sort(compareAccess);\n\n            while (size > 0 && states.length) {\n                state = states.shift();\n                size -= state[1];\n\n                demand.clear.path(state[5]);\n            }\n        };\n    }\n\n    provide(['/demand/function/iterate'], definition);\n}(localStorage));"]}