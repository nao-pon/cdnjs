/*
 *  Bootstrap TouchSpin - v4.1.0
 *  A mobile and touch friendly input spinner component for Bootstrap 3 & 4.
 *  http://www.virtuosoft.eu/code/bootstrap-touchspin/
 *
 *  Made by István Ujj-Mészáros
 *  Under Apache License v2.0 License
 */

!function(o){"function"==typeof define&&define.amd?define(["jquery"],o):"object"==typeof module&&module.exports?module.exports=function(t,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(t)),o(n),n}:o(jQuery)}(function(y){"use strict";var k=0;function C(t,n){return y.map(t,function(t){return t+".touchspin_"+n})}y.fn.TouchSpin=function(m){if("destroy"!==m){var w={min:0,max:100,initval:"",replacementval:"",step:1,decimals:0,stepinterval:100,forcestepdivisibility:"round",stepintervaldelay:500,verticalbuttons:!1,verticalup:"+",verticaldown:"-",verticalupclass:"",verticaldownclass:"",prefix:"",postfix:"",prefix_extraclass:"",postfix_extraclass:"",booster:!0,boostat:10,maxboostedstep:!1,mousewheel:!0,buttondown_class:"btn btn-primary",buttonup_class:"btn btn-primary",buttondown_txt:"-",buttonup_txt:"+",callback_before_calculation:function(t){return t},callback_after_calculation:function(t){return t}},_={min:"min",max:"max",initval:"init-val",replacementval:"replacement-val",step:"step",decimals:"decimals",stepinterval:"step-interval",verticalbuttons:"vertical-buttons",verticalupclass:"vertical-up-class",verticaldownclass:"vertical-down-class",forcestepdivisibility:"force-step-divisibility",stepintervaldelay:"step-interval-delay",prefix:"prefix",postfix:"postfix",prefix_extraclass:"prefix-extra-class",postfix_extraclass:"postfix-extra-class",booster:"booster",boostat:"boostat",maxboostedstep:"max-boosted-step",mousewheel:"mouse-wheel",buttondown_class:"button-down-class",buttonup_class:"button-up-class",buttondown_txt:"button-down-txt",buttonup_txt:"button-up-txt"};return this.each(function(){var i,u,s,o,t,n,a,e,r=y(this),p=r.data(),c=0,l=!1;function d(){var t,n,o;""!==(t=i.callback_before_calculation(r.val()))?0<i.decimals&&"."===t||(n=parseFloat(t),isNaN(n)&&(n=""!==i.replacementval?i.replacementval:0),(o=n).toString()!==t&&(o=n),n<i.min&&(o=i.min),n>i.max&&(o=i.max),o=function(t){switch(i.forcestepdivisibility){case"round":return(Math.round(t/i.step)*i.step).toFixed(i.decimals);case"floor":return(Math.floor(t/i.step)*i.step).toFixed(i.decimals);case"ceil":return(Math.ceil(t/i.step)*i.step).toFixed(i.decimals);default:return t}}(o),Number(t).toString()!==o.toString()&&(r.val(o),r.trigger("change"))):""!==i.replacementval&&(r.val(i.replacementval),r.trigger("change"))}function f(){if(i.booster){var t=Math.pow(2,Math.floor(c/i.boostat))*i.step;return i.maxboostedstep&&t>i.maxboostedstep&&(t=i.maxboostedstep,o=Math.round(o/t)*t),Math.max(i.step,t)}return i.step}function b(){d(),o=parseFloat(i.callback_before_calculation(s.input.val())),isNaN(o)&&(o=0);var t=o,n=f();(o+=n)>i.max&&(o=i.max,r.trigger("touchspin.on.max"),g()),s.input.val(i.callback_after_calculation(Number(o).toFixed(i.decimals))),t!==o&&r.trigger("change")}function v(){d(),o=parseFloat(i.callback_before_calculation(s.input.val())),isNaN(o)&&(o=0);var t=o,n=f();(o-=n)<i.min&&(o=i.min,r.trigger("touchspin.on.min"),g()),s.input.val(i.callback_after_calculation(o.toFixed(i.decimals))),t!==o&&r.trigger("change")}function h(){g(),c=0,l="down",r.trigger("touchspin.on.startspin"),r.trigger("touchspin.on.startdownspin"),a=setTimeout(function(){t=setInterval(function(){c++,v()},i.stepinterval)},i.stepintervaldelay)}function x(){g(),c=0,l="up",r.trigger("touchspin.on.startspin"),r.trigger("touchspin.on.startupspin"),e=setTimeout(function(){n=setInterval(function(){c++,b()},i.stepinterval)},i.stepintervaldelay)}function g(){switch(clearTimeout(a),clearTimeout(e),clearInterval(t),clearInterval(n),l){case"up":r.trigger("touchspin.on.stopupspin"),r.trigger("touchspin.on.stopspin");break;case"down":r.trigger("touchspin.on.stopdownspin"),r.trigger("touchspin.on.stopspin")}c=0,l=!1}!function(){if(r.data("alreadyinitialized"))return;if(r.data("alreadyinitialized",!0),k+=1,r.data("spinnerid",k),!r.is("input"))return console.log("Must be an input.");i=y.extend({},w,p,(a={},y.each(_,function(t,n){var o="bts-"+n;r.is("[data-"+o+"]")&&(a[t]=r.data(o))}),a),m),""!==i.initval&&""===r.val()&&r.val(i.initval),d(),function(){var t=r.val(),n=r.parent();""!==t&&(t=i.callback_after_calculation(Number(t).toFixed(i.decimals)));r.data("initvalue",t).val(t),r.addClass("form-control"),n.hasClass("input-group")?function(t){t.addClass("bootstrap-touchspin");var n,o,a=r.prev(),s=r.next(),e='<span class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"><span class="input-group-text">'+i.prefix+"</span></span>",p='<span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+i.postfix+"</span></span>";a.hasClass("input-group-btn")||a.hasClass("input-group-prepend")?(n='<button class="'+i.buttondown_class+' bootstrap-touchspin-down" type="button">'+i.buttondown_txt+"</button>",a.append(n)):(n='<span class="input-group-btn input-group-prepend"><button class="'+i.buttondown_class+' bootstrap-touchspin-down" type="button">'+i.buttondown_txt+"</button></span>",y(n).insertBefore(r));s.hasClass("input-group-btn")||s.hasClass("input-group-append")?(o='<button class="'+i.buttonup_class+' bootstrap-touchspin-up" type="button">'+i.buttonup_txt+"</button>",s.prepend(o)):(o='<span class="input-group-btn input-group-append"><button class="'+i.buttonup_class+' bootstrap-touchspin-up" type="button">'+i.buttonup_txt+"</button></span>",y(o).insertAfter(r));y(e).insertBefore(r),y(p).insertAfter(r),u=t}(n):function(){var t,n="";r.hasClass("input-sm")&&(n="input-group-sm");r.hasClass("input-lg")&&(n="input-group-lg");t=i.verticalbuttons?'<div class="input-group '+n+' bootstrap-touchspin"><span class="input-group-addon bootstrap-touchspin-prefix">'+i.prefix+'</span><span class="input-group-addon bootstrap-touchspin-postfix input-group-prepend"><span class="input-group-text">'+i.postfix+'</span></span><span class="input-group-btn-vertical"><button class="'+i.buttondown_class+" bootstrap-touchspin-up "+i.verticalupclass+'" type="button">'+i.verticalup+'</button><button class="'+i.buttonup_class+" bootstrap-touchspin-down "+i.verticaldownclass+'" type="button">'+i.verticaldown+"</button></span></div>":'<div class="input-group bootstrap-touchspin"><span class="input-group-btn input-group-prepend"><button class="'+i.buttondown_class+' bootstrap-touchspin-down" type="button">'+i.buttondown_txt+'</button></span><span class="input-group-addon bootstrap-touchspin-prefix input-group-prepend"><span class="input-group-text">'+i.prefix+'</span></span><span class="input-group-addon bootstrap-touchspin-postfix input-group-append"><span class="input-group-text">'+i.postfix+'</span></span><span class="input-group-btn input-group-append"><button class="'+i.buttonup_class+' bootstrap-touchspin-up" type="button">'+i.buttonup_txt+"</button></span></div>";u=y(t).insertBefore(r),y(".bootstrap-touchspin-prefix",u).after(r),r.hasClass("input-sm")?u.addClass("input-group-sm"):r.hasClass("input-lg")&&u.addClass("input-group-lg")}()}(),s={down:y(".bootstrap-touchspin-down",u),up:y(".bootstrap-touchspin-up",u),input:y("input",u),prefix:y(".bootstrap-touchspin-prefix",u).addClass(i.prefix_extraclass),postfix:y(".bootstrap-touchspin-postfix",u).addClass(i.postfix_extraclass)},function(){""===i.prefix&&s.prefix.hide();""===i.postfix&&s.postfix.hide()}(),r.on("keydown",function(t){var n=t.keyCode||t.which;38===n?("up"!==l&&(b(),x()),t.preventDefault()):40===n&&("down"!==l&&(v(),h()),t.preventDefault())}),r.on("keyup",function(t){var n=t.keyCode||t.which;38===n?g():40===n&&g()}),r.on("blur",function(){d(),r.val(i.callback_after_calculation(r.val()))}),s.down.on("keydown",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("down"!==l&&(v(),h()),t.preventDefault())}),s.down.on("keyup",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||g()}),s.up.on("keydown",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||("up"!==l&&(b(),x()),t.preventDefault())}),s.up.on("keyup",function(t){var n=t.keyCode||t.which;32!==n&&13!==n||g()}),s.down.on("mousedown.touchspin",function(t){s.down.off("touchstart.touchspin"),r.is(":disabled")||(v(),h(),t.preventDefault(),t.stopPropagation())}),s.down.on("touchstart.touchspin",function(t){s.down.off("mousedown.touchspin"),r.is(":disabled")||(v(),h(),t.preventDefault(),t.stopPropagation())}),s.up.on("mousedown.touchspin",function(t){s.up.off("touchstart.touchspin"),r.is(":disabled")||(b(),x(),t.preventDefault(),t.stopPropagation())}),s.up.on("touchstart.touchspin",function(t){s.up.off("mousedown.touchspin"),r.is(":disabled")||(b(),x(),t.preventDefault(),t.stopPropagation())}),s.up.on("mouseout touchleave touchend touchcancel",function(t){l&&(t.stopPropagation(),g())}),s.down.on("mouseout touchleave touchend touchcancel",function(t){l&&(t.stopPropagation(),g())}),s.down.on("mousemove touchmove",function(t){l&&(t.stopPropagation(),t.preventDefault())}),s.up.on("mousemove touchmove",function(t){l&&(t.stopPropagation(),t.preventDefault())}),y(document).on(C(["mouseup","touchend","touchcancel"],k).join(" "),function(t){l&&(t.preventDefault(),g())}),y(document).on(C(["mousemove","touchmove","scroll","scrollstart"],k).join(" "),function(t){l&&(t.preventDefault(),g())}),r.on("mousewheel DOMMouseScroll",function(t){if(i.mousewheel&&r.is(":focus")){var n=t.originalEvent.wheelDelta||-t.originalEvent.deltaY||-t.originalEvent.detail;t.stopPropagation(),t.preventDefault(),n<0?v():b()}}),r.on("touchspin.uponce",function(){g(),b()}),r.on("touchspin.downonce",function(){g(),v()}),r.on("touchspin.startupspin",function(){x()}),r.on("touchspin.startdownspin",function(){h()}),r.on("touchspin.stopspin",function(){g()}),r.on("touchspin.updatesettings",function(t,n){!function(t){var n;n=t,i=y.extend({},i,n),n.postfix&&r.parent().find(".bootstrap-touchspin-postfix").text(n.postfix),n.prefix&&r.parent().find(".bootstrap-touchspin-prefix").text(n.prefix),d();var o=s.input.val();""!==o&&(o=Number(i.callback_before_calculation(s.input.val())),s.input.val(i.callback_after_calculation(o.toFixed(i.decimals))))}(n)}),s.input.css("display","block");var a}()})}this.each(function(){var t=y(this).data();y(document).off(C(["mouseup","touchend","touchcancel","mousemove","touchmove","scroll","scrollstart"],t.spinnerid).join(" "))})}});