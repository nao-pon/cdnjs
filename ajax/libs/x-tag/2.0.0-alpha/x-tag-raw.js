!function(){function e(e,t){var n=e.rxns[t],r=n.queue;for(let t in r)r[t].fn.call(e),!n.singleton&&r[t].recurring||delete r[t];n.fired=!0}function t(n={}){var a;return a=class extends(n.native?Object.getPrototypeOf(document.createElement(n.native)).constructor:HTMLElement){constructor(){super(),this.rxns||(this.rxns={ready:{queue:{},singleton:!0},firstpaint:{queue:{},singleton:!0},render:{queue:{}}}),s(this),new Promise(e=>o(this,e)).then(()=>e(this,"ready"))}connectedCallback(){i(this),this.rxns.firstpaint.frame||(this.rxns.firstpaint.frame=requestAnimationFrame(()=>e(this,"firstpaint")))}rxn(e,t,n){var r=this.rxns[e];if(!r.singleton||!r.fired)return r.queue[f++]={fn:t,recurring:n},f;t.call(this)}cancelRxn(e,t){delete this.rxns[e].queue[t]}},a.options={extensions:{},pseudos:{}},a.getOptions=function(e){return this.options[e]||(this.options[e]=Object.assign({},Object.getPrototypeOf(this).options?Object.getPrototypeOf(this).options[e]:{}))},a.extensions=function(...e){var t=this.getOptions("extensions");return e.reduce((e,n)=>{var s,o=e;return t[n.name]||("string"==typeof n?s=d.extensions[n].mixin:(s=n.mixin,t[n.name]=n),s&&r(o=s(e))),o},this)},a.as=function(e){return t({native:e})},a.extensions("attr","event","template")}function n(e,t,n,r){return function(){var s={fn:n,args:t,detail:r},o=e.onInvoke(this,s,...arguments);return null===o||!1===o?o:s.fn.apply(this,o instanceof Array?o:arguments)}}function r(e){var t={},r=a(e),s=e.getOptions("extensions"),o=e._processedExtensions=new Map;for(let i in r){let a,l,p=[],f=[],m=r[i],v=e._pseudos||d.pseudos;i.replace(c,function(){p.unshift(arguments)}),p.forEach(t=>(function(t,r,i,c,p){if(a=r||a,p)var h=p.split(u);if("::"==i)f=h||[],l=s[c]||d.extensions[c],o.get(l)||o.set(l,[]);else if(!r){let t=v[c];if(t)for(let r in m){let s=m[r];"function"==typeof s&&t.onInvoke&&(s=m[r]=n(t,h,s),t.onParse&&t.onParse(e,a,h,s))}}}).apply(null,t));let h;if(l&&(o.get(l).push([a,f,m]),l.onParse&&(h=l.onParse(e,a,f,m,i))),a){if(!1!==h){let e=t[a]||(t[a]={});for(let t in m)e[t]=m[t]}}else delete e.prototype[i]}for(let n of o.keys())n.onCompiled&&n.onCompiled(e,t);Object.defineProperties(e.prototype,t)}function s(e){var t=e.constructor._processedExtensions;for(let[n,r]of t)n.onConstruct&&r.forEach(t=>n.onConstruct(e,...t))}function o(e,t){var n=e.constructor._processedExtensions;for(let[r,s]of n)r.onReady&&Promise.all(s.map(t=>new Promise(n=>r.onReady(e,n,...t)))).then(()=>t())}function i(e){var t=e.constructor._processedExtensions;for(let[n,r]of t)n.onConnect&&r.forEach(t=>n.onConnect(e,...t))}function a(e){var t={},n=e.prototype;return Object.getOwnPropertyNames(n).forEach(e=>{t[e]=Object.getOwnPropertyDescriptor(n,e)}),t}var l=document.documentElement;Element.prototype.matches||(Element.prototype.matches=l.webkitMatchesSelector||l.msMatchesSelector||l.oMatchesSelector);var c=/(\w+)|(::|:)(\w+)(?:\((.+?(?=\)))\))?/g,u=/,\s*/,p=document.createRange(),d={events:{},pseudos:{delegate:{onInvoke:function(e,t,n){for(var r,s=n.target,o=n.currentTarget;!r&&s&&s!=o;)s.tagName&&s.matches(t.args)&&(r=s),s=s.parentNode;if(!r&&o.tagName&&o.matches(t.args)&&(r=o),!r)return null;t.fn=t.fn.bind(r)}}},extensions:{rxn:{onParse:(e,t,n,r,s)=>(delete e.prototype[s],!1),onConstruct(e,t,n,r){e.rxn(t,r.value,!!n[1])}},attr:{mixin:e=>class extends e{attributeChangedCallback(e,t,n){var r=this.constructor.getOptions("attributes")[e];r&&r.set&&!r._skip&&(r._skip=!0,r.set.call(this,n),r._skip=null)}},types:{boolean:{set:function(e,t){t||""===t?this.setAttribute(e,""):this.removeAttribute(e)},get:function(e){return this.hasAttribute(e)}}},onParse(e,t,n,r,s){if(r.value)throw'Attribute accessor "'+t+'" was declared as a value, but must be declared as get or set';e.getOptions("attributes")[t]=r;var o=this.types[n[0]]||{};let i=r.set,a=o.set||HTMLElement.prototype.setAttribute;r.set=function(e){if(!r._skip){r._skip=!0;var n;i&&(n=i.call(this,e)),a.call(this,t,void 0===n?e:n),r._skip=null}};let l=r.get,c=o.get||HTMLElement.prototype.getAttribute;r.get=function(){var e,n=c.call(this,t);return l&&(e=l.call(this,n)),void 0===e?n:e},delete e.prototype[s]},onCompiled(e){e.observedAttributes=Object.keys(e.getOptions("attributes")).concat(e.observedAttributes||[])}},event:{onParse:(e,t,n,r,s)=>(delete e.prototype[s],!1),onConstruct(e,t,n,r){d.addEvent(e,t,r.value)}},template:{insert:function(e,t,n){var r=p.createContextualFragment(t.call(e));Array.from(r.children).forEach(e=>e._templateNode=!0),Array.from(e.children).forEach(t=>{t._templateNode&&e.removeChild(t)}),e.appendChild(r),n&&n()},render:function(e,t,n){var r=t||"default",s=e.templates[r];if(!s)throw new ReferenceError('Template "'+r+'" is undefined');cancelAnimationFrame(e._templateFrame),n?e._templatePromise&&!e._templatePromise.resolved||(e._templatePromise=new Promise(t=>{e._templateFrame=requestAnimationFrame(()=>{this.insert(e,s,t)})})):this.insert(e,s,resolve),e._templateRender()},mixin:t=>class extends t{set"template::attr"(e){this.render(e)}get templates(){return this.constructor.getOptions("templates")}render(t,n={}){return new Promise((e,n)=>{this.template=t;var r=t||"default",s=this.templates[r];if(this.template!=t&&(this.template=r),!s)throw new ReferenceError('Template "'+r+'" is undefined');d.extensions.template.insert(this,s,e)}).then(()=>{e(this,"render")})}},onParse:(e,t,n,r)=>(e.getOptions("templates")[t||"default"]=r.value,!1),onReady(e,t,n,r){JSON.parse(r[0]||!1)&&("ready"==r[1]?e.render(n):e.rxn("firstpaint",()=>e.render(n))),t()}}},create(e,t){var n=t||e;return n.options=Object.assign({},n.options),r(n),t&&e&&customElements.define(e,n),n},register(e,t){customElements.define(e,t)},addEvents(e,t){let n={};for(let r in t)n[r]=d.addEvent(e,r,t[r]);return n},addEvent(e,t,r,s){var o,i=r,a={data:{},capture:s},l=e.constructor.getOptions("pseudos");t.replace(c,(t,r,s,c,p)=>{if(r)o=r;else{var f=l[f=s||p]||d.pseudos[f],m=c?c.split(u):[];i=n(f,m,i,a),f.onParse&&f.onParse(e,o,m,i,a)}}),e.addEventListener(o,i,s),a.type=o,a.listener=i;var p=e.constructor.getOptions("events")[o]||d.events[o];if(p){var f=function(e){new Promise((t,n)=>{p.onFilter(this,e,a,t,n)}).then(()=>{d.fireEvent(e.target,o)})};a.attached=p.attach.map(t=>d.addEvent(e,t,f,!0)),p.onAdd&&p.onAdd(e,a)}return a},removeEvents(e,t){for(let n in t)d.removeEvent(e,t[n])},removeEvent(e,t){e.removeEventListener(t.type,t.listener,t.capture);var n=e.constructor.getOptions("events")[t.type]||d.events[t.type];n&&n.onRemove&&n.onRemove(e,t),t.attached&&t.attached.forEach(n=>{d.removeEvent(e,t)})},fireEvent(e,t,n={}){let r=Object.assign({bubbles:!0,cancelable:!0},n);e.dispatchEvent(new CustomEvent(t,r))}},f=0;XTagElement=t(),"function"==typeof define&&define.amd?(define(d),define(XTagElement)):"undefined"!=typeof module&&module.exports?module.exports={xtag:d,XTagElement:XTagElement}:(window.xtag=d,window.XTagElement=XTagElement)}();