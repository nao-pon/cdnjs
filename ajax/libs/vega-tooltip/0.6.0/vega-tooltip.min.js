!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).vegaTooltip=e()}}(function(){return function(){return function e(t,n,r){function i(a,u){if(!n[a]){if(!t[a]){var c="function"==typeof require&&require;if(!u&&c)return c(a,!0);if(o)return o(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return i(n||e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}}()({1:[function(e,t,n){var r;r=this,function(e){"use strict";var t,n=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]},r=function(e){return(e=n(Math.abs(e)))?e[1]:NaN},i=function(e,t){var r=n(e,t);if(!r)return e+"";var i=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+i:i.length>o+1?i.slice(0,o+1)+"."+i.slice(o+1):i+new Array(o-i.length+2).join("0")},o={"":function(e,t){e:for(var n,r=(e=e.toPrecision(t)).length,i=1,o=-1;i<r;++i)switch(e[i]){case".":o=n=i;break;case"0":0===o&&(o=i),n=i;break;case"e":break e;default:o>0&&(o=0)}return o>0?e.slice(0,o)+e.slice(n+1):e},"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return i(100*e,t)},r:i,s:function(e,r){var i=n(e,r);if(!i)return e+"";var o=i[0],a=i[1],u=a-(t=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,c=o.length;return u===c?o:u>c?o+new Array(u-c+1).join("0"):u>0?o.slice(0,u)+"."+o.slice(u):"0."+new Array(1-u).join("0")+n(e,Math.max(0,r+u-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},a=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function u(e){return new c(e)}function c(e){if(!(t=a.exec(e)))throw new Error("invalid format: "+e);var t,n=t[1]||" ",r=t[2]||">",i=t[3]||"-",u=t[4]||"",c=!!t[5],s=t[6]&&+t[6],l=!!t[7],f=t[8]&&+t[8].slice(1),d=t[9]||"";"n"===d?(l=!0,d="g"):o[d]||(d=""),(c||"0"===n&&"="===r)&&(c=!0,n="0",r="="),this.fill=n,this.align=r,this.sign=i,this.symbol=u,this.zero=c,this.width=s,this.comma=l,this.precision=f,this.type=d}u.prototype=c.prototype,c.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var s,l=function(e){return e},f=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"],d=function(e){var n,i,a,c=e.grouping&&e.thousands?(i=e.grouping,a=e.thousands,function(e,t){for(var n=e.length,r=[],o=0,u=i[0],c=0;n>0&&u>0&&(c+u+1>t&&(u=Math.max(1,t-c)),r.push(e.substring(n-=u,n+u)),!((c+=u+1)>t));)u=i[o=(o+1)%i.length];return r.reverse().join(a)}):l,s=e.currency,d=e.decimal,p=e.numerals?(n=e.numerals,function(e){return e.replace(/[0-9]/g,function(e){return n[+e]})}):l,h=e.percent||"%";function g(e){var n=(e=u(e)).fill,r=e.align,i=e.sign,a=e.symbol,l=e.zero,g=e.width,m=e.comma,v=e.precision,y=e.type,T="$"===a?s[0]:"#"===a&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",O="$"===a?s[1]:/[%p]/.test(y)?h:"",S=o[y],_=!y||/[defgprs%]/.test(y);function b(e){var o,a,u,s=T,h=O;if("c"===y)h=S(e)+h,e="";else{var b=(e=+e)<0;if(e=S(Math.abs(e),v),b&&0==+e&&(b=!1),s=(b?"("===i?i:"-":"-"===i||"("===i?"":i)+s,h=("s"===y?f[8+t/3]:"")+h+(b&&"("===i?")":""),_)for(o=-1,a=e.length;++o<a;)if(48>(u=e.charCodeAt(o))||u>57){h=(46===u?d+e.slice(o+1):e.slice(o))+h,e=e.slice(0,o);break}}m&&!l&&(e=c(e,1/0));var E=s.length+e.length+h.length,w=E<g?new Array(g-E+1).join(n):"";switch(m&&l&&(e=c(w+e,w.length?g-h.length:1/0),w=""),r){case"<":e=s+e+h+w;break;case"=":e=s+w+e+h;break;case"^":e=w.slice(0,E=w.length>>1)+s+e+h+w.slice(E);break;default:e=w+s+e+h}return p(e)}return v=null==v?y?6:12:/[gprs]/.test(y)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),b.toString=function(){return e+""},b}return{format:g,formatPrefix:function(e,t){var n=g(((e=u(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(r(t)/3))),o=Math.pow(10,-i),a=f[8+i/3];return function(e){return n(o*e)+a}}}};function p(t){return s=d(t),e.format=s.format,e.formatPrefix=s.formatPrefix,s}p({decimal:".",thousands:",",grouping:[3],currency:["$",""]});e.formatDefaultLocale=p,e.formatLocale=d,e.formatSpecifier=u,e.precisionFixed=function(e){return Math.max(0,-r(Math.abs(e)))},e.precisionPrefix=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(r(t)/3)))-r(Math.abs(e)))},e.precisionRound=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,r(t)-r(e))+1},Object.defineProperty(e,"__esModule",{value:!0})}("object"==typeof n&&void 0!==t?n:r.d3=r.d3||{})},{}],2:[function(e,t,n){var r;r=this,function(e){"use strict";var t="http://www.w3.org/1999/xhtml",n={svg:"http://www.w3.org/2000/svg",xhtml:t,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function r(e){var t=e+="",r=t.indexOf(":");return r>=0&&"xmlns"!==(t=e.slice(0,r))&&(e=e.slice(r+1)),n.hasOwnProperty(t)?{space:n[t],local:e}:e}function i(e){var n=r(e);return(n.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var n=this.ownerDocument,r=this.namespaceURI;return r===t&&n.documentElement.namespaceURI===t?n.createElement(e):n.createElementNS(r,e)}})(n)}function o(){}function a(e){return null==e?o:function(){return this.querySelector(e)}}function u(){return[]}function c(e){return null==e?u:function(){return this.querySelectorAll(e)}}var s=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var l=document.documentElement;if(!l.matches){var f=l.webkitMatchesSelector||l.msMatchesSelector||l.mozMatchesSelector||l.oMatchesSelector;s=function(e){return function(){return f.call(this,e)}}}}var d=s;function p(e){return new Array(e.length)}function h(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}h.prototype={constructor:h,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var g="$";function m(e,t,n,r,i,o){for(var a,u=0,c=t.length,s=o.length;u<s;++u)(a=t[u])?(a.__data__=o[u],r[u]=a):n[u]=new h(e,o[u]);for(;u<c;++u)(a=t[u])&&(i[u]=a)}function v(e,t,n,r,i,o,a){var u,c,s,l={},f=t.length,d=o.length,p=new Array(f);for(u=0;u<f;++u)(c=t[u])&&(p[u]=s=g+a.call(c,c.__data__,u,t),s in l?i[u]=c:l[s]=c);for(u=0;u<d;++u)(c=l[s=g+a.call(e,o[u],u,o)])?(r[u]=c,c.__data__=o[u],l[s]=null):n[u]=new h(e,o[u]);for(u=0;u<f;++u)(c=t[u])&&l[p[u]]===c&&(i[u]=c)}function y(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function T(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function O(e,t){return e.style.getPropertyValue(t)||T(e).getComputedStyle(e,null).getPropertyValue(t)}function S(e){return e.trim().split(/^|\s+/)}function _(e){return e.classList||new b(e)}function b(e){this._node=e,this._names=S(e.getAttribute("class")||"")}function E(e,t){for(var n=_(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function w(e,t){for(var n=_(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function A(){this.textContent=""}function C(){this.innerHTML=""}function M(){this.nextSibling&&this.parentNode.appendChild(this)}function N(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function x(){return null}function D(){var e=this.parentNode;e&&e.removeChild(this)}function U(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function I(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}b.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var P={};(e.event=null,"undefined"!=typeof document)&&("onmouseenter"in document.documentElement||(P={mouseenter:"mouseover",mouseleave:"mouseout"}));function L(e,t,n){return e=F(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function F(t,n,r){return function(i){var o=e.event;e.event=i;try{t.call(this,this.__data__,n,r)}finally{e.event=o}}}function R(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,o=t.length;r<o;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function k(e,t,n){var r=P.hasOwnProperty(e.type)?L:F;return function(i,o,a){var u,c=this.__on,s=r(t,o,a);if(c)for(var l=0,f=c.length;l<f;++l)if((u=c[l]).type===e.type&&u.name===e.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=s,u.capture=n),void(u.value=t);this.addEventListener(e.type,s,n),u={type:e.type,name:e.name,value:t,listener:s,capture:n},c?c.push(u):this.__on=[u]}}function j(e,t,n){var r=T(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}var H=[null];function Y(e,t){this._groups=e,this._parents=t}function q(){return new Y([[document.documentElement]],H)}function z(e){return"string"==typeof e?new Y([[document.querySelector(e)]],[document.documentElement]):new Y([[e]],H)}Y.prototype=q.prototype={constructor:Y,select:function(e){"function"!=typeof e&&(e=a(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,u,c=t[i],s=c.length,l=r[i]=new Array(s),f=0;f<s;++f)(o=c[f])&&(u=e.call(o,o.__data__,f,c))&&("__data__"in o&&(u.__data__=o.__data__),l[f]=u);return new Y(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=c(e));for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a,u=t[o],s=u.length,l=0;l<s;++l)(a=u[l])&&(r.push(e.call(a,a.__data__,l,u)),i.push(a));return new Y(r,i)},filter:function(e){"function"!=typeof e&&(e=d(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o,a=t[i],u=a.length,c=r[i]=[],s=0;s<u;++s)(o=a[s])&&e.call(o,o.__data__,s,a)&&c.push(o);return new Y(r,this._parents)},data:function(e,t){if(!e)return h=new Array(this.size()),l=-1,this.each(function(e){h[++l]=e}),h;var n,r=t?v:m,i=this._parents,o=this._groups;"function"!=typeof e&&(n=e,e=function(){return n});for(var a=o.length,u=new Array(a),c=new Array(a),s=new Array(a),l=0;l<a;++l){var f=i[l],d=o[l],p=d.length,h=e.call(f,f&&f.__data__,l,i),g=h.length,y=c[l]=new Array(g),T=u[l]=new Array(g);r(f,d,y,T,s[l]=new Array(p),h,t);for(var O,S,_=0,b=0;_<g;++_)if(O=y[_]){for(_>=b&&(b=_+1);!(S=T[b])&&++b<g;);O._next=S||null}}return(u=new Y(u,i))._enter=c,u._exit=s,u},enter:function(){return new Y(this._enter||this._groups.map(p),this._parents)},exit:function(){return new Y(this._exit||this._groups.map(p),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,o=Math.min(r,i),a=new Array(r),u=0;u<o;++u)for(var c,s=t[u],l=n[u],f=s.length,d=a[u]=new Array(f),p=0;p<f;++p)(c=s[p]||l[p])&&(d[p]=c);for(;u<r;++u)a[u]=t[u];return new Y(a,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],o=i.length-1,a=i[o];--o>=0;)(r=i[o])&&(a&&a!==r.nextSibling&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=y);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a,u=n[o],c=u.length,s=i[o]=new Array(c),l=0;l<c;++l)(a=u[l])&&(s[l]=a);s.sort(t)}return new Y(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,o=t[n],a=0,u=o.length;a<u;++a)(i=o[a])&&e.call(i,i.__data__,a,o);return this},attr:function(e,t){var n=r(e);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==t?n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}:function(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):O(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"==typeof t?function(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=S(e+"");if(arguments.length<2){for(var r=_(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?function(e,t){return function(){(t.apply(this,arguments)?E:w)(this,e)}}:t?function(e){return function(){E(this,e)}}:function(e){return function(){w(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?A:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?C:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(M)},lower:function(){return this.each(N)},append:function(e){var t="function"==typeof e?e:i(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:i(e),r=null==t?x:"function"==typeof t?t:a(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(D)},clone:function(e){return this.select(e?I:U)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,o=(e+"").trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}),a=o.length;if(!(arguments.length<2)){for(u=t?k:R,null==n&&(n=!1),r=0;r<a;++r)this.each(u(o[r],t,n));return this}var u=this.node().__on;if(u)for(var c,s=0,l=u.length;s<l;++s)for(r=0,c=u[s];r<a;++r)if((i=o[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return j(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return j(this,e,t)}})(e,t))}};var B=0;function W(){return new X}function X(){this._="@"+(++B).toString(36)}function V(){for(var t,n=e.event;t=n.sourceEvent;)n=t;return n}function G(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}X.prototype=W.prototype={constructor:X,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}},e.create=function(e){return z(i(e).call(document.documentElement))},e.creator=i,e.local=W,e.matcher=d,e.mouse=function(e){var t=V();return t.changedTouches&&(t=t.changedTouches[0]),G(e,t)},e.namespace=r,e.namespaces=n,e.clientPoint=G,e.select=z,e.selectAll=function(e){return"string"==typeof e?new Y([document.querySelectorAll(e)],[document.documentElement]):new Y([null==e?[]:e],H)},e.selection=q,e.selector=a,e.selectorAll=c,e.style=O,e.touch=function(e,t,n){arguments.length<3&&(n=t,t=V().changedTouches);for(var r,i=0,o=t?t.length:0;i<o;++i)if((r=t[i]).identifier===n)return G(e,r);return null},e.touches=function(e,t){null==t&&(t=V().touches);for(var n=0,r=t?t.length:0,i=new Array(r);n<r;++n)i[n]=G(e,t[n]);return i},e.window=T,e.customEvent=function(t,n,r,i){var o=e.event;t.sourceEvent=e.event,e.event=t;try{return n.apply(r,i)}finally{e.event=o}},Object.defineProperty(e,"__esModule",{value:!0})}("object"==typeof n&&void 0!==t?n:r.d3=r.d3||{})},{}],3:[function(e,t,n){var r,i;r=this,i=function(e,t){"use strict";function n(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function r(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function i(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function o(e){var o=e.dateTime,a=e.date,c=e.time,s=e.periods,l=e.days,f=e.shortDays,d=e.months,ve=e.shortMonths,ye=p(s),Te=h(s),Oe=p(l),Se=h(l),_e=p(f),be=h(f),Ee=p(d),we=h(d),Ae=p(ve),Ce=h(ve),Me={a:function(e){return f[e.getDay()]},A:function(e){return l[e.getDay()]},b:function(e){return ve[e.getMonth()]},B:function(e){return d[e.getMonth()]},c:null,d:P,e:P,f:j,H:L,I:F,j:R,L:k,m:H,M:Y,p:function(e){return s[+(e.getHours()>=12)]},Q:ge,s:me,S:q,u:z,U:B,V:W,w:X,W:V,x:null,X:null,y:G,Y:K,Z:Q,"%":he},Ne={a:function(e){return f[e.getUTCDay()]},A:function(e){return l[e.getUTCDay()]},b:function(e){return ve[e.getUTCMonth()]},B:function(e){return d[e.getUTCMonth()]},c:null,d:J,e:J,f:ne,H:Z,I:$,j:ee,L:te,m:re,M:ie,p:function(e){return s[+(e.getUTCHours()>=12)]},Q:ge,s:me,S:oe,u:ae,U:ue,V:ce,w:se,W:le,x:null,X:null,y:fe,Y:de,Z:pe,"%":he},xe={a:function(e,t,n){var r=_e.exec(t.slice(n));return r?(e.w=be[r[0].toLowerCase()],n+r[0].length):-1},A:function(e,t,n){var r=Oe.exec(t.slice(n));return r?(e.w=Se[r[0].toLowerCase()],n+r[0].length):-1},b:function(e,t,n){var r=Ae.exec(t.slice(n));return r?(e.m=Ce[r[0].toLowerCase()],n+r[0].length):-1},B:function(e,t,n){var r=Ee.exec(t.slice(n));return r?(e.m=we[r[0].toLowerCase()],n+r[0].length):-1},c:function(e,t,n){return Ie(e,o,t,n)},d:E,e:E,f:x,H:A,I:A,j:w,L:N,m:b,M:C,p:function(e,t,n){var r=ye.exec(t.slice(n));return r?(e.p=Te[r[0].toLowerCase()],n+r[0].length):-1},Q:U,s:I,S:M,u:m,U:v,V:y,w:g,W:T,x:function(e,t,n){return Ie(e,a,t,n)},X:function(e,t,n){return Ie(e,c,t,n)},y:S,Y:O,Z:_,"%":D};function De(e,t){return function(n){var r,i,o,a=[],c=-1,s=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++c<l;)37===e.charCodeAt(c)&&(a.push(e.slice(s,c)),null!=(i=u[r=e.charAt(++c)])?r=e.charAt(++c):i="e"===r?" ":"0",(o=t[r])&&(r=o(n,i)),a.push(r),s=c+1);return a.push(e.slice(s,c)),a.join("")}}function Ue(e,n){return function(o){var a,u,c=i(1900);if(Ie(c,e,o+="",0)!=o.length)return null;if("Q"in c)return new Date(c.Q);if("p"in c&&(c.H=c.H%12+12*c.p),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(a=(u=(a=r(i(c.y))).getUTCDay())>4||0===u?t.utcMonday.ceil(a):t.utcMonday(a),a=t.utcDay.offset(a,7*(c.V-1)),c.y=a.getUTCFullYear(),c.m=a.getUTCMonth(),c.d=a.getUTCDate()+(c.w+6)%7):(a=(u=(a=n(i(c.y))).getDay())>4||0===u?t.timeMonday.ceil(a):t.timeMonday(a),a=t.timeDay.offset(a,7*(c.V-1)),c.y=a.getFullYear(),c.m=a.getMonth(),c.d=a.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),u="Z"in c?r(i(c.y)).getUTCDay():n(i(c.y)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(u+5)%7:c.w+7*c.U-(u+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,r(c)):n(c)}}function Ie(e,t,n,r){for(var i,o,a=0,c=t.length,s=n.length;a<c;){if(r>=s)return-1;if(37===(i=t.charCodeAt(a++))){if(i=t.charAt(a++),!(o=xe[i in u?t.charAt(a++):i])||(r=o(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return Me.x=De(a,Me),Me.X=De(c,Me),Me.c=De(o,Me),Ne.x=De(a,Ne),Ne.X=De(c,Ne),Ne.c=De(o,Ne),{format:function(e){var t=De(e+="",Me);return t.toString=function(){return e},t},parse:function(e){var t=Ue(e+="",n);return t.toString=function(){return e},t},utcFormat:function(e){var t=De(e+="",Ne);return t.toString=function(){return e},t},utcParse:function(e){var t=Ue(e,r);return t.toString=function(){return e},t}}}var a,u={"-":"",_:" ",0:"0"},c=/^\s*\d+/,s=/^%/,l=/[\\^$*+?|[\]().{}]/g;function f(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(t)+i:i)}function d(e){return e.replace(l,"\\$&")}function p(e){return new RegExp("^(?:"+e.map(d).join("|")+")","i")}function h(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function g(e,t,n){var r=c.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function m(e,t,n){var r=c.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function v(e,t,n){var r=c.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function y(e,t,n){var r=c.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function T(e,t,n){var r=c.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function O(e,t,n){var r=c.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function S(e,t,n){var r=c.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function _(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function b(e,t,n){var r=c.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function E(e,t,n){var r=c.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function w(e,t,n){var r=c.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function A(e,t,n){var r=c.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function C(e,t,n){var r=c.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function M(e,t,n){var r=c.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function N(e,t,n){var r=c.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function x(e,t,n){var r=c.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function D(e,t,n){var r=s.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function U(e,t,n){var r=c.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function I(e,t,n){var r=c.exec(t.slice(n));return r?(e.Q=1e3*+r[0],n+r[0].length):-1}function P(e,t){return f(e.getDate(),t,2)}function L(e,t){return f(e.getHours(),t,2)}function F(e,t){return f(e.getHours()%12||12,t,2)}function R(e,n){return f(1+t.timeDay.count(t.timeYear(e),e),n,3)}function k(e,t){return f(e.getMilliseconds(),t,3)}function j(e,t){return k(e,t)+"000"}function H(e,t){return f(e.getMonth()+1,t,2)}function Y(e,t){return f(e.getMinutes(),t,2)}function q(e,t){return f(e.getSeconds(),t,2)}function z(e){var t=e.getDay();return 0===t?7:t}function B(e,n){return f(t.timeSunday.count(t.timeYear(e),e),n,2)}function W(e,n){var r=e.getDay();return e=r>=4||0===r?t.timeThursday(e):t.timeThursday.ceil(e),f(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),n,2)}function X(e){return e.getDay()}function V(e,n){return f(t.timeMonday.count(t.timeYear(e),e),n,2)}function G(e,t){return f(e.getFullYear()%100,t,2)}function K(e,t){return f(e.getFullYear()%1e4,t,4)}function Q(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+f(t/60|0,"0",2)+f(t%60,"0",2)}function J(e,t){return f(e.getUTCDate(),t,2)}function Z(e,t){return f(e.getUTCHours(),t,2)}function $(e,t){return f(e.getUTCHours()%12||12,t,2)}function ee(e,n){return f(1+t.utcDay.count(t.utcYear(e),e),n,3)}function te(e,t){return f(e.getUTCMilliseconds(),t,3)}function ne(e,t){return te(e,t)+"000"}function re(e,t){return f(e.getUTCMonth()+1,t,2)}function ie(e,t){return f(e.getUTCMinutes(),t,2)}function oe(e,t){return f(e.getUTCSeconds(),t,2)}function ae(e){var t=e.getUTCDay();return 0===t?7:t}function ue(e,n){return f(t.utcSunday.count(t.utcYear(e),e),n,2)}function ce(e,n){var r=e.getUTCDay();return e=r>=4||0===r?t.utcThursday(e):t.utcThursday.ceil(e),f(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),n,2)}function se(e){return e.getUTCDay()}function le(e,n){return f(t.utcMonday.count(t.utcYear(e),e),n,2)}function fe(e,t){return f(e.getUTCFullYear()%100,t,2)}function de(e,t){return f(e.getUTCFullYear()%1e4,t,4)}function pe(){return"+0000"}function he(){return"%"}function ge(e){return+e}function me(e){return Math.floor(+e/1e3)}function ve(t){return a=o(t),e.timeFormat=a.format,e.timeParse=a.parse,e.utcFormat=a.utcFormat,e.utcParse=a.utcParse,a}ve({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var ye="%Y-%m-%dT%H:%M:%S.%LZ";var Te=Date.prototype.toISOString?function(e){return e.toISOString()}:e.utcFormat(ye);var Oe=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:e.utcParse(ye);e.timeFormatDefaultLocale=ve,e.timeFormatLocale=o,e.isoFormat=Te,e.isoParse=Oe,Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof n&&void 0!==t?i(n,e("d3-time")):i(r.d3=r.d3||{},r.d3)},{"d3-time":4}],4:[function(e,t,n){var r;r=this,function(e){"use strict";var t=new Date,n=new Date;function r(e,i,o,a){function u(t){return e(t=new Date(+t)),t}return u.floor=u,u.ceil=function(t){return e(t=new Date(t-1)),i(t,1),e(t),t},u.round=function(e){var t=u(e),n=u.ceil(e);return e-t<n-e?t:n},u.offset=function(e,t){return i(e=new Date(+e),null==t?1:Math.floor(t)),e},u.range=function(t,n,r){var o,a=[];if(t=u.ceil(t),r=null==r?1:Math.floor(r),!(t<n&&r>0))return a;do{a.push(o=new Date(+t)),i(t,r),e(t)}while(o<t&&t<n);return a},u.filter=function(t){return r(function(n){if(n>=n)for(;e(n),!t(n);)n.setTime(n-1)},function(e,n){if(e>=e)if(n<0)for(;++n<=0;)for(;i(e,-1),!t(e););else for(;--n>=0;)for(;i(e,1),!t(e););})},o&&(u.count=function(r,i){return t.setTime(+r),n.setTime(+i),e(t),e(n),Math.floor(o(t,n))},u.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?u.filter(a?function(t){return a(t)%e==0}:function(t){return u.count(0,t)%e==0}):u:null}),u}var i=r(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?r(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):i:null};var o=i.range,a=6e4,u=36e5,c=6048e5,s=r(function(e){e.setTime(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),l=s.range,f=r(function(e){e.setTime(Math.floor(e/a)*a)},function(e,t){e.setTime(+e+t*a)},function(e,t){return(t-e)/a},function(e){return e.getMinutes()}),d=f.range,p=r(function(e){var t=e.getTimezoneOffset()*a%u;t<0&&(t+=u),e.setTime(Math.floor((+e-t)/u)*u+t)},function(e,t){e.setTime(+e+t*u)},function(e,t){return(t-e)/u},function(e){return e.getHours()}),h=p.range,g=r(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*a)/864e5},function(e){return e.getDate()-1}),m=g.range;function v(e){return r(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*a)/c})}var y=v(0),T=v(1),O=v(2),S=v(3),_=v(4),b=v(5),E=v(6),w=y.range,A=T.range,C=O.range,M=S.range,N=_.range,x=b.range,D=E.range,U=r(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),I=U.range,P=r(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});P.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var L=P.range,F=r(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*a)},function(e,t){return(t-e)/a},function(e){return e.getUTCMinutes()}),R=F.range,k=r(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*u)},function(e,t){return(t-e)/u},function(e){return e.getUTCHours()}),j=k.range,H=r(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1}),Y=H.range;function q(e){return r(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/c})}var z=q(0),B=q(1),W=q(2),X=q(3),V=q(4),G=q(5),K=q(6),Q=z.range,J=B.range,Z=W.range,$=X.range,ee=V.range,te=G.range,ne=K.range,re=r(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),ie=re.range,oe=r(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});oe.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var ae=oe.range;e.timeInterval=r,e.timeMillisecond=i,e.timeMilliseconds=o,e.utcMillisecond=i,e.utcMilliseconds=o,e.timeSecond=s,e.timeSeconds=l,e.utcSecond=s,e.utcSeconds=l,e.timeMinute=f,e.timeMinutes=d,e.timeHour=p,e.timeHours=h,e.timeDay=g,e.timeDays=m,e.timeWeek=y,e.timeWeeks=w,e.timeSunday=y,e.timeSundays=w,e.timeMonday=T,e.timeMondays=A,e.timeTuesday=O,e.timeTuesdays=C,e.timeWednesday=S,e.timeWednesdays=M,e.timeThursday=_,e.timeThursdays=N,e.timeFriday=b,e.timeFridays=x,e.timeSaturday=E,e.timeSaturdays=D,e.timeMonth=U,e.timeMonths=I,e.timeYear=P,e.timeYears=L,e.utcMinute=F,e.utcMinutes=R,e.utcHour=k,e.utcHours=j,e.utcDay=H,e.utcDays=Y,e.utcWeek=z,e.utcWeeks=Q,e.utcSunday=z,e.utcSundays=Q,e.utcMonday=B,e.utcMondays=J,e.utcTuesday=W,e.utcTuesdays=Z,e.utcWednesday=X,e.utcWednesdays=$,e.utcThursday=V,e.utcThursdays=ee,e.utcFriday=G,e.utcFridays=te,e.utcSaturday=K,e.utcSaturdays=ne,e.utcMonth=re,e.utcMonths=ie,e.utcYear=oe,e.utcYears=ae,Object.defineProperty(e,"__esModule",{value:!0})}("object"==typeof n&&void 0!==t?n:r.d3=r.d3||{})},{}],5:[function(e,t,n){var r="undefined"!=typeof JSON?JSON:e("jsonify");t.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n=t.space||"";"number"==typeof n&&(n=Array(n+1).join(" "));var a,u="boolean"==typeof t.cycles&&t.cycles,c=t.replacer||function(e,t){return t},s=t.cmp&&(a=t.cmp,function(e){return function(t,n){var r={key:t,value:e[t]},i={key:n,value:e[n]};return a(r,i)}}),l=[];return function e(t,a,f,d){var p=n?"\n"+new Array(d+1).join(n):"",h=n?": ":":";if(f&&f.toJSON&&"function"==typeof f.toJSON&&(f=f.toJSON()),void 0!==(f=c.call(t,a,f))){if("object"!=typeof f||null===f)return r.stringify(f);if(i(f)){for(var g=[],m=0;m<f.length;m++){var v=e(f,m,f[m],d+1)||r.stringify(null);g.push(p+n+v)}return"["+g.join(",")+p+"]"}if(-1!==l.indexOf(f)){if(u)return r.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}l.push(f);var y=o(f).sort(s&&s(f));for(g=[],m=0;m<y.length;m++){var T=e(f,a=y[m],f[a],d+1);if(T){var O=r.stringify(a)+h+T;g.push(p+n+O)}}return l.splice(l.indexOf(f),1),"{"+g.join(",")+p+"}"}}({"":e},"",e,0)};var i=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},o=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},n=[];for(var r in e)t.call(e,r)&&n.push(r);return n}},{jsonify:6}],6:[function(e,t,n){n.parse=e("./lib/parse"),n.stringify=e("./lib/stringify")},{"./lib/parse":7,"./lib/stringify":8}],7:[function(e,t,n){var r,i,o,a,u={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},c=function(e){throw{name:"SyntaxError",message:e,at:r,text:o}},s=function(e){return e&&e!==i&&c("Expected '"+e+"' instead of '"+i+"'"),i=o.charAt(r),r+=1,i},l=function(){var e,t="";for("-"===i&&(t="-",s("-"));i>="0"&&i<="9";)t+=i,s();if("."===i)for(t+=".";s()&&i>="0"&&i<="9";)t+=i;if("e"===i||"E"===i)for(t+=i,s(),"-"!==i&&"+"!==i||(t+=i,s());i>="0"&&i<="9";)t+=i,s();if(e=+t,isFinite(e))return e;c("Bad number")},f=function(){var e,t,n,r="";if('"'===i)for(;s();){if('"'===i)return s(),r;if("\\"===i)if(s(),"u"===i){for(n=0,t=0;t<4&&(e=parseInt(s(),16),isFinite(e));t+=1)n=16*n+e;r+=String.fromCharCode(n)}else{if("string"!=typeof u[i])break;r+=u[i]}else r+=i}c("Bad string")},d=function(){for(;i&&i<=" ";)s()};a=function(){switch(d(),i){case"{":return function(){var e,t={};if("{"===i){if(s("{"),d(),"}"===i)return s("}"),t;for(;i;){if(e=f(),d(),s(":"),Object.hasOwnProperty.call(t,e)&&c('Duplicate key "'+e+'"'),t[e]=a(),d(),"}"===i)return s("}"),t;s(","),d()}}c("Bad object")}();case"[":return function(){var e=[];if("["===i){if(s("["),d(),"]"===i)return s("]"),e;for(;i;){if(e.push(a()),d(),"]"===i)return s("]"),e;s(","),d()}}c("Bad array")}();case'"':return f();case"-":return l();default:return i>="0"&&i<="9"?l():function(){switch(i){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}c("Unexpected '"+i+"'")}()}},t.exports=function(e,t){var n;return o=e,r=0,i=" ",n=a(),d(),i&&c("Syntax error"),"function"==typeof t?function e(n,r){var i,o,a=n[r];if(a&&"object"==typeof a)for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(void 0!==(o=e(a,i))?a[i]=o:delete a[i]);return t.call(n,r,a)}({"":n},""):n}},{}],8:[function(e,t,n){var r,i,o,a=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,u={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function c(e){return a.lastIndex=0,a.test(e)?'"'+e.replace(a,function(e){var t=u[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}t.exports=function(e,t,n){var a;if(r="",i="","number"==typeof n)for(a=0;a<n;a+=1)i+=" ";else"string"==typeof n&&(i=n);if(o=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return function e(t,n){var a,u,s,l,f,d=r,p=n[t];switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(t)),"function"==typeof o&&(p=o.call(n,t,p)),typeof p){case"string":return c(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":return String(p);case"object":if(!p)return"null";if(r+=i,f=[],"[object Array]"===Object.prototype.toString.apply(p)){for(l=p.length,a=0;a<l;a+=1)f[a]=e(a,p)||"null";return s=0===f.length?"[]":r?"[\n"+r+f.join(",\n"+r)+"\n"+d+"]":"["+f.join(",")+"]",r=d,s}if(o&&"object"==typeof o)for(l=o.length,a=0;a<l;a+=1)"string"==typeof(u=o[a])&&(s=e(u,p))&&f.push(c(u)+(r?": ":":")+s);else for(u in p)Object.prototype.hasOwnProperty.call(p,u)&&(s=e(u,p))&&f.push(c(u)+(r?": ":":")+s);return s=0===f.length?"{}":r?"{\n"+r+f.join(",\n"+r)+"\n"+d+"}":"{"+f.join(",")+"}",r=d,s}}("",{"":e})}},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./util"),i={values:1,count:1,valid:1,missing:1,distinct:1,sum:1,mean:1,average:1,variance:1,variancep:1,stdev:1,stdevp:1,median:1,q1:1,q3:1,ci0:1,ci1:1,min:1,max:1,argmin:1,argmax:1};n.AGGREGATE_OPS=r.flagKeys(i),n.isAggregateOp=function(e){return!!i[e]},n.COUNTING_OPS=["count","valid","missing","distinct"],n.isCountingAggregateOp=function(e){return e&&r.contains(n.COUNTING_OPS,e)},n.SUM_OPS=["count","sum","distinct","valid","missing"],n.SHARED_DOMAIN_OPS=["mean","average","median","q1","q3","min","max"],n.SHARED_DOMAIN_OP_INDEX=r.toSet(n.SHARED_DOMAIN_OPS)},{"./util":27}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./channel"),i=e("./util");n.binToString=function(e){return i.isBoolean(e)?"bin":"bin"+i.keys(e).map(function(t){return("_"+t+"_"+e[t]).replace(",","_")}).join("")},n.autoMaxBins=function(e){switch(e){case r.ROW:case r.COLUMN:case r.SIZE:case r.COLOR:case r.OPACITY:case r.SHAPE:return 6;default:return 10}}},{"./channel":11,"./util":27}],11:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(n,"__esModule",{value:!0});var o,a,u=e("./util");(a=o=n.Channel||(n.Channel={})).ROW="row",a.COLUMN="column",a.X="x",a.Y="y",a.X2="x2",a.Y2="y2",a.COLOR="color",a.SHAPE="shape",a.SIZE="size",a.OPACITY="opacity",a.TEXT="text",a.ORDER="order",a.DETAIL="detail",a.TOOLTIP="tooltip",a.HREF="href",n.X=o.X,n.Y=o.Y,n.X2=o.X2,n.Y2=o.Y2,n.ROW=o.ROW,n.COLUMN=o.COLUMN,n.SHAPE=o.SHAPE,n.SIZE=o.SIZE,n.COLOR=o.COLOR,n.TEXT=o.TEXT,n.DETAIL=o.DETAIL,n.ORDER=o.ORDER,n.OPACITY=o.OPACITY,n.TOOLTIP=o.TOOLTIP,n.HREF=o.HREF;var c={x:1,y:1,x2:1,y2:1,size:1,shape:1,color:1,order:1,opacity:1,text:1,detail:1,tooltip:1,href:1},s=r({},c,{row:1,column:1});n.CHANNELS=u.flagKeys(s);s.order,s.detail;var l=i(s,["order","detail"]);n.SINGLE_DEF_CHANNELS=u.flagKeys(l),n.isChannel=function(e){return!!s[e]},n.UNIT_CHANNELS=u.flagKeys(c);var f=i(c,["x","y","x2","y2"]);n.NONPOSITION_CHANNELS=u.flagKeys(f);var d={x:1,y:1};n.POSITION_SCALE_CHANNELS=u.flagKeys(d);f.text,f.tooltip,f.href,f.detail,f.order;var p=i(f,["text","tooltip","href","detail","order"]);n.NONPOSITION_SCALE_CHANNELS=u.flagKeys(p);var h=r({},d,p);function g(e){switch(e){case n.COLOR:case n.DETAIL:case n.TOOLTIP:case n.HREF:case n.ORDER:case n.OPACITY:case n.ROW:case n.COLUMN:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,rect:!0,line:!0,area:!0,text:!0,geoshape:!0};case n.X:case n.Y:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,rect:!0,line:!0,area:!0,text:!0};case n.X2:case n.Y2:return{rule:!0,bar:!0,rect:!0,area:!0};case n.SIZE:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,text:!0,line:!0};case n.SHAPE:return{point:!0,geoshape:!0};case n.TEXT:return{text:!0}}}n.SCALE_CHANNELS=u.flagKeys(h),n.isScaleChannel=function(e){return!!h[e]},n.supportMark=function(e,t){return t in g(e)},n.getSupportedMark=g,n.rangeType=function(e){switch(e){case n.X:case n.Y:case n.SIZE:case n.OPACITY:case n.X2:case n.Y2:return"continuous";case n.ROW:case n.COLUMN:case n.SHAPE:case n.TEXT:case n.TOOLTIP:case n.HREF:return"discrete";case n.COLOR:return"flexible";case n.DETAIL:case n.ORDER:return}throw new Error("getSupportedRole not implemented for "+e)}},{"./util":27}],12:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(n,"__esModule",{value:!0});var o=e("vega-util"),a=e("../encoding"),u=e("./../encoding"),c=e("./../fielddef"),s=e("./../log"),l=e("./common");function f(e){return!!e.type}n.BOXPLOT="box-plot",n.isBoxPlotDef=f,n.BOXPLOT_STYLES=["boxWhisker","box","boxMid"],n.VL_ONLY_BOXPLOT_CONFIG_PROPERTY_INDEX={box:["size","color"],boxWhisker:["color"],boxMid:["color"]};var d=["x","y","color","detail","opacity","size"];function p(e){return r({},e,{encoding:a.reduce(e.encoding,function(e,t,r){return d.indexOf(r)>-1?e[r]=t:s.warn(s.message.incompatibleChannel(r,n.BOXPLOT)),e},{})})}n.filterUnsupportedChannels=p,n.normalizeBoxPlot=function(e,t){var a=(e=p(e)).mark,d=(e.encoding,e.selection),h=(e.projection,i(e,["mark","encoding","selection","projection"])),g=void 0;f(a)&&a.extent&&o.isNumber(a.extent)&&(g=a.extent);var m,v,y,T,O=function(e,t,r){var o=function(e,t){e.mark;var r,o,a=e.encoding;if(e.projection,i(e,["mark","encoding","projection"]),"vertical"===t?(o="y",r=a.y):(o="x",r=a.x),r&&r.aggregate){var u=r.aggregate,c=i(r,["aggregate"]);u!==n.BOXPLOT&&s.warn("Continuous axis should not have customized aggregation function "+u),r=c}return{continuousAxisChannelDef:r,continuousAxis:o}}(e,t),a=o.continuousAxisChannelDef,l=o.continuousAxis,f=e.encoding,d=void 0===r,p=[{op:"q1",field:a.field,as:"lower_box_"+a.field},{op:"q3",field:a.field,as:"upper_box_"+a.field},{op:"median",field:a.field,as:"mid_box_"+a.field}],h=[];p.push({op:"min",field:a.field,as:(d?"lower_whisker_":"min_")+a.field}),p.push({op:"max",field:a.field,as:(d?"upper_whisker_":"max_")+a.field}),d||(h=[{calculate:"datum.upper_box_"+a.field+" - datum.lower_box_"+a.field,as:"iqr_"+a.field},{calculate:"min(datum.upper_box_"+a.field+" + datum.iqr_"+a.field+" * "+r+", datum.max_"+a.field+")",as:"upper_whisker_"+a.field},{calculate:"max(datum.lower_box_"+a.field+" - datum.iqr_"+a.field+" * "+r+", datum.min_"+a.field+")",as:"lower_whisker_"+a.field}]);var g=[],m=[],v=[],y={};return u.forEach(f,function(e,t){if(t!==l)if(c.isFieldDef(e)){if(e.aggregate&&e.aggregate!==n.BOXPLOT)p.push({op:e.aggregate,field:e.field,as:c.vgField(e)});else if(void 0===e.aggregate){var r=c.vgField(e),i=e.bin;if(i){var o=e.field;m.push({bin:i,field:o,as:r})}else if(e.timeUnit){var a=e.timeUnit;o=e.field,v.push({timeUnit:a,field:o,as:r})}g.push(r)}y[t]={field:c.vgField(e),type:e.type}}else y[t]=f[t]}),{transform:[].concat(m,v,[{aggregate:p,groupby:g}],h),continuousAxisChannelDef:a,continuousAxis:l,encodingWithoutContinuousAxis:y}}(e,function(e){var t=e.mark,r=e.encoding;if(e.projection,i(e,["mark","encoding","projection"]),c.isFieldDef(r.x)&&c.isContinuous(r.x)){if(c.isFieldDef(r.y)&&c.isContinuous(r.y)){if(void 0===r.x.aggregate&&r.y.aggregate===n.BOXPLOT)return"vertical";if(void 0===r.y.aggregate&&r.x.aggregate===n.BOXPLOT)return"horizontal";if(r.x.aggregate===n.BOXPLOT&&r.y.aggregate===n.BOXPLOT)throw new Error("Both x and y cannot have aggregate");return f(t)&&t.orient?t.orient:"vertical"}return"horizontal"}if(c.isFieldDef(r.y)&&c.isContinuous(r.y))return"vertical";throw new Error("Need a valid continuous axis for boxplots")}(e),g),S=O.transform,_=O.continuousAxisChannelDef,b=O.continuousAxis,E=O.encodingWithoutContinuousAxis,w=(E.color,E.size),A=i(E,["color","size"]),C=w?{size:w}:l.getMarkSpecificConfigMixins(t.box,"size"),M={};return _.scale&&(M.scale=_.scale),_.axis&&(M.axis=_.axis),r({},h,{transform:S,layer:[{mark:{type:"rule",style:"boxWhisker"},encoding:r((m={},m[b]=r({field:"lower_whisker_"+_.field,type:_.type},M),m[b+"2"]={field:"lower_box_"+_.field,type:_.type},m),A,l.getMarkSpecificConfigMixins(t.boxWhisker,"color"))},{mark:{type:"rule",style:"boxWhisker"},encoding:r((v={},v[b]={field:"upper_box_"+_.field,type:_.type},v[b+"2"]={field:"upper_whisker_"+_.field,type:_.type},v),A,l.getMarkSpecificConfigMixins(t.boxWhisker,"color"))},r({},d?{selection:d}:{},{mark:{type:"bar",style:"box"},encoding:r((y={},y[b]={field:"lower_box_"+_.field,type:_.type},y[b+"2"]={field:"upper_box_"+_.field,type:_.type},y),E,E.color?{}:l.getMarkSpecificConfigMixins(t.box,"color"),C)}),{mark:{type:"tick",style:"boxMid"},encoding:r((T={},T[b]={field:"mid_box_"+_.field,type:_.type},T),A,l.getMarkSpecificConfigMixins(t.boxMid,"color"),C)}]})}},{"../encoding":17,"./../encoding":17,"./../fielddef":18,"./../log":19,"./common":13,"vega-util":28}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getMarkSpecificConfigMixins=function(e,t){var n,r=e[t];return void 0!==r?((n={})[t]={value:r},n):{}}},{}],14:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(n,"__esModule",{value:!0}),n.ERRORBAR="error-bar",n.normalizeErrorBar=function(e){e.mark,e.selection,e.projection;var t=e.encoding,n=i(e,["mark","selection","projection","encoding"]),o=(t.size,i(t,["size"])),a=(t.x2,t.y2,i(t,["x2","y2"])),u=(a.x,a.y,i(a,["x","y"]));if(!t.x2&&!t.y2)throw new Error("Neither x2 or y2 provided");return r({},n,{layer:[{mark:"rule",encoding:o},{mark:"tick",encoding:a},{mark:"tick",encoding:t.x2?r({x:t.x2,y:t.y},u):r({x:t.x,y:t.y2},u)}]})}},{}],15:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(n,"__esModule",{value:!0});var i=e("./../mark"),o=e("./boxplot"),a=e("./errorbar"),u={};function c(e,t){u[e]=t}n.add=c,n.remove=function(e){delete u[e]},n.COMPOSITE_MARK_STYLES=o.BOXPLOT_STYLES,n.VL_ONLY_COMPOSITE_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX=r({},o.VL_ONLY_BOXPLOT_CONFIG_PROPERTY_INDEX),c(o.BOXPLOT,o.normalizeBoxPlot),c(a.ERRORBAR,a.normalizeErrorBar),n.normalize=function(e,t){var n=i.isMarkDef(e.mark)?e.mark.type:e.mark,r=u[n];if(r)return r(e,t);throw new Error("Unregistered composite mark "+n)}},{"./../mark":21,"./boxplot":12,"./errorbar":14}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./log"),i=e("./util"),o=2006;n.isDateTime=function(e){return!(!e||!(e.year||e.quarter||e.month||e.date||e.day||e.hours||e.minutes||e.seconds||e.milliseconds))},n.MONTHS=["january","february","march","april","may","june","july","august","september","october","november","december"],n.SHORT_MONTHS=n.MONTHS.map(function(e){return e.substr(0,3)}),n.DAYS=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],n.SHORT_DAYS=n.DAYS.map(function(e){return e.substr(0,3)}),n.dateTimeExpr=function(e,t){void 0===t&&(t=!1);var a=[];if(t&&void 0!==e.day&&i.keys(e).length>1&&(r.warn(r.message.droppedDay(e)),delete(e=i.duplicate(e)).day),void 0!==e.year?a.push(e.year):void 0!==e.day?a.push(o):a.push(0),void 0!==e.month){var u=t?function(e){if(i.isNumber(e))return e-1+"";var t=e.toLowerCase(),o=n.MONTHS.indexOf(t);if(-1!==o)return o+"";var a=t.substr(0,3),u=n.SHORT_MONTHS.indexOf(a);if(-1!==u)return u+"";throw new Error(r.message.invalidTimeUnit("month",e))}(e.month):e.month;a.push(u)}else if(void 0!==e.quarter){var c=t?function(e){if(i.isNumber(e))return e>4&&r.warn(r.message.invalidTimeUnit("quarter",e)),e-1+"";throw new Error(r.message.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;a.push(c+"*3")}else a.push(0);if(void 0!==e.date)a.push(e.date);else if(void 0!==e.day){var s=t?function(e){if(i.isNumber(e))return e%7+"";var t=e.toLowerCase(),o=n.DAYS.indexOf(t);if(-1!==o)return o+"";var a=t.substr(0,3),u=n.SHORT_DAYS.indexOf(a);if(-1!==u)return u+"";throw new Error(r.message.invalidTimeUnit("day",e))}(e.day):e.day;a.push(s+"+1")}else a.push(1);for(var l=0,f=["hours","minutes","seconds","milliseconds"];l<f.length;l++){var d=f[l];void 0!==e[d]?a.push(e[d]):a.push(0)}return e.utc?"utc("+a.join(", ")+")":"datetime("+a.join(", ")+")"}},{"./log":19,"./util":27}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./channel"),i=e("./fielddef"),o=e("./log"),a=e("./util");function u(e,t){var n=e&&e[t];return!!n&&(a.isArray(n)?a.some(n,function(e){return!!e.field}):i.isFieldDef(n)||i.hasConditionalFieldDef(n))}n.channelHasField=u,n.isAggregate=function(e){return a.some(r.CHANNELS,function(t){if(u(e,t)){var n=e[t];if(a.isArray(n))return a.some(n,function(e){return!!e.aggregate});var r=i.getFieldDef(n);return r&&!!r.aggregate}return!1})},n.normalizeEncoding=function(e,t){return a.keys(e).reduce(function(n,u){if(!r.supportMark(u,t))return o.warn(o.message.incompatibleChannel(u,t)),n;if("size"===u&&"line"===t){var c=i.getFieldDef(e[u]);if(c&&c.aggregate)return o.warn(o.message.incompatibleChannel(u,t,"when the field is aggregated.")),n}if("detail"===u||"order"===u)(s=e[u])&&(n[u]=(a.isArray(s)?s:[s]).reduce(function(e,t){return i.isFieldDef(t)?e.push(i.normalizeFieldDef(t,u)):o.warn(o.message.emptyFieldDef(t,u)),e},[]));else{var s=e[u];if(!i.isFieldDef(s)&&!i.isValueDef(s)&&!i.isConditionalDef(s))return o.warn(o.message.emptyFieldDef(s,u)),n;n[u]=i.normalize(s,u)}return n},{})},n.isRanged=function(e){return e&&(!!e.x&&!!e.x2||!!e.y&&!!e.y2)},n.fieldDefs=function(e){var t=[];return r.CHANNELS.forEach(function(n){if(u(e,n)){var r=e[n];(a.isArray(r)?r:[r]).forEach(function(e){i.isFieldDef(e)?t.push(e):i.hasConditionalFieldDef(e)&&t.push(e.condition)})}}),t},n.forEach=function(e,t,n){if(e)for(var r=function(r){a.isArray(e[r])?e[r].forEach(function(e){t.call(n,e,r)}):t.call(n,e[r],r)},i=0,o=a.keys(e);i<o.length;i++)r(o[i])},n.reduce=function(e,t,n,r){return e?a.keys(e).reduce(function(n,i){var o=e[i];return a.isArray(o)?o.reduce(function(e,n){return t.call(r,e,n,i)},n):t.call(r,n,o,i)},n):n}},{"./channel":11,"./fielddef":18,"./log":19,"./util":27}],18:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./aggregate"),a=e("./bin"),u=e("./channel"),c=e("./log"),s=e("./timeunit"),l=e("./type"),f=e("./util");function d(e){return!!e&&!!e.condition&&!f.isArray(e.condition)&&p(e.condition)}function p(e){return!(!e||!e.field&&"count"!==e.aggregate)}function h(e){return e&&"value"in e&&void 0!==e.value}function g(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return!!e.bin;case"latitude":case"longitude":case"temporal":return!1}throw new Error(c.message.invalidFieldType(e.type))}function m(e){return!g(e)}function v(e){return"count"===e.aggregate}function y(e,t){var n=e.field,r=e.bin,i=e.timeUnit,o=e.aggregate;return"count"===o?t.countTitle:r?n+" (binned)":i?n+" ("+s.getTimeUnitParts(i).join("-")+")":o?f.titlecase(o)+" of "+n:n}function T(e,t){var n=e.aggregate||e.timeUnit||e.bin&&"bin";return n?n.toUpperCase()+"("+e.field+")":e.field}n.isConditionalSelection=function(e){return e.selection},n.isRepeatRef=function(e){return e&&!f.isString(e)&&"repeat"in e},n.isConditionalDef=function(e){return!!e&&!!e.condition},n.hasConditionalFieldDef=d,n.hasConditionalValueDef=function(e){return!!e&&!!e.condition&&(f.isArray(e.condition)||h(e.condition))},n.isFieldDef=p,n.isStringFieldDef=function(e){return p(e)&&f.isString(e.field)},n.isValueDef=h,n.isScaleFieldDef=function(e){return!(!e||!e.scale&&!e.sort)},n.vgField=function(e,t){void 0===t&&(t={});var n=e.field,r=t.prefix,i=t.suffix;if(v(e))n="count_*";else{var o=void 0;t.nofn||(e.bin?(o=a.binToString(e.bin),i=t.binSuffix||""):e.aggregate?o=String(t.aggregate||e.aggregate):e.timeUnit&&(o=String(e.timeUnit))),o&&(n=o+"_"+n)}return i&&(n=n+"_"+i),r&&(n=r+"_"+n),t.expr&&(n=""+t.expr+f.accessPath(n)),n},n.isDiscrete=g,n.isContinuous=m,n.isCount=v,n.verbalTitleFormatter=y,n.functionalTitleFormatter=T,n.defaultTitleFormatter=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return T(e);default:return y(e,t)}};var O=n.defaultTitleFormatter;function S(e){O=e}function _(e,t){if(e.timeUnit)return"temporal";if(e.bin)return"quantitative";switch(u.rangeType(t)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}function b(e,t){if(e.aggregate&&!o.isAggregateOp(e.aggregate)){e.aggregate;var n=i(e,["aggregate"]);c.warn(c.message.invalidAggregate(e.aggregate)),e=n}if(e.timeUnit&&(e=r({},e,{timeUnit:s.normalizeTimeUnit(e.timeUnit)})),e.bin&&(e=r({},e,{bin:E(e.bin,t)})),e.type){var a=l.getFullName(e.type);e.type!==a&&(e=r({},e,{type:a})),"quantitative"!==e.type&&o.isCountingAggregateOp(e.aggregate)&&(c.warn(c.message.invalidFieldTypeForCountAggregate(e.type,e.aggregate)),e=r({},e,{type:"quantitative"}))}else{var u=_(e,t);c.warn(c.message.emptyOrInvalidFieldType(e.type,t,u)),e=r({},e,{type:u})}var f=A(e,t),d=f.compatible,p=f.warning;return d||c.warn(p),e}function E(e,t){return f.isBoolean(e)?{maxbins:a.autoMaxBins(t)}:e.maxbins||e.step?e:r({},e,{maxbins:a.autoMaxBins(t)})}n.setTitleFormatter=S,n.resetTitleFormatter=function(){S(n.defaultTitleFormatter)},n.title=function(e,t){return O(e,t)},n.defaultType=_,n.getFieldDef=function(e){return p(e)?e:d(e)?e.condition:void 0},n.normalize=function(e,t){if(f.isString(e)||f.isNumber(e)||f.isBoolean(e)){var n=f.isString(e)?"string":f.isNumber(e)?"number":"boolean";return c.warn(c.message.primitiveChannelDef(t,n,e)),{value:e}}return p(e)?b(e,t):d(e)?r({},e,{condition:b(e.condition,t)}):e},n.normalizeFieldDef=b,n.normalizeBin=E;var w={compatible:!0};function A(e,t){switch(t){case"row":case"column":return m(e)&&!e.timeUnit?{compatible:!1,warning:c.message.facetChannelShouldBeDiscrete(t)}:w;case"x":case"y":case"color":case"text":case"detail":case"tooltip":case"href":return w;case"opacity":case"size":case"x2":case"y2":return g(e)&&!e.bin?{compatible:!1,warning:"Channel "+t+" should not be used with discrete field."}:w;case"shape":return"nominal"!==e.type&&"geojson"!==e.type?{compatible:!1,warning:"Shape channel should be used with nominal data or geojson only"}:w;case"order":return"nominal"===e.type?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:w}throw new Error("channelCompatability not implemented for channel "+t)}n.channelCompatibility=A,n.isNumberFieldDef=function(e){return"quantitative"===e.type||!!e.bin},n.isTimeFieldDef=function(e){return"temporal"===e.type||!!e.timeUnit}},{"./aggregate":9,"./bin":10,"./channel":11,"./log":19,"./timeunit":25,"./type":26,"./util":27}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("vega-util"),i=e("./util"),o=r.logger(r.Warn),a=o,u=function(){function e(){this.warns=[],this.infos=[],this.debugs=[]}return e.prototype.level=function(){return this},e.prototype.warn=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.warns).push.apply(e,t),this},e.prototype.info=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.infos).push.apply(e,t),this},e.prototype.debug=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.debugs).push.apply(e,t),this},e}();function c(){return a=o}n.LocalLogger=u,n.wrap=function(e){return function(){a=new u,e(a),c()}},n.set=function(e){return a=e},n.reset=c,n.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a.warn.apply(a,arguments)},n.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a.info.apply(a,arguments)},n.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a.debug.apply(a,arguments)},function(e){e.INVALID_SPEC="Invalid spec",e.FIT_NON_SINGLE='Autosize "fit" only works for single views and layered views.',e.CANNOT_FIX_RANGE_STEP_WITH_FIT='Cannot use a fixed value of "rangeStep" when "autosize" is "fit".',e.cannotProjectOnChannelWithoutField=function(e){return'Cannot project a selection on encoding channel "'+e+'", which has no field.'},e.nearestNotSupportForContinuous=function(e){return'The "nearest" transform is not supported for '+e+" marks."},e.selectionNotFound=function(e){return'Cannot find a selection named "'+e+'"'},e.SCALE_BINDINGS_CONTINUOUS="Scale bindings are currently only supported for scales with unbinned, continuous domains.",e.noSuchRepeatedValue=function(e){return'Unknown repeated value "'+e+'".'},e.CONCAT_CANNOT_SHARE_AXIS="Axes cannot be shared in concatenated views.",e.REPEAT_CANNOT_SHARE_AXIS="Axes cannot be shared in repeated views.",e.cannotSetTitleAnchor=function(e){return'Cannot set title "anchor" for a '+e+" spec"},e.unrecognizedParse=function(e){return'Unrecognized parse "'+e+'".'},e.differentParse=function(e,t,n){return'An ancestor parsed field "'+e+'" as '+n+" but a child wants to parse the field as "+t+"."},e.invalidTransformIgnored=function(e){return"Ignoring an invalid transform: "+i.stringify(e)+"."},e.NO_FIELDS_NEEDS_AS='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the the data from the secondary source.',e.primitiveChannelDef=function(e,t,n){return"Channel "+e+" is a "+t+". Converted to {value: "+i.stringify(n)+"}."},e.invalidFieldType=function(e){return'Invalid field type "'+e+'"'},e.invalidFieldTypeForCountAggregate=function(e,t){return'Invalid field type "'+e+'" for aggregate: "'+t+'", using "quantitative" instead.'},e.invalidAggregate=function(e){return'Invalid aggregation operator "'+e+'"'},e.emptyOrInvalidFieldType=function(e,t,n){return'Invalid field type "'+e+'" for channel "'+t+'", using "'+n+'" instead.'},e.emptyFieldDef=function(e,t){return"Dropping "+i.stringify(e)+' from channel "'+t+'" since it does not contain data field or value.'},e.incompatibleChannel=function(e,t,n){return e+' dropped as it is incompatible with "'+t+'"'+(n?" when "+n:"")+"."},e.facetChannelShouldBeDiscrete=function(e){return e+" encoding should be discrete (ordinal / nominal / binned)."},e.discreteChannelCannotEncode=function(e,t){return'Using discrete channel "'+e+'" to encode "'+t+'" field can be misleading as it does not encode '+("ordinal"===t?"order":"magnitude")+"."},e.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL="Bar mark should not be used with point scale when rangeStep is null. Please use band scale instead.",e.unclearOrientContinuous=function(e){return'Cannot clearly determine orientation for "'+e+'" since both x and y channel encode continuous fields. In this case, we use vertical by default'},e.unclearOrientDiscreteOrEmpty=function(e){return'Cannot clearly determine orientation for "'+e+'" since both x and y channel encode discrete or empty fields.'},e.orientOverridden=function(e,t){return'Specified orient "'+e+'" overridden with "'+t+'"'},e.CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN="custom domain scale cannot be unioned with default field-based domain",e.cannotUseScalePropertyWithNonColor=function(e){return'Cannot use the scale property "'+e+'" with non-color channel.'},e.unaggregateDomainHasNoEffectForRawField=function(e){return"Using unaggregated domain with raw field has no effect ("+i.stringify(e)+")."},e.unaggregateDomainWithNonSharedDomainOp=function(e){return'Unaggregated domain not applicable for "'+e+'" since it produces values outside the origin domain of the source data.'},e.unaggregatedDomainWithLogScale=function(e){return"Unaggregated domain is currently unsupported for log scale ("+i.stringify(e)+")."},e.cannotUseSizeFieldWithBandSize=function(e){return"Using size field when "+e+"-channel has a band scale is not supported."},e.cannotApplySizeToNonOrientedMark=function(e){return'Cannot apply size to non-oriented mark "'+e+'".'},e.rangeStepDropped=function(e){return'rangeStep for "'+e+'" is dropped as top-level '+("x"===e?"width":"height")+" is provided."},e.scaleTypeNotWorkWithChannel=function(e,t,n){return'Channel "'+e+'" does not work with "'+t+'" scale. We are using "'+n+'" scale instead.'},e.scaleTypeNotWorkWithFieldDef=function(e,t){return'FieldDef does not work with "'+e+'" scale. We are using "'+t+'" scale instead.'},e.scalePropertyNotWorkWithScaleType=function(e,t,n){return n+"-scale's \""+t+'" is dropped as it does not work with '+e+" scale."},e.scaleTypeNotWorkWithMark=function(e,t){return'Scale type "'+t+'" does not work with mark "'+e+'".'},e.mergeConflictingProperty=function(e,t,n,r){return"Conflicting "+t+' property "'+e+'" ('+i.stringify(n)+" and "+i.stringify(r)+").  Using "+i.stringify(n)+"."},e.independentScaleMeansIndependentGuide=function(e){return'Setting the scale to be independent for "'+e+'" means we also have to set the guide (axis or legend) to be independent.'},e.conflictedDomain=function(e){return"Cannot set "+e+'-scale\'s "domain" as it is binned. Please use "bin"\'s "extent" instead.'},e.domainSortDropped=function(e){return"Dropping sort property "+i.stringify(e)+" as unioned domains only support boolean or op 'count'."},e.UNABLE_TO_MERGE_DOMAINS="Unable to merge domains",e.MORE_THAN_ONE_SORT="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",e.INVALID_CHANNEL_FOR_AXIS="Invalid channel for axis.",e.cannotStackRangedMark=function(e){return'Cannot stack "'+e+'" if there is already "'+e+'2"'},e.cannotStackNonLinearScale=function(e){return"Cannot stack non-linear scale ("+e+")"},e.stackNonSummativeAggregate=function(e){return'Stacking is applied even though the aggregate function is non-summative ("'+e+'")'},e.invalidTimeUnit=function(e,t){return"Invalid "+e+": "+i.stringify(t)},e.dayReplacedWithDate=function(e){return'Time unit "'+e+'" is not supported. We are replacing it with '+e.replace("day","date")+"."},e.droppedDay=function(e){return"Dropping day from datetime "+i.stringify(e)+" as day cannot be combined with other units."}}(n.message||(n.message={}))},{"./util":27,"vega-util":28}],20:[function(e,t,n){"use strict";function r(e){return!!e.or}function i(e){return!!e.and}function o(e){return!!e.not}Object.defineProperty(n,"__esModule",{value:!0}),n.isLogicalOr=r,n.isLogicalAnd=i,n.isLogicalNot=o,n.forEachLeave=function e(t,n){if(o(t))e(t.not,n);else if(i(t))for(var a=0,u=t.and;a<u.length;a++)e(u[a],n);else if(r(t))for(var c=0,s=t.or;c<s.length;c++)e(s[c],n);else n(t)},n.normalizeLogicalOperand=function e(t,n){return o(t)?{not:e(t.not,n)}:i(t)?{and:t.and.map(function(t){return e(t,n)})}:r(t)?{or:t.or.map(function(t){return e(t,n)})}:n(t)}},{}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,i,o=e("./util");(i=r=n.Mark||(n.Mark={})).AREA="area",i.BAR="bar",i.LINE="line",i.POINT="point",i.RECT="rect",i.RULE="rule",i.TEXT="text",i.TICK="tick",i.CIRCLE="circle",i.SQUARE="square",i.GEOSHAPE="geoshape",n.AREA=r.AREA,n.BAR=r.BAR,n.LINE=r.LINE,n.POINT=r.POINT,n.TEXT=r.TEXT,n.TICK=r.TICK,n.RECT=r.RECT,n.RULE=r.RULE,n.GEOSHAPE=r.GEOSHAPE,n.CIRCLE=r.CIRCLE,n.SQUARE=r.SQUARE;var a={area:1,bar:1,line:1,point:1,text:1,tick:1,rect:1,geoshape:1,rule:1,circle:1,square:1};function u(e){return e.type}n.isMark=function(e){return!!a[e]},n.PRIMITIVE_MARKS=o.flagKeys(a),n.isMarkDef=u;var c=o.toSet(n.PRIMITIVE_MARKS);n.isPrimitiveMark=function(e){return(u(e)?e.type:e)in c},n.STROKE_CONFIG=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity"],n.FILL_CONFIG=["fill","fillOpacity"],n.FILL_STROKE_CONFIG=[].concat(n.STROKE_CONFIG,n.FILL_CONFIG),n.VL_ONLY_MARK_CONFIG_PROPERTIES=["filled","color"],n.VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX={bar:["binSpacing","continuousBandSize","discreteBandSize"],text:["shortTimeLabels"],tick:["bandSize","thickness"]},n.defaultMarkConfig={color:"#4c78a8"},n.defaultBarConfig={binSpacing:1,continuousBandSize:5},n.defaultTickConfig={thickness:1}},{"./util":27}],22:[function(e,t,n){"use strict";var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(n,"__esModule",{value:!0});var i,o=e("./channel"),a=e("./log"),u=e("./util");(i=n.ScaleType||(n.ScaleType={})).LINEAR="linear",i.BIN_LINEAR="bin-linear",i.LOG="log",i.POW="pow",i.SQRT="sqrt",i.TIME="time",i.UTC="utc",i.SEQUENTIAL="sequential",i.QUANTILE="quantile",i.QUANTIZE="quantize",i.THRESHOLD="threshold",i.ORDINAL="ordinal",i.BIN_ORDINAL="bin-ordinal",i.POINT="point",i.BAND="band";var c={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric","bin-linear":"bin-linear",time:"time",utc:"time",sequential:"sequential",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position"};n.SCALE_TYPES=u.keys(c),n.scaleCompatible=function(e,t){var n=c[e],r=c[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n};var s={linear:0,log:1,pow:1,sqrt:1,time:0,utc:0,point:10,band:11,"bin-linear":0,sequential:0,ordinal:0,"bin-ordinal":0};n.scaleTypePrecedence=function(e){return s[e]},n.CONTINUOUS_TO_CONTINUOUS_SCALES=["linear","bin-linear","log","pow","sqrt","time","utc"];var l=u.toSet(n.CONTINUOUS_TO_CONTINUOUS_SCALES);n.CONTINUOUS_DOMAIN_SCALES=n.CONTINUOUS_TO_CONTINUOUS_SCALES.concat(["sequential"]);var f=u.toSet(n.CONTINUOUS_DOMAIN_SCALES);n.DISCRETE_DOMAIN_SCALES=["ordinal","bin-ordinal","point","band"];var d=u.toSet(n.DISCRETE_DOMAIN_SCALES),p=u.toSet(["bin-linear","bin-ordinal"]);function h(e){return e in f}function g(e){return e in l}n.TIME_SCALE_TYPES=["time","utc"],n.hasDiscreteDomain=function(e){return e in d},n.isBinScale=function(e){return e in p},n.hasContinuousDomain=h,n.isContinuousToContinuous=g,n.defaultScaleConfig={textXRangeStep:90,rangeStep:21,pointPadding:.5,bandPaddingInner:.1,facetSpacing:16,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4},n.isExtendedScheme=function(e){return e&&!!e.name},n.isSelectionDomain=function(e){return e&&e.selection};var m={type:1,domain:1,range:1,rangeStep:1,scheme:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1};n.SCALE_PROPERTIES=u.flagKeys(m);var v=r(m,["type","domain","range","rangeStep","scheme"]);n.NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES=u.flagKeys(v),n.scaleTypeSupportProperty=function(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":return u.contains(["sequential","ordinal","bin-ordinal","quantile","quantize"],e);case"interpolate":return u.contains(["linear","bin-linear","pow","log","sqrt","utc","time"],e);case"round":return g(e)||"band"===e||"point"===e;case"padding":return g(e)||u.contains(["point","band"],e);case"paddingOuter":case"rangeStep":return u.contains(["point","band"],e);case"paddingInner":return"band"===e;case"clamp":return g(e)||"sequential"===e;case"nice":return g(e)||"sequential"===e||"quantize"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"zero":return h(e)&&!u.contains(["log","time","utc","bin-linear","threshold","quantile"],e)}throw new Error("Invalid scale property "+t+".")},n.channelScalePropertyIncompatability=function(e,t){switch(t){case"interpolate":case"scheme":return"color"!==e?a.message.cannotUseScalePropertyWithNonColor(e):void 0;case"type":case"domain":case"range":case"base":case"exponent":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeStep":case"reverse":case"round":case"clamp":case"zero":return}throw new Error('Invalid scale property "'+t+'".')},n.channelSupportScaleType=function(e,t){switch(e){case o.Channel.X:case o.Channel.Y:case o.Channel.SIZE:case o.Channel.OPACITY:return g(t)||u.contains(["band","point"],t);case o.Channel.COLOR:return"band"!==t;case o.Channel.SHAPE:return"ordinal"===t}return!1}},{"./channel":11,"./log":19,"./util":27}],23:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(n,"__esModule",{value:!0});var o=e("./channel"),a=e("./compositemark"),u=e("./encoding"),c=e("./encoding"),s=e("./log"),l=e("./mark"),f=e("./stack"),d=e("./util");function p(e){return void 0!==e.facet}function h(e){return!!e.mark}function g(e){return void 0!==e.layer}function m(e){return void 0!==e.repeat}function v(e){return y(e)||T(e)}function y(e){return void 0!==e.vconcat}function T(e){return void 0!==e.hconcat}function O(e,t){if(p(e))return a=t,c=(n=e).spec,l=i(n,["spec"]),r({},l,{spec:O(c,a)});var n,a,c,l,f,d,v,_,b,E,w,A,C,M,N,x,D,U,I,P,L,F,R,k,j,H,Y,q;if(g(e))return function e(t,n){var o=t.layer,a=i(t,["layer"]);return r({},a,{layer:o.map(function(t){return g(t)?e(t,n):S(t,n)})})}(e,t);if(m(e))return d=t,v=(f=e).spec,_=i(f,["spec"]),r({},_,{spec:O(v,d)});if(y(e))return E=t,w=(b=e).vconcat,A=i(b,["vconcat"]),r({},A,{vconcat:w.map(function(e){return O(e,E)})});if(T(e))return M=t,N=(C=e).hconcat,x=i(C,["hconcat"]),r({},x,{hconcat:N.map(function(e){return O(e,M)})});if(h(e)){var z=u.channelHasField(e.encoding,o.ROW),B=u.channelHasField(e.encoding,o.COLUMN);return z||B?(U=t,I=(D=e).encoding,P=I.row,L=I.column,F=i(I,["row","column"]),R=D.mark,k=D.width,j=D.projection,H=D.height,Y=D.selection,D.encoding,q=i(D,["mark","width","projection","height","selection","encoding"]),r({},q,{facet:r({},P?{row:P}:{},L?{column:L}:{}),spec:S(r({},j?{projection:j}:{},{mark:R},k?{width:k}:{},H?{height:H}:{},{encoding:F},Y?{selection:Y}:{}),U)})):S(e,t)}throw new Error(s.message.INVALID_SPEC)}function S(e,t){if(p=e,l.isPrimitiveMark(p.mark)){if(u.isRanged(e.encoding))return function(e){var t=u.channelHasField(e.encoding,o.X),n=u.channelHasField(e.encoding,o.Y),r=u.channelHasField(e.encoding,o.X2),i=u.channelHasField(e.encoding,o.Y2);if(r&&!t||i&&!n){var a=d.duplicate(e);return r&&!t&&(a.encoding.x=a.encoding.x2,delete a.encoding.x2),i&&!n&&(a.encoding.y=a.encoding.y2,delete a.encoding.y2),a}return e}(e);var n=t&&t.overlay,c=n&&e.mark===l.AREA&&d.contains(["linepoint","line"],n.area),s=n&&(n.line&&e.mark===l.LINE||"linepoint"===n.area&&e.mark===l.AREA);return s||c?function(e,t,n,o){var a,u=e.mark,c=e.selection,s=e.projection,l=e.encoding,d=i(e,["mark","selection","projection","encoding"]),p=[{mark:u,encoding:l}],h=f.stack(u,l,o?o.stack:void 0),g=l;if(h){var m=h.fieldChannel,v=h.offset;g=r({},l,((a={})[m]=r({},l[m],v?{stack:v}:{}),a))}n&&p.push(r({},s?{projection:s}:{},{mark:{type:"line",style:"lineOverlay"}},c?{selection:c}:{},{encoding:g}));t&&p.push(r({},s?{projection:s}:{},{mark:{type:"point",filled:!0,style:"pointOverlay"}},c?{selection:c}:{},{encoding:g}));return r({},d,{layer:p})}(e,s,c,t):e}return a.normalize(e,t);var p}function _(e,t){return t.forEach(function(t){var n=["field","type","value","timeUnit","bin","aggregate"].reduce(function(e,n){return void 0!==t[n]&&(e[n]=t[n]),e},{}),r=d.hash(n);e[r]=e[r]||t}),e}n.isFacetSpec=p,n.isUnitSpec=h,n.isLayerSpec=g,n.isRepeatSpec=m,n.isConcatSpec=v,n.isVConcatSpec=y,n.isHConcatSpec=T,n.normalize=O,n.fieldDefs=function(e){return d.vals(function e(t,n){return void 0===n&&(n={}),g(t)?t.layer.forEach(function(t){h(t)?_(n,c.fieldDefs(t.encoding)):e(t,n)}):p(t)?(_(n,c.fieldDefs(t.facet)),e(t.spec,n)):m(t)?e(t.spec,n):v(t)?(y(t)?t.vconcat:t.hconcat).forEach(function(t){return e(t,n)}):_(n,c.fieldDefs(t.encoding)),n}(e))},n.isStacked=function(e,t){return t=t||e.config,!!l.isPrimitiveMark(e.mark)&&null!==f.stack(e.mark,e.encoding,t?t.stack:void 0)}},{"./channel":11,"./compositemark":15,"./encoding":17,"./log":19,"./mark":21,"./stack":24,"./util":27}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("./aggregate"),i=e("./channel"),o=e("./encoding"),a=e("./fielddef"),u=e("./log"),c=e("./mark"),s=e("./scale"),l=e("./util"),f={zero:1,center:1,normalize:1};function d(e){return!!f[e]}n.isStackOffset=d,n.STACKABLE_MARKS=[c.BAR,c.AREA,c.RULE,c.POINT,c.CIRCLE,c.SQUARE,c.LINE,c.TEXT,c.TICK],n.STACK_BY_DEFAULT_MARKS=[c.BAR,c.AREA],n.stack=function(e,t,f){var p=c.isMarkDef(e)?e.type:e;if(!l.contains(n.STACKABLE_MARKS,p))return null;var h=function(e){var t=e.x,n=e.y;if(a.isFieldDef(t)&&a.isFieldDef(n))if("quantitative"===t.type&&"quantitative"===n.type){if(t.stack)return"x";if(n.stack)return"y";if(!!t.aggregate!=!!n.aggregate)return t.aggregate?"x":"y"}else{if("quantitative"===t.type)return"x";if("quantitative"===n.type)return"y"}else{if(a.isFieldDef(t)&&"quantitative"===t.type)return"x";if(a.isFieldDef(n)&&"quantitative"===n.type)return"y"}}(t);if(!h)return null;var g=t[h],m=a.isStringFieldDef(g)?a.vgField(g,{}):void 0,v="x"===h?"y":"x",y=t[v],T=a.isStringFieldDef(y)?a.vgField(y,{}):void 0,O=i.NONPOSITION_CHANNELS.reduce(function(e,n){if(o.channelHasField(t,n)){var r=t[n];(l.isArray(r)?r:[r]).forEach(function(t){var r=a.getFieldDef(t);if(!r.aggregate){var i=a.isStringFieldDef(r)?a.vgField(r,{}):void 0;(!i||i!==T&&i!==m)&&e.push({channel:n,fieldDef:r})}})}return e},[]);if(0===O.length)return null;var S=void 0;return(S=void 0!==g.stack?g.stack:l.contains(n.STACK_BY_DEFAULT_MARKS,p)&&void 0===f?"zero":f)&&d(S)?g.scale&&g.scale.type&&g.scale.type!==s.ScaleType.LINEAR?(u.warn(u.message.cannotStackNonLinearScale(g.scale.type)),null):o.channelHasField(t,h===i.X?i.X2:i.Y2)?(u.warn(u.message.cannotStackRangedMark(h)),null):(g.aggregate&&!l.contains(r.SUM_OPS,g.aggregate)&&u.warn(u.message.stackNonSummativeAggregate(g.aggregate)),{groupbyChannel:y?v:void 0,fieldChannel:h,impute:l.contains(["area","line"],p),stackBy:O,offset:S}):null}},{"./aggregate":9,"./channel":11,"./encoding":17,"./fielddef":18,"./log":19,"./mark":21,"./scale":22,"./util":27}],25:[function(e,t,n){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(n,"__esModule",{value:!0});var i,o,a=e("./datetime"),u=e("./log"),c=e("./util");(o=i=n.TimeUnit||(n.TimeUnit={})).YEAR="year",o.MONTH="month",o.DAY="day",o.DATE="date",o.HOURS="hours",o.MINUTES="minutes",o.SECONDS="seconds",o.MILLISECONDS="milliseconds",o.YEARMONTH="yearmonth",o.YEARMONTHDATE="yearmonthdate",o.YEARMONTHDATEHOURS="yearmonthdatehours",o.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes",o.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds",o.MONTHDATE="monthdate",o.HOURSMINUTES="hoursminutes",o.HOURSMINUTESSECONDS="hoursminutesseconds",o.MINUTESSECONDS="minutesseconds",o.SECONDSMILLISECONDS="secondsmilliseconds",o.QUARTER="quarter",o.YEARQUARTER="yearquarter",o.QUARTERMONTH="quartermonth",o.YEARQUARTERMONTH="yearquartermonth",o.UTCYEAR="utcyear",o.UTCMONTH="utcmonth",o.UTCDAY="utcday",o.UTCDATE="utcdate",o.UTCHOURS="utchours",o.UTCMINUTES="utcminutes",o.UTCSECONDS="utcseconds",o.UTCMILLISECONDS="utcmilliseconds",o.UTCYEARMONTH="utcyearmonth",o.UTCYEARMONTHDATE="utcyearmonthdate",o.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours",o.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes",o.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds",o.UTCMONTHDATE="utcmonthdate",o.UTCHOURSMINUTES="utchoursminutes",o.UTCHOURSMINUTESSECONDS="utchoursminutesseconds",o.UTCMINUTESSECONDS="utcminutesseconds",o.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds",o.UTCQUARTER="utcquarter",o.UTCYEARQUARTER="utcyearquarter",o.UTCQUARTERMONTH="utcquartermonth",o.UTCYEARQUARTERMONTH="utcyearquartermonth";var s={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};n.TIMEUNIT_PARTS=c.flagKeys(s),n.isLocalSingleTimeUnit=function(e){return!!s[e]};var l={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1};n.isUtcSingleTimeUnit=function(e){return!!l[e]};var f={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1},d=r({},l,f);function p(e){return!!d[e]}n.isUTCTimeUnit=p,n.getLocalTimeUnit=function(e){return e.substr(3)};var h=r({},s,l,{yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1},f);n.TIMEUNITS=c.flagKeys(h),n.isTimeUnit=function(e){return!!h[e]};var g={year:"setFullYear",month:"setMonth",date:"setDate",hours:"setHours",minutes:"setMinutes",seconds:"setSeconds",milliseconds:"setMilliseconds",quarter:null,day:null};function m(e,t){var n=g[e];return{setDateMethod:t?"setUTC"+n.substr(3):n,getDateMethod:"get"+(t?"UTC":"")+n.substr(3)}}function v(e,t){var n=e.indexOf(t);return n>-1&&(t!==i.SECONDS||0===n||"i"!==e.charAt(n-1))}n.convert=function(e,t){for(var r=p(e),o=r?new Date(Date.UTC(0,0,1,0,0,0,0)):new Date(0,0,1,0,0,0,0),a=0,u=n.TIMEUNIT_PARTS;a<u.length;a++){var c=u[a];if(v(e,c))switch(c){case i.DAY:throw new Error("Cannot convert to TimeUnits containing 'day'");case i.QUARTER:var s=m("month",r),l=s.getDateMethod;o[s.setDateMethod](3*Math.floor(t[l]()/3));break;default:var f=m(c,r),d=f.getDateMethod;o[f.setDateMethod](t[d]())}}return o},n.getTimeUnitParts=function(e){return n.TIMEUNIT_PARTS.reduce(function(t,n){return v(e,n)?t.concat(n):t},[])},n.containsTimeUnit=v,n.fieldExpr=function(e,t){var r="datum"+c.accessPath(t),o=p(e)?"utc":"",u=n.TIMEUNIT_PARTS.reduce(function(t,n){var a;return v(e,n)&&(t[n]=(a=n)===i.QUARTER?"("+o+"quarter("+r+")-1)":""+o+a+"("+r+")"),t},{});return a.dateTimeExpr(u)},n.formatExpression=function(e,t,n,r){if(e){var o=[],a="",u=v(e,i.YEAR);v(e,i.QUARTER)&&(a="'Q' + quarter("+t+")"),v(e,i.MONTH)&&o.push(!1!==n?"%b":"%B"),v(e,i.DAY)?o.push(n?"%a":"%A"):v(e,i.DATE)&&o.push("%d"+(u?",":"")),u&&o.push(n?"%y":"%Y");var c=[];v(e,i.HOURS)&&c.push("%H"),v(e,i.MINUTES)&&c.push("%M"),v(e,i.SECONDS)&&c.push("%S"),v(e,i.MILLISECONDS)&&c.push("%L");var s=[];return o.length>0&&s.push(o.join(" ")),c.length>0&&s.push(c.join(":")),s.length>0&&(a&&(a+=" + ' ' + "),a+=r?"utcFormat("+t+", '"+s.join(" ")+"')":"timeFormat("+t+", '"+s.join(" ")+"')"),a||void 0}},n.normalizeTimeUnit=function(e){return"day"!==e&&e.indexOf("day")>=0?(u.warn(u.message.dayReplacedWithDate(e)),e.replace("day","date")):e}},{"./datetime":16,"./log":19,"./util":27}],26:[function(e,t,n){"use strict";var r,i;Object.defineProperty(n,"__esModule",{value:!0}),(i=r=n.Type||(n.Type={})).QUANTITATIVE="quantitative",i.ORDINAL="ordinal",i.TEMPORAL="temporal",i.NOMINAL="nominal",i.LATITUDE="latitude",i.LONGITUDE="longitude",i.GEOJSON="geojson";var o={quantitative:1,ordinal:1,temporal:1,nominal:1,latitude:1,longitude:1,geojson:1};n.isType=function(e){return!!o[e]},n.QUANTITATIVE=r.QUANTITATIVE,n.ORDINAL=r.ORDINAL,n.TEMPORAL=r.TEMPORAL,n.NOMINAL=r.NOMINAL,n.LATITUDE=r.LATITUDE,n.LONGITUDE=r.LONGITUDE,n.GEOJSON=r.GEOJSON,n.getFullName=function(e){if(e)switch(e=e.toLowerCase()){case"q":case n.QUANTITATIVE:return"quantitative";case"t":case n.TEMPORAL:return"temporal";case"o":case n.ORDINAL:return"ordinal";case"n":case n.NOMINAL:return"nominal";case n.LATITUDE:return"latitude";case n.LONGITUDE:return"longitude";case n.GEOJSON:return"geojson"}}},{}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("json-stable-stringify"),i=e("vega-util"),o=e("./logical"),a=e("vega-util");function u(e,t){return e.indexOf(t)>-1}function c(e,t){return e.filter(function(e){return!u(t,e)})}function s(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){e=l(e,i[r])}return e}function l(e,t){if("object"!=typeof t||null===t)return e;for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&("object"!=typeof t[n]||i.isArray(t[n])||null===t[n]?e[n]=t[n]:"object"!=typeof e[n]||null===e[n]?e[n]=s(i.isArray(t[n].constructor)?[]:{},t[n]):s(e[n],t[n]));return e}function f(e){return JSON.parse(JSON.stringify(e))}n.isArray=a.isArray,n.isObject=a.isObject,n.isNumber=a.isNumber,n.isString=a.isString,n.truncate=a.truncate,n.toSet=a.toSet,n.stringValue=a.stringValue,n.splitAccessPath=a.splitAccessPath,n.pick=function(e,t){for(var n={},r=0,i=t;r<i.length;r++){var o=i[r];e.hasOwnProperty(o)&&(n[o]=e[o])}return n},n.omit=function(e,t){for(var n=f(e),r=0,i=t;r<i.length;r++)delete n[i[r]];return n},n.stringify=r,n.hash=function(e){if(i.isNumber(e))return e;var t=i.isString(e)?e:r(e);if(t.length<100)return t;for(var n=0,o=0;o<t.length;o++)n=(n<<5)-n+t.charCodeAt(o),n&=n;return n},n.contains=u,n.without=c,n.union=function(e,t){return e.concat(c(t,e))},n.some=function(e,t){for(var n=0,r=0;r<e.length;r++)if(t(e[r],r,n++))return!0;return!1},n.every=function(e,t){for(var n=0,r=0;r<e.length;r++)if(!t(e[r],r,n++))return!1;return!0},n.flatten=function(e){return[].concat.apply([],e)},n.mergeDeep=s,n.unique=function(e,t){for(var n,r=[],i={},o=0,a=e;o<a.length;o++){var u=a[o];(n=t(u))in i||(i[n]=1,r.push(u))}return r},n.differ=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t[n]&&e[n]&&t[n]!==e[n])return!0;return!1},n.hasIntersection=function(e,t){for(var n in e)if(n in t)return!0;return!1},n.isNumeric=function(e){return!isNaN(e)},n.differArray=function(e,t){if(e.length!==t.length)return!0;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(t[n]!==e[n])return!0;return!1},n.keys=Object.keys,n.vals=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},n.flagKeys=function(e){return n.keys(e)},n.duplicate=f,n.isBoolean=function(e){return!0===e||!1===e},n.varName=function(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t},n.logicalExpr=function e(t,n){return o.isLogicalNot(t)?"!("+e(t.not,n)+")":o.isLogicalAnd(t)?"("+t.and.map(function(t){return e(t,n)}).join(") && (")+")":o.isLogicalOr(t)?"("+t.or.map(function(t){return e(t,n)}).join(") || (")+")":n(t)},n.deleteNestedProperty=function(e,t){for(var r=!0;t.length>0&&r;){for(var i=e,o=0;o<t.length-1;o++)i=i[t[o]];delete i[t.pop()],0!==n.keys(i).length&&(r=!1)}},n.titlecase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},n.accessPath=function(e){return"["+i.splitAccessPath(e).map(i.stringValue).join("][")+"]"}},{"./logical":20,"json-stable-stringify":5,"vega-util":28}],28:[function(e,t,n){var r;r=this,function(e){"use strict";var t=function(e,t,n){return e.fields=t||[],e.fname=n,e};function n(e){return null==e?null:e.fields}var r=function(e){throw Error(e)},i=function(e){var t,n,i,o=[],a=null,u=0,c=e.length,s="";function l(){o.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<c;++n)if("\\"===(i=e[n]))s+=e.substring(t,n),t=++n;else if(i===a)l(),a=null,u=-1;else{if(a)continue;t===u&&'"'===i?(t=n+1,a=i):t===u&&"'"===i?(t=n+1,a=i):"."!==i||u?"["===i?(n>t&&l(),u=t=n+1):"]"===i&&(u||r("Access path missing open bracket: "+e),u>0&&l(),u=0,t=n+1):n>t?l():t=n+1}return u&&r("Access path missing closing bracket: "+e),a&&r("Access path missing closing quote: "+e),n>t&&(n++,l()),o},o=Array.isArray,a=function(e){return e===Object(e)},u=function(e){return"string"==typeof e};function c(e){return o(e)?"["+e.map(c)+"]":a(e)||u(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var s=function(e,n){var r=i(e),o="return _["+r.map(c).join("][")+"];";return t(Function("_",o),[e=1===r.length?r[0]:e],n||e)},l=[],f=s("id"),d=t(function(e){return e},l,"identity"),p=t(function(){return 0},l,"zero"),h=t(function(){return 1},l,"one"),g=t(function(){return!0},l,"true"),m=t(function(){return!1},l,"false");function v(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var y=function(e){return e[e.length-1]},T=function(e){return null==e||""===e?null:+e};function O(e){return function(t){return e*Math.exp(t)}}function S(e){return function(t){return Math.log(e*t)}}function _(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function b(e,t,n,r){var i=n(e[0]),o=n(y(e)),a=(o-i)*t;return[r(i-a),r(o-a)]}function E(e,t,n,r,i){var o=r(e[0]),a=r(y(e)),u=null!=t?r(t):(o+a)/2;return[i(u+(o-u)*n),i(u+(a-u)*n)]}var w=function(e){return null!=e?o(e)?e:[e]:[]},A=function(e){return"function"==typeof e},C={},M=function(e){return"[object Date]"===Object.prototype.toString.call(e)},N=function(e){return"number"==typeof e},x=function(e,t){for(var n="";--t>=0;)n+=e;return n};function D(e){return N(e)?e:M(e)?e:Date.parse(e)}e.accessor=t,e.accessorName=function(e){return null==e?null:e.fname},e.accessorFields=n,e.id=f,e.identity=d,e.zero=p,e.one=h,e.truthy=g,e.falsy=m,e.logger=function(e){var t=e||0;return{level:function(e){return arguments.length?(t=+e,this):t},error:function(){return t>=1&&v("error","ERROR",arguments),this},warn:function(){return t>=2&&v("warn","WARN",arguments),this},info:function(){return t>=3&&v("log","INFO",arguments),this},debug:function(){return t>=4&&v("log","DEBUG",arguments),this}}},e.None=0,e.Error=1,e.Warn=2,e.Info=3,e.Debug=4,e.panLinear=function(e,t){return b(e,t,T,d)},e.panLog=function(e,t){var n=Math.sign(e[0]);return b(e,t,S(n),O(n))},e.panPow=function(e,t,n){return b(e,t,_(n),_(1/n))},e.zoomLinear=function(e,t,n){return E(e,t,n,T,d)},e.zoomLog=function(e,t,n){var r=Math.sign(e[0]);return E(e,t,n,S(r),O(r))},e.zoomPow=function(e,t,n,r){return E(e,t,n,_(r),_(1/r))},e.array=w,e.compare=function(e,r){var o,a,u,s,l,f,d,p,h,g=[],m=(e=w(e)).map(function(e,t){return null==e?null:(g.push(t),A(e)?e:i(e).map(c).join("]["))}),v=g.length-1,y=w(r),T="var u,v;return ";if(v<0)return null;for(a=0;a<=v;++a)u=m[o=g[a]],A(u)?(s="(u=this."+(f="f"+o)+"(a))",l="(v=this."+f+"(b))",(d=d||{})[f]=u):(s="(u=a["+u+"])",l="(v=b["+u+"])"),f="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==y[o]?(h=1,p=-1):(h=-1,p=1),T+="("+s+"<"+l+"||u==null)&&v!=null?"+p+":(u>v||v==null)&&u!=null?"+h+":"+f+"!==u&&v===v?"+p+":v!==v&&u===u?"+h+(o<v?":":":0");return u=Function("a","b",T+";"),d&&(u=u.bind(d)),e=e.reduce(function(e,t){return A(t)?(n(t)||[]).forEach(function(t){e[t]=1}):null!=t&&(e[t+""]=1),e},{}),t(u,Object.keys(e))},e.constant=function(e){return A(e)?e:function(){return e}},e.debounce=function(e,t){var n,r;function i(){t(r),n=r=null}return function(t){r=t,n&&clearTimeout(n),n=setTimeout(i,e)}},e.error=r,e.extend=function(e){for(var t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r])e[n]=t[n];return e},e.extentIndex=function(e,t){var n,r,i,o,a,u=-1,c=e.length;if(null==t){for(;++u<c;)if(null!=(r=e[u])&&r>=r){n=i=r;break}for(o=a=u;++u<c;)null!=(r=e[u])&&(n>r&&(n=r,o=u),i<r&&(i=r,a=u))}else{for(;++u<c;)if(null!=(r=t(e[u],u,e))&&r>=r){n=i=r;break}for(o=a=u;++u<c;)null!=(r=t(e[u],u,e))&&(n>r&&(n=r,o=u),i<r&&(i=r,a=u))}return[o,a]},e.fastmap=function(e){var t,n,r={};function i(e){return r.hasOwnProperty(e)&&r[e]!==C}return t={size:0,empty:0,object:r,has:i,get:function(e){return i(e)?r[e]:void 0},set:function(e,n){return i(e)||(++t.size,r[e]===C&&--t.empty),r[e]=n,this},delete:function(e){return i(e)&&(--t.size,++t.empty,r[e]=C),this},clear:function(){t.size=t.empty=0,t.object=r={}},test:function(e){return arguments.length?(n=e,t):n},clean:function(){var e,i,o={},a=0;for(e in r)(i=r[e])===C||n&&n(i)||(o[e]=i,++a);t.size=a,t.empty=0,t.object=r=o}},e&&Object.keys(e).forEach(function(n){t.set(n,e[n])}),t},e.field=s,e.inherits=function(e,t){var n=e.prototype=Object.create(t.prototype);return n.constructor=e,n},e.isArray=o,e.isBoolean=function(e){return"boolean"==typeof e},e.isDate=M,e.isFunction=A,e.isNumber=N,e.isObject=a,e.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},e.isString=u,e.key=function(e,n){e&&(e=n?w(e).map(function(e){return e.replace(/\\(.)/g,"$1")}):w(e));var r=e&&e.length?Function("_","return ''+"+e.map(function(e){return"_["+(n?c(e):i(e).map(c).join("]["))+"]"}).join("+'|'+")+";"):function(){return""};return t(r,e,"key")},e.merge=function(e,t,n,r){var i=t.length,o=n.length;if(!o)return t;if(!i)return n;for(var a=r||new t.constructor(i+o),u=0,c=0,s=0;u<i&&c<o;++s)a[s]=e(t[u],n[c])>0?n[c++]:t[u++];for(;u<i;++u,++s)a[s]=t[u];for(;c<o;++c,++s)a[s]=n[c];return a},e.pad=function(e,t,n,r){var i=n||" ",o=e+"",a=t-o.length;return a<=0?o:"left"===r?x(i,a)+o:"center"===r?x(i,~~(a/2))+o+x(i,Math.ceil(a/2)):o+x(i,a)},e.peek=y,e.repeat=x,e.splitAccessPath=i,e.stringValue=c,e.toBoolean=function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)},e.toDate=function(e,t){return t=t||D,null==e||""===e?null:t(e)},e.toNumber=T,e.toString=function(e){return null==e||""===e?null:e+""},e.toSet=function(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t},e.truncate=function(e,t,n,r){var i=null!=r?r:"â¦",o=e+"",a=o.length,u=Math.max(0,t-i.length);return a<=t?o:"left"===n?i+o.slice(a-u):"center"===n?o.slice(0,Math.ceil(u/2))+i+o.slice(a-~~(u/2)):o.slice(0,u)+i},e.visitArray=function(e,t,n){if(e){var r,i=0,o=e.length;if(t)for(;i<o;++i)(r=t(e[i]))&&n(r,i,e);else e.forEach(n)}},Object.defineProperty(e,"__esModule",{value:!0})}("object"==typeof n&&void 0!==t?n:r.vega=r.vega||{})},{}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("d3-format"),i=e("d3-time"),o=e("d3-time-format"),a=e("vega-util");function u(e){return e%1==0?r.format(",")(e):r.format(",.2f")(e)}function c(e){var t=o.timeFormat(".%L"),n=o.timeFormat(":%S"),r=o.timeFormat("%I:%M"),a=o.timeFormat("%I %p"),u=o.timeFormat("%a %d"),c=o.timeFormat("%b %d"),s=o.timeFormat("%B"),l=o.timeFormat("%Y");return(i.timeSecond(e)<e?t:i.timeMinute(e)<e?n:i.timeHour(e)<e?r:i.timeDay(e)<e?a:i.timeMonth(e)<e?i.timeWeek(e)<e?u:c:i.timeYear(e)<e?s:l)(e)}n.customFormat=function(e,t,n){if(null!=e&&(t||n)){if(a.isString(n))switch(t){case"time":return n?o.timeFormat(n)(e):c(e);case"number":return n?r.format(n)(e):u(e);case"string":default:return e}return a.isFunction(n)?n(e):void 0}},n.autoFormat=function(e){return a.isNumber(e)?u(e):a.isDate(e)?c(e):e},n.autoNumberFormat=u,n.autoTimeFormat=c},{"d3-format":1,"d3-time":4,"d3-time-format":3,"vega-util":28}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("d3-selection"),i=e("./options"),o=e("./parseOption"),a=e("./supplementField"),u=e("./tooltipDisplay"),c=void 0,s=!1;function l(e,t){e.addEventListener("mouseover.tooltipInit",function(e,n){d(n)&&(f(),c=window.setTimeout(function(){!function(e,t,n){var i=u.getTooltipPlaceholder(),a=o.getTooltipData(t,n);if(!a||0===a.length)return;u.bindData(i,a),u.updatePosition(e,n),u.updateColorTheme(n),r.select("#vis-tooltip").style("visibility","visible"),s=!0,n.onAppear&&n.onAppear(e,t)}(e,n,t)},t.delay||i.DELAY))}),e.addEventListener("mousemove.tooltipUpdate",function(e,n){d(n)&&s&&function(e,t,n){if(!d(t))return;u.updatePosition(e,n),n.onMove&&n.onMove(e,t)}(e,n,t)}),e.addEventListener("mouseout.tooltipRemove",function(e,n){d(n)&&(f(),s&&function(e,t,n){if(!d(t))return;r.select("#vis-tooltip").style("visibility","hidden"),s=!1,u.clearData(),u.clearColorTheme(),u.clearPosition(),n.onDisappear&&n.onDisappear(e,t)}(e,n,t))})}function f(){window.clearTimeout(c),c=void 0}function d(e){return!(!e||!e.datum)&&!e.datum._facetID}function p(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}n.vega=function(e,t){return void 0===t&&(t={showAllFields:!0,isComposition:!1}),l(e,p(t)),{destroy:function(){e.removeEventListener("mouseover.tooltipInit"),e.removeEventListener("mousemove.tooltipUpdate"),e.removeEventListener("mouseout.tooltipRemove"),f()}}},n.vegaLite=function(e,t,n){return void 0===n&&(n={showAllFields:!0,isComposition:!1}),n=a.supplementOptions(p(n),t),l(e,p(n)),{destroy:function(){e.removeEventListener("mouseover.tooltipInit"),e.removeEventListener("mousemove.tooltipUpdate"),e.removeEventListener("mouseout.tooltipRemove"),f()}}}},{"./options":31,"./parseOption":32,"./supplementField":33,"./tooltipDisplay":34,"d3-selection":2}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.DELAY=100},{}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("vega-util"),i=e("./formatFieldValue");function o(e,t){void 0===t&&(t={});var n=[];return t.fields.forEach(function(o){var u=r.isString(o.title)?o.title:void 0,c=r.isFunction(o.title)?o.title:void 0,s=c&&c(e)||u||o.field,l=o.valueAccessor&&o.valueAccessor(e)||a(e,o.field,t.isComposition);if(void 0!==l){var f=i.customFormat(l,o.formatType,o.format)||i.autoFormat(l);n.push({title:s,value:f,rawValue:l,render:o.render})}}),n}function a(e,t,n){var r,i=t.split("."),o=i[0];return i.shift(),e[o]&&(r=e[o],i.forEach(function(e){(r=r)[e]&&(r=r[e])})),void 0===r?void(n||console.warn("[Tooltip] Cannot find field "+t+" in data.")):r}function u(e,t){void 0===t&&(t={});var n=[],r={};if(t&&t.fields)for(var o=0,a=t.fields;o<a.length;o++){var u=a[o];r[u.field]=u}for(var c in e)if(e.hasOwnProperty(c)){var s=e[c],l=void 0;l=r[c]&&r[c].title?r[c].title:c;var f=void 0,d=void 0;r[c]&&(f=r[c].formatType,d=r[c].format);var p=i.customFormat(s,f,d)||i.autoFormat(s);n.push({title:l,value:p,rawValue:s})}return n}function c(e,t){t.forEach(function(t){delete e[t]})}function s(e,t){t&&t.forEach(function(t){t.removeOriginalTemporalField&&c(e,[t.removeOriginalTemporalField])})}function l(e,t){if(t)return t.forEach(function(t){if(!0===t.bin){var n=t.field,r=n,i=n.concat("_mid"),o=n.concat("_end"),a=e[r],u=e[o];if(void 0!==a&&void 0!==u){var s=a+"-"+u;e[n]=s}c(e,[i,o])}}),e}function f(e,t){if("line"===e||"area"===e){var n=[];for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];r.isDate(o)&&n.push(i)}c(t,n)}}n.getTooltipData=function(e,t){if("group"!==e.mark.marktype){var n,i,a={};for(var d in e.datum)e.datum.hasOwnProperty(d)&&(a[d]=e.datum[d]);if(c(a,["width","height","count_start","count_end","layout_start","layout_mid","layout_end","layout_path","layout_x","layout_y"]),s(a,t.fields),l(a,t.fields),f(e.mark.marktype,a),n=!0===t.showAllFields?u(a,t):o(a,t),t.sort){var p="title"===t.sort?"title":"value"===t.sort?"rawValue":null,h=p?(i=p,function(e,t){return r.isNumber(e[i])&&r.isNumber(t[i])?t[i]-e[i]:r.isString(e[i])&&r.isString(t[i])?e[i].localeCompare(t[i]):r.isDate(e[i])&&r.isDate(t[i])?e[i]-t[i]:r.isDate(e[i])?-1:r.isDate(t[i])?1:r.isNumber(e[i])?-1:(r.isNumber(t[i]),1)}):r.isFunction(t.sort)&&t.sort;h&&(n=n.sort(h))}return n}},n.prepareCustomFieldsData=o,n.getValue=a,n.prepareAllFieldsData=u,n.removeFields=c,n.removeDuplicateTimeFields=s,n.combineBinFields=l,n.dropFieldsForLineArea=f},{"./formatFieldValue":29,"vega-util":28}],33:[function(e,t,n){(function(t){"use strict";var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(n,"__esModule",{value:!0});var i="undefined"!=typeof window?window.vl:void 0!==t?t.vl:null,o=e("vega-lite/build/src/spec"),a=e("vega-lite/build/src/type"),u={quantitative:"number",temporal:"time",ordinal:void 0,nominal:void 0};function c(e,t){if(t&&e&&!(e.length<=0))if(t.aggregate){for(var n=0,r=e;n<r.length;n++){if((c=r[n]).field===t.field&&c.aggregate===t.aggregate)return c}for(var i=0,o=e;i<o.length;i++){if((c=o[i]).field===t.field&&!c.aggregate)return c}}else for(var a=0,u=e;a<u.length;a++){var c;if((c=u[a]).field===t.field)return c}}function s(e,t){if(t&&t.field&&e)for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i.field===t.field){if(!i.aggregate)return i;if(i.aggregate===t.aggregate||!t.aggregate)return i}}}function l(e,t,n){var o=r({},n.config);if(e||t){!e&&t&&(e={}),e&&!t&&(t={});var c={};if(t.bin&&(t.bin=i.fieldDef.normalizeBin(t.bin,void 0)),c.field=i.fieldDef.vgField(t)||e.field,t.type===a.TEMPORAL&&t.timeUnit){var s=t.field;c.removeOriginalTemporalField=s;for(var l=0,f=i.spec.fieldDefs(n);l<f.length;l++){var d=f[l];if(d.field===s&&!d.timeUnit){c.removeOriginalTemporalField=void 0;break}}}o.countTitle||(o.countTitle=i.config.defaultConfig.countTitle);var p=i.fieldDef.title(t,o);if("axis"in t&&t.axis&&t.axis.title&&(p=t.axis.title),"legend"in t&&t.legend&&t.legend.title&&(p=t.legend.title),c.title=e.title||p,c.formatType=e.formatType||u[t.type],e.format)c.format=e.format;else switch(c.formatType){case"time":c.format=t.timeUnit?i.timeUnit.formatExpression(t.timeUnit,"",!1,!1).split("'")[1]:o.timeFormat||i.config.defaultConfig.timeFormat;break;case"number":c.format=o.numberFormat}return t.bin&&(c.field=c.field.replace("_start","_range"),c.bin=!0,c.formatType="string"),c}console.error("[Tooltip] Cannot supplement a field when field and fieldDef are both empty.")}n.supplementOptions=function(e,t){var n,r=[];return t=o.normalize(t,{}),!1!==e.showAllFields?i.spec.fieldDefs(t).forEach(function(n){var i=l(c(e.fields,n),n,t);r.push(i)}):e.fields&&e.fields.forEach(function(e){var n=l(e,s(i.spec.fieldDefs(t),e),t);r.push(n)}),n=t,(o.isConcatSpec(n)||o.isFacetSpec(n)||o.isLayerSpec(n)||o.isRepeatSpec(n))&&(e.isComposition=!0),e.fields=r,e},n.getFieldOption=c,n.getFieldDef=s,n.supplementFieldOption=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"vega-lite/build/src/spec":23,"vega-lite/build/src/type":26}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e("d3-selection");function i(){r.select("#vis-tooltip").classed("dark-theme light-theme",!1)}n.getTooltipPlaceholder=function(){return r.select("#vis-tooltip").empty()?r.select("body").append("div").attr("id","vis-tooltip").attr("class","vg-tooltip"):r.select("#vis-tooltip")},n.bindData=function(e,t){e.selectAll("table").remove();var n=e.append("table").selectAll(".tooltip-row").data(t);n.exit().remove(),n.enter().append("tr").attr("class","tooltip-row").each(function(e){var t=r.select(this);e.render?t.append("td").attr("colspan","2").append(function(){return e.render(e.title,e.value)}):(t.append("td").attr("class","key").text(function(e){return e.title+":"}),t.append("td").attr("class","value").text(function(e){return e.value}))})},n.clearData=function(){r.select("#vis-tooltip").selectAll(".tooltip-row").data([]).exit().remove()},n.updatePosition=function(e,t){var n=10,i=10;t&&t.offset&&void 0!==t.offset.x&&null!==t.offset.x&&(n=t.offset.x),t&&t.offset&&void 0!==t.offset.y&&null!==t.offset.y&&(i=t.offset.y),r.select("#vis-tooltip").style("top",function(){var t=this.getBoundingClientRect().height;return e.clientY+t+i<window.innerHeight?e.clientY+i+"px":e.clientY-t-i+"px"}).style("left",function(){var t=this.getBoundingClientRect().width;return e.clientX+t+n<window.innerWidth?e.clientX+n+"px":e.clientX-t-n+"px"})},n.clearPosition=function(){r.select("#vis-tooltip").style("top","-9999px").style("left","-9999px")},n.updateColorTheme=function(e){i(),e&&"dark"===e.colorTheme?r.select("#vis-tooltip").classed("dark-theme",!0):r.select("#vis-tooltip").classed("light-theme",!0)},n.clearColorTheme=i},{"d3-selection":2}]},{},[30])(30)});