!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.topojson=n.topojson||{})}(this,function(n){"use strict";function t(){}function e(n){if(!n)return t;var e,r,o=n.scale[0],i=n.scale[1],a=n.translate[0],u=n.translate[1];return function(n,t){t||(e=r=0),n[0]=(e+=n[0])*o+a,n[1]=(r+=n[1])*i+u}}function r(n,t){for(var e=0,r=n.length;e<r;){var o=e+r>>>1;n[o]<t?e=o+1:r=o}return e}function o(n,t){var e={type:"Feature",id:t.id,properties:t.properties||{},geometry:i(n,t)};return null==t.id&&delete e.id,e}function i(n,t){var r=e(n.transform),o=n.arcs;function i(n,t){t.length&&t.pop();for(var e,i=o[n<0?~n:n],a=0,u=i.length;a<u;++a)t.push(e=i[a].slice()),r(e,a);n<0&&function(n,t){for(var e,r=n.length,o=r-t;o<--r;)e=n[o],n[o++]=n[r],n[r]=e}(t,u)}function a(n){return n=n.slice(),r(n,0),n}function u(n){for(var t=[],e=0,r=n.length;e<r;++e)i(n[e],t);return t.length<2&&t.push(t[0].slice()),t}function f(n){for(var t=u(n);t.length<4;)t.push(t[0].slice());return t}function c(n){return n.map(f)}var s={Point:function(n){return a(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(a)},LineString:function(n){return u(n.arcs)},MultiLineString:function(n){return n.arcs.map(u)},Polygon:function(n){return c(n.arcs)},MultiPolygon:function(n){return n.arcs.map(c)}};return function n(t){var e=t.type;return"GeometryCollection"===e?{type:e,geometries:t.geometries.map(n)}:e in s?{type:e,coordinates:s[e](t)}:null}(t)}function a(n,t){var e={},r={},o={},i=[],a=-1;function u(n,t){for(var r in n){var o=n[r];delete t[o.start],delete o.start,delete o.end,o.forEach(function(n){e[n<0?~n:n]=1}),i.push(o)}}return t.forEach(function(e,r){var o,i=n.arcs[e<0?~e:e];i.length<3&&!i[1][0]&&!i[1][1]&&(o=t[++a],t[a]=e,t[r]=o)}),t.forEach(function(t){var e,i,a=function(t){var e,r=n.arcs[t<0?~t:t],o=r[0];n.transform?(e=[0,0],r.forEach(function(n){e[0]+=n[0],e[1]+=n[1]})):e=r[r.length-1];return t<0?[e,o]:[o,e]}(t),u=a[0],f=a[1];if(e=o[u])if(delete o[e.end],e.push(t),e.end=f,i=r[f]){delete r[i.start];var c=i===e?e:e.concat(i);r[c.start=e.start]=o[c.end=i.end]=c}else r[e.start]=o[e.end]=e;else if(e=r[f])if(delete r[e.start],e.unshift(t),e.start=u,i=o[u]){delete o[i.end];var s=i===e?e:i.concat(e);r[s.start=i.start]=o[s.end=e.end]=s}else r[e.start]=o[e.end]=e;else r[(e=[t]).start=u]=o[e.end=f]=e}),u(o,r),u(r,o),t.forEach(function(n){e[n<0?~n:n]||i.push([n])}),i}function u(n,t,e){var r=[];function o(n){var t=n<0?~n:n;(c[t]||(c[t]=[])).push({i:n,g:f})}function i(n){n.forEach(o)}function u(n){n.forEach(i)}if(arguments.length>1){var f,c=[],s={LineString:i,MultiLineString:u,Polygon:u,MultiPolygon:function(n){n.forEach(u)}};!function n(t){"GeometryCollection"===t.type?t.geometries.forEach(n):t.type in s&&(f=t,s[t.type](t.arcs))}(t),c.forEach(arguments.length<3?function(n){r.push(n[0].i)}:function(n){e(n[0].g,n[n.length-1].g)&&r.push(n[0].i)})}else for(var l=0,h=n.arcs.length;l<h;++l)r.push(l);return{type:"MultiLineString",arcs:a(n,r)}}function f(n){var t=n[0],e=n[1],r=n[2];return Math.abs((t[0]-r[0])*(e[1]-t[1])-(t[0]-e[0])*(r[1]-t[1]))}function c(n,t){var e={},r=[],o=[];function u(n){n.forEach(function(t){t.forEach(function(t){(e[t=t<0?~t:t]||(e[t]=[])).push(n)})}),r.push(n)}function f(t){return Math.abs(function(n){for(var t,e=-1,r=n.length,o=n[r-1],i=0;++e<r;)t=o,o=n[e],i+=t[0]*o[1]-t[1]*o[0];return i/2}(i(n,{type:"Polygon",arcs:[t]}).coordinates[0]))}return t.forEach(function(n){"Polygon"===n.type?u(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(u)}),r.forEach(function(n){if(!n._){var t=[],r=[n];for(n._=1,o.push(t);n=r.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){e[n<0?~n:n].forEach(function(n){n._||(n._=1,r.push(n))})})})}}),r.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:o.map(function(t){var r,o=[];if(t.forEach(function(n){n.forEach(function(n){n.forEach(function(n){e[n<0?~n:n].length<2&&o.push(n)})})}),(r=(o=a(n,o)).length)>1)for(var i,u,c=1,s=f(o[0]);c<r;++c)(i=f(o[c]))>s&&(u=o[0],o[0]=o[c],o[c]=u,s=i);return o})}}function s(n,t){return n[1][2]-t[1][2]}n.version="1.6.26",n.mesh=function(n){return i(n,u.apply(this,arguments))},n.meshArcs=u,n.merge=function(n){return i(n,c.apply(this,arguments))},n.mergeArcs=c,n.feature=function(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return o(n,t)})}:o(n,t)},n.neighbors=function(n){var t={},e=n.map(function(){return[]});function o(n,e){n.forEach(function(n){n<0&&(n=~n);var r=t[n];r?r.push(e):t[n]=[e]})}function i(n,t){n.forEach(function(n){o(n,t)})}var a={LineString:o,MultiLineString:i,Polygon:i,MultiPolygon:function(n,t){n.forEach(function(n){i(n,t)})}};n.forEach(function n(t,e){"GeometryCollection"===t.type?t.geometries.forEach(function(t){n(t,e)}):t.type in a&&a[t.type](t.arcs,e)});for(var u in t)for(var f=t[u],c=f.length,s=0;s<c;++s)for(var l=s+1;l<c;++l){var h,p=f[s],d=f[l];(h=e[p])[u=r(h,d)]!==d&&h.splice(u,0,d),(h=e[d])[u=r(h,p)]!==p&&h.splice(u,0,p)}return e},n.presimplify=function(n,r){var o=e(n.transform),i=function(n){if(!n)return t;var e,r,o=n.scale[0],i=n.scale[1],a=n.translate[0],u=n.translate[1];return function(n,t){t||(e=r=0);var f=Math.round((n[0]-a)/o),c=Math.round((n[1]-u)/i);n[0]=f-e,n[1]=c-r,e=f,r=c}}(n.transform),a=function(){var n={},t=[],e=0;function r(n,e){for(;e>0;){var r=(e+1>>1)-1,o=t[r];if(s(n,o)>=0)break;t[o._=e]=o,t[n._=e=r]=n}}function o(n,r){for(;;){var o=r+1<<1,i=o-1,a=r,u=t[a];if(i<e&&s(t[i],u)<0&&(u=t[a=i]),o<e&&s(t[o],u)<0&&(u=t[a=o]),a===r)break;t[u._=r]=u,t[n._=r=a]=n}}return n.push=function(n){return r(t[n._=e]=n,e++),e},n.pop=function(){if(!(e<=0)){var n,r=t[0];return--e>0&&(n=t[e],o(t[n._=0]=n,0)),r}},n.remove=function(n){var i,a=n._;if(t[a]===n)return a!==--e&&(s(i=t[e],n)<0?r:o)(t[i._=a]=i,a),a},n}();function u(n){a.remove(n),n[1][2]=r(n),a.push(n)}return r||(r=f),n.arcs.forEach(function(n){var t,e,f,c,s=[],l=0;for(e=0,f=n.length;e<f;++e)c=n[e],o(n[e]=[c[0],c[1],1/0],e);for(e=1,f=n.length-1;e<f;++e)(t=n.slice(e-1,e+2))[1][2]=r(t),s.push(t),a.push(t);for(e=0,f=s.length;e<f;++e)(t=s[e]).previous=s[e-1],t.next=s[e+1];for(;t=a.pop();){var h=t.previous,p=t.next;t[1][2]<l?t[1][2]=l:l=t[1][2],h&&(h.next=p,h[2]=t[2],u(h)),p&&(p.previous=h,p[0]=t[0],u(p))}n.forEach(i)}),n}}),L.TOPOJSON=L.FeatureGroup.extend({options:{async:!0},initialize:function(n,t){L.Util.setOptions(this,t),this._topojson=n,this._layers={},n&&this.addTOPOJSON(n,t,this.options.async)},loadJSON:function(n,t,e,r){void 0===r&&(r=this.options.async),void 0===e&&(e=this.options);var o=new window.XMLHttpRequest;if(void 0===o.withCredentials&&void 0!==window.XDomainRequest){var i=new window.XDomainRequest;i.open("GET",n,r),i.onprogress=function(){},i.ontimeout=function(){},i.onerror=function(){},i.onload=function(){i.responseText&&t(i.responseText,e)},setTimeout(function(){i.send()},0)}else{o.open("GET",n,r);try{o.overrideMimeType("application/json")}catch(n){}o.onreadystatechange=function(){4===o.readyState&&200===o.status&&t(o.response,e)},o.send(null)}},addTOPOJSON:function(n,t,e){var r=this;this.loadJSON(n,function(n){r._addTOPOJSON(n)},t,e)},_addTOPOJSON:function(n){var t=this.parseTOPOJSON(n);if(t&&t.length){for(var e=0;e<t.length;e++)this.fire("addlayer",{layer:t[e]}),this.addLayer(t[e]);this.fire("loaded")}},_addData:function(n,t){"addData"in n&&n.addData(t),"setGeoJSON"in n&&n.setGeoJSON(t)},parseTOPOJSON:function(n){var t=[],e="string"==typeof n?JSON.parse(n):n;for(var r in e.objects){var o=L.geoJson(),i=topojson.feature(e,e.objects[r]);i.features?this._addData(o,i.features):_this._addData(o,i),t.push(o)}return t}});