!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./grid.filter"],function(a){return t(a,e,e.document)}):"object"==typeof module&&module.exports?module.exports=function(e,a){return e||(e=window),void 0===a&&(a="undefined"!=typeof window?require("jquery"):require("jquery")(e)),require("./grid.base"),require("./jquery.fmatter"),require("./grid.common"),require("./grid.filter"),t(a,e,e.document),a}:t(jQuery,e,e.document)}("undefined"!=typeof window?window:this,function(e,t,a){"use strict";var i=e.jgrid,o=i.jqID,r=e.fn.jqGrid,l=r.getGuiStyles,n=i.mergeCssClasses,d=i.hasOneFromClasses,s=i.feedback,c=i.fullBoolFeedback,u=i.builderFmButon,p=function(e,t,a){var i;!0===t[0]&&(i="<span class='"+n("fm-button-icon",a,t[2])+"'></span>","right"===t[1]?e.addClass("fm-button-icon-right").append(i):e.addClass("fm-button-icon-left").prepend(i))},h=function(e){return l.call(this,"states."+e)},f=function(t){t.find("tr[data-rowpos]").each(function(){var t=0;e(this).children("td").each(function(){"hidden"!==e(this).css("visibility")&&t++}),t||e(this).hide()})},m=function(e){return"&nbsp;"===e||"&#160;"===e||1===e.length&&160===e.charCodeAt(0)};i.extend({searchGrid:function(t){return this.each(function(){var a=this,d=e(a),p=a.p;if(a.grid&&null!=p){var f=e.extend(!0,{drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:p.prmNames.filters,loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE",in:"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},r.getGridRes.call(d,"search"),i.search||{},p.searching||{},t||{}),m="fbox_"+p.id,v=f.commonIconClass,g={themodal:"searchmod"+m,modalhead:"searchhd"+m,modalcontent:"searchcnt"+m,resizeAlso:m},b="#"+o(g.themodal),y=p.gBox,w=p.gView,x=e.each,D=p.postData[f.sFilter],C=function(){var t=e.makeArray(arguments);return t.unshift("Search"),t.unshift("Filter"),t.unshift(f),s.apply(a,t)},k=function(){i.hideModal(b,{gb:y,jqm:f.jqModal,onClose:f.onClose,removemodal:f.removemodal})};if("string"==typeof D&&(D=""!==e.trim(D)?e.parseJSON(D):void 0),e(b).remove(),void 0!==e(b)[0])B(e("#fbox_"+o(p.id)));else{var F=e("<div><div id='"+m+"' class='"+l.call(a,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(w);"rtl"===p.direction&&F.attr("dir","rtl");var _,S,E="",O="",j=!1,q=-1,T=e.extend([],p.colModel),A=u.call(a,m+"_search",f.Find,n(v,f.findDialogIcon),"right"),G=u.call(a,m+"_reset",f.Reset,n(v,f.resetDialogIcon),"left");if(f.showQuery&&(E=u.call(a,m+"_query","Query",n(v,f.queryDialogIcon),"left")+"&#160;"),f.searchForAdditionalProperties&&x(p.additionalProperties,function(){var e="string"==typeof this?{name:this}:this;e.label||(e.label=e.name),e.isAddProp=!0,T.push(e)}),f.columns.length?(T=f.columns,q=0,_=T[0].index||T[0].name):x(T,function(e,t){if(t.label||(t.label=t.isAddProp?t.name:p.colNames[e]),!j){var a=void 0===t.search||t.search,i=!0===t.hidden;(t.searchoptions&&!0===t.searchoptions.searchhidden&&a||a&&!i)&&(j=!0,_=t.index||t.name,q=e)}}),!D&&_||!1===f.multipleSearch){var I="eq";q>=0&&T[q].searchoptions&&T[q].searchoptions.sopt?I=T[q].searchoptions.sopt[0]:f.sopt&&f.sopt.length&&(I=f.sopt[0]),D={groupOp:"AND",rules:[{field:_,op:I,data:""}]}}j=!1,f.tmplNames&&f.tmplNames.length&&(j=!0,O=f.tmplLabel,O+="<select class='ui-template'>",O+="<option value='default'>Default</option>",x(f.tmplNames,function(e,t){O+="<option value='"+e+"'>"+t+"</option>"}),O+="</select>"),S="<div class='"+l.call(a,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+m+"_2'><tbody><tr><td colspan='2'><hr class='"+l.call(a,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+p.direction+"'  style='float:"+("rtl"===p.direction?"right":"left")+";'>"+G+O+"</td><td class='EditButton EditButton-"+p.direction+"'>"+E+A+"</td></tr></tbody></table></div>",m=o(m),f.gbox=y,f.height="auto",e(m="#"+m).jqFilter({columns:T,filter:f.loadDefaults?D:null,showQuery:f.showQuery,errorcheck:f.errorcheck,sopt:f.sopt,groupButton:f.multipleGroup,ruleButtons:f.multipleSearch,afterRedraw:f.afterRedraw,ops:f.odata,cops:p.customSortOperations,operands:f.operands,ajaxSelectOptions:p.ajaxSelectOptions,groupOps:f.groupOps,onChange:function(t,i){t.showQuery&&e(".query",i).text(i.toUserFriendlyString()),c.call(a,f.afterChange,"jqGridFilterAfterChange",e(m),f,t,i)},direction:p.direction,id:p.id}),F.append(S),j&&f.tmplFilters&&f.tmplFilters.length&&e(".ui-template",F).on("change",function(){var t=e(this).val();return"default"===t?e(m).jqFilter("addFilter",D):e(m).jqFilter("addFilter",f.tmplFilters[parseInt(t,10)]),!1}),!0===f.multipleGroup&&(f.multipleSearch=!0),C("onInitialize",e(m)),f.layer?i.createModal.call(a,g,F,f,w,e(y)[0],"#"+o(f.layer),{position:"relative"}):i.createModal.call(a,g,F,f,w,e(y)[0]),(f.searchOnEnter||f.closeOnEscape)&&e(b).keydown(function(t){var a=e(t.target);return!f.searchOnEnter||13!==t.which||a.hasClass("add-group")||a.hasClass("add-rule")||a.hasClass("delete-group")||a.hasClass("delete-rule")||a.hasClass("fm-button")&&a.is("[id$=_query]")?f.closeOnEscape&&27===t.which?(e("#"+o(g.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:(e(m+"_search").click(),!1)}),E&&e(m+"_query").on("click",function(){return e(".queryresult",F).toggle(),!1}),void 0===f.stringResult&&(f.stringResult=f.multipleSearch),e(m+"_search").on("click",function(){var t,i={},o="",r=e(m),l=r.find(".input-elm");if(l.filter(":focus")&&(l=l.filter(":focus")),l.change(),t=r.jqFilter("filterData"),f.errorcheck&&(r[0].hideError(),f.showQuery||r.jqFilter("toSQLString"),r[0].p.error))return r[0].showError(),!1;if(f.stringResult||"local"===p.datatype){try{o=JSON.stringify(t)}catch(e){}"string"==typeof o&&(i[f.sFilter]=o,x([f.sField,f.sValue,f.sOper],function(){i[this]=""}))}else f.multipleSearch?(i[f.sFilter]=t,x([f.sField,f.sValue,f.sOper],function(){i[this]=""})):(i[f.sField]=t.rules[0].field,i[f.sValue]=t.rules[0].data,i[f.sOper]=t.rules[0].op,i[f.sFilter]="");return e.extend(p.postData,i),c.call(a,f.onSearch,"jqGridFilterSearch",p.filters)&&(p.search=!0,d.trigger("reloadGrid",[e.extend({page:1},f.reloadGridSearchOptions||{})])),f.closeAfterSearch&&k(),!1}),e(m+"_reset").on("click",function(){var t={},i=e(m);return p.search=!1,p.resetsearch=!0,!1===f.multipleSearch?t[f.sField]=t[f.sValue]=t[f.sOper]="":t[f.sFilter]="",i[0].resetFilter(),j&&e(".ui-template",F).val("default"),e.extend(p.postData,t),c.call(a,f.onReset,"jqGridFilterReset")&&d.trigger("reloadGrid",[e.extend({page:1},f.reloadGridResetOptions||{})]),f.closeAfterReset&&k(),!1}),B(e(m));var N=h.call(a,"hover");e(".fm-button:not(."+h.call(a,"disabled").split(" ").join(".")+")",F).hover(function(){e(this).addClass(N)},function(){e(this).removeClass(N)})}}function B(t){C("beforeShow",t)&&(e(b).data("onClose",f.onClose),i.viewModal.call(a,b,{gbox:y,jqm:f.jqModal,overlay:f.overlay,modal:f.modal,overlayClass:f.overlayClass,toTop:f.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),C("afterShow",t))}})},editGridRow:function(t,a){return this.each(function(){var c=this,v=e(c),g=c.p;if(c.grid&&null!=g&&t){var b,y,w=g.id,x=r.getGridRes,D=r.setSelection,C=e.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:l.call(this,"overlay"),removemodal:!0,skipPostTypes:["image","file"],saveui:"enable",savetext:x.call(v,"defaults.savetext")||"Saving..."},x.call(v,"edit"),i.edit,g.formEditing||{},a||{}),k="FrmGrid_"+w,F=k,_="TblGrid_"+w,S="#"+o(_),E=S+"_2",O={themodal:"editmod"+w,modalhead:"edithd"+w,modalcontent:"editcnt"+w,resizeAlso:k},j="#"+o(O.themodal),q=g.gBox,T=g.colModel,A=g.iColByName,G=1,I=0,N=C.commonIconClass,B=function(){i.hideModal(j,{gb:q,jqm:C.jqModal,onClose:C.onClose,removemodal:C.removemodal})},P=x.call(v,"errors.errcap"),R=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("AddEdit"),t.unshift(C),s.apply(c,t)},M=h.call(c,"hover"),z=h.call(c,"disabled"),V=h.call(c,"select"),L=h.call(c,"active"),U=h.call(c,"error");e(j).remove(),k="#"+o(k),"new"===t?(t="_empty",y="add",C.caption=C.addCaption):(C.caption=C.editCaption,y="edit");var H=!0;!C.checkOnUpdate||!0!==C.jqModal&&void 0!==C.jqModal||C.modal||(H=!1);var Q=isNaN(C.dataheight)?C.dataheight:C.dataheight+"px",K=isNaN(C.datawidth)?C.datawidth:C.datawidth+"px",W=e("<form name='FormPost' id='"+F+"' class='FormGrid' onSubmit='return false;' style='width:"+K+";overflow:auto;position:relative;height:"+Q+";'></form>").data("disabled",!1),X=e("<table id='"+_+"' class='EditTable'><tbody></tbody></table>");e(T).each(function(){var e=this.formoptions;G=Math.max(G,e?e.colpos||0:0),I=Math.max(I,e?e.rowpos||0:0)}),e(W).append(X);var Y=e("<tr id='FormError' style='display:none'><td class='"+U+"' colspan='"+2*G+"'>&#160;</td></tr>");if(Y[0].rp=0,e(X).append(Y),(Y=e("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*G+"'>"+(C.topinfo||"&#160;")+"</td></tr>"))[0].rp=0,e(X).append(Y),R("beforeInitData",W,y)){!function(){var a=i.detectRowEditing.call(c,t);if(null!=a)if("inlineEditing"===a.mode)r.restoreRow.call(v,t);else{var o=a.savedRow,l=c.rows[o.id];r.restoreCell.call(v,o.id,o.ic),e(l.cells[o.ic]).removeClass("edit-cell "+V),e(l).addClass(V).attr({"aria-selected":"true",tabindex:"0"})}}();var J="rtl"===g.direction,$=J?"nData":"pData",Z=J?"pData":"nData";!function(t,a,n){var d,s=0,u=[],p=!1,h=e(a),b="";for(d=1;d<=n;d++)b+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";if("_empty"!==t&&(p=r.getInd.call(v,t)),e(T).each(function(a){var r,d,f,y,w,x=this,D=x.name,F=x.editable,_=!1,S=!1,E="_empty"===t?"addForm":"editForm";switch(e.isFunction(F)&&(F=F.call(c,{rowid:t,iCol:a,iRow:p,cmName:D,cm:x,mode:E})),d=!(x.editrules&&!0===x.editrules.edithidden||!0!==x.hidden&&"hidden"!==F),String(F).toLowerCase()){case"hidden":F=!0;break;case"disabled":F=!0,_=!0;break;case"readonly":F=!0,S=!0}if("cb"!==D&&"subgrid"!==D&&!0===F&&"rn"!==D){if(!1===p)y="";else{r=e(c.rows[p].cells[a]);try{y=e.unformat.call(c,r,{rowId:t,colModel:x},a)}catch(e){y=x.edittype&&"textarea"===x.edittype?r.text():r.html()}m(y)&&(y="")}var O=e.extend({},x.editoptions||{},{id:D,name:D,rowId:t,mode:E,cm:x,iCol:a}),j=e.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},x.formoptions||{}),q=parseInt(j.rowpos,10)||s+1,T=parseInt(2*(parseInt(j.colpos,10)||1),10);if("_empty"===t&&O.defaultValue&&(y=e.isFunction(O.defaultValue)?O.defaultValue.call(c):O.defaultValue),x.edittype||(x.edittype="text"),g.autoEncodeOnEdit&&(y=i.oldDecodePostedData(y)),w=i.createEl.call(c,x.edittype,O,y,!1,e.extend({},i.ajaxOptions,g.ajaxSelectOptions||{})),(C.checkOnSubmit||C.checkOnUpdate)&&(C._savedData[D]=y),e(w).addClass("FormElement"),e.inArray(x.edittype,["text","textarea","checkbox","password","select"])>-1&&e(w).addClass(l.call(c,"dialog.dataField")),f=h.find("tr[data-rowpos="+q+"]"),j.rowabove){var A=e("<tr><td class='contentinfo' colspan='"+2*n+"'>"+j.rowcontent+"</td></tr>");h.append(A),A[0].rp=q}0===f.length&&(f=e("<tr data-rowpos='"+q+"'></tr>").addClass("FormData").attr("id","tr_"+D),e(f).append(b),h.append(f),f[0].rp=q);var G=e("td:eq("+(T-2)+")",f[0]),I=e("td:eq("+(T-1)+")",f[0]);G.html(void 0===j.label?g.colNames[a]:j.label||"&#160;");var N=I[m(I.html())?"html":"append"](j.elmprefix);if(N.append(w).append(j.elmsuffix),"INPUT"===w.tagName.toUpperCase()&&x.createColumnIndex&&O.generateDatalist){var B=v.jqGrid("generateDatalistFromColumnIndex",x.name);null!=B&&B.length>0&&(e(w).attr("list","dl_"+w.id),N.append(B.attr("id","dl_"+w.id)))}_?(G.addClass(z),I.addClass(z),e(w).prop("readonly",!0),e(w).prop("disabled",!0)):S&&e(w).prop("readonly",!0),"custom"===x.edittype&&e.isFunction(O.custom_value)&&O.custom_value.call(c,e("#"+o(D),k),"set",y),i.bindEv.call(c,w,O),d&&G.add(I).css("visibility","hidden"),u[s]=a,s++}}),f(h),s>0){var y=e("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*n-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+w+"_id' value='"+t+"'/></td></tr>");y[0].rp=s+999,h.append(y),(C.checkOnSubmit||C.checkOnUpdate)&&(C._savedData[w+"_id"]=t)}}(t,X,G);var ee=u.call(c,$,"",n(N,C.prevIcon),"","left"),te=u.call(c,Z,"",n(N,C.nextIcon),"","right"),ae=u.call(c,"sData",C.bSubmit),ie=u.call(c,"cData",C.bCancel),oe="<div class='"+l.call(c,"dialog.footer")+"'><table class='EditTable' id='"+_+"_2'><tbody><tr><td colspan='2'><hr class='"+l.call(c,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+g.direction+"'>"+(J?te+ee:ee+te)+"</td><td class='EditButton EditButton-"+g.direction+"'>"+ae+"&#160;"+ie+"</td></tr>";if(oe+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(C.bottominfo||"&#160;")+"</td></tr>",oe+="</tbody></table></div>",I>0){var re=[];e.each(e(X)[0].rows,function(e,t){re[e]=t}),re.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(re,function(t,a){e("tbody",X).append(a)})}C.gbox=q;var le=!1;!0===C.closeOnEscape&&(C.closeOnEscape=!1,le=!0);var ne=e("<div></div>").append(e("<div class='"+l.call(c,"dialog.body")+"'></div>").append(W)).append(oe);if(i.createModal.call(c,O,ne,C,g.gView,e(q)[0]),C.topinfo&&e(".tinfo",S).show(),C.bottominfo&&e(".binfo",E).show(),ne=null,oe=null,e(j).keydown(function(t){var a,i,o=(t.target.tagName||"").toUpperCase();if(!0===e(k).data("disabled"))return!1;if(13===t.which&&"TEXTAREA"!==o){if(i=(a=e(E).find(":focus")).attr("id"),a.length>0&&e.inArray(i,["pData","nData","cData"])>=0)return a.trigger("click"),!1;if(!0===C.savekey[0]&&13===C.savekey[1])return e("#sData",E).trigger("click"),!1}if(!0===C.savekey[0]&&t.which===C.savekey[1]&&"TEXTAREA"!==o)return e("#sData",E).trigger("click"),!1;if(27===t.which)return!!fe()&&(le&&B(),!1);if(!0===C.navkeys[0]){if("_empty"===e("#id_g",S).val())return!0;if(t.which===C.navkeys[1])return e("#pData",E).trigger("click"),!1;if(t.which===C.navkeys[2])return e("#nData",E).trigger("click"),!1}}),C.checkOnUpdate&&(e("a.ui-jqdialog-titlebar-close span",j).removeClass("jqmClose"),e("a.ui-jqdialog-titlebar-close",j).off("click").click(function(){return!!fe()&&(B(),!1)})),p(e("#sData",E),C.saveicon,N),p(e("#cData",E),C.closeicon,N),C.checkOnSubmit||C.checkOnUpdate){ae=u.call(c,"sNew",C.bYes),te=u.call(c,"nNew",C.bNo),ie=u.call(c,"cNew",C.bExit);var de=C.zIndex||999;de++,e("<div class='"+C.overlayClass+" jqgrid-overlay confirm' style='z-index:"+de+";display:none;'>&#160;</div><div class='"+l.call(c,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(de+1)+"'>"+C.saveData+"<br/><br/>"+ae+te+ie+"</div>").insertAfter(k),e("#sNew",j).click(function(){return pe(),e(k).data("disabled",!1),e(".confirm",j).hide(),!1}),e("#nNew",j).click(function(){return e(".confirm",j).hide(),e(k).data("disabled",!1),setTimeout(function(){e(k).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()},0),!1}),e("#cNew",j).click(function(){return e(".confirm",j).hide(),e(k).data("disabled",!1),B(),!1})}R("onInitializeForm",e(k),y),"_empty"!==t&&C.viewPagerButtons?e("#pData,#nData",E).show():e("#pData,#nData",E).hide(),R("beforeShowForm",e(k),y),e(j).data("onClose",C.onClose),i.viewModal.call(c,j,{gbox:q,jqm:C.jqModal,overlay:C.overlay,modal:C.modal,overlayClass:C.overlayClass,toTop:C.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),H||e("."+o(C.overlayClass)).click(function(){return!!fe()&&(B(),!1)}),e(".fm-button",j).hover(function(){e(this).addClass(M)},function(){e(this).removeClass(M)}),e("#sData",E).click(function(){return b={},e("#FormError",S).hide(),ce(),"_empty"===b[w+"_id"]?pe():!0===C.checkOnSubmit&&he(b,C._savedData)?(e(k).data("disabled",!0),e(".confirm",j).show()):pe(),!1}),e("#cData",E).click(function(){return!!fe()&&(B(),!1)}),e("#nData",E).click(function(){if(!fe())return!1;e("#FormError",S).hide();var t=ve();if(t[0]=parseInt(t[0],10),-1!==t[0]&&t[1][t[0]+1]){if(!R("onclickPgButtons","next",e(k),t[1][t[0]]))return!1;ue(t[1][t[0]+1],k),D.call(v,t[1][t[0]+1]),R("afterclickPgButtons","next",e(k),t[1][t[0]+1]),me(t[0]+1,t)}return!1}),e("#pData",E).click(function(){if(!fe())return!1;e("#FormError",S).hide();var t=ve();if(-1!==t[0]&&t[1][t[0]-1]){if(!R("onclickPgButtons","prev",e(k),t[1][t[0]]))return!1;if(d(e("#"+o(t[1][t[0]-1])),z))return!1;ue(t[1][t[0]-1],k),D.call(v,t[1][t[0]-1]),R("afterclickPgButtons","prev",e(k),t[1][t[0]-1]),me(t[0]-1,t)}return!1}),R("afterShowForm",e(k),y);var se=ve();me(se[0],se)}}function ce(){return e(S+" > tbody > tr > td .FormElement").each(function(){var t,a,r,l,n=e(".customelement",this),d=this.name;if(n.length){if(d=n.attr("name"),void 0!==(t=A[d])&&(a=T[t].editoptions||{},e.isFunction(a.custom_value))){try{if(b[d]=a.custom_value.call(c,e("#"+o(d),S),"get"),void 0===b[d])throw"e1"}catch(e){"e1"===e?i.info_dialog.call(c,P,"function 'custom_value' "+C.msg.novalue,C.bClose):i.info_dialog.call(c,P,e.message,C.bClose)}return!0}}else switch(l=e(this)[0].type){case"checkbox":b[d]=e(this).is(":checked")?e(this).val():e(this).data("offval");break;case"select-one":b[d]=e("option:selected",this).val();break;case"select-multiple":b[d]=e(this).val(),b[d]=b[d]?b[d].join(","):"";var s=[];e("option:selected",this).each(function(t,a){s[t]=e(a).text()});break;case"date":b[d]=e(this).val(),3===String(b[d]).split("-").length&&void 0!==(t=A[d])&&(r=(T[t].formatoptions||{}).newformat||x.call(v,"formatter.date.newformat"),b[d]=i.parseDate.call(v[0],"Y-m-d",b[d],r));break;default:void 0!==l&&e.inArray(l,C.skipPostTypes)<0&&(b[d]=e(this).val())}}),!0}function ue(t,a){var l,n,d,s,u,p=0;(C.checkOnSubmit||C.checkOnUpdate)&&(C._savedData={},C._savedData[w+"_id"]=t);var h=g.colModel;if("_empty"===t)return e(h).each(function(){l=this.name,d=e.extend({},this.editoptions||{}),(n=e("#"+o(l),a))&&n.length&&null!==n[0]&&(s="","custom"===this.edittype&&e.isFunction(d.custom_value)?d.custom_value.call(c,n,"set",s):d.defaultValue?(s=e.isFunction(d.defaultValue)?d.defaultValue.call(c):d.defaultValue,"checkbox"===n[0].type?(u=s.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==u?(n[0].checked=!0,n[0].defaultChecked=!0,n[0].value=s):(n[0].checked=!1,n[0].defaultChecked=!1):n.val(s)):"checkbox"===n[0].type?(n[0].checked=!1,n[0].defaultChecked=!1,s=e(n).data("offval")):n[0].type&&"select"===n[0].type.substr(0,6)?n[0].selectedIndex=0:n.val(s),(!0===C.checkOnSubmit||C.checkOnUpdate)&&(C._savedData[l]=s))}),void e("#id_g",a).val(t);var f=r.getInd.call(v,t,!0);f&&(e(f.cells).filter("td[role=gridcell]").each(function(r){var n;if("cb"!==(l=h[r].name)&&"subgrid"!==l&&"rn"!==l&&!0===h[r].editable){try{n=e.unformat.call(c,e(this),{rowId:t,colModel:h[r]},r)}catch(t){n="textarea"===h[r].edittype?e(this).text():e(this).html()}switch(g.autoEncodeOnEdit&&(n=i.oldDecodePostedData(n)),(!0===C.checkOnSubmit||C.checkOnUpdate)&&(C._savedData[l]=n),l="#"+o(l),h[r].edittype){case"password":case"text":case"button":case"image":case"textarea":m(n)&&(n=""),e(l,a).val(n);break;case"select":var d=n.split(",");d=e.map(d,function(t){return e.trim(t)}),e(l+" option",a).each(function(){var t,a=e(this),i=e.trim(a.val());if(h[r].editoptions.multiple||d[0]!==i?h[r].editoptions.multiple&&(t=e.inArray(i,d))>-1?(d.splice(t,1),this.selected=!0):this.selected=!1:(d.splice(0,1),this.selected=!0),0===d.length)return!1}),d.length>0&&e(l+" option",a).each(function(){var t,a=e(this),i=e.trim(a.text());if(h[r].editoptions.multiple||e.trim(n)!==i&&d[0]!==i?h[r].editoptions.multiple&&(t=e.inArray(i,d))>-1&&(d.splice(t,1),this.selected=!0):(d.splice(0,1),this.selected=!0),0===d.length)return!1});break;case"checkbox":n=String(n),n=h[r].editoptions&&h[r].editoptions.value?h[r].editoptions.value.split(":")[0]===n:(n=n.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==n,e(l,a).prop({checked:n,defaultChecked:n});break;case"custom":try{if(!h[r].editoptions||!e.isFunction(h[r].editoptions.custom_value))throw"e1";h[r].editoptions.custom_value.call(c,e(l,a),"set",n)}catch(e){"e1"===e?i.info_dialog.call(c,P,"function 'custom_value' "+C.msg.nodefined,C.bClose):i.info_dialog.call(c,P,e.message,C.bClose)}}p++}}),p>0&&e("#id_g",S).val(t))}function pe(){var a,o,l,n,d,s,u,p,h=[!0,"",""],f=h,m={},x=g.prmNames,F=r.getInd.call(v,t),_=!1===F?null:c.rows[F],O=v.triggerHandler("jqGridAddEditBeforeCheckValues",[b,e(k),y]);O&&"object"==typeof O&&(b=O),F=!1===F?-1:F,e.isFunction(C.beforeCheckValues)&&(O=C.beforeCheckValues.call(c,b,e(k),y))&&"object"==typeof O&&(b=O);for(l in b)if(b.hasOwnProperty(l)&&(p=g.iColByName[l],null!=(f=i.checkValues.call(c,b[l],l,void 0,void 0,{oldValue:"_empty"===t?null:r.getCell.call(v,t,p),newValue:b[l],cmName:l,rowid:t,cm:T[p],iCol:p,iRow:F,tr:_,td:null==_?null:_.cells[p],mode:"_empty"===t?"addForm":"editForm"}))&&!0!==f||(f=h),!1===f[0]))break;if(function(){var t=C.url||g.editurl;e.each(T,function(a,i){var o=i.name;b.hasOwnProperty(o)&&("date"!==i.formatter||null!=i.formatoptions&&!0===i.formatoptions.sendFormatted||(b[o]=e.unformat.date.call(c,b[o],i)),"clientArray"!==t&&i.editoptions&&!0===i.editoptions.NullIfEmpty&&""===b[o]&&(b[o]="null"))})}(),f[0]&&(void 0===(m=v.triggerHandler("jqGridAddEditClickSubmit",[C,b,y]))&&e.isFunction(C.onclickSubmit)&&(m=C.onclickSubmit.call(c,C,b,y)||{}),null!=(f=v.triggerHandler("jqGridAddEditBeforeSubmit",[b,e(k),y]))&&!0!==f||(f=h),f[0]&&e.isFunction(C.beforeSubmit)&&(null!=(f=C.beforeSubmit.call(c,b,e(k),y))&&!0!==f||(f=h))),f[0]&&!C.processing){if(C.processing=!0,e("#sData",E).addClass(L),s=C.url||g.editurl,o=x.oper,a="clientArray"===s&&!1!==g.keyName?g.keyName:x.id,b[o]="_empty"===e.trim(b[w+"_id"])?x.addoper:x.editoper,b[o]!==x.addoper?b[a]=b[w+"_id"]:void 0===b[a]&&(b[a]=b[w+"_id"]),delete b[w+"_id"],b=e.extend(b,C.editData,m),!0===g.treeGrid){if(b[o]===x.addoper){n=g.selrow;var j="adjacency"===g.treeGridModel?g.treeReader.parent_id_field:"parent_id";b[j]=n}for(d in g.treeReader)if(g.treeReader.hasOwnProperty(d)&&(u=g.treeReader[d],b.hasOwnProperty(u))){if(b[o]===x.addoper&&"parent_id_field"===d)continue;delete b[u]}}b[a]=i.stripPref(g.idPrefix,b[a]),g.autoEncodeOnEdit&&e.each(b,function(t,a){e.isFunction(a)||(b[t]=i.oldEncodePostedData(a))});var q=e.extend({url:e.isFunction(s)?s.call(c,b[a],y,b,C):s,type:e.isFunction(C.mtype)?C.mtype.call(c,y,C,b[a],b):C.mtype,data:i.serializeFeedback.call(c,e.isFunction(C.serializeEditData)?C.serializeEditData:g.serializeEditData,"jqGridAddEditSerializeEditData",b),complete:function(t,l){if(v.jqGrid("progressBar",{method:"hide",loadtype:C.saveui}),e("#sData",E).removeClass(L),b[a]=e("#id_g",S).val(),t.status>=300&&304!==t.status||0===t.status&&4===t.readyState?(f[0]=!1,f[1]=v.triggerHandler("jqGridAddEditErrorTextFormat",[t,y]),e.isFunction(C.errorTextFormat)?f[1]=C.errorTextFormat.call(c,t,y):f[1]=l+" Status: '"+t.statusText+"'. Error code: "+t.status):(null!=(f=v.triggerHandler("jqGridAddEditAfterSubmit",[t,b,y]))&&!0!==f||(f=h),f[0]&&e.isFunction(C.afterSubmit)&&(null!=(f=C.afterSubmit.call(c,t,b,y))&&!0!==f||(f=h))),!1===f[0])e("#FormError>td",S).html(f[1]),e("#FormError",S).show();else{g.autoEncodeOnEdit&&e.each(b,function(e,t){b[e]=i.oldDecodePostedData(t)});var d=[e.extend({},C.reloadGridOptions||{})];if(b[o]===x.addoper?(f[2]||(f[2]=i.randId()),null==b[a]||"_empty"===b[a]||b[o]===x.addoper?b[a]=f[2]:f[2]=b[a],C.reloadAfterSubmit?v.trigger("reloadGrid",d):!0===g.treeGrid?r.addChildNode.call(v,f[2],n,b):r.addRowData.call(v,f[2],b,C.addedrow),C.closeAfterAdd?(!0!==g.treeGrid&&D.call(v,f[2]),B()):C.clearAfterAdd&&ue("_empty",k)):(C.reloadAfterSubmit?(v.trigger("reloadGrid",d),C.closeAfterEdit||setTimeout(function(){D.call(v,b[a])},1e3)):!0===g.treeGrid?r.setTreeRow.call(v,b[a],b):r.setRowData.call(v,b[a],b),C.closeAfterEdit&&B()),e.isFunction(C.afterComplete)){var s=t;setTimeout(function(){v.triggerHandler("jqGridAddEditAfterComplete",[s,b,e(k),y]),C.afterComplete.call(c,s,b,e(k),y),s=null},50)}if((C.checkOnSubmit||C.checkOnUpdate)&&(e(k).data("disabled",!1),"_empty"!==C._savedData[w+"_id"])){var u;for(u in C._savedData)C._savedData.hasOwnProperty(u)&&b[u]&&(C._savedData[u]=b[u])}}C.processing=!1;try{e(k).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()}catch(e){}}},i.ajaxOptions,C.ajaxEditOptions);if(q.url||C.useDataProxy||(e.isFunction(g.dataProxy)?C.useDataProxy=!0:(f[0]=!1,f[1]+=" "+i.errors.nourl)),f[0])if(v.jqGrid("progressBar",{method:"show",loadtype:C.saveui,htmlcontent:C.savetext}),C.useDataProxy){var A=g.dataProxy.call(c,q,"set_"+w);void 0===A&&(A=[!0,""]),!1===A[0]?(f[0]=!1,f[1]=A[1]||"Error deleting the selected row!"):(q.data.oper===x.addoper&&C.closeAfterAdd&&B(),q.data.oper===x.editoper&&C.closeAfterEdit&&B())}else"clientArray"===q.url?(C.reloadAfterSubmit=!1,b=q.data,q.complete({status:200,statusText:""},"")):e.ajax(q)}!1===f[0]&&(e("#FormError>td",S).html(f[1]),e("#FormError",S).show())}function he(e,t){var a,i=!1;for(a in e)if(e.hasOwnProperty(a)&&String(e[a])!==String(t[a])){i=!0;break}return i}function fe(){var t=!0;return e("#FormError",S).hide(),C.checkOnUpdate&&(b={},ce(),he(b,C._savedData)&&(e(k).data("disabled",!0),e(".confirm",j).show(),t=!1)),t}function me(t,a){var i=a[1].length-1;0===t?e("#pData",E).addClass(z):void 0!==a[1][t-1]&&d(e("#"+o(a[1][t-1])),z)?e("#pData",E).addClass(z):e("#pData",E).removeClass(z),t===i?e("#nData",E).addClass(z):void 0!==a[1][t+1]&&d(e("#"+o(a[1][t+1])),z)?e("#nData",E).addClass(z):e("#nData",E).removeClass(z)}function ve(){var t=r.getDataIDs.call(v),a=e("#id_g",S).val();return[e.inArray(a,t),t]}})},viewGridRow:function(t,a){return this.each(function(){var c=this,v=e(c),g=c.p;if(c.grid&&null!=g&&t){var b=g.id,y=e.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,removemodal:!0},r.getGridRes.call(v,"view"),i.view||{},g.formViewing||{},a||{}),w="#ViewGrid_"+o(b),x="#ViewTbl_"+o(b),D=x+"_2",C="ViewGrid_"+b,k="ViewTbl_"+b,F=y.commonIconClass,_={themodal:"viewmod"+b,modalhead:"viewhd"+b,modalcontent:"viewcnt"+b,resizeAlso:C},S="#"+o(_.themodal),E=g.gBox,O=g.colModel,j=1,q=0,T=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("View"),t.unshift(y),s.apply(c,t)},A=function(){i.hideModal(S,{gb:E,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})},G=h.call(c,"hover"),I=h.call(c,"disabled"),N=isNaN(y.dataheight)?y.dataheight:y.dataheight+"px",B=isNaN(y.datawidth)?y.datawidth:y.datawidth+"px",P=e("<div class='"+l.call(c,"dialog.body")+"'><form name='FormPost' id='"+C+"' class='FormGrid' style='width:"+B+";overflow:auto;position:relative;height:"+N+";'></form></div>"),R=P.children("form.FormGrid"),M=e("<table id='"+k+"' class='EditTable'><tbody></tbody></table>");if(e(S).remove(),e(O).each(function(){var e=this.formoptions;j=Math.max(j,e?e.colpos||0:0),q=Math.max(q,e?e.rowpos||0:0)}),R.append(M),T("beforeInitData",R)){!function(t,a,o){var n,d,s,u,p,h,b,w,x=0,D=[],C=r.getInd.call(v,t),k=l.call(c,"dialog.viewData"),F=e(a),_=l.call(c,"dialog.viewLabel"),S=String(y.labelswidth)+(!y.labelswidth||isNaN(y.labelswidth)?"":"px"),E="<td class='"+l.call(c,"dialog.viewCellLabel","CaptionTD form-view-label")+(S?"' style='width:"+S+";":"")+"'>&#160;</td><td class='"+l.call(c,"dialog.viewCellData","DataTD form-view-data")+"'>&#160;</td>",j="",q=["integer","number","currency"],T=0,A=0;for(p=0;p<o;p++)j+=E;if(e(O).each(function(){(d=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden)||"right"!==this.align||(this.formatter&&-1!==e.inArray(this.formatter,q)?T=Math.max(T,parseInt(this.width,10)):A=Math.max(A,parseInt(this.width,10)))}),h=0!==T?T:0!==A?A:0,e(O).each(function(t){if(n=this.name,b=!1,d=(!this.editrules||!0!==this.editrules.edithidden)&&!0===this.hidden,w="boolean"!=typeof this.viewable||this.viewable,"cb"!==n&&"subgrid"!==n&&"rn"!==n&&w){u=!1===C?"":i.getDataFieldOfCell.call(c,c.rows[C],t).html(),b="right"===this.align&&0!==h;var a=e.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),r=parseInt(a.rowpos,10)||x+1,l=parseInt(2*(parseInt(a.colpos,10)||1),10);if(a.rowabove){var p=e("<tr><td class='contentinfo' colspan='"+2*o+"'>"+a.rowcontent+"</td></tr>");F.append(p),p[0].rp=r}0===(s=F.find("tr[data-rowpos="+r+"]")).length&&((s=e("<tr data-rowpos='"+r+"'></tr>").addClass("FormData").attr("id","trv_"+n)).append(j),F.append(s),s[0].rp=r);var f=void 0===a.label?g.colNames[t]:a.label,v=e("td:eq("+(l-1)+")",s[0]),y=e("td:eq("+(l-2)+")",s[0]);y.html("<label for='"+n+"'"+(_?" class='"+_+"'>":">")+(f||"&nbsp;")+"</label>"),v[m(v.html())?"html":"append"]("<span id='"+n+"'"+(k?" class='"+k+"'>":">")+(u||"&nbsp;")+"</span>").attr("id","v_"+n),b&&e("td:eq("+(l-1)+") span",s[0]).css({"text-align":"right",width:h+"px"}),d&&y.add(v).css("visibility","hidden"),D[x]=t,x++}}),f(F),x>0){var G=e("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*o-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+t+"'/></td></tr>");G[0].rp=x+99,F.append(G)}}(t,M,j);var z="rtl"===g.direction,V=z?"nData":"pData",L=z?"pData":"nData",U=u.call(c,V,"",n(F,y.prevIcon),"","left"),H=u.call(c,L,"",n(F,y.nextIcon),"","right"),Q=u.call(c,"cData",y.bClose);if(q>0){var K=[];e.each(e(M)[0].rows,function(e,t){K[e]=t}),K.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),e.each(K,function(t,a){e("tbody",M).append(a)})}y.gbox=E;var W=e("<div></div>").append(P).append("<div class='"+l.call(c,"dialog.footer")+"'><table border='0' class='EditTable' id='"+k+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+g.direction+"' width='"+(y.labelswidth||"auto")+"'>"+(z?H+U:U+H)+"</td><td class='EditButton EditButton-"+g.direction+"'>"+Q+"</td></tr></tbody></table></div>");i.createModal.call(c,_,W,y,g.gView,e(g.gView)[0]),y.viewPagerButtons||e("#pData, #nData",D).hide(),W=null,e(S).keydown(function(t){var a,i;if(!0===e(w).data("disabled"))return!1;if(13===t.which&&(i=(a=e(D).find(":focus")).attr("id"),a.length>0&&e.inArray(i,["pData","nData","cData"])>=0))return a.trigger("click"),!1;if(27===t.which)return y.closeOnEscape&&A(),!1;if(!0===y.navkeys[0]){if(t.which===y.navkeys[1])return e("#pData",D).trigger("click"),!1;if(t.which===y.navkeys[2])return e("#nData",D).trigger("click"),!1}}),p(e("#cData",D),y.closeicon,F),T("beforeShowForm",e(w)),i.viewModal.call(c,S,{gbox:E,jqm:y.jqModal,overlay:y.overlay,toTop:y.toTop,modal:y.modal,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),e(".fm-button:not(."+I.split(" ").join(".")+")",D).hover(function(){e(this).addClass(G)},function(){e(this).removeClass(G)}),Y(),e("#cData",D).click(function(){return A(),!1}),e("#nData",D).click(function(){e("#FormError",x).hide();var t=Z();if(t[0]=parseInt(t[0],10),-1!==t[0]&&t[1][t[0]+1]){if(!T("onclickPgButtons","next",e(w),t[1][t[0]]))return!1;J(t[1][t[0]+1]),r.setSelection.call(v,t[1][t[0]+1]),T("afterclickPgButtons","next",e(w),t[1][t[0]+1]),$(t[0]+1,t)}return Y(),!1}),e("#pData",D).click(function(){e("#FormError",x).hide();var t=Z();if(-1!==t[0]&&t[1][t[0]-1]){if(!T("onclickPgButtons","prev",e(w),t[1][t[0]]))return!1;J(t[1][t[0]-1]),r.setSelection.call(v,t[1][t[0]-1]),T("afterclickPgButtons","prev",e(w),t[1][t[0]-1]),$(t[0]-1,t)}return Y(),!1});var X=Z();$(X[0],X)}}function Y(){!0!==y.closeOnEscape&&!0!==y.navkeys[0]||setTimeout(function(){e("#cData").focus()},0)}function J(t){var a,l,n=0,d=r.getInd.call(v,t,!0);d&&(e("td",d).each(function(t){l=O[t],"cb"!==(a=l.name)&&"subgrid"!==a&&"rn"!==a&&(a=o("v_"+a),e("#"+a+" span",x).html(i.getDataFieldOfCell.call(c,d,t).html()),n++)}),n>0&&e("#id_g",x).val(t))}function $(t,a){var i=a[1].length-1;0===t?e("#pData",D).addClass(I):void 0!==a[1][t-1]&&d(e("#"+o(a[1][t-1])),I)?e("#pData",D).addClass(I):e("#pData",D).removeClass(I),t===i?e("#nData",D).addClass(I):void 0!==a[1][t+1]&&d(e("#"+o(a[1][t+1])),I)?e("#nData",D).addClass(I):e("#nData",D).removeClass(I)}function Z(){var t=r.getDataIDs.call(v),a=e("#id_g",x).val();return[e.inArray(a,t),t]}})},delGridRow:function(t,a){return this.each(function(){var n=this,d=n.p,c=e(n);if(n.grid&&null!=d&&t){var f,m,v,g,b=d.id,y=e.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},idSeparator:",",onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1,delui:"disable",deltext:r.getGridRes.call(c,"defaults.deltext")||"Deleting..."},r.getGridRes.call(c,"del"),i.del||{},d.formDeleting||{},a||{}),w="DelTbl_"+b,x="#DelTbl_"+o(b),D={themodal:"delmod"+b,modalhead:"delhd"+b,modalcontent:"delcnt"+b,resizeAlso:w},C="#"+o(D.themodal),k=d.gBox,F=y.commonIconClass,_=function(){var t=e.makeArray(arguments);return t.unshift(""),t.unshift("Delete"),t.unshift(y),s.apply(n,t)},S=h.call(n,"hover"),E=h.call(n,"active"),O=h.call(n,"error");if(e.isArray(t)||(t=[String(t)]),void 0!==e(C)[0]){if(!_("beforeInitData",e(x)))return;e("#DelData>td",x).text(t.join(y.idSeparator)).data("rowids",t),e("#DelError",x).hide(),!0===y.processing&&(y.processing=!1,e("#dData",x).removeClass(E)),_("beforeShowForm",e(x)),i.viewModal.call(n,C,{gbox:k,jqm:y.jqModal,jqM:!1,overlay:y.overlay,toTop:y.toTop,modal:y.modal}),_("afterShowForm",e(x))}else{var j=isNaN(y.dataheight)?y.dataheight:y.dataheight+"px",q=isNaN(y.datawidth)?y.datawidth:y.datawidth+"px",T="<div class='"+l.call(n,"dialog.body")+"'><div id='"+w+"' class='formdata' style='width:"+q+";overflow:auto;position:relative;height:"+j+";'>";T+="<table class='DelTable'><tbody>",T+="<tr id='DelError' style='display:none'><td class='"+O+"'></td></tr>",T+="<tr id='DelData' style='display:none'><td >"+t.join(y.idSeparator)+"</td></tr>",T+="<tr><td class='delmsg'>"+y.msg+"</td></tr>",T+="</tbody></table></div></div>";var A=u.call(n,"dData",y.bSubmit),G=u.call(n,"eData",y.bCancel);if(T+="<div class='"+l.call(n,"dialog.footer")+"'><table class='EditTable' id='"+w+"_2'><tbody><tr><td><hr class='"+l.call(n,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+d.direction+"'>"+A+"&#160;"+G+"</td></tr></tbody></table></div>",y.gbox=k,i.createModal.call(n,D,T,y,d.gView,e(d.gView)[0]),e("#DelData>td",x).data("rowids",t),!_("beforeInitData",e(T)))return;e(".fm-button",x+"_2").hover(function(){e(this).addClass(S)},function(){e(this).removeClass(S)}),p(e("#dData",x+"_2"),y.delicon,F),p(e("#eData",x+"_2"),y.cancelicon,F),e("#dData",x+"_2").click(function(){var t,a=[!0,""],o=e("#DelData>td",x),l=o.text(),s=o.data("rowids"),u={};if(e.isFunction(y.onclickSubmit)&&(u=y.onclickSubmit.call(n,y,l,s)||{}),e.isFunction(y.beforeSubmit)&&(a=y.beforeSubmit.call(n,l,s)||a),a[0]&&!y.processing){if(y.processing=!0,v=d.prmNames,f=e.extend({},y.delData,u),g=v.oper,f[g]=v.deloper,m=v.id,!(l=s.slice()).length)return!1;for(t in l)l.hasOwnProperty(t)&&(l[t]=i.stripPref(d.idPrefix,l[t]));f[m]=l.join(y.idSeparator),e(this).addClass(E);var p=y.url||d.editurl,h=e.extend({url:e.isFunction(p)?p.call(n,f[m],f,y,s):p,type:y.mtype,data:e.isFunction(y.serializeDelData)?y.serializeDelData.call(n,f,s):f,complete:function(t,o){var u;if(c.jqGrid("progressBar",{method:"hide",loadtype:y.delui}),e("#dData",x+"_2").removeClass(E),t.status>=300&&304!==t.status||0===t.status&&4===t.readyState?(a[0]=!1,e.isFunction(y.errorTextFormat)?a[1]=y.errorTextFormat.call(n,t):a[1]=o+" Status: '"+t.statusText+"'. Error code: "+t.status):e.isFunction(y.afterSubmit)&&(a=y.afterSubmit.call(n,t,f,s)||[!0]),!1===a[0])e("#DelError>td",x).html(a[1]),e("#DelError",x).show();else{if("local"===d.datatype||!0===d.treeGrid||!y.reloadAfterSubmit)if(!0===d.treeGrid)try{r.delTreeNode.call(c,s[0])}catch(e){}else for(s=s.slice(),u=0;u<s.length;u++)r.delRowData.call(c,s[u]);y.reloadAfterSubmit&&c.trigger("reloadGrid",[e.extend({},y.reloadGridOptions||{})]),setTimeout(function(){_("afterComplete",t,l,e(x),s)},50)}y.processing=!1,a[0]&&i.hideModal(C,{gb:k,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})}},i.ajaxOptions,y.ajaxDelOptions);if(h.url||y.useDataProxy||(e.isFunction(d.dataProxy)?y.useDataProxy=!0:(a[0]=!1,a[1]+=" "+i.errors.nourl)),a[0])if(c.jqGrid("progressBar",{method:"show",loadtype:y.delui,htmlcontent:y.deltext}),y.useDataProxy){var w=d.dataProxy.call(n,h,"del_"+b);void 0===w&&(w=[!0,""]),!1===w[0]?(a[0]=!1,a[1]=w[1]||"Error deleting the selected row!"):i.hideModal(C,{gb:k,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal})}else"clientArray"===h.url?(f=h.data,h.complete({status:200,statusText:""},"")):e.ajax(h)}return!1===a[0]&&(e("#DelError>td",x).html(a[1]),e("#DelError",x).show()),!1}),e("#eData",x+"_2").click(function(){return i.hideModal(C,{gb:k,jqm:y.jqModal,onClose:y.onClose,removemodal:y.removemodal}),!1}),_("beforeShowForm",e(x)),i.viewModal.call(n,C,{gbox:k,jqm:y.jqModal,overlay:y.overlay,toTop:y.toTop,modal:y.modal}),_("afterShowForm",e(x))}!0===y.closeOnEscape&&setTimeout(function(){e(".ui-jqdialog-titlebar-close","#"+o(D.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(s,c,u,p,f,m,v){return"object"==typeof s&&(v=m,m=f,f=p,p=u,u=c,c=s,s=void 0),p=p||{},u=u||{},v=v||{},f=f||{},m=m||{},this.each(function(){var g=this,b=g.p,y=e(g);if(g.grid&&null!=b&&!(g.nav&&e(s).find(".navtable").length>0)){var w=b.id,x=e.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},r.getGridRes.call(y,"nav"),i.nav||{},b.navOptions||{},c||{});x.position=x.position||("rtl"===b.direction?"right":"left");var D,C,k,F=b.idSel,_=b.gBox,S=x.commonIconClass,E={themodal:"alertmod_"+w,modalhead:"alerthd_"+w,modalcontent:"alertcnt_"+w},O=function(){var r=a.documentElement,n=t,d=1024,s=768,c=y.closest(".ui-jqgrid").offset();void 0===e("#"+o(E.themodal))[0]&&(x.alerttop||x.alertleft||(void 0!==n.innerWidth?(d=n.innerWidth,s=n.innerHeight):null!=r&&void 0!==r.clientWidth&&0!==r.clientWidth&&(d=r.clientWidth,s=r.clientHeight),d=d/2-parseInt(x.alertwidth,10)/2-c.left+(void 0!==n.pageXOffset?n.pageXOffset:(r||a.body.parentNode||a.body).scrollLeft),s=s/2-25-c.top+(void 0!==n.pageYOffset?n.pageYOffset:(r||a.body.parentNode||a.body).scrollTop)),i.createModal.call(g,E,"<div class='"+l.call(g,"dialog.body")+"'><div>"+x.alerttext+"</div></div>",{gbox:_,jqModal:x.jqModal,drag:!0,resize:!0,caption:x.alertcap,top:null!=x.alerttop?x.alerttop:s,left:null!=x.alertleft?x.alertleft:d,width:x.alertwidth,height:x.alertheight,closeOnEscape:x.closeOnEscape,zIndex:x.alertzIndex,removemodal:x.removemodal},b.gView,e(_)[0],!1)),i.viewModal.call(g,"#"+o(E.themodal),{gbox:_,toTop:x.alertToTop,jqm:x.jqModal});var u=e("#"+o(E.modalhead)).find(".ui-jqdialog-titlebar-close");u.attr({tabindex:"0",href:"#",role:"button"}),setTimeout(function(){u.focus()},50)},j=function(t){var a;if(13===t.which&&(a=e(this).find(".ui-pg-button").filter(":focus")).length>0){var i=a[0].id,o=i.substr(0,e(this).closest(".ui-jqgrid-toppager").length>0?i.length-w.length-5:i.length-w.length-1)+"mod"+b.id,r=e(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(e.inArray(o,r)<0)return a.trigger("click"),!1}},q=h.call(g,"hover"),T=h.call(g,"disabled"),A=l.call(g,"navButton","ui-pg-button");if(g.grid){g.modalAlert=O,void 0===s&&(b.pager?(s=b.pager,b.toppager&&(x.cloneToTop=!0)):b.toppager&&(s=b.toppager));var G,I,N,B,P,R,M,z=1,V=["left","center","right"],L="<div class='"+l.call(g,"navButton","ui-pg-button "+h.call(g,"disabled"))+"'><span class='ui-separator'></span></div>",U=function(){d(this,T)||e(this).addClass(q)},H=function(){e(this).removeClass(q)},Q=function(){return d(this,T)||(e.isFunction(x.addfunc)?x.addfunc.call(g,p):r.editGridRow.call(y,"new",p)),!1},K=function(t,a,i){if(!d(this,T)){var o=b.selrow;o?e.isFunction(t)?t.call(g,o,i):r[a].call(y,o,i):O()}return!1},W=function(){return K.call(this,x.editfunc,"editGridRow",u)},X=function(){return K.call(this,x.viewfunc,"viewGridRow",v)},Y=function(){var t;return d(this,T)||(b.multiselect?0===(t=b.selarrrow).length&&(t=null):t=b.selrow,t?e.isFunction(x.delfunc)?x.delfunc.call(g,t,f):r.delGridRow.call(y,t,f):O()),!1},J=function(){return d(this,T)||(e.isFunction(x.searchfunc)?x.searchfunc.call(g,m):r.searchGrid.call(y,m)),!1},$=function(){if(!d(this,T)){e.isFunction(x.beforeRefresh)&&x.beforeRefresh.call(g),b.search=!1,b.resetsearch=!0;try{if("currentfilter"!==x.refreshstate){b.postData.filters="";try{e("#fbox_"+F).jqFilter("resetFilter")}catch(e){}e.isFunction(g.clearToolbar)&&g.clearToolbar(!1)}}catch(e){}switch(x.refreshstate){case"firstpage":y.trigger("reloadGrid",[e.extend({},x.reloadGridOptions||{},{page:1})]);break;case"current":case"currentfilter":y.trigger("reloadGrid",[e.extend({},x.reloadGridOptions||{},{current:!0})])}e.isFunction(x.afterRefresh)&&x.afterRefresh.call(g)}return!1},Z=function(t,a,i){var o=e("<div class='"+A+"' tabindex='0' role='button'></div>"),r=x[t+"icon"],l=e.trim(x[t+"text"]);return o.append("<div class='ui-pg-div'><span class='"+(x.iconsOverText?n("ui-pg-button-icon-over-text",S,r):n(S,r))+"'></span>"+(l?"<span class='ui-pg-button-text"+(x.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l+"</span>":"")+"</div>"),e(k).append(o),o.attr({title:x[t+"title"]||"",id:a||t+"_"+B}).click(i).hover(U,H),o};for(x.cloneToTop&&b.toppager&&(z=2),G=0;G<z;G++){if(k=e("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===b.direction?"right":"left")+";table-layout:auto;'></div>"),0===G?(B=w,(N=s)===b.toppager&&(B+="_top",z=1)):(N=b.toppager,B=w+"_top"),x.add&&Z("add",p.id,Q),x.edit&&Z("edit",u.id,W),x.view&&Z("view",v.id,X),x.del&&Z("del",f.id,Y),(x.add||x.edit||x.del||x.view)&&e(k).append(L),x.search&&(I=Z("search",m.id,J),m.showOnLoad&&!0===m.showOnLoad&&e(I,k).click()),x.refresh&&Z("refresh","",$),C=e(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px",e("body").append("<div id='testpg2' class='"+l.call(g,"gBox","ui-jqgrid")+"' style='font-size:"+C+";visibility:hidden;' ></div>"),D=e(k).clone().appendTo("#testpg2").width(),e("#testpg2").remove(),e(N+"_"+x.position,N).append(k),x.hideEmptyPagerParts)for(P=0;P<V.length;P++)V[P]!==x.position&&(0===(M=e(N+"_"+V[P],N)).length||0===M[0].childNodes.length?M.hide():1===M[0].childNodes.length&&(R=M[0].firstChild,!e(R).is("table.ui-pg-table")||0!==R.rows&&0!==R.rows[0].cells.length||M.hide()));b._nvtd&&(D>b._nvtd[0]&&(e(N+"_"+x.position,N).width(D),b._nvtd[0]=D),b._nvtd[1]=D),g.nav=!0,k.on("keydown.jqGrid",j)}y.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(t,a){return"object"==typeof t&&(a=t,t=void 0),this.each(function(){var s=this,c=s.p;if(s.grid){var u=e.extend({caption:"newButton",title:"",onClickButton:null,position:"last",iconsOverText:!1},r.getGridRes.call(e(s),"nav"),i.nav||{},c.navOptions||{},a||{}),p=u.id,f=h.call(s,"hover"),m=h.call(s,"disabled"),v=l.call(s,"navButton","ui-pg-button");if(void 0===t)if(c.pager){if(r.navButtonAdd.call(e(s),c.pager,u),!c.toppager)return;t=c.toppager,p&&(p+="_top")}else c.toppager&&(t=c.toppager);"string"==typeof t&&0!==t.indexOf("#")&&(t="#"+o(t));var g=e(".navtable",t),b=u.commonIconClass;if(g.length>0){if(p&&g.find("#"+o(p)).length>0)return;var y=e("<div tabindex='0' role='button'></div>");"NONE"===u.buttonicon.toString().toUpperCase()?e(y).addClass(v).append("<div class='ui-pg-div'>"+(u.caption?"<span class='ui-pg-button-text"+(u.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+u.caption+"</span>":"")+"</div>"):e(y).addClass(v).append("<div class='ui-pg-div'><span class='"+(u.iconsOverText?n("ui-pg-button-icon-over-text",b,u.buttonicon):n(b,u.buttonicon))+"'></span>"+(u.caption?"<span class='ui-pg-button-text"+(u.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+u.caption+"</span>":"")+"</div>"),p&&e(y).attr("id",p),"first"===u.position&&g.children("div.ui-pg-button").length>0?g.children("div.ui-pg-button").first().before(y):g.append(y),e(y,g).attr("title",u.title||"").click(function(t){return d(this,m)||e.isFunction(u.onClickButton)&&u.onClickButton.call(s,u,t),!1}).hover(function(){d(this,m)||e(this).addClass(f)},function(){e(this).removeClass(f)}),e(s).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(t,a){return a=e.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},a||{}),this.each(function(){if(this.grid){var i=this.p,n=l.call(this,"navButton","ui-pg-button "+h.call(this,"disabled"));if(void 0===t)if(i.pager){if(r.navSeparatorAdd.call(e(this),i.pager,a),!i.toppager)return;t=i.toppager}else i.toppager&&(t=i.toppager);"string"==typeof t&&0!==t.indexOf("#")&&(t="#"+o(t));var d=e(".navtable",t);if(d.length>0){var s="<div class='"+n+"'><span class='"+a.sepclass+"'></span>"+a.sepcontent+"</div>";"first"===a.position?0===d.children("div.ui-pg-button").length?d.append(s):d.children("div.ui-pg-button").first().before(s):d.append(s)}}})},GridToForm:function(t,a){return this.each(function(){var i,l,n,d;if(this.grid){var s=r.getRowData.call(e(this),t);if(s)for(i in s)if(s.hasOwnProperty(i))if((l=e("[name="+o(i)+"]",a)).is("input:radio")||l.is("input:checkbox"))for(n=0;n<l.length;n++)(d=e(l[n])).prop("checked",d.val()===String(s[i]));else l.val(m(s[i])?"":s[i])}})},FormToGrid:function(t,a,i,o){return this.each(function(){if(this.grid){i||(i="set"),o||(o="first");var l=e(a).serializeArray(),n={};e.each(l,function(e,t){n[t.name]=t.value}),"add"===i?r.addRowData.call(e(this),t,n,o):"set"===i&&r.setRowData.call(e(this),t,n)}})}})});
//# sourceMappingURL=grid.formedit.js.map