!function(t,a){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./grid.filter"],function(e){return a(e,t,t.document)}):"object"==typeof module&&module.exports?module.exports=function(e,t){return e||(e=window),void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),require("./grid.base"),require("./jquery.fmatter"),require("./grid.common"),require("./grid.filter"),a(t,e,e.document),t}:a(jQuery,t,t.document)}("undefined"!=typeof window?window:this,function(oe,U,H){"use strict";var re=oe.jgrid,le=re.jqID,ne=oe.fn.jqGrid,de=ne.getGuiStyles,se=re.mergeCssClasses,ce=re.hasOneFromClasses,ue=re.feedback,E=re.fullBoolFeedback,pe=re.builderFmButon,fe=function(e,t,a){var i;!0===t[0]&&(i="<span class='"+se("fm-button-icon",a,t[2])+"'></span>","right"===t[1]?e.addClass("fm-button-icon-right").append(i):e.addClass("fm-button-icon-left").prepend(i))},he=function(e){return de.call(this,"states."+e)},me=function(e){e.find("tr[data-rowpos]").each(function(){var e=0;oe(this).children("td").each(function(){"hidden"!==oe(this).css("visibility")&&e++}),e||oe(this).hide()})},ve=function(e){return"&nbsp;"===e||"&#160;"===e||1===e.length&&160===e.charCodeAt(0)};re.extend({searchGrid:function(S){return this.each(function(){var r=this,l=oe(r),n=r.p;if(r.grid&&null!=n){var d=oe.extend(!0,{drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:n.prmNames.filters,loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE",in:"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},ne.getGridRes.call(l,"search"),re.search||{},n.searching||{},S||{}),s="fbox_"+n.id,e=d.commonIconClass,a={themodal:"searchmod"+s,modalhead:"searchhd"+s,modalcontent:"searchcnt"+s,resizeAlso:s},t="#"+le(a.themodal),i=n.gBox,o=n.gView,c=oe.each,u=n.postData[d.sFilter],p=function(){var e=oe.makeArray(arguments);return e.unshift("Search"),e.unshift("Filter"),e.unshift(d),ue.apply(r,e)},f=function(){re.hideModal(t,{gb:i,jqm:d.jqModal,onClose:d.onClose,removemodal:d.removemodal})};if("string"==typeof u&&(u=""!==oe.trim(u)?oe.parseJSON(u):void 0),oe(t).remove(),void 0!==oe(t)[0])_(oe("#fbox_"+le(n.id)));else{var h=oe("<div><div id='"+s+"' class='"+de.call(r,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(o);"rtl"===n.direction&&h.attr("dir","rtl");var m,v,g="",b="",y=!1,w=-1,x=oe.extend([],n.colModel),D=pe.call(r,s+"_search",d.Find,se(e,d.findDialogIcon),"right"),C=pe.call(r,s+"_reset",d.Reset,se(e,d.resetDialogIcon),"left");if(d.showQuery&&(g=pe.call(r,s+"_query","Query",se(e,d.queryDialogIcon),"left")+"&#160;"),d.searchForAdditionalProperties&&c(n.additionalProperties,function(){var e="string"==typeof this?{name:this}:this;e.label||(e.label=e.name),e.isAddProp=!0,x.push(e)}),d.columns.length?(x=d.columns,m=x[w=0].index||x[0].name):c(x,function(e,t){if(t.label||(t.label=t.isAddProp?t.name:n.colNames[e]),!y){var a=void 0===t.search||t.search,i=!0===t.hidden;(t.searchoptions&&!0===t.searchoptions.searchhidden&&a||a&&!i)&&(y=!0,m=t.index||t.name,w=e)}}),!u&&m||!1===d.multipleSearch){var k="eq";0<=w&&x[w].searchoptions&&x[w].searchoptions.sopt?k=x[w].searchoptions.sopt[0]:d.sopt&&d.sopt.length&&(k=d.sopt[0]),u={groupOp:"AND",rules:[{field:m,op:k,data:""}]}}y=!1,d.tmplNames&&d.tmplNames.length&&(y=!0,b=d.tmplLabel,b+="<select class='ui-template'>",b+="<option value='default'>Default</option>",c(d.tmplNames,function(e,t){b+="<option value='"+e+"'>"+t+"</option>"}),b+="</select>"),v="<div class='"+de.call(r,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+s+"_2'><tbody><tr><td colspan='2'><hr class='"+de.call(r,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+n.direction+"'  style='float:"+("rtl"===n.direction?"right":"left")+";'>"+C+b+"</td><td class='EditButton EditButton-"+n.direction+"'>"+g+D+"</td></tr></tbody></table></div>",s=le(s),d.gbox=i,d.height="auto",oe(s="#"+s).jqFilter({columns:x,filter:d.loadDefaults?u:null,showQuery:d.showQuery,errorcheck:d.errorcheck,sopt:d.sopt,groupButton:d.multipleGroup,ruleButtons:d.multipleSearch,afterRedraw:d.afterRedraw,ops:d.odata,cops:n.customSortOperations,operands:d.operands,ajaxSelectOptions:n.ajaxSelectOptions,groupOps:d.groupOps,onChange:function(e,t){e.showQuery&&oe(".query",t).text(t.toUserFriendlyString()),E.call(r,d.afterChange,"jqGridFilterAfterChange",oe(s),d,e,t)},direction:n.direction,id:n.id}),h.append(v),y&&d.tmplFilters&&d.tmplFilters.length&&oe(".ui-template",h).on("change",function(){var e=oe(this).val();return"default"===e?oe(s).jqFilter("addFilter",u):oe(s).jqFilter("addFilter",d.tmplFilters[parseInt(e,10)]),!1}),!0===d.multipleGroup&&(d.multipleSearch=!0),p("onInitialize",oe(s)),d.layer?re.createModal.call(r,a,h,d,o,oe(i)[0],"#"+le(d.layer),{position:"relative"}):re.createModal.call(r,a,h,d,o,oe(i)[0]),(d.searchOnEnter||d.closeOnEscape)&&oe(t).keydown(function(e){var t=oe(e.target);return!d.searchOnEnter||13!==e.which||t.hasClass("add-group")||t.hasClass("add-rule")||t.hasClass("delete-group")||t.hasClass("delete-rule")||t.hasClass("fm-button")&&t.is("[id$=_query]")?d.closeOnEscape&&27===e.which?(oe("#"+le(a.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1):void 0:(oe(s+"_search").click(),!1)}),g&&oe(s+"_query").on("click",function(){return oe(".queryresult",h).toggle(),!1}),void 0===d.stringResult&&(d.stringResult=d.multipleSearch),oe(s+"_search").on("click",function(){var e,t={},a="",i=oe(s),o=i.find(".input-elm");if(o.filter(":focus")&&(o=o.filter(":focus")),o.change(),e=i.jqFilter("filterData"),d.errorcheck&&(i[0].hideError(),d.showQuery||i.jqFilter("toSQLString"),i[0].p.error))return i[0].showError(),!1;if(d.stringResult||"local"===n.datatype){try{a=JSON.stringify(e)}catch(e){}"string"==typeof a&&(t[d.sFilter]=a,c([d.sField,d.sValue,d.sOper],function(){t[this]=""}))}else d.multipleSearch?(t[d.sFilter]=e,c([d.sField,d.sValue,d.sOper],function(){t[this]=""})):(t[d.sField]=e.rules[0].field,t[d.sValue]=e.rules[0].data,t[d.sOper]=e.rules[0].op,t[d.sFilter]="");return oe.extend(n.postData,t),E.call(r,d.onSearch,"jqGridFilterSearch",n.filters)&&(n.search=!0,l.trigger("reloadGrid",[oe.extend({page:1},d.reloadGridSearchOptions||{})])),d.closeAfterSearch&&f(),!1}),oe(s+"_reset").on("click",function(){var e={},t=oe(s);return n.search=!1,!(n.resetsearch=!0)===d.multipleSearch?e[d.sField]=e[d.sValue]=e[d.sOper]="":e[d.sFilter]="",t[0].resetFilter(),y&&oe(".ui-template",h).val("default"),oe.extend(n.postData,e),E.call(r,d.onReset,"jqGridFilterReset")&&l.trigger("reloadGrid",[oe.extend({page:1},d.reloadGridResetOptions||{})]),d.closeAfterReset&&f(),!1}),_(oe(s));var F=he.call(r,"hover");oe(".fm-button:not(."+he.call(r,"disabled").split(" ").join(".")+")",h).hover(function(){oe(this).addClass(F)},function(){oe(this).removeClass(F)})}}function _(e){p("beforeShow",e)&&(oe(t).data("onClose",d.onClose),re.viewModal.call(r,t,{gbox:i,jqm:d.jqModal,overlay:d.overlay,modal:d.modal,overlayClass:d.overlayClass,toTop:d.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),p("afterShow",e))}})},editGridRow:function(ae,ie){return this.each(function(){var E=this,O=oe(E),j=E.p;if(E.grid&&null!=j&&ae){var y,w,q=j.id,n=ne.getGridRes,x=ne.setSelection,T=oe.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:de.call(this,"overlay"),removemodal:!0,skipPostTypes:["image","file"],saveui:"enable",savetext:n.call(O,"defaults.savetext")||"Saving..."},n.call(O,"edit"),re.edit,j.formEditing||{},ie||{}),A="FrmGrid_"+q,e=A,t="TblGrid_"+q,D="#"+le(t),C=D+"_2",a={themodal:"editmod"+q,modalhead:"edithd"+q,modalcontent:"editcnt"+q,resizeAlso:A},i="#"+le(a.themodal),o=j.gBox,G=j.colModel,d=j.iColByName,r=1,l=0,s=T.commonIconClass,k=function(){re.hideModal(i,{gb:o,jqm:T.jqModal,onClose:T.onClose,removemodal:T.removemodal})},c=n.call(O,"errors.errcap"),u=function(){var e=oe.makeArray(arguments);return e.unshift(""),e.unshift("AddEdit"),e.unshift(T),ue.apply(E,e)},p=he.call(E,"hover"),I=he.call(E,"disabled"),f=he.call(E,"select"),F=he.call(E,"active"),h=he.call(E,"error");oe(i).remove(),A="#"+le(A),"new"===ae?(ae="_empty",w="add",T.caption=T.addCaption):(T.caption=T.editCaption,w="edit");var m=!0;!T.checkOnUpdate||!0!==T.jqModal&&void 0!==T.jqModal||T.modal||(m=!1);var v=isNaN(T.dataheight)?T.dataheight:T.dataheight+"px",g=isNaN(T.datawidth)?T.datawidth:T.datawidth+"px",b=oe("<form name='FormPost' id='"+e+"' class='FormGrid' onSubmit='return false;' style='width:"+g+";overflow:auto;position:relative;height:"+v+";'></form>").data("disabled",!1),_=oe("<table id='"+t+"' class='EditTable'><tbody></tbody></table>");oe(G).each(function(){var e=this.formoptions;r=Math.max(r,e&&e.colpos||0),l=Math.max(l,e&&e.rowpos||0)}),oe(b).append(_);var S=oe("<tr id='FormError' style='display:none'><td class='"+h+"' colspan='"+2*r+"'>&#160;</td></tr>");if(S[0].rp=0,oe(_).append(S),(S=oe("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*r+"'>"+(T.topinfo||"&#160;")+"</td></tr>"))[0].rp=0,oe(_).append(S),u("beforeInitData",b,w)){!function(){var e=re.detectRowEditing.call(E,ae);if(null!=e)if("inlineEditing"===e.mode)ne.restoreRow.call(O,ae);else{var t=e.savedRow,a=E.rows[t.id];ne.restoreCell.call(O,t.id,t.ic),oe(a.cells[t.ic]).removeClass("edit-cell "+f),oe(a).addClass(f).attr({"aria-selected":"true",tabindex:"0"})}}();var N="rtl"===j.direction,B=N?"nData":"pData",P=N?"pData":"nData";!function(x,e,D){var t,C=0,k=[],F=!1,_=oe(e),S="";for(t=1;t<=D;t++)S+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";if("_empty"!==x&&(F=ne.getInd.call(O,x)),oe(G).each(function(e){var t,a,i,o,r,l=this,n=l.name,d=l.editable,s=!1,c=!1,u="_empty"===x?"addForm":"editForm";switch(oe.isFunction(d)&&(d=d.call(E,{rowid:x,iCol:e,iRow:F,cmName:n,cm:l,mode:u})),a=!(l.editrules&&!0===l.editrules.edithidden||!0!==l.hidden&&"hidden"!==d),String(d).toLowerCase()){case"hidden":d=!0;break;case"disabled":s=d=!0;break;case"readonly":c=d=!0}if("cb"!==n&&"subgrid"!==n&&!0===d&&"rn"!==n){if(!1===F)o="";else{t=oe(E.rows[F].cells[e]);try{o=oe.unformat.call(E,t,{rowId:x,colModel:l},e)}catch(e){o=l.edittype&&"textarea"===l.edittype?t.text():t.html()}ve(o)&&(o="")}var p=oe.extend({},l.editoptions||{},{id:n,name:n,rowId:x,mode:u,cm:l,iCol:e}),f=oe.extend({},{elmprefix:"",elmsuffix:"",rowabove:!1,rowcontent:""},l.formoptions||{}),h=parseInt(f.rowpos,10)||C+1,m=parseInt(2*(parseInt(f.colpos,10)||1),10);if("_empty"===x&&p.defaultValue&&(o=oe.isFunction(p.defaultValue)?p.defaultValue.call(E):p.defaultValue),l.edittype||(l.edittype="text"),j.autoEncodeOnEdit&&(o=re.oldDecodePostedData(o)),r=re.createEl.call(E,l.edittype,p,o,!1,oe.extend({},re.ajaxOptions,j.ajaxSelectOptions||{})),(T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[n]=o),oe(r).addClass("FormElement"),-1<oe.inArray(l.edittype,["text","textarea","checkbox","password","select"])&&oe(r).addClass(de.call(E,"dialog.dataField")),i=_.find("tr[data-rowpos="+h+"]"),f.rowabove){var v=oe("<tr><td class='contentinfo' colspan='"+2*D+"'>"+f.rowcontent+"</td></tr>");_.append(v),v[0].rp=h}0===i.length&&(i=oe("<tr data-rowpos='"+h+"'></tr>").addClass("FormData").attr("id","tr_"+n),oe(i).append(S),_.append(i),i[0].rp=h);var g=oe("td:eq("+(m-2)+")",i[0]),b=oe("td:eq("+(m-1)+")",i[0]);g.html(void 0===f.label?j.colNames[e]:f.label||"&#160;");var y=b[ve(b.html())?"html":"append"](f.elmprefix);if(y.append(r).append(f.elmsuffix),"INPUT"===r.tagName.toUpperCase()&&l.createColumnIndex&&p.generateDatalist){var w=O.jqGrid("generateDatalistFromColumnIndex",l.name);null!=w&&0<w.length&&(oe(r).attr("list","dl_"+r.id),y.append(w.attr("id","dl_"+r.id)))}s?(g.addClass(I),b.addClass(I),oe(r).prop("readonly",!0),oe(r).prop("disabled",!0)):c&&oe(r).prop("readonly",!0),"custom"===l.edittype&&oe.isFunction(p.custom_value)&&p.custom_value.call(E,oe("#"+le(n),A),"set",o),re.bindEv.call(E,r,p),a&&g.add(b).css("visibility","hidden"),k[C]=e,C++}}),me(_),0<C){var a=oe("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*D-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+q+"_id' value='"+x+"'/></td></tr>");a[0].rp=C+999,_.append(a),(T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[q+"_id"]=x)}}(ae,_,r);var R=pe.call(E,B,"",se(s,T.prevIcon),"","left"),M=pe.call(E,P,"",se(s,T.nextIcon),"","right"),z=pe.call(E,"sData",T.bSubmit),V=pe.call(E,"cData",T.bCancel),L="<div class='"+de.call(E,"dialog.footer")+"'><table class='EditTable' id='"+t+"_2'><tbody><tr><td colspan='2'><hr class='"+de.call(E,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+j.direction+"'>"+(N?M+R:R+M)+"</td><td class='EditButton EditButton-"+j.direction+"'>"+z+"&#160;"+V+"</td></tr>";if(L+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(T.bottominfo||"&#160;")+"</td></tr>",L+="</tbody></table></div>",0<l){var U=[];oe.each(oe(_)[0].rows,function(e,t){U[e]=t}),U.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),oe.each(U,function(e,t){oe("tbody",_).append(t)})}T.gbox=o;var H=!1;!0===T.closeOnEscape&&(T.closeOnEscape=!1,H=!0);var Q=oe("<div></div>").append(oe("<div class='"+de.call(E,"dialog.body")+"'></div>").append(b)).append(L);if(re.createModal.call(E,a,Q,T,j.gView,oe(o)[0]),T.topinfo&&oe(".tinfo",D).show(),T.bottominfo&&oe(".binfo",C).show(),L=Q=null,oe(i).keydown(function(e){var t,a,i=(e.target.tagName||"").toUpperCase();if(!0===oe(A).data("disabled"))return!1;if(13===e.which&&"TEXTAREA"!==i){if(a=(t=oe(C).find(":focus")).attr("id"),0<t.length&&0<=oe.inArray(a,["pData","nData","cData"]))return t.trigger("click"),!1;if(!0===T.savekey[0]&&13===T.savekey[1])return oe("#sData",C).trigger("click"),!1}if(!0===T.savekey[0]&&e.which===T.savekey[1]&&"TEXTAREA"!==i)return oe("#sData",C).trigger("click"),!1;if(27===e.which)return Z()&&H&&k(),!1;if(!0===T.navkeys[0]){if("_empty"===oe("#id_g",D).val())return!0;if(e.which===T.navkeys[1])return oe("#pData",C).trigger("click"),!1;if(e.which===T.navkeys[2])return oe("#nData",C).trigger("click"),!1}}),T.checkOnUpdate&&(oe("a.ui-jqdialog-titlebar-close span",i).removeClass("jqmClose"),oe("a.ui-jqdialog-titlebar-close",i).off("click").click(function(){return Z()&&k(),!1})),fe(oe("#sData",C),T.saveicon,s),fe(oe("#cData",C),T.closeicon,s),T.checkOnSubmit||T.checkOnUpdate){z=pe.call(E,"sNew",T.bYes),M=pe.call(E,"nNew",T.bNo),V=pe.call(E,"cNew",T.bExit);var K=T.zIndex||999;K++,oe("<div class='"+T.overlayClass+" jqgrid-overlay confirm' style='z-index:"+K+";display:none;'>&#160;</div><div class='"+de.call(E,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(K+1)+"'>"+T.saveData+"<br/><br/>"+z+M+V+"</div>").insertAfter(A),oe("#sNew",i).click(function(){return J(),oe(A).data("disabled",!1),oe(".confirm",i).hide(),!1}),oe("#nNew",i).click(function(){return oe(".confirm",i).hide(),oe(A).data("disabled",!1),setTimeout(function(){oe(A).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()},0),!1}),oe("#cNew",i).click(function(){return oe(".confirm",i).hide(),oe(A).data("disabled",!1),k(),!1})}u("onInitializeForm",oe(A),w),"_empty"!==ae&&T.viewPagerButtons?oe("#pData,#nData",C).show():oe("#pData,#nData",C).hide(),u("beforeShowForm",oe(A),w),oe(i).data("onClose",T.onClose),re.viewModal.call(E,i,{gbox:o,jqm:T.jqModal,overlay:T.overlay,modal:T.modal,overlayClass:T.overlayClass,toTop:T.toTop,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),m||oe("."+le(T.overlayClass)).click(function(){return Z()&&k(),!1}),oe(".fm-button",i).hover(function(){oe(this).addClass(p)},function(){oe(this).removeClass(p)}),oe("#sData",C).click(function(){return y={},oe("#FormError",D).hide(),X(),"_empty"===y[q+"_id"]?J():!0===T.checkOnSubmit&&$(y,T._savedData)?(oe(A).data("disabled",!0),oe(".confirm",i).show()):J(),!1}),oe("#cData",C).click(function(){return Z()&&k(),!1}),oe("#nData",C).click(function(){if(!Z())return!1;oe("#FormError",D).hide();var e=te();if(e[0]=parseInt(e[0],10),-1!==e[0]&&e[1][e[0]+1]){if(!u("onclickPgButtons","next",oe(A),e[1][e[0]]))return!1;Y(e[1][e[0]+1],A),x.call(O,e[1][e[0]+1]),u("afterclickPgButtons","next",oe(A),e[1][e[0]+1]),ee(e[0]+1,e)}return!1}),oe("#pData",C).click(function(){if(!Z())return!1;oe("#FormError",D).hide();var e=te();if(-1!==e[0]&&e[1][e[0]-1]){if(!u("onclickPgButtons","prev",oe(A),e[1][e[0]]))return!1;if(ce(oe("#"+le(e[1][e[0]-1])),I))return!1;Y(e[1][e[0]-1],A),x.call(O,e[1][e[0]-1]),u("afterclickPgButtons","prev",oe(A),e[1][e[0]-1]),ee(e[0]-1,e)}return!1}),u("afterShowForm",oe(A),w);var W=te();ee(W[0],W)}}function X(){return oe(D+" > tbody > tr > td .FormElement").each(function(){var e,t,a,i,o=oe(".customelement",this),r=this.name;if(o.length){if(r=o.attr("name"),void 0!==(e=d[r])&&(t=G[e].editoptions||{},oe.isFunction(t.custom_value))){try{if(y[r]=t.custom_value.call(E,oe("#"+le(r),D),"get"),void 0===y[r])throw"e1"}catch(e){"e1"===e?re.info_dialog.call(E,c,"function 'custom_value' "+T.msg.novalue,T.bClose):re.info_dialog.call(E,c,e.message,T.bClose)}return!0}}else switch(i=oe(this)[0].type){case"checkbox":y[r]=oe(this).is(":checked")?oe(this).val():oe(this).data("offval");break;case"select-one":y[r]=oe("option:selected",this).val();break;case"select-multiple":y[r]=oe(this).val(),y[r]=y[r]?y[r].join(","):"";var l=[];oe("option:selected",this).each(function(e,t){l[e]=oe(t).text()});break;case"date":y[r]=oe(this).val(),3===String(y[r]).split("-").length&&void 0!==(e=d[r])&&(a=(G[e].formatoptions||{}).newformat||n.call(O,"formatter.date.newformat"),y[r]=re.parseDate.call(O[0],"Y-m-d",y[r],a));break;default:void 0!==i&&oe.inArray(i,T.skipPostTypes)<0&&(y[r]=oe(this).val())}}),!0}function Y(e,t){var a,i,o,r,l,n=0;(T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData={},T._savedData[q+"_id"]=e);var d=j.colModel;if("_empty"===e)return oe(d).each(function(){a=this.name,o=oe.extend({},this.editoptions||{}),(i=oe("#"+le(a),t))&&i.length&&null!==i[0]&&(r="","custom"===this.edittype&&oe.isFunction(o.custom_value)?o.custom_value.call(E,i,"set",r):o.defaultValue?(r=oe.isFunction(o.defaultValue)?o.defaultValue.call(E):o.defaultValue,"checkbox"===i[0].type?(l=r.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==l?(i[0].checked=!0,i[0].defaultChecked=!0,i[0].value=r):(i[0].checked=!1,i[0].defaultChecked=!1):i.val(r)):"checkbox"===i[0].type?(i[0].checked=!1,i[0].defaultChecked=!1,r=oe(i).data("offval")):i[0].type&&"select"===i[0].type.substr(0,6)?i[0].selectedIndex=0:i.val(r),(!0===T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[a]=r))}),void oe("#id_g",t).val(e);var s=ne.getInd.call(O,e,!0);s&&(oe(s.cells).filter("td[role=gridcell]").each(function(o){var i;if("cb"!==(a=d[o].name)&&"subgrid"!==a&&"rn"!==a&&!0===d[o].editable){try{i=oe.unformat.call(E,oe(this),{rowId:e,colModel:d[o]},o)}catch(e){i="textarea"===d[o].edittype?oe(this).text():oe(this).html()}switch(j.autoEncodeOnEdit&&(i=re.oldDecodePostedData(i)),(!0===T.checkOnSubmit||T.checkOnUpdate)&&(T._savedData[a]=i),a="#"+le(a),d[o].edittype){case"password":case"text":case"button":case"image":case"textarea":ve(i)&&(i=""),oe(a,t).val(i);break;case"select":var r=i.split(",");r=oe.map(r,function(e){return oe.trim(e)}),oe(a+" option",t).each(function(){var e,t=this,a=oe(t),i=oe.trim(a.val());if(d[o].editoptions.multiple||r[0]!==i?d[o].editoptions.multiple&&-1<(e=oe.inArray(i,r))?(r.splice(e,1),t.selected=!0):t.selected=!1:(r.splice(0,1),t.selected=!0),0===r.length)return!1}),0<r.length&&oe(a+" option",t).each(function(){var e,t=oe(this),a=oe.trim(t.text());if(d[o].editoptions.multiple||oe.trim(i)!==a&&r[0]!==a?d[o].editoptions.multiple&&-1<(e=oe.inArray(a,r))&&(r.splice(e,1),this.selected=!0):(r.splice(0,1),this.selected=!0),0===r.length)return!1});break;case"checkbox":i=String(i),i=d[o].editoptions&&d[o].editoptions.value?d[o].editoptions.value.split(":")[0]===i:(i=i.toLowerCase()).search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==i,oe(a,t).prop({checked:i,defaultChecked:i});break;case"custom":try{if(!d[o].editoptions||!oe.isFunction(d[o].editoptions.custom_value))throw"e1";d[o].editoptions.custom_value.call(E,oe(a,t),"set",i)}catch(e){"e1"===e?re.info_dialog.call(E,c,"function 'custom_value' "+T.msg.nodefined,T.bClose):re.info_dialog.call(E,c,e.message,T.bClose)}}n++}}),0<n&&oe("#id_g",D).val(e))}function J(){var r,l,e,n,t,a,i,o,d,s=[!0,"",""],c=s,u={},p=j.prmNames,f=ne.getInd.call(O,ae),h=!1===f?null:E.rows[f],m=O.triggerHandler("jqGridAddEditBeforeCheckValues",[y,oe(A),w]);for(e in m&&"object"==typeof m&&(y=m),f=!1===f?-1:f,oe.isFunction(T.beforeCheckValues)&&(m=T.beforeCheckValues.call(E,y,oe(A),w))&&"object"==typeof m&&(y=m),y)if(y.hasOwnProperty(e)&&(o=j.iColByName[e],null!=(c=re.checkValues.call(E,y[e],e,void 0,void 0,{oldValue:"_empty"===ae?null:ne.getCell.call(O,ae,o),newValue:y[e],cmName:e,rowid:ae,cm:G[o],iCol:o,iRow:f,tr:h,td:null==h?null:h.cells[o],mode:"_empty"===ae?"addForm":"editForm"}))&&!0!==c||(c=s),!1===c[0]))break;if(d=T.url||j.editurl,oe.each(G,function(e,t){var a=t.name;y.hasOwnProperty(a)&&("date"!==t.formatter||null!=t.formatoptions&&!0===t.formatoptions.sendFormatted||(y[a]=oe.unformat.date.call(E,y[a],t)),"clientArray"!==d&&t.editoptions&&!0===t.editoptions.NullIfEmpty&&""===y[a]&&(y[a]="null"))}),c[0]&&(void 0===(u=O.triggerHandler("jqGridAddEditClickSubmit",[T,y,w]))&&oe.isFunction(T.onclickSubmit)&&(u=T.onclickSubmit.call(E,T,y,w)||{}),null!=(c=O.triggerHandler("jqGridAddEditBeforeSubmit",[y,oe(A),w]))&&!0!==c||(c=s),c[0]&&oe.isFunction(T.beforeSubmit)&&(null!=(c=T.beforeSubmit.call(E,y,oe(A),w))&&!0!==c||(c=s))),c[0]&&!T.processing){if(T.processing=!0,oe("#sData",C).addClass(F),a=T.url||j.editurl,l=p.oper,r="clientArray"===a&&!1!==j.keyName?j.keyName:p.id,y[l]="_empty"===oe.trim(y[q+"_id"])?p.addoper:p.editoper,y[l]!==p.addoper?y[r]=y[q+"_id"]:void 0===y[r]&&(y[r]=y[q+"_id"]),delete y[q+"_id"],y=oe.extend(y,T.editData,u),!0===j.treeGrid){if(y[l]===p.addoper){n=j.selrow;var v="adjacency"===j.treeGridModel?j.treeReader.parent_id_field:"parent_id";y[v]=n}for(t in j.treeReader)if(j.treeReader.hasOwnProperty(t)&&(i=j.treeReader[t],y.hasOwnProperty(i))){if(y[l]===p.addoper&&"parent_id_field"===t)continue;delete y[i]}}y[r]=re.stripPref(j.idPrefix,y[r]),j.autoEncodeOnEdit&&oe.each(y,function(e,t){oe.isFunction(t)||(y[e]=re.oldEncodePostedData(t))});var g=oe.extend({url:oe.isFunction(a)?a.call(E,y[r],w,y,T):a,type:oe.isFunction(T.mtype)?T.mtype.call(E,w,T,y[r],y):T.mtype,data:re.serializeFeedback.call(E,oe.isFunction(T.serializeEditData)?T.serializeEditData:j.serializeEditData,"jqGridAddEditSerializeEditData",y),complete:function(e,t){if(O.jqGrid("progressBar",{method:"hide",loadtype:T.saveui}),oe("#sData",C).removeClass(F),y[r]=oe("#id_g",D).val(),300<=e.status&&304!==e.status||0===e.status&&4===e.readyState?(c[0]=!1,c[1]=O.triggerHandler("jqGridAddEditErrorTextFormat",[e,w]),oe.isFunction(T.errorTextFormat)?c[1]=T.errorTextFormat.call(E,e,w):c[1]=t+" Status: '"+e.statusText+"'. Error code: "+e.status):(null!=(c=O.triggerHandler("jqGridAddEditAfterSubmit",[e,y,w]))&&!0!==c||(c=s),c[0]&&oe.isFunction(T.afterSubmit)&&(null!=(c=T.afterSubmit.call(E,e,y,w))&&!0!==c||(c=s))),!1===c[0])oe("#FormError>td",D).html(c[1]),oe("#FormError",D).show();else{j.autoEncodeOnEdit&&oe.each(y,function(e,t){y[e]=re.oldDecodePostedData(t)});var a,i=[oe.extend({},T.reloadGridOptions||{})];if(y[l]===p.addoper?(c[2]||(c[2]=re.randId()),null==y[r]||"_empty"===y[r]||y[l]===p.addoper?y[r]=c[2]:c[2]=y[r],T.reloadAfterSubmit?O.trigger("reloadGrid",i):!0===j.treeGrid?ne.addChildNode.call(O,c[2],n,y):ne.addRowData.call(O,c[2],y,T.addedrow),T.closeAfterAdd?(!0!==j.treeGrid&&x.call(O,c[2]),k()):T.clearAfterAdd&&Y("_empty",A)):(T.reloadAfterSubmit?(O.trigger("reloadGrid",i),T.closeAfterEdit||setTimeout(function(){x.call(O,y[r])},1e3)):!0===j.treeGrid?ne.setTreeRow.call(O,y[r],y):ne.setRowData.call(O,y[r],y),T.closeAfterEdit&&k()),oe.isFunction(T.afterComplete)){var o=e;setTimeout(function(){O.triggerHandler("jqGridAddEditAfterComplete",[o,y,oe(A),w]),T.afterComplete.call(E,o,y,oe(A),w),o=null},50)}if(T.checkOnSubmit||T.checkOnUpdate)if(oe(A).data("disabled",!1),"_empty"!==T._savedData[q+"_id"])for(a in T._savedData)T._savedData.hasOwnProperty(a)&&y[a]&&(T._savedData[a]=y[a])}T.processing=!1;try{oe(A).find("input,textarea,select,button,object,*[tabindex]").filter(":input:visible:not(:disabled)").first().focus()}catch(e){}}},re.ajaxOptions,T.ajaxEditOptions);if(g.url||T.useDataProxy||(oe.isFunction(j.dataProxy)?T.useDataProxy=!0:(c[0]=!1,c[1]+=" "+re.errors.nourl)),c[0])if(O.jqGrid("progressBar",{method:"show",loadtype:T.saveui,htmlcontent:T.savetext}),T.useDataProxy){var b=j.dataProxy.call(E,g,"set_"+q);void 0===b&&(b=[!0,""]),!1===b[0]?(c[0]=!1,c[1]=b[1]||"Error deleting the selected row!"):(g.data.oper===p.addoper&&T.closeAfterAdd&&k(),g.data.oper===p.editoper&&T.closeAfterEdit&&k())}else"clientArray"===g.url?(T.reloadAfterSubmit=!1,y=g.data,g.complete({status:200,statusText:""},"")):oe.ajax(g)}!1===c[0]&&(oe("#FormError>td",D).html(c[1]),oe("#FormError",D).show())}function $(e,t){var a,i=!1;for(a in e)if(e.hasOwnProperty(a)&&String(e[a])!==String(t[a])){i=!0;break}return i}function Z(){var e=!0;return oe("#FormError",D).hide(),T.checkOnUpdate&&(y={},X(),$(y,T._savedData)&&(oe(A).data("disabled",!0),oe(".confirm",i).show(),e=!1)),e}function ee(e,t){var a=t[1].length-1;0===e?oe("#pData",C).addClass(I):void 0!==t[1][e-1]&&ce(oe("#"+le(t[1][e-1])),I)?oe("#pData",C).addClass(I):oe("#pData",C).removeClass(I),e===a?oe("#nData",C).addClass(I):void 0!==t[1][e+1]&&ce(oe("#"+le(t[1][e+1])),I)?oe("#nData",C).addClass(I):oe("#nData",C).removeClass(I)}function te(){var e=ne.getDataIDs.call(O),t=oe("#id_g",D).val();return[oe.inArray(t,e),e]}})},viewGridRow:function(R,M){return this.each(function(){var k=this,F=oe(k),_=k.p;if(k.grid&&null!=_&&R){var e=_.id,S=oe.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,removemodal:!0},ne.getGridRes.call(F,"view"),re.view||{},_.formViewing||{},M||{}),i="#ViewGrid_"+le(e),r="#ViewTbl_"+le(e),o=r+"_2",t="ViewGrid_"+e,a="ViewTbl_"+e,l=S.commonIconClass,n={themodal:"viewmod"+e,modalhead:"viewhd"+e,modalcontent:"viewcnt"+e,resizeAlso:t},d="#"+le(n.themodal),s=_.gBox,E=_.colModel,c=1,u=0,p=function(){var e=oe.makeArray(arguments);return e.unshift(""),e.unshift("View"),e.unshift(S),ue.apply(k,e)},f=function(){re.hideModal(d,{gb:s,jqm:S.jqModal,onClose:S.onClose,removemodal:S.removemodal})},h=he.call(k,"hover"),m=he.call(k,"disabled"),v=isNaN(S.dataheight)?S.dataheight:S.dataheight+"px",g=isNaN(S.datawidth)?S.datawidth:S.datawidth+"px",b=oe("<div class='"+de.call(k,"dialog.body")+"'><form name='FormPost' id='"+t+"' class='FormGrid' style='width:"+g+";overflow:auto;position:relative;height:"+v+";'></form></div>"),y=b.children("form.FormGrid"),w=oe("<table id='"+a+"' class='EditTable'><tbody></tbody></table>");if(oe(d).remove(),oe(E).each(function(){var e=this.formoptions;c=Math.max(c,e&&e.colpos||0),u=Math.max(u,e&&e.rowpos||0)}),y.append(w),p("beforeInitData",y)){!function(e,t,s){var c,u,p,f,a,h,m,v,g=0,b=[],y=ne.getInd.call(F,e),w=de.call(k,"dialog.viewData"),x=oe(t),D=de.call(k,"dialog.viewLabel"),i=String(S.labelswidth)+(!S.labelswidth||isNaN(S.labelswidth)?"":"px"),o="<td class='"+de.call(k,"dialog.viewCellLabel","CaptionTD form-view-label")+(i?"' style='width:"+i+";":"")+"'>&#160;</td><td class='"+de.call(k,"dialog.viewCellData","DataTD form-view-data")+"'>&#160;</td>",C="",r=["integer","number","currency"],l=0,n=0;for(a=0;a<s;a++)C+=o;if(oe(E).each(function(){var e=this;(u=(!e.editrules||!0!==e.editrules.edithidden)&&!0===e.hidden)||"right"!==e.align||(e.formatter&&-1!==oe.inArray(e.formatter,r)?l=Math.max(l,parseInt(e.width,10)):n=Math.max(n,parseInt(e.width,10)))}),h=0!==l?l:0!==n?n:0,oe(E).each(function(e){var t=this;if(c=t.name,m=!1,u=(!t.editrules||!0!==t.editrules.edithidden)&&!0===t.hidden,v="boolean"!=typeof t.viewable||t.viewable,"cb"!==c&&"subgrid"!==c&&"rn"!==c&&v){f=!1===y?"":re.getDataFieldOfCell.call(k,k.rows[y],e).html(),m="right"===t.align&&0!==h;var a=oe.extend({},{rowabove:!1,rowcontent:""},t.formoptions||{}),i=parseInt(a.rowpos,10)||g+1,o=parseInt(2*(parseInt(a.colpos,10)||1),10);if(a.rowabove){var r=oe("<tr><td class='contentinfo' colspan='"+2*s+"'>"+a.rowcontent+"</td></tr>");x.append(r),r[0].rp=i}0===(p=x.find("tr[data-rowpos="+i+"]")).length&&((p=oe("<tr data-rowpos='"+i+"'></tr>").addClass("FormData").attr("id","trv_"+c)).append(C),x.append(p),p[0].rp=i);var l=void 0===a.label?_.colNames[e]:a.label,n=oe("td:eq("+(o-1)+")",p[0]),d=oe("td:eq("+(o-2)+")",p[0]);d.html("<label for='"+c+"'"+(D?" class='"+D+"'>":">")+(l||"&nbsp;")+"</label>"),n[ve(n.html())?"html":"append"]("<span id='"+c+"'"+(w?" class='"+w+"'>":">")+(f||"&nbsp;")+"</span>").attr("id","v_"+c),m&&oe("td:eq("+(o-1)+") span",p[0]).css({"text-align":"right",width:h+"px"}),u&&d.add(n).css("visibility","hidden"),b[g]=e,g++}}),me(x),0<g){var d=oe("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*s-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+e+"'/></td></tr>");d[0].rp=g+99,x.append(d)}}(R,w,c);var x="rtl"===_.direction,D=x?"nData":"pData",C=x?"pData":"nData",O=pe.call(k,D,"",se(l,S.prevIcon),"","left"),j=pe.call(k,C,"",se(l,S.nextIcon),"","right"),q=pe.call(k,"cData",S.bClose);if(0<u){var T=[];oe.each(oe(w)[0].rows,function(e,t){T[e]=t}),T.sort(function(e,t){return e.rp>t.rp?1:e.rp<t.rp?-1:0}),oe.each(T,function(e,t){oe("tbody",w).append(t)})}S.gbox=s;var A=oe("<div></div>").append(b).append("<div class='"+de.call(k,"dialog.footer")+"'><table border='0' class='EditTable' id='"+a+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+_.direction+"' width='"+(S.labelswidth||"auto")+"'>"+(x?j+O:O+j)+"</td><td class='EditButton EditButton-"+_.direction+"'>"+q+"</td></tr></tbody></table></div>");re.createModal.call(k,n,A,S,_.gView,oe(_.gView)[0]),S.viewPagerButtons||oe("#pData, #nData",o).hide(),A=null,oe(d).keydown(function(e){var t,a;if(!0===oe(i).data("disabled"))return!1;if(13===e.which&&(a=(t=oe(o).find(":focus")).attr("id"),0<t.length&&0<=oe.inArray(a,["pData","nData","cData"])))return t.trigger("click"),!1;if(27===e.which)return S.closeOnEscape&&f(),!1;if(!0===S.navkeys[0]){if(e.which===S.navkeys[1])return oe("#pData",o).trigger("click"),!1;if(e.which===S.navkeys[2])return oe("#nData",o).trigger("click"),!1}}),fe(oe("#cData",o),S.closeicon,l),p("beforeShowForm",oe(i)),re.viewModal.call(k,d,{gbox:s,jqm:S.jqModal,overlay:S.overlay,toTop:S.toTop,modal:S.modal,onHide:function(e){e.w.remove(),e.o&&e.o.remove()}}),oe(".fm-button:not(."+m.split(" ").join(".")+")",o).hover(function(){oe(this).addClass(h)},function(){oe(this).removeClass(h)}),I(),oe("#cData",o).click(function(){return f(),!1}),oe("#nData",o).click(function(){oe("#FormError",r).hide();var e=P();if(e[0]=parseInt(e[0],10),-1!==e[0]&&e[1][e[0]+1]){if(!p("onclickPgButtons","next",oe(i),e[1][e[0]]))return!1;N(e[1][e[0]+1]),ne.setSelection.call(F,e[1][e[0]+1]),p("afterclickPgButtons","next",oe(i),e[1][e[0]+1]),B(e[0]+1,e)}return I(),!1}),oe("#pData",o).click(function(){oe("#FormError",r).hide();var e=P();if(-1!==e[0]&&e[1][e[0]-1]){if(!p("onclickPgButtons","prev",oe(i),e[1][e[0]]))return!1;N(e[1][e[0]-1]),ne.setSelection.call(F,e[1][e[0]-1]),p("afterclickPgButtons","prev",oe(i),e[1][e[0]-1]),B(e[0]-1,e)}return I(),!1});var G=P();B(G[0],G)}}function I(){!0!==S.closeOnEscape&&!0!==S.navkeys[0]||setTimeout(function(){oe("#cData").focus()},0)}function N(e){var t,a,i=0,o=ne.getInd.call(F,e,!0);o&&(oe("td",o).each(function(e){a=E[e],"cb"!==(t=a.name)&&"subgrid"!==t&&"rn"!==t&&(t=le("v_"+t),oe("#"+t+" span",r).html(re.getDataFieldOfCell.call(k,o,e).html()),i++)}),0<i&&oe("#id_g",r).val(e))}function B(e,t){var a=t[1].length-1;0===e?oe("#pData",o).addClass(m):void 0!==t[1][e-1]&&ce(oe("#"+le(t[1][e-1])),m)?oe("#pData",o).addClass(m):oe("#pData",o).removeClass(m),e===a?oe("#nData",o).addClass(m):void 0!==t[1][e+1]&&ce(oe("#"+le(t[1][e+1])),m)?oe("#nData",o).addClass(m):oe("#nData",o).removeClass(m)}function P(){var e=ne.getDataIDs.call(F),t=oe("#id_g",r).val();return[oe.inArray(t,e),e]}})},delGridRow:function(k,F){return this.each(function(){var s=this,c=s.p,u=oe(s);if(s.grid&&null!=c&&k){var p,f,h,m,v=c.id,g=oe.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},idSeparator:",",onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1,delui:"disable",deltext:ne.getGridRes.call(u,"defaults.deltext")||"Deleting..."},ne.getGridRes.call(u,"del"),re.del||{},c.formDeleting||{},F||{}),e="DelTbl_"+v,b="#DelTbl_"+le(v),t={themodal:"delmod"+v,modalhead:"delhd"+v,modalcontent:"delcnt"+v,resizeAlso:e},y="#"+le(t.themodal),w=c.gBox,a=g.commonIconClass,x=function(){var e=oe.makeArray(arguments);return e.unshift(""),e.unshift("Delete"),e.unshift(g),ue.apply(s,e)},i=he.call(s,"hover"),D=he.call(s,"active"),o=he.call(s,"error");if(oe.isArray(k)||(k=[String(k)]),void 0!==oe(y)[0]){if(!x("beforeInitData",oe(b)))return;oe("#DelData>td",b).text(k.join(g.idSeparator)).data("rowids",k),oe("#DelError",b).hide(),!0===g.processing&&(g.processing=!1,oe("#dData",b).removeClass(D)),x("beforeShowForm",oe(b)),re.viewModal.call(s,y,{gbox:w,jqm:g.jqModal,jqM:!1,overlay:g.overlay,toTop:g.toTop,modal:g.modal}),x("afterShowForm",oe(b))}else{var r=isNaN(g.dataheight)?g.dataheight:g.dataheight+"px",l=isNaN(g.datawidth)?g.datawidth:g.datawidth+"px",n="<div class='"+de.call(s,"dialog.body")+"'><div id='"+e+"' class='formdata' style='width:"+l+";overflow:auto;position:relative;height:"+r+";'>";n+="<table class='DelTable'><tbody>",n+="<tr id='DelError' style='display:none'><td class='"+o+"'></td></tr>",n+="<tr id='DelData' style='display:none'><td >"+k.join(g.idSeparator)+"</td></tr>",n+="<tr><td class='delmsg'>"+g.msg+"</td></tr>",n+="</tbody></table></div></div>";var d=pe.call(s,"dData",g.bSubmit),C=pe.call(s,"eData",g.bCancel);if(n+="<div class='"+de.call(s,"dialog.footer")+"'><table class='EditTable' id='"+e+"_2'><tbody><tr><td><hr class='"+de.call(s,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+c.direction+"'>"+d+"&#160;"+C+"</td></tr></tbody></table></div>",g.gbox=w,re.createModal.call(s,t,n,g,c.gView,oe(c.gView)[0]),oe("#DelData>td",b).data("rowids",k),!x("beforeInitData",oe(n)))return;oe(".fm-button",b+"_2").hover(function(){oe(this).addClass(i)},function(){oe(this).removeClass(i)}),fe(oe("#dData",b+"_2"),g.delicon,a),fe(oe("#eData",b+"_2"),g.cancelicon,a),oe("#dData",b+"_2").click(function(){var e,i=[!0,""],t=oe("#DelData>td",b),o=t.text(),r=t.data("rowids"),a={};if(oe.isFunction(g.onclickSubmit)&&(a=g.onclickSubmit.call(s,g,o,r)||{}),oe.isFunction(g.beforeSubmit)&&(i=g.beforeSubmit.call(s,o,r)||i),i[0]&&!g.processing){if(g.processing=!0,h=c.prmNames,p=oe.extend({},g.delData,a),m=h.oper,p[m]=h.deloper,f=h.id,!(o=r.slice()).length)return!1;for(e in o)o.hasOwnProperty(e)&&(o[e]=re.stripPref(c.idPrefix,o[e]));p[f]=o.join(g.idSeparator),oe(this).addClass(D);var l=g.url||c.editurl,n=oe.extend({url:oe.isFunction(l)?l.call(s,p[f],p,g,r):l,type:g.mtype,data:oe.isFunction(g.serializeDelData)?g.serializeDelData.call(s,p,r):p,complete:function(e,t){var a;if(u.jqGrid("progressBar",{method:"hide",loadtype:g.delui}),oe("#dData",b+"_2").removeClass(D),300<=e.status&&304!==e.status||0===e.status&&4===e.readyState?(i[0]=!1,oe.isFunction(g.errorTextFormat)?i[1]=g.errorTextFormat.call(s,e):i[1]=t+" Status: '"+e.statusText+"'. Error code: "+e.status):oe.isFunction(g.afterSubmit)&&(i=g.afterSubmit.call(s,e,p,r)||[!0]),!1===i[0])oe("#DelError>td",b).html(i[1]),oe("#DelError",b).show();else{if("local"===c.datatype||!0===c.treeGrid||!g.reloadAfterSubmit)if(!0===c.treeGrid)try{ne.delTreeNode.call(u,r[0])}catch(e){}else for(r=r.slice(),a=0;a<r.length;a++)ne.delRowData.call(u,r[a]);g.reloadAfterSubmit&&u.trigger("reloadGrid",[oe.extend({},g.reloadGridOptions||{})]),setTimeout(function(){x("afterComplete",e,o,oe(b),r)},50)}g.processing=!1,i[0]&&re.hideModal(y,{gb:w,jqm:g.jqModal,onClose:g.onClose,removemodal:g.removemodal})}},re.ajaxOptions,g.ajaxDelOptions);if(n.url||g.useDataProxy||(oe.isFunction(c.dataProxy)?g.useDataProxy=!0:(i[0]=!1,i[1]+=" "+re.errors.nourl)),i[0])if(u.jqGrid("progressBar",{method:"show",loadtype:g.delui,htmlcontent:g.deltext}),g.useDataProxy){var d=c.dataProxy.call(s,n,"del_"+v);void 0===d&&(d=[!0,""]),!1===d[0]?(i[0]=!1,i[1]=d[1]||"Error deleting the selected row!"):re.hideModal(y,{gb:w,jqm:g.jqModal,onClose:g.onClose,removemodal:g.removemodal})}else"clientArray"===n.url?(p=n.data,n.complete({status:200,statusText:""},"")):oe.ajax(n)}return!1===i[0]&&(oe("#DelError>td",b).html(i[1]),oe("#DelError",b).show()),!1}),oe("#eData",b+"_2").click(function(){return re.hideModal(y,{gb:w,jqm:g.jqModal,onClose:g.onClose,removemodal:g.removemodal}),!1}),x("beforeShowForm",oe(b)),re.viewModal.call(s,y,{gbox:w,jqm:g.jqModal,overlay:g.overlay,toTop:g.toTop,modal:g.modal}),x("afterShowForm",oe(b))}!0===g.closeOnEscape&&setTimeout(function(){oe(".ui-jqdialog-titlebar-close","#"+le(t.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(B,P,R,M,z,V,L){return"object"==typeof B&&(L=V,V=z,z=M,M=R,R=P,P=B,B=void 0),M=M||{},R=R||{},L=L||{},z=z||{},V=V||{},this.each(function(){var l=this,n=l.p,d=oe(l);if(l.grid&&null!=n&&!(l.nav&&0<oe(B).find(".navtable").length)){var r=n.id,s=oe.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},ne.getGridRes.call(d,"nav"),re.nav||{},n.navOptions||{},P||{});s.position=s.position||("rtl"===n.direction?"right":"left");var e,t,c,a=n.idSel,u=n.gBox,p=s.commonIconClass,f={themodal:"alertmod_"+r,modalhead:"alerthd_"+r,modalcontent:"alertcnt_"+r},o=function(){var e=H.documentElement,t=U,a=1024,i=768,o=d.closest(".ui-jqgrid").offset();void 0===oe("#"+le(f.themodal))[0]&&(s.alerttop||s.alertleft||(void 0!==t.innerWidth?(a=t.innerWidth,i=t.innerHeight):null!=e&&void 0!==e.clientWidth&&0!==e.clientWidth&&(a=e.clientWidth,i=e.clientHeight),a=a/2-parseInt(s.alertwidth,10)/2-o.left+(void 0!==t.pageXOffset?t.pageXOffset:(e||H.body.parentNode||H.body).scrollLeft),i=i/2-25-o.top+(void 0!==t.pageYOffset?t.pageYOffset:(e||H.body.parentNode||H.body).scrollTop)),re.createModal.call(l,f,"<div class='"+de.call(l,"dialog.body")+"'><div>"+s.alerttext+"</div></div>",{gbox:u,jqModal:s.jqModal,drag:!0,resize:!0,caption:s.alertcap,top:null!=s.alerttop?s.alerttop:i,left:null!=s.alertleft?s.alertleft:a,width:s.alertwidth,height:s.alertheight,closeOnEscape:s.closeOnEscape,zIndex:s.alertzIndex,removemodal:s.removemodal},n.gView,oe(u)[0],!1)),re.viewModal.call(l,"#"+le(f.themodal),{gbox:u,toTop:s.alertToTop,jqm:s.jqModal});var r=oe("#"+le(f.modalhead)).find(".ui-jqdialog-titlebar-close");r.attr({tabindex:"0",href:"#",role:"button"}),setTimeout(function(){r.focus()},50)},i=function(e){var t;if(13===e.which&&0<(t=oe(this).find(".ui-pg-button").filter(":focus")).length){var a=t[0].id,i=a.substr(0,0<oe(this).closest(".ui-jqgrid-toppager").length?a.length-r.length-5:a.length-r.length-1)+"mod"+n.id,o=oe(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(oe.inArray(i,o)<0)return t.trigger("click"),!1}},h=he.call(l,"hover"),m=he.call(l,"disabled"),v=de.call(l,"navButton","ui-pg-button");if(l.grid){l.modalAlert=o,void 0===B&&(n.pager?(B=n.pager,n.toppager&&(s.cloneToTop=!0)):n.toppager&&(B=n.toppager));var g,b,y,w,x,D,C,k=1,F=["left","center","right"],_="<div class='"+de.call(l,"navButton","ui-pg-button "+he.call(l,"disabled"))+"'><span class='ui-separator'></span></div>",S=function(){ce(this,m)||oe(this).addClass(h)},E=function(){oe(this).removeClass(h)},O=function(){return ce(this,m)||(oe.isFunction(s.addfunc)?s.addfunc.call(l,M):ne.editGridRow.call(d,"new",M)),!1},j=function(e,t,a){if(!ce(this,m)){var i=n.selrow;i?oe.isFunction(e)?e.call(l,i,a):ne[t].call(d,i,a):o()}return!1},q=function(){return j.call(this,s.editfunc,"editGridRow",R)},T=function(){return j.call(this,s.viewfunc,"viewGridRow",L)},A=function(){var e;return ce(this,m)||(n.multiselect?0===(e=n.selarrrow).length&&(e=null):e=n.selrow,e?oe.isFunction(s.delfunc)?s.delfunc.call(l,e,z):ne.delGridRow.call(d,e,z):o()),!1},G=function(){return ce(this,m)||(oe.isFunction(s.searchfunc)?s.searchfunc.call(l,V):ne.searchGrid.call(d,V)),!1},I=function(){if(!ce(this,m)){oe.isFunction(s.beforeRefresh)&&s.beforeRefresh.call(l),n.search=!1,n.resetsearch=!0;try{if("currentfilter"!==s.refreshstate){n.postData.filters="";try{oe("#fbox_"+a).jqFilter("resetFilter")}catch(e){}oe.isFunction(l.clearToolbar)&&l.clearToolbar(!1)}}catch(e){}switch(s.refreshstate){case"firstpage":d.trigger("reloadGrid",[oe.extend({},s.reloadGridOptions||{},{page:1})]);break;case"current":case"currentfilter":d.trigger("reloadGrid",[oe.extend({},s.reloadGridOptions||{},{current:!0})])}oe.isFunction(s.afterRefresh)&&s.afterRefresh.call(l)}return!1},N=function(e,t,a){var i=oe("<div class='"+v+"' tabindex='0' role='button'></div>"),o=s[e+"icon"],r=oe.trim(s[e+"text"]);return i.append("<div class='ui-pg-div'><span class='"+(s.iconsOverText?se("ui-pg-button-icon-over-text",p,o):se(p,o))+"'></span>"+(r?"<span class='ui-pg-button-text"+(s.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+r+"</span>":"")+"</div>"),oe(c).append(i),i.attr({title:s[e+"title"]||"",id:t||e+"_"+w}).click(a).hover(S,E),i};for(s.cloneToTop&&n.toppager&&(k=2),g=0;g<k;g++){if(c=oe("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===n.direction?"right":"left")+";table-layout:auto;'></div>"),0===g?(w=r,(y=B)===n.toppager&&(w+="_top",k=1)):(y=n.toppager,w=r+"_top"),s.add&&N("add",M.id,O),s.edit&&N("edit",R.id,q),s.view&&N("view",L.id,T),s.del&&N("del",z.id,A),(s.add||s.edit||s.del||s.view)&&oe(c).append(_),s.search&&(b=N("search",V.id,G),V.showOnLoad&&!0===V.showOnLoad&&oe(b,c).click()),s.refresh&&N("refresh","",I),t=oe(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px",oe("body").append("<div id='testpg2' class='"+de.call(l,"gBox","ui-jqgrid")+"' style='font-size:"+t+";visibility:hidden;' ></div>"),e=oe(c).clone().appendTo("#testpg2").width(),oe("#testpg2").remove(),oe(y+"_"+s.position,y).append(c),s.hideEmptyPagerParts)for(x=0;x<F.length;x++)F[x]!==s.position&&(0===(C=oe(y+"_"+F[x],y)).length||0===C[0].childNodes.length?C.hide():1===C[0].childNodes.length&&(D=C[0].firstChild,!oe(D).is("table.ui-pg-table")||0!==D.rows&&0!==D.rows[0].cells.length||C.hide()));n._nvtd&&(e>n._nvtd[0]&&(oe(y+"_"+s.position,y).width(e),n._nvtd[0]=e),n._nvtd[1]=e),l.nav=!0,c.on("keydown.jqGrid",i)}d.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(c,u){return"object"==typeof c&&(u=c,c=void 0),this.each(function(){var t=this,e=t.p;if(t.grid){var a=oe.extend({caption:"newButton",title:"",onClickButton:null,position:"last",iconsOverText:!1},ne.getGridRes.call(oe(t),"nav"),re.nav||{},e.navOptions||{},u||{}),i=a.id,o=he.call(t,"hover"),r=he.call(t,"disabled"),l=de.call(t,"navButton","ui-pg-button");if(void 0===c)if(e.pager){if(ne.navButtonAdd.call(oe(t),e.pager,a),!e.toppager)return;c=e.toppager,i&&(i+="_top")}else e.toppager&&(c=e.toppager);"string"==typeof c&&0!==c.indexOf("#")&&(c="#"+le(c));var n=oe(".navtable",c),d=a.commonIconClass;if(0<n.length){if(i&&0<n.find("#"+le(i)).length)return;var s=oe("<div tabindex='0' role='button'></div>");"NONE"===a.buttonicon.toString().toUpperCase()?oe(s).addClass(l).append("<div class='ui-pg-div'>"+(a.caption?"<span class='ui-pg-button-text"+(a.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+a.caption+"</span>":"")+"</div>"):oe(s).addClass(l).append("<div class='ui-pg-div'><span class='"+(a.iconsOverText?se("ui-pg-button-icon-over-text",d,a.buttonicon):se(d,a.buttonicon))+"'></span>"+(a.caption?"<span class='ui-pg-button-text"+(a.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+a.caption+"</span>":"")+"</div>"),i&&oe(s).attr("id",i),"first"===a.position&&0<n.children("div.ui-pg-button").length?n.children("div.ui-pg-button").first().before(s):n.append(s),oe(s,n).attr("title",a.title||"").click(function(e){return ce(this,r)||oe.isFunction(a.onClickButton)&&a.onClickButton.call(t,a,e),!1}).hover(function(){ce(this,r)||oe(this).addClass(o)},function(){oe(this).removeClass(o)}),oe(t).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(o,r){return r=oe.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},r||{}),this.each(function(){if(this.grid){var e=this.p,t=de.call(this,"navButton","ui-pg-button "+he.call(this,"disabled"));if(void 0===o)if(e.pager){if(ne.navSeparatorAdd.call(oe(this),e.pager,r),!e.toppager)return;o=e.toppager}else e.toppager&&(o=e.toppager);"string"==typeof o&&0!==o.indexOf("#")&&(o="#"+le(o));var a=oe(".navtable",o);if(0<a.length){var i="<div class='"+t+"'><span class='"+r.sepclass+"'></span>"+r.sepcontent+"</div>";"first"===r.position?0===a.children("div.ui-pg-button").length?a.append(i):a.children("div.ui-pg-button").first().before(i):a.append(i)}}})},GridToForm:function(r,l){return this.each(function(){var e,t,a,i;if(this.grid){var o=ne.getRowData.call(oe(this),r);if(o)for(e in o)if(o.hasOwnProperty(e))if((t=oe("[name="+le(e)+"]",l)).is("input:radio")||t.is("input:checkbox"))for(a=0;a<t.length;a++)(i=oe(t[a])).prop("checked",i.val()===String(o[e]));else t.val(ve(o[e])?"":o[e])}})},FormToGrid:function(t,i,o,r){return this.each(function(){if(this.grid){o||(o="set"),r||(r="first");var e=oe(i).serializeArray(),a={};oe.each(e,function(e,t){a[t.name]=t.value}),"add"===o?ne.addRowData.call(oe(this),t,a,r):"set"===o&&ne.setRowData.call(oe(this),t,a)}})}})});
//# sourceMappingURL=grid.formedit.js.map