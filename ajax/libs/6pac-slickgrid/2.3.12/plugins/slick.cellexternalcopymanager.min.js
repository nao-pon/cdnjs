!function(e){e.extend(!0,window,{Slick:{CellExternalCopyManager:function(t){function o(t,o){if(d.dataItemColumnValueExtractor){var l=d.dataItemColumnValueExtractor(t,o);if(l)return l}var n="";if(o.editor){var a={container:e("<p>"),column:o,position:{top:0,left:0},grid:s},r=new o.editor(a);r.loadValue(t),n=r.serializeValue(),r.destroy()}else n=t[o.field];return n}function l(t,o,l){if(d.dataItemColumnValueSetter)return d.dataItemColumnValueSetter(t,o,l);if(o.editor){var n={container:e("body"),column:o,position:{top:0,left:0},grid:s},a=new o.editor(n);a.loadValue(t),a.applyValue(t,l),a.destroy()}else t[o.field]=l}function n(e){var t=document.createElement("textarea");return t.style.position="absolute",t.style.left="-1000px",t.style.top=document.body.scrollTop+"px",t.value=e,m.appendChild(t),t.select(),t}function a(e,t){var a;if(!s.getEditorLock().isActive()||s.getOptions().autoEdit){if(e.which==y.ESC&&c&&(e.preventDefault(),i(),u.onCopyCancelled.notify({ranges:c}),c=null),(e.which===y.C||e.which===y.INSERT)&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&(g&&g.call(),0!=(a=s.getSelectionModel().getSelectedRanges()).length)){c=a,r(a),u.onCopyCells.notify({ranges:a});for(var f=s.getColumns(),h="",C=0;C<a.length;C++){for(var v=a[C],w=[],S=v.fromRow;S<v.toRow+1;S++){var D=[],R=s.getDataItem(S);if(""==w&&d.includeHeaderWhenCopying){for(var x=[],E=v.fromCell;E<v.toCell+1;E++)f[E].name.length>0&&x.push(f[E].name);w.push(x.join("\t"))}for(E=v.fromCell;E<v.toCell+1;E++)D.push(o(R,f[E]));w.push(D.join("\t"))}h+=w.join("\r\n")+"\r\n"}if(window.clipboardData)return window.clipboardData.setData("Text",h),!0;var V=document.activeElement;if((I=n(h)).focus(),setTimeout(function(){m.removeChild(I),V?V.focus():console.log("Not element to restore focus to after copy?")},100),p){var b=0;b=1===a.length?a[0].toRow+1-a[0].fromRow:a.length,p.call(this,b)}return!1}if(!d.readOnlyMode&&(e.which===y.V&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||e.which===y.INSERT&&e.shiftKey&&!e.ctrlKey)){var I=n("");return setTimeout(function(){!function(e,t){var o=e.getColumns(),n=t.value.split(/[\n\f\r]/);""==n[n.length-1]&&n.pop();var a=[],i=0;m.removeChild(t);for(var s=0;s<n.length;s++)""!=n[s]?a[i++]=n[s].split("\t"):a[s]=[""];var c=e.getActiveCell(),f=e.getSelectionModel().getSelectedRanges(),h=f&&f.length?f[0]:null,C=null,g=null;if(h)C=h.fromRow,g=h.fromCell;else{if(!c)return;C=c.row,g=c.cell}var p=!1,y=a.length,v=a.length?a[0].length:0;1==a.length&&1==a[0].length&&h&&(p=!0,y=h.toRow-h.fromRow+1,v=h.toCell-h.fromCell+1);var w=e.getData().length-C,S=0;if(w<y){var D=e.getData();for(S=1;S<=y-w;S++)D.push({});e.setData(D),e.render()}var R=C+y>e.getDataLength();if(d.newRowCreator&&R){var x=C+y-e.getDataLength();d.newRowCreator(x)}var E={isClipboardCommand:!0,clippedRange:a,oldValues:[],cellExternalCopyManager:u,_options:d,setDataItemValueForColumn:l,markCopySelection:r,oneCellToMultiple:p,activeRow:C,activeCell:g,destH:y,destW:v,maxDestY:e.getDataLength(),maxDestX:e.getColumns().length,h:0,w:0,execute:function(){this.h=0;for(var t=0;t<this.destH;t++){this.oldValues[t]=[],this.w=0,this.h++;for(var l=0;l<this.destW;l++){this.w++;var n=C+t,r=g+l;if(n<this.maxDestY&&r<this.maxDestX){e.getCellNode(n,r);var i=e.getDataItem(n);this.oldValues[t][l]=i[o[r].field],p?this.setDataItemValueForColumn(i,o[r],a[0][0]):this.setDataItemValueForColumn(i,o[r],a[t]?a[t][l]:""),e.updateCell(n,r),e.onCellChange.notify({row:n,cell:r,item:i,grid:e})}}}var s={fromCell:g,fromRow:C,toCell:g+this.w-1,toRow:C+this.h-1};this.markCopySelection([s]),e.getSelectionModel().setSelectedRanges([s]),this.cellExternalCopyManager.onPasteCells.notify({ranges:[s]})},undo:function(){for(var t=0;t<this.destH;t++)for(var l=0;l<this.destW;l++){var n=C+t,a=g+l;if(n<this.maxDestY&&a<this.maxDestX){e.getCellNode(n,a);var r=e.getDataItem(n);p?this.setDataItemValueForColumn(r,o[a],this.oldValues[0][0]):this.setDataItemValueForColumn(r,o[a],this.oldValues[t][l]),e.updateCell(n,a),e.onCellChange.notify({row:n,cell:a,item:r,grid:e})}}var i={fromCell:g,fromRow:C,toCell:g+this.w-1,toRow:C+this.h-1};if(this.markCopySelection([i]),e.getSelectionModel().setSelectedRanges([i]),this.cellExternalCopyManager.onPasteCells.notify({ranges:[i]}),S>1){for(var s=e.getData();S>1;S--)s.splice(s.length-1,1);e.setData(s),e.render()}}};d.clipboardCommandHandler?d.clipboardCommandHandler(E):E.execute()}(s,I)},100),!1}}}function r(e){i();for(var t=s.getColumns(),o={},l=0;l<e.length;l++)for(var n=e[l].fromRow;n<=e[l].toRow;n++){o[n]={};for(var a=e[l].fromCell;a<=e[l].toCell&&a<t.length;a++)o[n][t[a].id]=h}s.setCellCssStyles(f,o),clearTimeout(C),C=setTimeout(function(){u.clearCopySelection()},2e3)}function i(){s.removeCellCssStyles(f)}var s,c,u=this,d=t||{},f=d.copiedCellStyleLayerKey||"copy-manager",h=d.copiedCellStyle||"copied",C=0,m=d.bodyElement||document.body,g=d.onCopyInit||null,p=d.onCopySuccess||null,y={C:67,V:86,ESC:27,INSERT:45};e.extend(this,{init:function(e){(s=e).onKeyDown.subscribe(a);var t=e.getSelectionModel();if(!t)throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new Slick.CellSelectionModel())");t.onSelectedRangesChanged.subscribe(function(e,t){s.focus()})},destroy:function(){s.onKeyDown.unsubscribe(a)},clearCopySelection:i,handleKeyDown:a,onCopyCells:new Slick.Event,onCopyCancelled:new Slick.Event,onPasteCells:new Slick.Event})}}})}(jQuery);