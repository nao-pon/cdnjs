!function(w){w.extend(!0,window,{Slick:{Plugins:{RowDetailView:function(e){var r,d=this,o=[],t=new Slick.EventHandler,l=w.extend(!0,{},{columnId:"_detail_selector",cssClass:null,toolTip:"",width:30},e);function i(e,t){if(l.useRowClick||r.getColumns()[t.cell].id===l.columnId&&w(e.target).hasClass("detailView-toggle")){if(r.getEditorLock().isActive()&&!r.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();var i=_dataView.getItem(t.row);d.onBeforeRowDetailToggle.notify({grid:r,item:i},e,d),n=i,r.getData().beginUpdate(),(a=n)&&(a._collapsed?function(e){if(e._collapsed=!1,o.push(e),e._detailContent||(e._detailViewLoaded=!1),e._detailViewLoaded&&!0===l.loadOnce)return d.onAsyncResponse.notify({itemDetail:e,detailView:e._detailContent},void 0,this),p(e),_dataView.updateItem(e.id,e);e._detailContent=l.preTemplate(e),p(e),_dataView.updateItem(e.id,e),l.process(e)}(a):c(a)),r.getData().endUpdate(),d.onAfterRowDetailToggle.notify({grid:r,item:i},e,d),e.stopPropagation(),e.stopImmediatePropagation()}var n,a}function n(e,t){s()}function a(e,t){var i=r.getRenderedRange(),n=0<i.top?i.top:0,a=i.bottom>_dataView.getLength()?i.bottom:_dataView.getLength(),d=_dataView.getItemByIdx(n);if(d&&null==d._parent){var o=_dataView.getItemByIdx(n+1);void 0!==o&&void 0!==o._parent&&o._parent==d&&g(d)}var l=_dataView.getItemByIdx(a-1);l&&void 0!==l._parent&&g(l._parent)}function s(){for(var e=o.length-1;0<=e;e--)c(o[e])}function g(e){var t=w("#innerDetailView_"+e.id);if(t){var i=w("#innerDetailView_"+e.id).html();void 0!==i&&(e._detailContent=i)}}function c(t){l.loadOnce&&g(t),t._collapsed=!0;for(var e=1;e<=t._sizePadding;e++)_dataView.deleteItem(t.id+"."+e);t._sizePadding=0,_dataView.updateItem(t.id,t),o=o.filter(function(e){return e.id!==t.id})}var u=function(e,t){var i={};for(var n in r.getData())i[n]=null;return i.id=e.id+"."+t,i._collapsed=!0,i._isPadding=!0,i._parent=e,i._offset=t,i};function p(e){var t=l.panelRows;e._sizePadding=Math.ceil(2*t*13/r.getOptions().rowHeight),e._height=e._sizePadding*r.getOptions().rowHeight;for(var i=_dataView.getIdxById(e.id),n=1;n<=e._sizePadding;n++)_dataView.insertItem(i+n,u(e,n))}function _(e,t,i,n,a){if(null==a._collapsed&&(a._collapsed=!0,a._sizePadding=0,a._height=0,a._isPadding=!1,a._parent=void 0,a._offset=0),1!=a._isPadding){if(a._collapsed)return"<div class='detailView-toggle expand'></div>";var d=[],o=r.getOptions().rowHeight;return d.push("<div class='detailView-toggle collapse'></div></div>"),d.push("<div id='cellDetailView_",a.id,"' class='dynamic-cell-detail' "),d.push("style='height:",a._height,"px;"),d.push("top:",o,"px'>"),d.push("<div id='detailViewContainer_",a.id,"'  class='detail-container' style='max-height:"+(a._height-o+5)+"px'>"),d.push("<div id='innerDetailView_",a.id,"'>",a._detailContent,"</div></div>"),d.join("")}return null}w.extend(this,{init:function(e){r=e,_dataView=r.getData(),r.getOptions().minRowBuffer=l.panelRows+3,t.subscribe(r.onClick,i).subscribe(r.onSort,n).subscribe(r.onScroll,a),r.getData().onRowCountChanged.subscribe(function(){r.updateRowCount(),r.render()}),r.getData().onRowsChanged.subscribe(function(e,t){r.invalidateRows(t.rows),r.render()}),d.onAsyncResponse.subscribe(function(e,t){if(!t||!t.itemDetail)throw'Slick.RowDetailView plugin requires the onAsyncResponse() to supply "args.itemDetail" property.';t.detailView?t.itemDetail._detailContent=t.detailView:t.itemDetail._detailContent=l.postTemplate(t.itemDetail),t.itemDetail._detailViewLoaded=!0,_dataView.getIdxById(t.itemDetail.id),_dataView.updateItem(t.itemDetail.id,t.itemDetail),d.onAsyncEndUpdate.notify({grid:r,itemDetail:t.itemDetail},e,d)})},destroy:function(){t.unsubscribeAll(),d.onAsyncResponse.unsubscribe(),d.onAsyncEndUpdate.unsubscribe(),d.onAfterRowDetailToggle.unsubscribe(),d.onBeforeRowDetailToggle.unsubscribe()},collapseAll:s,getColumnDefinition:function(){return{id:l.columnId,name:"",toolTip:l.toolTip,field:"sel",width:l.width,resizable:!1,sortable:!1,cssClass:l.cssClass,formatter:_}},getOptions:function(e){return l},setOptions:function(e){l=w.extend(!0,{},l,e)},onAsyncResponse:new Slick.Event,onAsyncEndUpdate:new Slick.Event,onAfterRowDetailToggle:new Slick.Event,onBeforeRowDetailToggle:new Slick.Event,resizeDetailView:function(e){if(!e)return;var t=document.getElementById("detailViewContainer_"+e.id),i=document.getElementById("cellDetailView_"+e.id),n=document.getElementById("innerDetailView_"+e.id);if(!t||!i||!n)return;for(var a=1;a<=e._sizePadding;a++)_dataView.deleteItem(e.id+"."+a);var d=r.getOptions().rowHeight,o=n.clientHeight,l=Math.ceil(o/d)+1;e._sizePadding=Math.ceil(2*l*13/d),e._height=e._sizePadding*d,r.getOptions().minRowBuffer<e._sizePadding&&(r.getOptions().minRowBuffer=e._sizePadding+3);t.setAttribute("style","max-height: "+e._height+"px"),i&&i.setAttribute("style","height: "+e._height+"px;top:"+d+"px");for(var s=_dataView.getIdxById(e.id),a=1;a<=e._sizePadding;a++)_dataView.insertItem(s+a,u(e,a))}})}}}})}(jQuery);