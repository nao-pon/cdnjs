!function(e){e.extend(!0,window,{Slick:{Plugins:{RowDetailView:function(t){var i,n=this,a=[],d=new Slick.EventHandler,o=e.extend(!0,{},{columnId:"_detail_selector",cssClass:null,toolTip:"",width:30},t);function l(t,d){if(o.useRowClick||i.getColumns()[d.cell].id===o.columnId&&e(t.target).hasClass("detailView-toggle")){if(i.getEditorLock().isActive()&&!i.getEditorLock().commitCurrentEdit())return t.preventDefault(),void t.stopImmediatePropagation();var l=_dataView.getItem(d.row);n.onBeforeRowDetailToggle.notify({grid:i,item:l},t,n),s=l,i.getData().beginUpdate(),(r=s)&&(r._collapsed?function(e){if(e._collapsed=!1,a.push(e),e._detailContent||(e._detailViewLoaded=!1),e._detailViewLoaded&&!0===o.loadOnce)return n.onAsyncResponse.notify({itemDetail:e,detailView:e._detailContent},void 0,this),_(e),void _dataView.updateItem(e.id,e);e._detailContent=o.preTemplate(e),_(e),_dataView.updateItem(e.id,e),o.process(e)}(r):u(r)),i.getData().endUpdate(),n.onAfterRowDetailToggle.notify({grid:i,item:l},t,n),t.stopPropagation(),t.stopImmediatePropagation()}var s,r}function s(e,t){g()}function r(e,t){var n=i.getRenderedRange(),a=n.top>0?n.top:0,d=n.bottom>_dataView.getLength()?n.bottom:_dataView.getLength(),o=_dataView.getItemByIdx(a);if(null==o._parent){var l=_dataView.getItemByIdx(a+1);void 0!==l&&void 0!==l._parent&&l._parent==o&&c(o)}var s=_dataView.getItemByIdx(d-1);void 0!==s._parent&&c(s._parent)}function g(){for(var e=a.length-1;e>=0;e--)u(a[e])}function c(t){var i=e("#innerDetailView_"+t.id);if(i){var n=e("#innerDetailView_"+t.id).html();void 0!==n&&(t._detailContent=n)}}function u(e){o.loadOnce&&c(e),e._collapsed=!0;for(var t=1;t<=e._sizePadding;t++)_dataView.deleteItem(e.id+"."+t);e._sizePadding=0,_dataView.updateItem(e.id,e),a=a.filter(function(t){return t.id!==e.id})}var p=function(e,t){var n={};for(var a in i.getData())n[a]=null;return n.id=e.id+"."+t,n._collapsed=!0,n._isPadding=!0,n._parent=e,n._offset=t,n};function _(e){var t=o.panelRows;e._sizePadding=Math.ceil(2*t*13/i.getOptions().rowHeight),e._height=e._sizePadding*i.getOptions().rowHeight;for(var n=_dataView.getIdxById(e.id),a=1;a<=e._sizePadding;a++)_dataView.insertItem(n+a,p(e,a))}function w(e,t,n,a,d){if(null==d._collapsed&&(d._collapsed=!0,d._sizePadding=0,d._height=0,d._isPadding=!1,d._parent=void 0,d._offset=0),1!=d._isPadding){if(d._collapsed)return"<div class='detailView-toggle expand'></div>";var o=[],l=i.getOptions().rowHeight;return o.push("<div class='detailView-toggle collapse'></div></div>"),o.push("<div id='cellDetailView_",d.id,"' class='dynamic-cell-detail' "),o.push("style='height:",d._height,"px;"),o.push("top:",l,"px'>"),o.push("<div id='detailViewContainer_",d.id,"'  class='detail-container' style='max-height:"+(d._height-l+5)+"px'>"),o.push("<div id='innerDetailView_",d.id,"'>",d._detailContent,"</div></div>"),o.join("")}return null}e.extend(this,{init:function(e){i=e,_dataView=i.getData(),i.getOptions().minRowBuffer=o.panelRows+3,d.subscribe(i.onClick,l).subscribe(i.onSort,s).subscribe(i.onScroll,r),i.getData().onRowCountChanged.subscribe(function(){i.updateRowCount(),i.render()}),i.getData().onRowsChanged.subscribe(function(e,t){i.invalidateRows(t.rows),i.render()}),n.onAsyncResponse.subscribe(function(e,t){if(!t||!t.itemDetail)throw'Slick.RowDetailView plugin requires the onAsyncResponse() to supply "args.itemDetail" property.';t.detailView?t.itemDetail._detailContent=t.detailView:t.itemDetail._detailContent=o.postTemplate(t.itemDetail),t.itemDetail._detailViewLoaded=!0,_dataView.getIdxById(t.itemDetail.id),_dataView.updateItem(t.itemDetail.id,t.itemDetail),n.onAsyncEndUpdate.notify({grid:i,itemDetail:t.itemDetail},e,n)})},destroy:function(){d.unsubscribeAll(),n.onAsyncResponse.unsubscribe(),n.onAsyncEndUpdate.unsubscribe(),n.onAfterRowDetailToggle.unsubscribe(),n.onBeforeRowDetailToggle.unsubscribe()},collapseAll:g,getColumnDefinition:function(){return{id:o.columnId,name:"",toolTip:o.toolTip,field:"sel",width:o.width,resizable:!1,sortable:!1,cssClass:o.cssClass,formatter:w}},getOptions:function(e){return o},setOptions:function(t){o=e.extend(!0,{},o,t)},onAsyncResponse:new Slick.Event,onAsyncEndUpdate:new Slick.Event,onAfterRowDetailToggle:new Slick.Event,onBeforeRowDetailToggle:new Slick.Event,resizeDetailView:function(e){if(!e)return;var t=document.getElementById("detailViewContainer_"+e.id),n=document.getElementById("cellDetailView_"+e.id),a=document.getElementById("innerDetailView_"+e.id);if(!t||!n||!a)return;for(var d=1;d<=e._sizePadding;d++)_dataView.deleteItem(e.id+"."+d);var o=i.getOptions().rowHeight,l=a.clientHeight,s=Math.ceil(l/o)+1;e._sizePadding=Math.ceil(2*s*13/o),e._height=e._sizePadding*o,i.getOptions().minRowBuffer<e._sizePadding&&(i.getOptions().minRowBuffer=e._sizePadding+3);t.setAttribute("style","max-height: "+e._height+"px"),n&&n.setAttribute("style","height: "+e._height+"px;top:"+o+"px");for(var r=_dataView.getIdxById(e.id),d=1;d<=e._sizePadding;d++)_dataView.insertItem(r+d,p(e,d))}})}}}})}(jQuery);