!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):e.VueLocalStorage=n()}(this,function(){"use strict";var e={},n={getItem:function(n){return n in e?e[n]:null},setItem:function(n,t){return e[n]=t,!0},removeItem:function(n){return!!(n in e)&&delete e[n]},clear:function(){return e={},!0},key:function(n){var t=Object.keys(e);return void 0!==t[n]?t[n]:null}};Object.defineProperty(n,"length",{get:function(){return Object.keys(e).length}});var t=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var o={},r=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return t(e,null,[{key:"on",value:function(e,n){void 0===o[e]&&(o[e]=[]),o[e].push(n)}},{key:"off",value:function(e,n){o[e].length?o[e].splice(o[e].indexOf(n),1):o[e]=[]}},{key:"emit",value:function(e){var n=e||window.event,t=function(e){try{return JSON.parse(e).value}catch(n){return e}};if(void 0!==n&&void 0!==n.key){var r=o[n.key];void 0!==r&&r.forEach(function(e){e(t(n.newValue),t(n.oldValue),n.url||n.uri)})}}}]),e}(),i=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},a=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();var s=function(){function e(n){if(function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.storage=n,this.options={namespace:"",events:["storage"]},Object.defineProperty(this,"length",{get:function(){return this.storage.length}}),"undefined"!=typeof window)for(var t in this.options.events)window.addEventListener?window.addEventListener(this.options.events[t],r.emit,!1):window.attachEvent?window.attachEvent("on"+this.options.events[t],r.emit):window["on"+this.options.events[t]]=r.emit}return a(e,[{key:"setOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=i(this.options,e)}},{key:"set",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=JSON.stringify({value:n,expire:null!==t?(new Date).getTime()+t:null});this.storage.setItem(this.options.namespace+e,o)}},{key:"get",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=this.storage.getItem(this.options.namespace+e);if(null!==t)try{var o=JSON.parse(t);if(null===o.expire)return o.value;if(o.expire>=(new Date).getTime())return o.value;this.remove(e)}catch(e){return n}return n}},{key:"key",value:function(e){return this.storage.key(e)}},{key:"remove",value:function(e){return this.storage.removeItem(this.options.namespace+e)}},{key:"clear",value:function(){if(0!==this.length){for(var e=[],n=0;n<this.length;n++){var t=this.storage.key(n);!1!==new RegExp("^"+this.options.namespace+".+","i").test(t)&&e.push(t)}for(var o in e)this.storage.removeItem(e[o])}}},{key:"on",value:function(e,n){r.on(this.options.namespace+e,n)}},{key:"off",value:function(e,n){r.off(this.options.namespace+e,n)}}]),e}(),u=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},l={install:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=u({},t,{storage:t.storage?t.storage:"local",name:t.name||"ls"});if(o.storage&&-1===["memory","local","session"].indexOf(o.storage))throw new Error('Vue-ls: Storage "'+o.storage+'" is not supported');var r=null;switch(o.storage){case"local":r="undefined"!=typeof window&&"localStorage"in window?window.localStorage:null;break;case"session":r="undefined"!=typeof window&&"sessionStorage"in window?window.sessionStorage:null;break;case"memory":r=n}r||(r=n,console.error('Vue-ls: Storage "'+o.storage+'" is not supported your system, use memory storage'));var i=new s(r);i.setOptions(u(i.options,{namespace:""},o||{})),e[o.name]=i,Object.defineProperty(e.prototype,"$"+o.name,{get:function(){return i}})}};return"undefined"!=typeof window&&(window.VueLocalStorage=l),l});
