var HASH=35,DOT=46,TAGNAME=0,ID=1,CLASSNAME=2,parseQuery=function(e){var n=null,t=null,i=null,o=TAGNAME,r='';for(var l=0;l<=e.length;l++){var _=e.charCodeAt(l),u=_===HASH,d=_===DOT,c=!_;u||d||c?(o===TAGNAME?(l===0?(n='div'):(n=r)):o===ID?(t=r):(i?(i+=' '+r):(i=r)),u?(o=ID):d&&(o=CLASSNAME),r=''):(r+=e[l])}return{tag:n,id:t,className:i}},createElement=function(e,n){var t=parseQuery(e),i=t.tag,o=t.id,r=t.className,l=n?document.createElementNS(n,i):document.createElement(i);o&&(l.id=o);r&&(n?l.setAttribute('class',r):(l.className=r));return l},unmount=function(e,n){var t=getEl(e),i=getEl(n);n===i&&i.__redom_view&&(n=i.__redom_view);i.parentNode&&(doUnmount(n,i,t),t.removeChild(i));return n},doUnmount=function(e,n,t){var i=n.__redom_lifecycle;if(!i){n.__redom_mounted=!1;return}var o=t;n.__redom_mounted&&trigger(n,'onunmount');while(o){var r=o.__redom_lifecycle||(o.__redom_lifecycle={}),l=!1;for(var _ in i)r[_]&&(r[_]-=i[_]),r[_]&&(l=!0);l||(o.__redom_lifecycle=null);o=o.parentNode}},hookNames=['onmount','onunmount'],mount=function(e,n,t){var i=getEl(e),o=getEl(n);n===o&&o.__redom_view&&(n=o.__redom_view);n!==o&&(o.__redom_view=n);var r=o.__redom_mounted,l=o.parentNode;r&&l!==i&&doUnmount(n,o,l);t!=null?i.insertBefore(o,getEl(t)):i.appendChild(o);doMount(n,o,i,l);return n},doMount=function(e,n,t,i){var o=n.__redom_lifecycle||(n.__redom_lifecycle={}),r=t===i,l=!1;for(var _=0;_<hookNames.length;_++){var u=hookNames[_];!r&&e!==n&&u in e&&(o[u]=(o[u]||0)+1);o[u]&&(l=!0)}if(!l){n.__redom_mounted=!0;return}var d=t,c=!1;(r||!c&&(d&&d.__redom_mounted))&&(trigger(n,r?'onremount':'onmount'),c=!0);if(r){return}while(d){var f=d.parentNode,m=d.__redom_lifecycle||(d.__redom_lifecycle={});for(var a in o)m[a]=(m[a]||0)+o[a];!c&&(d===document||f&&f.__redom_mounted)&&(trigger(d,r?'onremount':'onmount'),c=!0);d=f}},trigger=function(e,n){n==='onmount'?(e.__redom_mounted=!0):n==='onunmount'&&(e.__redom_mounted=!1);var t=e.__redom_lifecycle;if(!t){return}var i=e.__redom_view,o=0;i&&i[n]&&i[n]();for(var r in t)r&&o++;if(o){var l=e.firstChild;while(l){var _=l.nextSibling;trigger(l,n);l=_}}},setStyle=function(e,n,t){var i=getEl(e);if(t!==void 0)i.style[n]=t;else if(isString(n))i.setAttribute('style',n);else{for(var o in n)setStyle(i,o,n[o])}},setAttr=function(e,n,t){var i=getEl(e),o=i instanceof SVGElement;if(t!==void 0)n==='style'?setStyle(i,t):o&&isFunction(t)?(i[n]=t):!o&&(n in i||isFunction(t))?(i[n]=t):i.setAttribute(n,t);else{for(var r in n)setAttr(i,r,n[r])}},text=function(e){return document.createTextNode(e)},parseArguments=function(e,n){for(var t=0;t<n.length;t++){var i=n[t];if(i!==0&&!i){continue}typeof i==='function'?i(e):isString(i)||isNumber(i)?e.appendChild(text(i)):isNode(getEl(i))?mount(e,i):i.length?parseArguments(e,i):typeof i==='object'&&setAttr(e,i)}},ensureEl=function(e){return isString(e)?html(e):getEl(e)},getEl=function(e){return e.nodeType&&e||!e.el&&e||getEl(e.el)},isString=function(e){return typeof e==='string'},isNumber=function(e){return typeof e==='number'},isFunction=function(e){return typeof e==='function'},isNode=function(e){return e&&e.nodeType},htmlCache={},memoizeHTML=function(e){return htmlCache[e]||(htmlCache[e]=createElement(e))},html=function(e){var n=[],t=arguments.length-1;while(t-->0)n[t]=arguments[t+1];var i;if(isString(e))i=memoizeHTML(e).cloneNode(!1);else if(isNode(e))i=e.cloneNode(!1);else{throw new Error('At least one argument required')}parseArguments(i,n);return i};html.extend=function(e){var n=memoizeHTML(e);return html.bind(this,n)};var el=html,setChildren=function(e,n){if(n.length===void 0){return setChildren(e,[n])}var t=getEl(e),i=t.firstChild;for(var o=0;o<n.length;o++){var r=n[o];if(!r){continue}var l=getEl(r);if(l===i){i=i.nextSibling;continue}mount(e,r,i)}while(i){var _=i.nextSibling;unmount(e,i);i=_}},propKey=function(e){return function(n){return n[e]}},list=function(e,n,t,i){return new List(e,n,t,i)},List=function(e,n,t,i){this.__redom_list=!0;this.View=n;this.initData=i;this.views=[];this.el=ensureEl(e);t!=null&&(this.lookup={},this.key=isFunction(t)?t:propKey(t))};List.prototype.update=function(e,n){var t=this;e===void 0&&(e=[]);var i=this.View,o=this.key,r=o!=null,l=this.initData,_=new Array(e.length),u=this.views,d=o&&{},c=o&&this.lookup;for(var f=0;f<e.length;f++){var m=e[f],a=void 0;if(r){var w=o(m);a=c[w]||new i(l,m,f,e);d[w]=a;a.__redom_id=w}else a=u[f]||new i(l,m,f,e);_[f]=a;var p=getEl(a.el);p.__redom_view=a;a.update&&a.update(m,f,e,n)}if(r){for(var s=0;s<u.length;s++){var h=u[s].__redom_id;(h in d)||unmount(t,c[h])}}setChildren(this,_);r&&(this.lookup=d);this.views=_};List.extend=function(e,n,t,i){return List.bind(List,e,n,t,i)};list.extend=List.extend;var place=function(e,n){return new Place(e,n)},Place=function(e,n){this.el=text('');this.visible=!1;this.view=null;this._placeholder=this.el;e instanceof Node?(this._el=e):(this._View=e);this._initData=n};Place.prototype.update=function(e,n){var t=this._placeholder,i=this.el.parentNode;if(e){if(!this.visible){if(this._el){mount(i,this._el,t);unmount(i,t);this.el=this._el;this.visible=e;return}var o=this._View,r=new o(this._initData);this.el=getEl(r.el);this.view=r;mount(i,r,t);unmount(i,t)}this.view.update&&this.view.update(n)}else{if(this.visible){if(this._el){mount(i,t,this.view);unmount(i,this._el);this.el=t;this.visible=e;return}mount(i,t,this.view);unmount(i,this.view);this.el=t;this.view=null}}this.visible=e};var router=function(e,n,t){return new Router(e,n,t)},Router=function(e,n,t){this.el=ensureEl(e);this.Views=n;this.initData=t};Router.prototype.update=function(e,n){if(e!==this.route){var t=this.Views,i=t[e];this.view=i&&new i(this.initData,n);this.route=e;setChildren(this.el,[this.view])}this.view&&this.view.update&&this.view.update(n,e)};var SVG='http://www.w3.org/2000/svg',svgCache={},memoizeSVG=function(e){return svgCache[e]||(svgCache[e]=createElement(e,SVG))},svg=function(e){var n=[],t=arguments.length-1;while(t-->0)n[t]=arguments[t+1];var i;if(isString(e))i=memoizeSVG(e).cloneNode(!1);else if(isNode(e))i=e.cloneNode(!1);else{throw new Error('At least one argument required')}parseArguments(i,n);return i};svg.extend=function(e){var n=memoizeSVG(e);return svg.bind(this,n)};export { html, el, list, List, mount, unmount, place, Place, router, Router, setAttr, setStyle, setChildren, svg, text }