var HASH=35,DOT=46,parseQuery=function(e){var n=null,t=null,o=null,i=0,r='';for(var l=0;l<=e.length;l++){var u=e.charCodeAt(l),_=u===HASH,d=u===DOT,c=!u;_||d||c?(i===0?(l===0?(n='div'):(n=r)):i===1?(t=r):(o?(o+=' '+r):(o=r)),_?(i=1):d&&(i=2),r=''):(r+=e[l])}return{tag:n,id:t,className:o}},createElement=function(e,n){var t=parseQuery(e),o=t.tag,i=t.id,r=t.className,l=n?document.createElementNS(n,o):document.createElement(o);i&&(l.id=i);r&&(n?l.setAttribute('class',r):(l.className=r));return l},hookNames=['onmount','onunmount'],mount=function(e,n,t){var o=getEl(e),i=getEl(n);n===i&&i.__redom_view&&(n=i.__redom_view);n!==i&&(i.__redom_view=n);var r=i.__redom_mounted,l=i.parentNode;r&&l!==o&&doUnmount(n,i,l);t!=null?o.insertBefore(i,getEl(t)):o.appendChild(i);doMount(n,i,o,l);return n},unmount=function(e,n){var t=getEl(e),o=getEl(n);n===o&&o.__redom_view&&(n=o.__redom_view);o.parentNode&&(doUnmount(n,o,t),t.removeChild(o));return n},doMount=function(e,n,t,o){var i=n.__redom_lifecycle||(n.__redom_lifecycle={}),r=t===o,l=!1;for(var u=0;u<hookNames.length;u++){var _=hookNames[u];!r&&e!==n&&_ in e&&(i[_]=(i[_]||0)+1);i[_]&&(l=!0)}if(!l){n.__redom_mounted=!0;return}var d=t,c=!1;(r||!c&&(d&&d.__redom_mounted))&&(trigger(n,r?'onremount':'onmount'),c=!0);if(r){return}while(d){var f=d.parentNode,m=d.__redom_lifecycle||(d.__redom_lifecycle={});for(var a in i)m[a]=(m[a]||0)+i[a];!c&&(d===document||f&&f.__redom_mounted)&&(trigger(d,r?'onremount':'onmount'),c=!0);d=f}},doUnmount=function(e,n,t){var o=n.__redom_lifecycle;if(!o){n.__redom_mounted=!1;return}var i=t;n.__redom_mounted&&trigger(n,'onunmount');while(i){var r=i.__redom_lifecycle||(i.__redom_lifecycle={}),l=!1;for(var u in o)r[u]&&(r[u]-=o[u]),r[u]&&(l=!0);l||(i.__redom_lifecycle=null);i=i.parentNode}},trigger=function(e,n){n==='onmount'?(e.__redom_mounted=!0):n==='onunmount'&&(e.__redom_mounted=!1);var t=e.__redom_lifecycle;if(!t){return}var o=e.__redom_view,i=0;o&&o[n]&&o[n]();for(var r in t)r&&i++;if(i){var l=e.firstChild;while(l){var u=l.nextSibling;trigger(l,n);l=u}}},setStyle=function(e,n,t){var o=getEl(e);if(t!==void 0)o.style[n]=t;else if(isString(n))o.setAttribute('style',n);else{for(var i in n)setStyle(o,i,n[i])}},setAttr=function(e,n,t){var o=getEl(e),i=o instanceof SVGElement;if(t!==void 0)n==='style'?setStyle(o,t):i&&isFunction(t)?(o[n]=t):!i&&(n in o||isFunction(t))?(o[n]=t):o.setAttribute(n,t);else{for(var r in n)setAttr(o,r,n[r])}},text=function(e){return document.createTextNode(e)},parseArguments=function(e,n){for(var t=0;t<n.length;t++){var o=n[t];if(o!==0&&!o){continue}typeof o==='function'?o(e):isString(o)||isNumber(o)?e.appendChild(text(o)):isNode(getEl(o))?mount(e,o):o.length?parseArguments(e,o):typeof o==='object'&&setAttr(e,o)}},ensureEl=function(e){return isString(e)?html(e):getEl(e)},getEl=function(e){return e.nodeType&&e||!e.el&&e||getEl(e.el)},isString=function(e){return typeof e==='string'},isNumber=function(e){return typeof e==='number'},isFunction=function(e){return typeof e==='function'},isNode=function(e){return e&&e.nodeType},htmlCache={},memoizeHTML=function(e){return htmlCache[e]||(htmlCache[e]=createElement(e))},html=function(e){var n=[],t=arguments.length-1;while(t-->0)n[t]=arguments[t+1];var o;if(isString(e))o=memoizeHTML(e).cloneNode(!1);else if(isNode(e))o=e.cloneNode(!1);else{throw new Error('At least one argument required')}parseArguments(o,n);return o};html.extend=function(e){var n=memoizeHTML(e);return html.bind(this,n)};var el=html,setChildren=function(e,n){if(n.length===void 0){return setChildren(e,[n])}var t=getEl(e),o=t.firstChild;for(var i=0;i<n.length;i++){var r=n[i];if(!r){continue}var l=getEl(r);if(l===o){o=o.nextSibling;continue}mount(e,r,o)}while(o){var u=o.nextSibling;unmount(e,o);o=u}},propKey=function(e){return function(n){return n[e]}},list=function(e,n,t,o){return new List(e,n,t,o)},List=function(e,n,t,o){this.__redom_list=!0;this.View=n;this.initData=o;this.views=[];this.el=ensureEl(e);t!=null&&(this.lookup={},this.key=isFunction(t)?t:propKey(t))};List.prototype.update=function(e,n){var t=this;e===void 0&&(e=[]);var o=this.View,i=this.key,r=i!=null,l=this.initData,u=new Array(e.length),_=this.views,d=i&&{},c=i&&this.lookup;for(var f=0;f<e.length;f++){var m=e[f],a=void 0;if(r){var w=i(m);a=c[w]||new o(l,m,f,e);d[w]=a;a.__redom_id=w}else a=_[f]||new o(l,m,f,e);u[f]=a;var p=getEl(a.el);p.__redom_view=a;a.update&&a.update(m,f,e,n)}if(r){for(var h=0;h<_.length;h++){var s=_[h].__redom_id;(s in d)||unmount(t,c[s])}}setChildren(this,u);r&&(this.lookup=d);this.views=u};List.extend=function(e,n,t,o){return List.bind(List,e,n,t,o)};list.extend=List.extend;var place=function(e,n){return new Place(e,n)},Place=function(e,n){this.el=text('');this.visible=!1;this.view=null;this._placeholder=this.el;this._View=e;this._initData=n};Place.prototype.update=function(e,n){var t=this._placeholder,o=this.el.parentNode;if(e){if(!this.visible){var i=this._View,r=new i(this._initData);this.el=getEl(r.el);this.view=r;mount(o,this.el,t);unmount(o,t)}this.view.update&&this.view.update(n)}else this.visible&&(mount(o,t,this.el),unmount(o,this.el),this.el=t,this.view=null);this.visible=e};var router=function(e,n,t){return new Router(e,n,t)},Router=function(e,n,t){this.el=ensureEl(e);this.Views=n;this.initData=t};Router.prototype.update=function(e,n){if(e!==this.route){var t=this.Views,o=t[e];this.view=o&&new o(this.initData,n);this.route=e;setChildren(this.el,[this.view])}this.view&&this.view.update&&this.view.update(n,e)};var SVG='http://www.w3.org/2000/svg',svgCache={},memoizeSVG=function(e){return svgCache[e]||(svgCache[e]=createElement(e,SVG))},svg=function(e){var n=[],t=arguments.length-1;while(t-->0)n[t]=arguments[t+1];var o;if(isString(e))o=memoizeSVG(e).cloneNode(!1);else if(isNode(e))o=e.cloneNode(!1);else{throw new Error('At least one argument required')}parseArguments(o,n);return o};svg.extend=function(e){var n=memoizeSVG(e);return svg.bind(this,n)};export { html, el, list, List, mount, unmount, place, Place, router, Router, setAttr, setStyle, setChildren, svg, text }