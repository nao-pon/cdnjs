!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.redom={})}(this,function(e){"use strict";var t="#".charCodeAt(0),i=".".charCodeAt(0),n=function(e,n){var o=function(e){for(var n=null,o=null,r=null,s=0,l="",u=0;u<=e.length;u++){var a=e.charCodeAt(u),f=a===t,d=a===i;f||d||!a?(0===s?n=0===u?"div":l:1===s?o=l:r?r+=" "+l:r=l,f?s=1:d&&(s=2),l=""):l+=e[u]}return{tag:n,id:o,className:r}}(e),r=o.tag,s=o.id,l=o.className,u=n?document.createElementNS(n,r):document.createElement(r);return s&&(u.id=s),l&&(n?u.setAttribute("class",l):u.className=l),u},o=function(e,t){var i=w(e),n=w(t);return t===n&&n.__redom_view&&(t=n.__redom_view),n.parentNode&&(r(t,n,i),i.removeChild(n)),t},r=function(e,t,i){var n=t.__redom_lifecycle;if(n){var o=i;for(t.__redom_mounted&&f(t,"onunmount");o;){var r=o.__redom_lifecycle||(o.__redom_lifecycle={}),s=!1;for(var l in n)r[l]&&(r[l]-=n[l]),r[l]&&(s=!0);s||(o.__redom_lifecycle=null),o=o.parentNode}}else t.__redom_mounted=!1},s=["onmount","onunmount"],l="ShadowRoot"in window,u=function(e,t,i){var n=w(e),o=w(t);t===o&&o.__redom_view&&(t=o.__redom_view),t!==o&&(o.__redom_view=t);var s=o.__redom_mounted,l=o.parentNode;return s&&l!==n&&r(t,o,l),null!=i?n.insertBefore(o,w(i)):n.appendChild(o),a(t,o,n,l),t},a=function(e,t,i,n){for(var o=t.__redom_lifecycle||(t.__redom_lifecycle={}),r=i===n,u=!1,a=0;a<s.length;a++){var d=s[a];!r&&e!==t&&d in e&&(o[d]=(o[d]||0)+1),o[d]&&(u=!0)}if(u){var h=i,v=!1;if((r||!v&&h&&h.__redom_mounted)&&(f(t,r?"onremount":"onmount"),v=!0),!r)for(;h;){var _=h.parentNode,c=h.__redom_lifecycle||(h.__redom_lifecycle={});for(var m in o)c[m]=(c[m]||0)+o[m];!v&&(h===document||l&&h instanceof window.ShadowRoot||_&&_.__redom_mounted)&&(f(h,r?"onremount":"onmount"),v=!0),h=_}}else t.__redom_mounted=!0},f=function(e,t){"onmount"===t?e.__redom_mounted=!0:"onunmount"===t&&(e.__redom_mounted=!1);var i=e.__redom_lifecycle;if(i){var n=e.__redom_view,o=0;for(var r in n&&n[t]&&n[t](),i)r&&o++;if(o)for(var s=e.firstChild;s;){var l=s.nextSibling;f(s,t),s=l}}},d=function(e,t,i){var n=w(e);if(void 0!==i)n.style[t]=i;else if(p(t))n.setAttribute("style",t);else for(var o in t)d(n,o,t[o])},h="http://www.w3.org/1999/xlink",v=function(e,t,i){var n=w(e),o=n instanceof SVGElement;if(void 0!==i)if("style"===t)d(n,i);else if(o&&g(i))n[t]=i;else if(!o&&(t in n||g(i)))n[t]=i;else{if(o&&"xlink"===t)return void function(e,t){for(var i in t)e.setAttributeNS(h,i,t[i])}(n,i);n.setAttribute(t,i)}else for(var r in t)v(n,r,t[r])};var _=function(e){return document.createTextNode(e)},c=function(e,t){for(var i=0;i<t.length;i++){var n=t[i];(0===n||n)&&("function"==typeof n?n(e):p(n)||y(n)?e.appendChild(_(n)):b(w(n))?u(e,n):n.length?c(e,n):"object"==typeof n&&v(e,n))}},m=function(e){return p(e)?x(e):w(e)},w=function(e){return e.nodeType&&e||!e.el&&e||w(e.el)},p=function(e){return"string"==typeof e},y=function(e){return"number"==typeof e},g=function(e){return"function"==typeof e},b=function(e){return e&&e.nodeType},N={},k=function(e){return N[e]||(N[e]=n(e))},x=function(e){for(var t,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];if(p(e))t=k(e).cloneNode(!1);else{if(!b(e))throw new Error("At least one argument required");t=e.cloneNode(!1)}return c(t,i),t};x.extend=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];var n=k(e);return x.bind.apply(x,[this,n].concat(t))};var A=x,S=x,V=function(e){for(var t=[],i=arguments.length-1;i-- >0;)t[i]=arguments[i+1];for(var n=function e(t,i,n){var o=n;for(var r=0;r<i.length;r++){var s=i[r];if(s)if(null==s.length){var l=w(s);l!==o?u(t,s,o):o=o.nextSibling}else o=e(t,s,o)}return o}(e,t,w(e).firstChild);n;){var r=n.nextSibling;o(e,n),n=r}};var C=function(e,t,i){var n;this.View=e,this.initData=i,this.oldLookup={},this.lookup={},this.oldViews=[],this.views=[],null!=t&&(this.lookup={},this.key=g(t)?t:(n=t,function(e){return e[n]}))};C.prototype.update=function(e,t){for(var i=this.View,n=this.key,o=this.initData,r=null!=n,s=this.lookup,l={},u=new Array(e.length),a=this.views,f=0;f<e.length;f++){var d=e[f],h=void 0;if(r){var v=n(d);h=s[v]||new i(o,d,f,e),l[v]=h,h.__redom_id=v}else h=a[f]||new i(o,d,f,e);h.update&&h.update(d,f,e,t),w(h.el).__redom_view=h,u[f]=h}this.oldViews=a,this.views=u,this.oldLookup=s,this.lookup=l};var D=function(e,t,i,n){return new E(e,t,i,n)},E=function(e,t,i,n){this.__redom_list=!0,this.View=t,this.initData=n,this.views=[],this.pool=new C(t,i,n),this.el=m(e),this.keySet=null!=i};E.prototype.update=function(e,t){void 0===e&&(e=[]);var i=this.keySet,n=this.views,r=i&&this.lookup;this.pool.update(e,t);var s=this.pool,l=s.views,u=s.lookup;if(i)for(var a=0;a<n.length;a++){var f=n[a].__redom_id;f in u||o(this,r[f])}V(this,l),i&&(this.lookup=u),this.views=l},E.extend=function(e,t,i,n){return E.bind(E,e,t,i,n)},D.extend=E.extend;var L=function(e,t){this.el=_(""),this.visible=!1,this.view=null,this._placeholder=this.el,e instanceof Node?this._el=e:this._View=e,this._initData=t};L.prototype.update=function(e,t){var i=this._placeholder,n=this.el.parentNode;if(e){if(!this.visible){if(this._el)return u(n,this._el,i),o(n,i),this.el=this._el,void(this.visible=e);var r=new(0,this._View)(this._initData);this.el=w(r),this.view=r,u(n,r,i),o(n,i)}this.view&&this.view.update&&this.view.update(t)}else if(this.visible){if(this._el)return u(n,i,this._el),o(n,this._el),this.el=i,void(this.visible=e);u(n,i,this.view),o(n,this.view),this.el=i,this.view=null}this.visible=e};var P=function(e,t,i){this.el=m(e),this.Views=t,this.initData=i};P.prototype.update=function(e,t){if(e!==this.route){var i=this.Views[e];this.route=e,this.view=i&&new i(this.initData,t),V(this.el,[this.view])}this.view&&this.view.update&&this.view.update(t,e)};var j="http://www.w3.org/2000/svg",R={},T=function(e){return R[e]||(R[e]=n(e,j))},q=function(e){for(var t,i=[],n=arguments.length-1;n-- >0;)i[n]=arguments[n+1];if(p(e))t=T(e).cloneNode(!1);else{if(!b(e))throw new Error("At least one argument required");t=e.cloneNode(!1)}return c(t,i),t};q.extend=function(e){var t=T(e);return q.bind(this,t)},q.ns=j;var B=q;e.el=A,e.h=S,e.html=x,e.list=D,e.List=E,e.listPool=function(e,t,i){return new C(e,t,i)},e.ListPool=C,e.mount=u,e.unmount=o,e.place=function(e,t){return new L(e,t)},e.Place=L,e.router=function(e,t,i){return new P(e,t,i)},e.Router=P,e.setAttr=v,e.setStyle=d,e.setChildren=V,e.s=B,e.svg=q,e.text=_,Object.defineProperty(e,"__esModule",{value:!0})});