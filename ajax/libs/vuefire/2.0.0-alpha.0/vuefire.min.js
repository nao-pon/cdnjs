/*!
 * vuefire v2.0.0-alpha.0
 * (c) 2017 Eduardo San Martin Morote
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.Vuefire={})}(this,function(e){"use strict";function n(e){return Object.defineProperty(e.data(),"id",{value:e.id})}e.default=function(e,t){e.mixin({created:function(){var e=this,n=this.$options.firestore;this._firestoreUnbinds=Object.create(null),this.$firestoreRefs=Object.create(null),n&&Object.keys(n).forEach(function(t){e.$bind(t,n[t])})},beforeDestroy:function(){Object.values(this._firestoreUnbinds).forEach(function(e){e()}),this._firestoreUnbinds=null,this.$firestoreRefs=null}}),e.prototype.$bind=function(e,t){!function(e){var t,o=e.vm,i=e.key,r=e.ref;t=r.add?function(e){var t=e.vm,o=e.key,i=e.collection,r=t[o]=[],f={added:function(e){var t=e.newIndex,o=e.doc;r.splice(t,0,n(o))},modified:function(e){var t=e.oldIndex,o=e.newIndex,i=e.doc;r.splice(t,1),r.splice(o,0,n(i))},removed:function(e){var n=e.oldIndex;r.splice(n,1)}};return i.onSnapshot(function(e){e.docChanges.forEach(function(e){f[e.type](e)})},function(e){console.log("onSnapshot ERR",e)})}({vm:o,key:i,collection:r}):function(e){var t=e.vm,o=e.key;return e.document.onSnapshot(function(e){var i=function(e){return Object.keys(e).reduce(function(n,t){var o=e[t];return"function"==typeof o.isEqual?(n[0][t]=null,n[1][t]=o):n[0][t]=o,n},[{},{}])}(n(e))[0];t[o]=i},function(e){console.log("onSnapshot ERR",e)})}({vm:o,key:i,document:r}),o._firestoreUnbinds[i]=t}({vm:this,key:e,ref:t}),this.$firestoreRefs[e]=t},e.prototype.$unbind=function(e){this._firestoreUnbinds[e](),delete this._firestoreUnbinds[e],delete this.$firestoreRefs[e]}},Object.defineProperty(e,"__esModule",{value:!0})});